//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ---------------- Integer Types Definitions -----------------

typedef int8_t int4_t;

// ------------------- Function Prototypes --------------------

int32_t _fdt_check_node_offset(int32_t a1, int32_t a2);
int32_t _fdt_check_prop_offset(int32_t a1);
int32_t add_panel_to_manager(int32_t * a1, int32_t a2, int32_t a3);
int32_t arch_disable_mmu(int32_t a1, int32_t a2, int32_t a3);
int32_t arm_mmu_init(int32_t a1);
int32_t board_machtype(int32_t a1, int32_t a2, int32_t a3);
int32_t display_draw_screen_line(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t display_draw_screen_line_alignment(int32_t a1);
int32_t factory_mode(int32_t a1, int32_t a2, int32_t a3);
void function_8f67b680(void);
int32_t is_factory_mode(void);
int32_t is_validation_enabled(char * a1, int32_t a2);
int32_t load_and_validate_logo(void);
int32_t load_and_validate_oem_image(void);
int32_t mipi_mot_panel_off(int32_t a1, int32_t a2, int32_t a3);
int32_t mipi_mot_panel_on(int32_t a1, int32_t a2, int32_t a3);
int32_t mmc_enable_enhanced_erase(void);
int32_t mmc_sdhci_enable_enhanced_erase(int32_t a1, int32_t a2, int32_t a3);
int32_t mmc_sdhci_get_wp_group_size(void);
void mmc_set_power_on_wp_user(char * a1, int32_t a2, int32_t a3);
int32_t mot_sst_get_unlock_data(char * a1, char * a2);
int32_t mot_sst_oem_unlock_handler(void);
int32_t panel_manager_init(int32_t a1, int32_t a2, int32_t a3);
int32_t pm8x41_config_s3_source(uint32_t a1, int32_t a2, int32_t a3);
int32_t pm8x41_resin_status(int32_t a1, int32_t a2);
int32_t target_serialno(char * a1, int32_t a2);
int32_t validate_partition(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t wait_queue_block(int32_t a1, int32_t a2);
int32_t wait_queue_init(int32_t * a1, int32_t a2);

// --------------------- Global Variables ---------------------

int32_t g19 = 0; // LR
int32_t g20 = 0; // R0
int32_t g21 = 0; // R1
int32_t g22 = 0; // R10
int32_t g23 = 0; // R11
int32_t g24 = 0; // R2
int32_t g25 = 0; // R3
int32_t g26 = 0; // R4
int32_t g27 = 0; // R5
int32_t g28 = 0; // R6
int32_t g29 = 0; // R7
int32_t g30 = 0; // R8
int32_t g31 = 0; // R9
int32_t g1 = -0x16d2bfed; // 0x8f61bf74
char * g2 = "\xff\xff\xff\xff\x6c\x6f\x61\x64\x5f\x61\x6e\x64\x5f\x76\x61\x6c\x69\x64\x61\x74\x65\x5f\x6b\x65\x72\x6e\x65\x6c\x5f\x69\x6d\x61\x67\x65"; // 0x8f6826be
char * g3 = "\n"; // 0x8f6ac1b0
int32_t g4 = 4; // 0x8f6acacc
int32_t g5 = 4; // 0x8f6acb18
int32_t g6 = 4; // 0x8f6acb30
int32_t g7 = -1; // 0x8f6affb0
int32_t g8 = 102; // 0x8f6affdc
int32_t g9 = 1; // 0x8f6b0044
char * g10; // 0x8f6b0070
int32_t g11 = 0; // 0x8f6bc000
char * g12; // 0x8f6e06ae
int32_t g13 = 0; // 0x8f6e06b4
int32_t g14 = 0; // 0x8f6e0c38
int32_t g15 = 0; // 0x8f7112f4
int32_t g16 = 0; // 0x8f7114ac
int32_t g17 = 0; // 0x8f711550
int32_t g18 = 0; // 0x8f711554

// ------------------------ Functions -------------------------

// Address range: 0x8f673264 - 0x8f6736c3
int32_t validate_partition(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x8f673264
    int32_t v1;
    char * v2 = (char *)v1;
    int32_t v3 = g26; // 0x8f673264
    int32_t v4 = g27; // 0x8f673264
    int32_t v5 = g28; // 0x8f673264
    int32_t v6 = g29; // 0x8f673264
    int32_t v7 = g30; // 0x8f673264
    int32_t v8 = g31; // 0x8f673264
    int32_t v9 = g22; // 0x8f673264
    int32_t v10 = g23; // 0x8f673264
    int32_t v11 = g19; // 0x8f673264
    g23 = a4;
    g30 = a1;
    g31 = a2;
    g22 = a3;
    int32_t v12; // 0x8f6735ec
    int32_t v13; // 0x8f6735ec
    int32_t v14; // 0x8f6735ec
    int32_t result; // 0x8f67366c_2
    int32_t v15;
    int32_t v16;
    char * v17;
    char * v18;
    int32_t v19; // 0x8f67328c16
    if (a1 == 0) {
        // after_if_8f673288_0.thread
        g21 = (int32_t)"%s: Partition is NULL\n";
        v16 = g15;
        g25 = v16;
        v14 = (int32_t)"validate_partition";
        v12 = 0;
        v17 = v2;
        v13 = (int32_t)"%s: Partition is NULL\n";
        // branch -> 0x8f6735ec
      lab_0x8f6735ec:
        // 0x8f6735ec
        print_log(v12, v13, v14, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
        // branch -> 0x8f6735f0
    } else {
        int32_t v20 = g15;
        int32_t v21; // 0x8f673478
        if (a2 != 0) {
            char v22 = *(char *)(a1 + 41); // 0x8f6732b4
            char v23 = *(char *)(a1 + 40); // 0x8f6732b8
            char v24 = *(char *)(a1 + 33); // 0x8f6732bc
            char v25 = *(char *)(a1 + 42); // 0x8f6732c4
            char v26 = *(char *)(a1 + 32); // 0x8f6732c8
            char v27 = *(char *)(a1 + 43); // 0x8f6732d0
            char v28 = *(char *)(a1 + 34); // 0x8f6732d8
            int32_t v29 = 0x1000000 * (int32_t)v27 | 0x10000 * (int32_t)v25 | (int32_t)v23 | 256 * (int32_t)v22; // 0x8f6732dc
            char v30 = *(char *)(a1 + 45); // 0x8f6732e0
            char v31 = *(char *)(a1 + 44); // 0x8f6732e4
            char v32 = *(char *)(a1 + 35); // 0x8f6732ec
            uint32_t v33 = v29 + 1; // 0x8f6732f0
            char v34 = *(char *)(a1 + 46); // 0x8f6732f8
            char v35 = *(char *)(a1 + 47); // 0x8f673300
            uint32_t v36 = 0x1000000 * (int32_t)v32 | 0x10000 * (int32_t)v28 | (int32_t)v26 | 256 * (int32_t)v24; // 0x8f673308
            char v37 = *(char *)(a1 + 37); // 0x8f67330c
            char v38 = *(char *)(a1 + 36); // 0x8f673314
            char v39 = *(char *)(a1 + 38); // 0x8f67331c
            int32_t v40 = 0x10000 * (int32_t)v39 | (int32_t)v38 | 256 * (int32_t)v37; // 0x8f673320
            char v41 = *(char *)(a1 + 39); // 0x8f673324
            int32_t v42 = v33 - v36; // 0x8f67332c
            g28 = v42;
            int32_t v43 = (0x1000000 * (int32_t)v35 | 0x10000 * (int32_t)v34 | (int32_t)v31 | 256 * (int32_t)v30) + (int32_t)(v29 == -1) - (0x1000000 * (int32_t)v41 | v40) + (int32_t)(v33 < v36); // 0x8f673330
            g29 = v43;
            uint32_t v44 = g22; // 0x8f673334
            g25 = 0;
            int32_t v45 = 512 * v42; // 0x8f673340
            g26 = v45;
            int32_t v46 = 512 * v43 | v42 / 0x800000; // 0x8f673344
            g27 = v46;
            int32_t v47; // 0x8f673594
            int32_t v48; // 0x8f673630
            char * v49;
            char * v50;
            int32_t v51;
            char * v52;
            int32_t v53;
            char * v54;
            int32_t v55; // 0x8f673610
            int32_t v56; // 0x8f67328c12
            int32_t v57; // 0x8f67328c13
            int32_t v58; // 0x8f67328c14
            int32_t v59; // 0x8f67328c15
            char v60; // 0x8f67360c
            if (v44 > v45 && v46 == 0) {
                // 0x8f673354
                g21 = (int32_t)"Data size exceeds partition %s size";
                v14 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                v16 = v20;
                v17 = v2;
                // branch -> 0x8f6735ec
                // 0x8f6735ec
                print_log(5, (int32_t)"Data size exceeds partition %s size", v14, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
                // branch -> 0x8f6735f0
              lab_0x8f6735f0:
                // 0x8f6735f0
                g20 = -1;
                result = -1;
                v19 = v16;
                v18 = v17;
                // branch -> 0x8f6735f4
              lab_0x8f6735f4_3:
                // 0x8f6735f4
                g24 = v19;
                v51 = g15;
                g25 = v51;
                if (v19 == v51) {
                    // 0x8f673668
                    g26 = v3;
                    g27 = v4;
                    g28 = v5;
                    g29 = v6;
                    g30 = v7;
                    g31 = v8;
                    g22 = v9;
                    g23 = v10;
                    return result;
                }
              lab_0x8f673608_11:
                // 0x8f673608
                __stack_chk_fail();
                v55 = g27;
                v59 = v19;
                v52 = v18;
                // branch -> 0x8f67360c
                // 0x8f67360c
                v60 = *(char *)g29;
                g21 = v55;
                v53 = (int32_t)v52;
                if (SecWriteFuse((int32_t)v60, v55, g24, g25, v15, v53) == 0) {
                    v58 = v59;
                    v49 = v52;
                    // 0x8f673590
                    v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                    g21 = (int32_t)"validating partition %s successfully\n";
                    v57 = v58;
                    v50 = v49;
                    // branch -> 0x8f6735cc
                    // 0x8f6735cc
                    print_log(1, (int32_t)"validating partition %s successfully\n", v47, g25, v15, (int32_t)v50, 0, v57, 0, v3, v4, v5, v6);
                    g20 = 0;
                    result = 0;
                    v19 = v57;
                    v18 = v50;
                    // branch -> 0x8f6735f4
                    goto lab_0x8f6735f4_3;
                } else {
                  lab_0x8f673620_4:
                    // 0x8f673620
                    g21 = (int32_t)"efuse SV write failed!\n";
                    print_log(-1, (int32_t)"efuse SV write failed!\n", g24, g25, v15, v53, 0, v59, 0, v3, v4, v5, v6);
                    v56 = v59;
                    v54 = v52;
                    // branch -> 0x8f67362c
                    // 0x8f67362c
                    v48 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v54, 0, v56);
                    g21 = (int32_t)"version downgraded for %s";
                    v14 = v48;
                    v12 = 5;
                    v16 = v56;
                    v17 = v54;
                    v13 = (int32_t)"version downgraded for %s";
                    // branch -> 0x8f6735ec
                    goto lab_0x8f6735ec;
                }
                // 0x8f6735f4
                g24 = v19;
                v51 = g15;
                g25 = v51;
                if (v19 != v51) {
                    goto lab_0x8f673608_11;
                }
                // 0x8f673668
                g26 = v3;
                g27 = v4;
                g28 = v5;
                g29 = v6;
                g30 = v7;
                g31 = v8;
                g22 = v9;
                g23 = v10;
                return result;
            }
            unsigned char v61 = *(char *)(a1 + 49); // 0x8f673368
            g26 = v61 % 16;
            int32_t v62; // 0x8f6735cc
            int32_t v63; // 0x8f6735cc
            int32_t v64; // 0x8f6733ac
            int32_t v65; // 0x8f6733c4
            int32_t v66; // 0x8f6733d8
            int32_t v67; // 0x8f6733dc
            int32_t v68; // 0x8f673408
            int32_t v69; // 0x8f673434
            int32_t v70; // 0x8f673438
            int32_t v71; // 0x8f67344c
            int32_t v72; // 0x8f673450
            int32_t v73; // 0x8f673460
            int32_t v74; // 0x8f6734a4
            int32_t v75; // 0x8f6734e8
            int32_t v76; // 0x8f673514
            int32_t len; // 0x8f673528
            int32_t v77; // 0x8f673558
            int32_t v78;
            int32_t v79;
            char * v80;
            char * str2;
            char * v81;
            int32_t v82; // 0x8f673498
            int32_t v83; // 0x8f673480
            int32_t v84; // 0x8f6734c4
            int32_t v85; // 0x8f67355c
            int32_t v86; // 0x8f6733c8
            int32_t v87; // 0x8f673400
            int32_t v88; // 0x8f673404
            int32_t v89; // 0x8f673488
            int32_t v90; // 0x8f67348c
            int32_t v91; // 0x8f673490
            int32_t result2; // 0x8f6734bc
            int32_t v92; // 0x8f6734cc
            int32_t v93; // 0x8f6734d0
            int32_t v94; // 0x8f6734d4
            int32_t v95; // 0x8f673560
            int32_t v96; // 0x8f67328c17
            int32_t str; // 0x8f673518
            int32_t v97; // 0x8f67355c
            int32_t v98; // 0x8f67357c
            switch ((int4_t)v61) {
                default: {
                    // 0x8f6735d8
                    g21 = (int32_t)"Not supported signing type for partition %s\n";
                    v14 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                    v12 = 0;
                    v16 = v20;
                    v17 = v2;
                    v13 = (int32_t)"Not supported signing type for partition %s\n";
                    // branch -> 0x8f6735ec
                  lab_0x8f6735ec_4:
                    // 0x8f6735ec
                    print_log(v12, v13, v14, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
                    // branch -> 0x8f6735f0
                    goto lab_0x8f6735f0;
                    break;
                }
                case 0: {
                    // 0x8f6733a8
                    v64 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                    g21 = (int32_t)"Don't need to validation partition %s";
                    v63 = v64;
                    v57 = v20;
                    v50 = v2;
                    v62 = (int32_t)"Don't need to validation partition %s";
                    // branch -> 0x8f6735cc
                  lab_0x8f6735cc_13:
                    // 0x8f6735cc
                    print_log(1, v62, v63, g25, v15, (int32_t)v50, 0, v57, 0, v3, v4, v5, v6);
                    g20 = 0;
                    result = 0;
                    v19 = v57;
                    v18 = v50;
                    // branch -> 0x8f6735f4
                    goto lab_0x8f6735f4_3;
                    break;
                }
                case 1: {
                    // 0x8f6733c0
                    v65 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                    v86 = g26;
                    v66 = print_log(1, (int32_t)"validating partition %s (type=%d)...\n", v65, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                    v67 = is_validation_enabled((char *)v66, (int32_t)"validating partition %s (type=%d)...\n");
                    g26 = v67;
                    if (v67 != 0) {
                        // 0x8f6733fc
                        v87 = g31;
                        v88 = g22;
                        v68 = is_most_like_hab_image(g30, v87, v88, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6, v7, v8, v9, v10, v11, v78);
                        v71 = get_entry_name(g30, v87, v88, v86, v15, v1, 0, v20);
                        if (v68 == 0) {
                            // 0x8f67344c
                            v72 = get_policy_executor(v71, v87, v88, v86, v15);
                            g26 = v72;
                            if (v72 == 0) {
                                // 0x8f67345c
                                v73 = get_entry_name(g30, v87, v88, v86, v15, v1, 0, v20);
                                g21 = (int32_t)"No executor for partition %s, type=%d\n";
                                v21 = (int32_t)(*(char *)(g30 + 49) % 16);
                                // branch -> 0x8f673478
                                // 0x8f673478
                                print_log(g26, (int32_t)"No executor for partition %s, type=%d\n", v73, v21, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                                v96 = v20;
                                v81 = v2;
                                // branch -> 0x8f6735f0
                              lab_0x8f6735f0_3:
                                // 0x8f6735f0
                                g20 = -1;
                                result = -1;
                                v19 = v96;
                                v18 = v81;
                                // branch -> 0x8f6735f4
                                goto lab_0x8f6735f4_3;
                            } else {
                                v83 = v72;
                            }
                        } else {
                            // 0x8f673418
                            g26 = (int32_t)&g10;
                            print_log(1, (int32_t)"Detected a most-likely HAB signed image for %s\n", v71, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                            v69 = get_entry_name(g30, (int32_t)"Detected a most-likely HAB signed image for %s\n", v71, v86, v15, v1, 0, v20);
                            v70 = is_bootloader_partition(v69, (int32_t)"Detected a most-likely HAB signed image for %s\n", v71, v86, v15, v1, 0, v20, 0, v3, v4);
                            if (v70 == 0) {
                                // if_8f673444_0_true
                                g26 = &g9;
                                v83 = &g9;
                                // branch -> 0x8f673480
                            } else {
                                // 0x8f673418
                                v83 = g26;
                                // branch -> 0x8f673480
                            }
                            // 0x8f673480
                            g20 = v83;
                            v89 = g30;
                            g21 = v89;
                            v90 = g31;
                            g24 = v90;
                            v91 = g22;
                            g25 = v91;
                            g19 = -0x7098cb68;
                            ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v83 + 12))(v83, v89, v90, v91);
                            v82 = g20;
                            g28 = v82;
                            if (v82 != 0) {
                                // 0x8f6734a0
                                v74 = get_entry_name(g30, v89, v90, v91, v78, v79, 0, 0);
                                g21 = (int32_t)"Failed to verify image %s, status=%d\n";
                                print_log(0, (int32_t)"Failed to verify image %s, status=%d\n", v74, g28, v78, v79, 0, 0, 0, 0, 0, 0, 0);
                                result2 = g28;
                                g20 = result2;
                                v19 = v20;
                                v18 = v2;
                                // branch -> 0x8f6735f4
                                // 0x8f6735f4
                                g24 = v19;
                                v51 = g15;
                                g25 = v51;
                                if (v19 != v51) {
                                    goto lab_0x8f673608_11;
                                }
                                // 0x8f673668
                                g26 = v3;
                                g27 = v4;
                                g28 = v5;
                                g29 = v6;
                                g30 = v7;
                                g31 = v8;
                                g22 = v9;
                                g23 = v10;
                                return result2;
                            }
                            // 0x8f6734c4
                            v84 = g26;
                            v80 = (char *)v84;
                            g20 = v84;
                            v92 = g30;
                            g21 = v92;
                            v93 = g31;
                            g24 = v93;
                            v94 = g22;
                            g25 = v94;
                            g19 = -0x7098cb24;
                            ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v84 + 20))(v84, v92, v93, v94);
                            g27 = v84;
                            if (v80 > (char *)-1) {
                                // 0x8f6734fc
                                if (is_validation_enabled(v80, g21) == 0) {
                                    v58 = v20;
                                    v49 = v2;
                                  lab_0x8f673590:
                                    // 0x8f673590
                                    v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                    g21 = (int32_t)"validating partition %s successfully\n";
                                    v63 = v47;
                                    v57 = v58;
                                    v50 = v49;
                                    v62 = (int32_t)"validating partition %s successfully\n";
                                    // branch -> 0x8f6735cc
                                    goto lab_0x8f6735cc_13;
                                } else {
                                    // 0x8f673508
                                    g22 = &g8;
                                    int32_t v99 = &g8; // 0x8f673510
                                    // branch -> 0x8f67350c
                                    while (true) {
                                        // 0x8f67350c
                                        g29 = g28 + v99;
                                        v76 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                                        str = *(int32_t *)(g29 + 4);
                                        g31 = str;
                                        str2 = (char *)v76;
                                        len = strlen((char *)str);
                                        g21 = v76;
                                        g24 = len;
                                        if (strncmp((char *)g31, str2, len) == 0) {
                                            // 0x8f673554
                                            v77 = SecReadFuse((int32_t)*(char *)g29, g21, g24, g25);
                                            v85 = g26;
                                            v97 = *(int32_t *)(v85 + 28);
                                            g25 = v97;
                                            v95 = g27;
                                            g21 = v95;
                                            g28 = v77;
                                            g20 = v85;
                                            g24 = v77;
                                            g19 = -0x7098ca8c;
                                            ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))v97)(v85, v95, v77, v97);
                                            if (g20 == 0) {
                                                // 0x8f67357c
                                                v98 = g27;
                                                if (v98 > g28) {
                                                    // after_if_8f673584_0
                                                    if (g23 % 2 != 0) {
                                                        v55 = v98;
                                                        v59 = v20;
                                                        v52 = str2;
                                                        // 0x8f67360c
                                                        v60 = *(char *)g29;
                                                        g21 = v55;
                                                        v53 = (int32_t)v52;
                                                        if (SecWriteFuse((int32_t)v60, v55, g24, g25, v15, v53) == 0) {
                                                            v58 = v59;
                                                            v49 = v52;
                                                            goto lab_0x8f673590;
                                                        }
                                                        goto lab_0x8f673620_4;
                                                    } else {
                                                        v58 = v20;
                                                        v49 = str2;
                                                    }
                                                } else {
                                                    // after_if_8f673584_0.thread
                                                    v58 = v20;
                                                    v49 = str2;
                                                    // branch -> 0x8f673590
                                                }
                                                // 0x8f673590
                                                v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                                g21 = (int32_t)"validating partition %s successfully\n";
                                                v63 = v47;
                                                v57 = v58;
                                                v50 = v49;
                                                v62 = (int32_t)"validating partition %s successfully\n";
                                                // branch -> 0x8f6735cc
                                                goto lab_0x8f6735cc_13;
                                            } else {
                                                v56 = v20;
                                                v54 = str2;
                                            }
                                        } else {
                                          lab_0x8f673544_3:;
                                            int32_t v100 = g28 + 8; // 0x8f673544
                                            g28 = v100;
                                            if (v100 == 48) {
                                                int32_t v101 = g26; // 0x8f673648
                                                g20 = v101;
                                                int32_t v102 = *(int32_t *)(v101 + 28); // 0x8f67364c
                                                g25 = v102;
                                                int32_t v103 = g27; // 0x8f673650
                                                g21 = v103;
                                                int32_t v104 = (int32_t)*(char *)(g30 + 49) / 16; // 0x8f673654
                                                g24 = v104;
                                                g19 = -0x7098c9a4;
                                                ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))v102)(v101, v103, v104, v102);
                                                if (g20 == 0) {
                                                    v58 = v20;
                                                    v49 = str2;
                                                    // 0x8f673590
                                                    v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                                    g21 = (int32_t)"validating partition %s successfully\n";
                                                    v63 = v47;
                                                    v57 = v58;
                                                    v50 = v49;
                                                    v62 = (int32_t)"validating partition %s successfully\n";
                                                    // branch -> 0x8f6735cc
                                                    goto lab_0x8f6735cc_13;
                                                } else {
                                                    v56 = v20;
                                                    v54 = str2;
                                                    // 0x8f67362c
                                                    v48 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v54, 0, v56);
                                                    g21 = (int32_t)"version downgraded for %s";
                                                    v14 = v48;
                                                    v12 = 5;
                                                    v16 = v56;
                                                    v17 = v54;
                                                    v13 = (int32_t)"version downgraded for %s";
                                                    // branch -> 0x8f6735ec
                                                    goto lab_0x8f6735ec_4;
                                                }
                                                // 0x8f6735f4
                                                g24 = v19;
                                                v51 = g15;
                                                g25 = v51;
                                                if (v19 != v51) {
                                                    goto lab_0x8f673608_11;
                                                }
                                                // 0x8f673668
                                                g26 = v3;
                                                g27 = v4;
                                                g28 = v5;
                                                g29 = v6;
                                                g30 = v7;
                                                g31 = v8;
                                                g22 = v9;
                                                g23 = v10;
                                                return result;
                                            }
                                            // 0x8f673544
                                            v99 = g22;
                                            g28 = v100;
                                            // branch -> 0x8f67350c
                                            continue;
                                        }
                                        // 0x8f67362c
                                        v48 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v54, 0, v56);
                                        g21 = (int32_t)"version downgraded for %s";
                                        v14 = v48;
                                        v12 = 5;
                                        v16 = v56;
                                        v17 = v54;
                                        v13 = (int32_t)"version downgraded for %s";
                                        // branch -> 0x8f6735ec
                                        goto lab_0x8f6735ec_4;
                                    }
                                }
                            } else {
                                // 0x8f6734e4
                                v75 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                                g21 = (int32_t)"Failed to get image version for %s\n";
                                v14 = v75;
                                v12 = g28;
                                v16 = v20;
                                v17 = v2;
                                v13 = (int32_t)"Failed to get image version for %s\n";
                                // branch -> 0x8f6735ec
                              lab_0x8f6735ec_5:
                                // 0x8f6735ec
                                print_log(v12, v13, v14, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
                                v96 = v16;
                                v81 = v17;
                                // branch -> 0x8f6735f0
                                goto lab_0x8f6735f0_3;
                            }
                        }
                        // 0x8f673480
                        g20 = v83;
                        v89 = g30;
                        g21 = v89;
                        v90 = g31;
                        g24 = v90;
                        v91 = g22;
                        g25 = v91;
                        g19 = -0x7098cb68;
                        ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v83 + 12))(v83, v89, v90, v91);
                        v82 = g20;
                        g28 = v82;
                        if (v82 != 0) {
                            // 0x8f6734a0
                            v74 = get_entry_name(g30, v89, v90, v91, v78, v79, 0, 0);
                            g21 = (int32_t)"Failed to verify image %s, status=%d\n";
                            print_log(0, (int32_t)"Failed to verify image %s, status=%d\n", v74, g28, v78, v79, 0, 0, 0, 0, 0, 0, 0);
                            result2 = g28;
                            g20 = result2;
                            result = result2;
                            v19 = v20;
                            v18 = v2;
                            // branch -> 0x8f6735f4
                          lab_0x8f6735f4_4:
                            // 0x8f6735f4
                            g24 = v19;
                            v51 = g15;
                            g25 = v51;
                            if (v19 != v51) {
                                goto lab_0x8f673608_11;
                            }
                            // 0x8f673668
                            g26 = v3;
                            g27 = v4;
                            g28 = v5;
                            g29 = v6;
                            g30 = v7;
                            g31 = v8;
                            g22 = v9;
                            g23 = v10;
                            return result;
                        }
                        // 0x8f6734c4
                        v84 = g26;
                        v80 = (char *)v84;
                        g20 = v84;
                        v92 = g30;
                        g21 = v92;
                        v93 = g31;
                        g24 = v93;
                        v94 = g22;
                        g25 = v94;
                        g19 = -0x7098cb24;
                        ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v84 + 20))(v84, v92, v93, v94);
                        g27 = v84;
                        if (v80 > (char *)-1) {
                            // 0x8f6734fc
                            if (is_validation_enabled(v80, g21) == 0) {
                                v58 = v20;
                                v49 = v2;
                              lab_0x8f673590_2:
                                // 0x8f673590
                                v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                g21 = (int32_t)"validating partition %s successfully\n";
                                v63 = v47;
                                v57 = v58;
                                v50 = v49;
                                v62 = (int32_t)"validating partition %s successfully\n";
                                // branch -> 0x8f6735cc
                                goto lab_0x8f6735cc_13;
                            } else {
                                // 0x8f673508
                                g22 = &g8;
                                // branch -> 0x8f67350c
                                while (true) {
                                    // 0x8f67350c
                                    g29 = g28 + (int32_t)&g8;
                                    v76 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                                    str = *(int32_t *)(g29 + 4);
                                    g31 = str;
                                    str2 = (char *)v76;
                                    len = strlen((char *)str);
                                    g21 = v76;
                                    g24 = len;
                                    if (strncmp((char *)g31, str2, len) != 0) {
                                        goto lab_0x8f673544_3;
                                    }
                                    // 0x8f673554
                                    v77 = SecReadFuse((int32_t)*(char *)g29, g21, g24, g25);
                                    v85 = g26;
                                    v97 = *(int32_t *)(v85 + 28);
                                    g25 = v97;
                                    v95 = g27;
                                    g21 = v95;
                                    g28 = v77;
                                    g20 = v85;
                                    g24 = v77;
                                    g19 = -0x7098ca8c;
                                    ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))v97)(v85, v95, v77, v97);
                                    if (g20 == 0) {
                                        // 0x8f67357c
                                        v98 = g27;
                                        if (v98 > g28) {
                                            // after_if_8f673584_0
                                            if (g23 % 2 != 0) {
                                                v55 = v98;
                                                v59 = v20;
                                                v52 = str2;
                                                // 0x8f67360c
                                                v60 = *(char *)g29;
                                                g21 = v55;
                                                v53 = (int32_t)v52;
                                                if (SecWriteFuse((int32_t)v60, v55, g24, g25, v15, v53) == 0) {
                                                    v58 = v59;
                                                    v49 = v52;
                                                    goto lab_0x8f673590_2;
                                                }
                                                goto lab_0x8f673620_4;
                                            } else {
                                                v58 = v20;
                                                v49 = str2;
                                            }
                                        } else {
                                            // after_if_8f673584_0.thread
                                            v58 = v20;
                                            v49 = str2;
                                            // branch -> 0x8f673590
                                        }
                                        // 0x8f673590
                                        v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                        g21 = (int32_t)"validating partition %s successfully\n";
                                        v63 = v47;
                                        v57 = v58;
                                        v50 = v49;
                                        v62 = (int32_t)"validating partition %s successfully\n";
                                        // branch -> 0x8f6735cc
                                        goto lab_0x8f6735cc_13;
                                    } else {
                                        v56 = v20;
                                        v54 = str2;
                                    }
                                }
                            }
                            // 0x8f67362c
                            v48 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v54, 0, v56);
                            g21 = (int32_t)"version downgraded for %s";
                            v14 = v48;
                            v12 = 5;
                            v16 = v56;
                            v17 = v54;
                            v13 = (int32_t)"version downgraded for %s";
                            // branch -> 0x8f6735ec
                            goto lab_0x8f6735ec_5;
                        } else {
                            // 0x8f6734e4
                            v75 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                            g21 = (int32_t)"Failed to get image version for %s\n";
                            v14 = v75;
                            v12 = g28;
                            v16 = v20;
                            v17 = v2;
                            v13 = (int32_t)"Failed to get image version for %s\n";
                            // branch -> 0x8f6735ec
                          lab_0x8f6735ec_6:
                            // 0x8f6735ec
                            print_log(v12, v13, v14, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
                            v96 = v16;
                            v81 = v17;
                            // branch -> 0x8f6735f0
                            goto lab_0x8f6735f0_3;
                        }
                    }
                    break;
                }
                case 4: {
                    // 0x8f6733c0
                    v65 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                    v86 = g26;
                    v66 = print_log(1, (int32_t)"validating partition %s (type=%d)...\n", v65, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                    v67 = is_validation_enabled((char *)v66, (int32_t)"validating partition %s (type=%d)...\n");
                    g26 = v67;
                    if (v67 != 0) {
                        // 0x8f6733fc
                        v87 = g31;
                        v88 = g22;
                        v68 = is_most_like_hab_image(g30, v87, v88, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6, v7, v8, v9, v10, v11, v78);
                        v71 = get_entry_name(g30, v87, v88, v86, v15, v1, 0, v20);
                        if (v68 == 0) {
                            // 0x8f67344c
                            v72 = get_policy_executor(v71, v87, v88, v86, v15);
                            g26 = v72;
                            if (v72 == 0) {
                                // 0x8f67345c
                                v73 = get_entry_name(g30, v87, v88, v86, v15, v1, 0, v20);
                                g21 = (int32_t)"No executor for partition %s, type=%d\n";
                                v21 = (int32_t)(*(char *)(g30 + 49) % 16);
                                // branch -> 0x8f673478
                                // 0x8f673478
                                print_log(g26, (int32_t)"No executor for partition %s, type=%d\n", v73, v21, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                                v96 = v20;
                                v81 = v2;
                                // branch -> 0x8f6735f0
                              lab_0x8f6735f0_5:
                                // 0x8f6735f0
                                g20 = -1;
                                result = -1;
                                v19 = v96;
                                v18 = v81;
                                // branch -> 0x8f6735f4
                                goto lab_0x8f6735f4_4;
                            } else {
                                v83 = v72;
                            }
                        } else {
                            // 0x8f673418
                            g26 = (int32_t)&g10;
                            print_log(1, (int32_t)"Detected a most-likely HAB signed image for %s\n", v71, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                            v69 = get_entry_name(g30, (int32_t)"Detected a most-likely HAB signed image for %s\n", v71, v86, v15, v1, 0, v20);
                            v70 = is_bootloader_partition(v69, (int32_t)"Detected a most-likely HAB signed image for %s\n", v71, v86, v15, v1, 0, v20, 0, v3, v4);
                            if (v70 == 0) {
                                // if_8f673444_0_true
                                g26 = &g9;
                                v83 = &g9;
                                // branch -> 0x8f673480
                            } else {
                                // 0x8f673418
                                v83 = g26;
                                // branch -> 0x8f673480
                            }
                            // 0x8f673480
                            g20 = v83;
                            v89 = g30;
                            g21 = v89;
                            v90 = g31;
                            g24 = v90;
                            v91 = g22;
                            g25 = v91;
                            g19 = -0x7098cb68;
                            ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v83 + 12))(v83, v89, v90, v91);
                            v82 = g20;
                            g28 = v82;
                            if (v82 != 0) {
                                // 0x8f6734a0
                                v74 = get_entry_name(g30, v89, v90, v91, v78, v79, 0, 0);
                                g21 = (int32_t)"Failed to verify image %s, status=%d\n";
                                print_log(0, (int32_t)"Failed to verify image %s, status=%d\n", v74, g28, v78, v79, 0, 0, 0, 0, 0, 0, 0);
                                result2 = g28;
                                g20 = result2;
                                v19 = v20;
                                v18 = v2;
                                // branch -> 0x8f6735f4
                                // 0x8f6735f4
                                g24 = v19;
                                v51 = g15;
                                g25 = v51;
                                if (v19 != v51) {
                                    goto lab_0x8f673608_11;
                                }
                                // 0x8f673668
                                g26 = v3;
                                g27 = v4;
                                g28 = v5;
                                g29 = v6;
                                g30 = v7;
                                g31 = v8;
                                g22 = v9;
                                g23 = v10;
                                return result2;
                            }
                            // 0x8f6734c4
                            v84 = g26;
                            v80 = (char *)v84;
                            g20 = v84;
                            v92 = g30;
                            g21 = v92;
                            v93 = g31;
                            g24 = v93;
                            v94 = g22;
                            g25 = v94;
                            g19 = -0x7098cb24;
                            ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v84 + 20))(v84, v92, v93, v94);
                            g27 = v84;
                            if (v80 > (char *)-1) {
                                // 0x8f6734fc
                                if (is_validation_enabled(v80, g21) == 0) {
                                    v58 = v20;
                                    v49 = v2;
                                  lab_0x8f673590_3:
                                    // 0x8f673590
                                    v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                    g21 = (int32_t)"validating partition %s successfully\n";
                                    v63 = v47;
                                    v57 = v58;
                                    v50 = v49;
                                    v62 = (int32_t)"validating partition %s successfully\n";
                                    // branch -> 0x8f6735cc
                                    goto lab_0x8f6735cc_13;
                                } else {
                                    // 0x8f673508
                                    g22 = &g8;
                                    // branch -> 0x8f67350c
                                    while (true) {
                                        // 0x8f67350c
                                        g29 = g28 + (int32_t)&g8;
                                        v76 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                                        str = *(int32_t *)(g29 + 4);
                                        g31 = str;
                                        str2 = (char *)v76;
                                        len = strlen((char *)str);
                                        g21 = v76;
                                        g24 = len;
                                        if (strncmp((char *)g31, str2, len) != 0) {
                                            goto lab_0x8f673544_3;
                                        }
                                        // 0x8f673554
                                        v77 = SecReadFuse((int32_t)*(char *)g29, g21, g24, g25);
                                        v85 = g26;
                                        v97 = *(int32_t *)(v85 + 28);
                                        g25 = v97;
                                        v95 = g27;
                                        g21 = v95;
                                        g28 = v77;
                                        g20 = v85;
                                        g24 = v77;
                                        g19 = -0x7098ca8c;
                                        ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))v97)(v85, v95, v77, v97);
                                        if (g20 == 0) {
                                            // 0x8f67357c
                                            v98 = g27;
                                            if (v98 > g28) {
                                                // after_if_8f673584_0
                                                if (g23 % 2 != 0) {
                                                    v55 = v98;
                                                    v59 = v20;
                                                    v52 = str2;
                                                    // 0x8f67360c
                                                    v60 = *(char *)g29;
                                                    g21 = v55;
                                                    v53 = (int32_t)v52;
                                                    if (SecWriteFuse((int32_t)v60, v55, g24, g25, v15, v53) == 0) {
                                                        v58 = v59;
                                                        v49 = v52;
                                                        goto lab_0x8f673590_3;
                                                    }
                                                    goto lab_0x8f673620_4;
                                                } else {
                                                    v58 = v20;
                                                    v49 = str2;
                                                }
                                            } else {
                                                // after_if_8f673584_0.thread
                                                v58 = v20;
                                                v49 = str2;
                                                // branch -> 0x8f673590
                                            }
                                            // 0x8f673590
                                            v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                            g21 = (int32_t)"validating partition %s successfully\n";
                                            v63 = v47;
                                            v57 = v58;
                                            v50 = v49;
                                            v62 = (int32_t)"validating partition %s successfully\n";
                                            // branch -> 0x8f6735cc
                                            goto lab_0x8f6735cc_13;
                                        } else {
                                            v56 = v20;
                                            v54 = str2;
                                        }
                                    }
                                }
                                // 0x8f67362c
                                v48 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v54, 0, v56);
                                g21 = (int32_t)"version downgraded for %s";
                                v14 = v48;
                                v12 = 5;
                                v16 = v56;
                                v17 = v54;
                                v13 = (int32_t)"version downgraded for %s";
                                // branch -> 0x8f6735ec
                                goto lab_0x8f6735ec_6;
                            } else {
                                // 0x8f6734e4
                                v75 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                                g21 = (int32_t)"Failed to get image version for %s\n";
                                v14 = v75;
                                v12 = g28;
                                v16 = v20;
                                v17 = v2;
                                v13 = (int32_t)"Failed to get image version for %s\n";
                                // branch -> 0x8f6735ec
                              lab_0x8f6735ec_7:
                                // 0x8f6735ec
                                print_log(v12, v13, v14, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
                                v96 = v16;
                                v81 = v17;
                                // branch -> 0x8f6735f0
                                goto lab_0x8f6735f0_5;
                            }
                        }
                        // 0x8f673480
                        g20 = v83;
                        v89 = g30;
                        g21 = v89;
                        v90 = g31;
                        g24 = v90;
                        v91 = g22;
                        g25 = v91;
                        g19 = -0x7098cb68;
                        ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v83 + 12))(v83, v89, v90, v91);
                        v82 = g20;
                        g28 = v82;
                        if (v82 != 0) {
                            // 0x8f6734a0
                            v74 = get_entry_name(g30, v89, v90, v91, v78, v79, 0, 0);
                            g21 = (int32_t)"Failed to verify image %s, status=%d\n";
                            print_log(0, (int32_t)"Failed to verify image %s, status=%d\n", v74, g28, v78, v79, 0, 0, 0, 0, 0, 0, 0);
                            result2 = g28;
                            g20 = result2;
                            result = result2;
                            v19 = v20;
                            v18 = v2;
                            // branch -> 0x8f6735f4
                          lab_0x8f6735f4_7:
                            // 0x8f6735f4
                            g24 = v19;
                            v51 = g15;
                            g25 = v51;
                            if (v19 != v51) {
                                goto lab_0x8f673608_11;
                            }
                            // 0x8f673668
                            g26 = v3;
                            g27 = v4;
                            g28 = v5;
                            g29 = v6;
                            g30 = v7;
                            g31 = v8;
                            g22 = v9;
                            g23 = v10;
                            return result;
                        }
                        // 0x8f6734c4
                        v84 = g26;
                        v80 = (char *)v84;
                        g20 = v84;
                        v92 = g30;
                        g21 = v92;
                        v93 = g31;
                        g24 = v93;
                        v94 = g22;
                        g25 = v94;
                        g19 = -0x7098cb24;
                        ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))*(int32_t *)(v84 + 20))(v84, v92, v93, v94);
                        g27 = v84;
                        if (v80 > (char *)-1) {
                            // 0x8f6734fc
                            if (is_validation_enabled(v80, g21) == 0) {
                                v58 = v20;
                                v49 = v2;
                              lab_0x8f673590_4:
                                // 0x8f673590
                                v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                g21 = (int32_t)"validating partition %s successfully\n";
                                v63 = v47;
                                v57 = v58;
                                v50 = v49;
                                v62 = (int32_t)"validating partition %s successfully\n";
                                // branch -> 0x8f6735cc
                                goto lab_0x8f6735cc_13;
                            } else {
                                // 0x8f673508
                                g22 = &g8;
                                // branch -> 0x8f67350c
                                while (true) {
                                    // 0x8f67350c
                                    g29 = g28 + (int32_t)&g8;
                                    v76 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                                    str = *(int32_t *)(g29 + 4);
                                    g31 = str;
                                    str2 = (char *)v76;
                                    len = strlen((char *)str);
                                    g21 = v76;
                                    g24 = len;
                                    if (strncmp((char *)g31, str2, len) != 0) {
                                        goto lab_0x8f673544_3;
                                    }
                                    // 0x8f673554
                                    v77 = SecReadFuse((int32_t)*(char *)g29, g21, g24, g25);
                                    v85 = g26;
                                    v97 = *(int32_t *)(v85 + 28);
                                    g25 = v97;
                                    v95 = g27;
                                    g21 = v95;
                                    g28 = v77;
                                    g20 = v85;
                                    g24 = v77;
                                    g19 = -0x7098ca8c;
                                    ((int32_t (*)(int32_t, int32_t, int32_t, int32_t))v97)(v85, v95, v77, v97);
                                    if (g20 == 0) {
                                        // 0x8f67357c
                                        v98 = g27;
                                        if (v98 > g28) {
                                            // after_if_8f673584_0
                                            if (g23 % 2 != 0) {
                                                v55 = v98;
                                                v59 = v20;
                                                v52 = str2;
                                                // 0x8f67360c
                                                v60 = *(char *)g29;
                                                g21 = v55;
                                                v53 = (int32_t)v52;
                                                if (SecWriteFuse((int32_t)v60, v55, g24, g25, v15, v53) == 0) {
                                                    v58 = v59;
                                                    v49 = v52;
                                                    goto lab_0x8f673590_4;
                                                }
                                                goto lab_0x8f673620_4;
                                            } else {
                                                v58 = v20;
                                                v49 = str2;
                                            }
                                        } else {
                                            // after_if_8f673584_0.thread
                                            v58 = v20;
                                            v49 = str2;
                                            // branch -> 0x8f673590
                                        }
                                        // 0x8f673590
                                        v47 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v49, 0, v58);
                                        g21 = (int32_t)"validating partition %s successfully\n";
                                        v63 = v47;
                                        v57 = v58;
                                        v50 = v49;
                                        v62 = (int32_t)"validating partition %s successfully\n";
                                        // branch -> 0x8f6735cc
                                        goto lab_0x8f6735cc_13;
                                    } else {
                                        v56 = v20;
                                        v54 = str2;
                                    }
                                }
                            }
                            // 0x8f67362c
                            v48 = get_entry_name(g30, g21, g24, g25, v15, (int32_t)v54, 0, v56);
                            g21 = (int32_t)"version downgraded for %s";
                            v14 = v48;
                            v12 = 5;
                            v16 = v56;
                            v17 = v54;
                            v13 = (int32_t)"version downgraded for %s";
                            // branch -> 0x8f6735ec
                            goto lab_0x8f6735ec_7;
                        } else {
                            // 0x8f6734e4
                            v75 = get_entry_name(g30, g21, g24, g25, v78, v79, 0, 0);
                            g21 = (int32_t)"Failed to get image version for %s\n";
                            v16 = v20;
                            v17 = v2;
                            // branch -> 0x8f6735ec
                            // 0x8f6735ec
                            print_log(g28, (int32_t)"Failed to get image version for %s\n", v75, g25, v15, (int32_t)v17, 0, v16, 0, v3, v4, v5, v6);
                            v96 = v16;
                            v81 = v17;
                            // branch -> 0x8f6735f0
                            goto lab_0x8f6735f0_5;
                        }
                    }
                    break;
                }
                case 5: {
                    // 0x8f6733a8
                    v64 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                    g21 = (int32_t)"Don't need to validation partition %s";
                    v57 = v20;
                    v50 = v2;
                    // branch -> 0x8f6735cc
                    // 0x8f6735cc
                    print_log(1, (int32_t)"Don't need to validation partition %s", v64, g25, v15, (int32_t)v50, 0, v57, 0, v3, v4, v5, v6);
                    g20 = 0;
                    result = 0;
                    v19 = v57;
                    v18 = v50;
                    // branch -> 0x8f6735f4
                    goto lab_0x8f6735f4_7;
                }
                case 6: {
                    // 0x8f6735a8
                    g21 = (int32_t)"Only sparse PIV image is supported \n";
                    print_log(1, (int32_t)"Only sparse PIV image is supported \n", v44, 0, v15, v1, 0, v20, 0, v3, v4, v5, v6);
                    // branch -> 0x8f6735f0
                    // 0x8f6735f0
                    g20 = -1;
                    result = -1;
                    v19 = v20;
                    v18 = v2;
                    // branch -> 0x8f6735f4
                    goto lab_0x8f6735f4_7;
                }
                case -6: {
                    // 0x8f6735b8
                    g21 = (int32_t)"validating QC_BOOT partiiton %s...\n";
                    v63 = get_entry_name(a1, v40, v44, 0, v15, v1, 0, v20);
                    v57 = v20;
                    v50 = v2;
                    // branch -> 0x8f6735cc
                    // 0x8f6735cc
                    print_log(1, (int32_t)"validating QC_BOOT partiiton %s...\n", v63, g25, v15, (int32_t)v50, 0, v57, 0, v3, v4, v5, v6);
                    g20 = 0;
                    result = 0;
                    v19 = v57;
                    v18 = v50;
                    // branch -> 0x8f6735f4
                    goto lab_0x8f6735f4_7;
                }
            }
            // 0x8f6733e8
            g21 = (int32_t)"Engineer hw, skip validation\n";
            print_log(1, (int32_t)"Engineer hw, skip validation\n", v65, v86, v15, v1, 0, v20, 0, v3, v4, v5, v6);
            g20 = g26;
            result = g26;
            v19 = v20;
            v18 = v2;
            // branch -> 0x8f6735f4
          lab_0x8f6735f4_9:
            // 0x8f6735f4
            g24 = v19;
            v51 = g15;
            g25 = v51;
            if (v19 != v51) {
                goto lab_0x8f673608_11;
            }
            // 0x8f673668
            g26 = v3;
            g27 = v4;
            g28 = v5;
            g29 = v6;
            g30 = v7;
            g31 = v8;
            g22 = v9;
            g23 = v10;
            return result;
        }
        // 0x8f67329c
        g21 = (int32_t)"%s: data is NULL for partition %s\n";
        v21 = get_entry_name(a1, 0, a3, v20, v15, v1, 0, v20);
        // branch -> 0x8f673478
        // 0x8f673478
        print_log(g31, (int32_t)"%s: data is NULL for partition %s\n", (int32_t)"validate_partition", v21, v15, v1, 0, v20, 0, v3, v4, v5, v6);
        // branch -> 0x8f6735f0
        // 0x8f6735f0
        g20 = -1;
        result = -1;
        v19 = v20;
        v18 = v2;
        // branch -> 0x8f6735f4
        goto lab_0x8f6735f4_9;
    }
    // 0x8f6735f0
    g20 = -1;
    result = -1;
    v19 = v16;
    v18 = v17;
    // branch -> 0x8f6735f4
    goto lab_0x8f6735f4_9;
}

// --------------- Statically Linked Functions ----------------

// ulldiv_t __aeabi_uldivmod(unsigned long long a, unsigned long long b);
// void __stack_chk_fail(void);
// void free(void * ptr);
// void * malloc(size_t size);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);
// char * strcpy(char * restrict dest, const char * restrict src);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);

// --------------- Instruction-Idiom Functions ----------------

// int32_t llvm_ctlz_i32(int32_t a1, bool a2);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 29
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:56:15

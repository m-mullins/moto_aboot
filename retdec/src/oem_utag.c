//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t arch_disable_mmu(int32_t a1, int32_t a2, int32_t a3);
int32_t connect_to_key(int32_t a1);
int32_t display_logo(int32_t a1, int32_t a2);
int32_t fan54046_get_ibuslim(int32_t a1);
int32_t fan540xx_get_ic_info_pn(void);
int32_t fboot_cmd_erase_validate(int32_t a1, int32_t a2, int32_t a3);
int32_t fboot_cmd_flash_permission_validate(int32_t a1, int32_t a2);
int32_t free_sparse_image(int32_t a1, int32_t a2, int32_t a3);
int32_t get_gpio_setting(int32_t a1, int32_t * a2, int32_t a3);
int32_t get_pmic_gpio_setting(int32_t a1, int32_t * a2, int32_t a3);
int32_t heap_init(int32_t a1, int32_t a2);
int32_t heap_realloc(char * a1);
int32_t initial_thread_func(int32_t a1, int32_t a2, int32_t a3);
int32_t keys_get_state(uint32_t a1);
int32_t mcs_bytes_to_mpint(int32_t a1);
int32_t mcs_mpint_to_bytes(int32_t a1, int32_t a2, int32_t a3);
int32_t mcs_multi_add(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t mcs_multi_convert_from_multi_digit_byte_len(int32_t * a1, int32_t a2, uint32_t a3);
int32_t mdp_clk_gating_ctrl(int32_t a1, int32_t a2);
int32_t mdp_get_revision(int32_t a1, int32_t a2, int32_t a3);
int32_t mdp_set_revision(int32_t a1, int32_t a2, int32_t a3);
int32_t mdss_intf_tg_setup(int32_t * a1);
int32_t oem_utag(int32_t a1, int32_t * a2);
int32_t ondraw(int32_t a1, int32_t a2, int32_t a3);
int32_t parse_sparse_image(int32_t * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t platform_get_sclk_count(int32_t a1, int32_t a2, int32_t a3);
int32_t platform_uninit(char * a1, int32_t a2, int32_t a3);
int32_t target_mot_prod_id(char * a1, int32_t a2, int32_t a3);
int32_t target_set_prod_id(char * a1, int32_t a2, int32_t a3);
int32_t utag_parent_exists(int32_t a1);

// --------------------- Global Variables ---------------------

bool g41 = false; // LR
int32_t g42 = 0; // R1
int32_t g43 = 0; // R2
int32_t g44 = 0; // R3
int32_t g45 = 0; // R4
int32_t g46 = 0; // R5
int32_t g47 = 0; // R6
int32_t g48 = 0; // R7
int32_t g1 = -0x16d2bf8d; // 0x8f624998
int32_t g2 = -0x16d2bf10; // 0x8f6287bc
int32_t g3 = -0x1a60cfd4; // 0x8f6760e8
int32_t g4 = -0x1a60cfd4; // 0x8f676120
int32_t g5 = -0x1a60cfa8; // 0x8f676158
int32_t g6 = -0x1a60cf9c; // 0x8f6761bc
int32_t g7 = -0x1a60cf9c; // 0x8f67622c
int32_t g8 = -0x1a60cfa8; // 0x8f67629c
int32_t g9 = -0x1a60cfd0; // 0x8f676300
int32_t g10 = -0x1a60cf70; // 0x8f6763ac
int32_t g11 = 0x7325002c; // 0x8f682749
int32_t g12 = 0x402d2b00; // 0x8f686e33
char g13[2] = "/"; // 0x8f686fbc
int32_t g14 = 0x746e6300; // 0x8f6a4e20
int32_t g15 = 0x70750020; // 0x8f6a4f1e
char * g16 = "\xff\xff\xff\xff\xff\xff\xff\xff\xe8\xc0\x6a\x8f\xe8\xc0\x6a\x8f\x01"; // 0x8f6ac0e0
int32_t g17 = 1; // 0x8f6ac0f0
int32_t g18 = 6; // 0x8f6acab0
int32_t g19 = 0; // 0x8f6b8af8
char * g20; // 0x8f6e08d4
char * g21; // 0x8f6e08f8
char * g22; // 0x8f6e08f9
int32_t g23 = 0; // 0x8f6e091c
char * g24; // 0x8f6e0938
char * g25; // 0x8f6e0aac
int32_t g26 = 0; // 0x8f6e0af4
char * g27; // 0x8f6e0b34
int32_t g28 = 0; // 0x8f6e0be8
int32_t g29 = 0; // 0x8f6e0bec
int32_t g30 = 0; // 0x8f6e0bf0
int32_t g31 = 0; // 0x8f6e0bf4
int32_t g32 = 0; // 0x8f7112f4
int32_t g33 = 0; // 0x8f7114ac
char * g34; // 0x8f711580
char * g35; // 0x8f711588
char * g36; // 0x8f711589
int16_t g37 = 0; // 0x8f711592
int32_t g38 = 0; // 0x8f7125b8
int32_t g39 = 0; // 0x8f7125bc
int32_t g40 = 0; // 0x8f7125ec

// ------------------------ Functions -------------------------

// Address range: 0x8f6292d4 - 0x8f62a643
int32_t oem_utag(int32_t a1, int32_t * a2) {
    // 0x8f6292d4
    int32_t v1;
    char * v2 = (char *)v1;
    int32_t v3 = g45; // bp-32
    int32_t v4 = g47; // 0x8f6292d4
    int32_t v5 = a1; // R9
    int32_t result2 = a1 - 1; // R5
    g45 = (int32_t)a2;
    g47 = *a2;
    int32_t v6 = g32;
    int32_t str = g47; // 0x8f629300
    int32_t n = strlen("config") + 1; // 0x8f629304
    int32_t v7 = n; // R2
    int32_t strncmp_rc = strncmp("config", (char *)str, n); // 0x8f62930c
    g44 = strncmp_rc;
    int32_t v8; // 0x8f62a28c
    int32_t v9; // 0x8f62a28c110
    int32_t v10; // 0x8f62a274
    int32_t v11; // 0x8f62a28c
    int32_t v12; // 0x8f62a61835
    int32_t v13; // 0x8f62a61837
    int32_t v14; // 0x8f62a61838
    int32_t v15; // 0x8f62a61839
    int32_t v16; // 0x8f62a61840
    int32_t v17; // 0x8f62a61841
    int32_t v18; // 0x8f62a61843
    int32_t v19; // 0x8f62a61844
    int32_t v20; // 0x8f62a61845
    int32_t v21; // 0x8f62a61846
    int32_t v22; // 0x8f62a61847
    int32_t v23; // 0x8f62a61848
    int32_t v24;
    int32_t v25; // 0x8f62a5d8_0
    int32_t v26; // 0x8f6295d8
    int32_t v27; // 0x8f62a548
    int32_t v28; // R1
    int32_t v29; // R3
    int32_t result; // 0x8f62a640_2
    int32_t v30;
    int32_t str6;
    int32_t v31;
    int32_t v32;
    int32_t v33;
    char * v34;
    char * v35;
    char * v36;
    char * v37;
    char * v38;
    char * v39;
    char * v40;
    char * v41;
    char * v42;
    int32_t v43;
    char * v44;
    char * v45;
    char * v46;
    int32_t v47; // 0x8f62a568
    int32_t v48; // 0x8f62a08c
    int32_t v49; // 0x8f62a08c97
    if (strncmp_rc == 0) {
        // 0x8f629318
        int32_t v50; // 0x8f62a61851
        int32_t v51; // 0x8f62941c
        if (result2 < 1) {
            v50 = 0;
            // 0x8f629414
            v32 = 0;
            v51 = __utags_walk(0, (int32_t)&g2, (int32_t)&v32, 0, v1, 0, 0, v50, str6, 0, 0, 0, 0, 0, 0);
            if (v51 == 0) {
                // after_if_8f629424_0
                result = 1;
                v42 = v2;
                v22 = v50;
                // branch -> 0x8f62a554
            } else {
                // if_8f629428_0_true
                result = 3;
                v42 = v2;
                v22 = v50;
                // branch -> 0x8f62a554
            }
          lab_0x8f62a554_4:
            // 0x8f62a554
            v43 = g32;
            g44 = v43;
            if (v6 == v43) {
                // 0x8f62a63c
                g45 = v3;
                g47 = v4;
                return result;
            }
          lab_0x8f62a564_24:
            // 0x8f62a564
            __stack_chk_fail();
            v44 = v42;
            v21 = v22;
            // branch -> 0x8f62a568
            // 0x8f62a568
            v47 = g45;
            v49 = v47;
            v46 = v44;
            v19 = v21;
            if (v47 == 0) {
                v36 = v44;
                v20 = v21;
              lab_0x8f62a144_3:
                // 0x8f62a144
                v24 = &str6;
                v38 = v36;
                v16 = v20;
                v9 = (int32_t)"failed to add utag [%s]";
                // branch -> 0x8f62a288
              lab_0x8f62a288_2:
                // 0x8f62a288
                v39 = v38;
                v15 = v16;
                // branch -> 0x8f62a28c
              lab_0x8f62a28c_2:
                // 0x8f62a28c
                fboot_info((int32_t)"INFO", v9, v24, g44, (int32_t)v39, 0, v32, v15, str6, 0, 0);
                v41 = v39;
                v23 = v15;
                // branch -> 0x8f62a550
              lab_0x8f62a550:
                // 0x8f62a550
                result = 3;
                v42 = v41;
                v22 = v23;
                // branch -> 0x8f62a554
                goto lab_0x8f62a554_4;
            }
            // 0x8f62a634
            g46 = 0;
            v48 = v49;
            v34 = v46;
            v18 = v19;
            // branch -> 0x8f62a080
          lab_0x8f62a080:
            // 0x8f62a080
            v29 = v48;
            print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
            if (g46 == 0) {
              lab_0x8f62a09c_14:;
                char * v52 = token_present((int32_t)".features,.attributes,.version", (int32_t)&g11, g45, v29, v30, 0, 0, 0, 0, 0, 0); // 0x8f62a0a8
                if (v52 == NULL) {
                    // 0x8f62a0b4
                    v33 = g45;
                    // branch -> 0x8f62a0c4
                    // 0x8f62a0c4
                    g44 = v33;
                    print_log(2, (int32_t)"DEBUG: %s: utag not set and not special attribute [%s] - not allowed", (int32_t)"utag_allowed", v33, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                    v36 = v34;
                    v20 = v18;
                    // branch -> 0x8f62a144
                    goto lab_0x8f62a144_3;
                } else {
                    v45 = v34;
                    v17 = v18;
                }
            } else {
              lab_0x8f62a574_14:
                // 0x8f62a574
                g46 = (int32_t)".attributes";
                int32_t v53 = load_string_utag_constprop_29((int32_t)".attributes", (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0); // 0x8f62a57c
                g47 = v53;
                if (v53 != 0) {
                    char * v54 = token_present(v53, (int32_t)&g11, g45, v29, v30, 0, 0, 0, 0, 0, 0); // 0x8f62a590
                    if (v54 == NULL) {
                        int32_t v55 = g46; // 0x8f62a5a0
                        print_log(2, (int32_t)"%s: attribute [%s] not in %s", (int32_t)"utag_allowed", g45, v55, 0, v32, v18, str6, 0, 0, 0, 0);
                        int32_t v56 = g46; // 0x8f62a5c0
                        g44 = v56;
                        fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in %s", g45, v56, v55, 0, v32, v18, str6, 0, 0);
                        // branch -> 0x8f62a13c
                        // 0x8f62a13c
                        free((char *)g47);
                        v36 = (char *)v55;
                        v20 = v18;
                        // branch -> 0x8f62a144
                        goto lab_0x8f62a144_3;
                    } else {
                        // 0x8f62a588
                        // branch -> 0x8f62a5cc
                        // 0x8f62a5cc
                        free((char *)g47);
                        v45 = v34;
                        v17 = v18;
                        // branch -> 0x8f62a5d4
                      lab_0x8f62a5d4:
                        // 0x8f62a5d4
                        v25 = &str6;
                        g42 = v25;
                        if (utag_parent_exists(1) != 0) {
                          lab_0x8f62a5f0_15:
                            // 0x8f62a5f0
                            if (__utag_exists(1, v25, g43, g44) == 0) {
                                // 0x8f62a60c
                                v28 = v25;
                                v7 = &g14;
                                char * v57 = __utag_puts(1, v25, (int32_t)&g14, g44, (int32_t)v45, 0, v32, v17, str6, 0); // 0x8f62a618
                                if (v57 == NULL) {
                                    // 0x8f62a624
                                    v24 = v25;
                                    v38 = v45;
                                    v16 = v17;
                                    v9 = (int32_t)"failed to create [%s]";
                                    // branch -> 0x8f62a288
                                    goto lab_0x8f62a288_2;
                                } else {
                                    v35 = v45;
                                    v14 = v17;
                                    // 0x8f62a0cc
                                    if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) != 0) {
                                        v41 = v35;
                                        v23 = v14;
                                        goto lab_0x8f62a550;
                                    }
                                  lab_0x8f62a0cc_16:;
                                    int32_t v58 = &str6;
                                    v40 = v35;
                                    v13 = v14;
                                    // branch -> 0x8f62a540
                                    // 0x8f62a540
                                    v27 = list_str_utag_short(1, v58, v7, g44, (int32_t)v40, 0, v32, v13, str6, 0, 0, 0);
                                    result = v27;
                                    v42 = v40;
                                    v22 = v13;
                                    // branch -> 0x8f62a554
                                    goto lab_0x8f62a554_4;
                                }
                                // 0x8f62a550
                                result = 3;
                                v42 = v41;
                                v22 = v23;
                                // branch -> 0x8f62a554
                                goto lab_0x8f62a554_4;
                            } else {
                                // if_8f62a600_0_true
                                // branch -> 0x8f62a234
                                // 0x8f62a234
                                v10 = &str6;
                                v37 = v45;
                                v12 = v17;
                                // branch -> 0x8f62a274
                                // 0x8f62a274
                                fboot_info((int32_t)"INFO", (int32_t)"can't create [%s] it already exists", v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                // branch -> 0x8f62a278
                                // 0x8f62a278
                                result = 1;
                                v42 = v37;
                                v22 = v12;
                                // branch -> 0x8f62a554
                                goto lab_0x8f62a554_4;
                            }
                            // 0x8f62a554
                            v43 = g32;
                            g44 = v43;
                            if (v6 != v43) {
                                goto lab_0x8f62a564_24;
                            }
                            int32_t v59 = v3; // 0x8f62a640
                            g45 = v59;
                            g47 = v4;
                            return result;
                        }
                      lab_if_8f62a5e4_0_true_15:
                        // if_8f62a5e4_0_true
                        v24 = v25;
                        v38 = v45;
                        v16 = v17;
                        v9 = (int32_t)"can't create [%s] it does not have parent";
                        // branch -> 0x8f62a288
                        goto lab_0x8f62a288_2;
                        // 0x8f62a288
                        v11 = v24;
                        v8 = v9;
                        v39 = v38;
                        v15 = v16;
                        // branch -> 0x8f62a28c
                        goto lab_0x8f62a28c_2;
                    }
                    // 0x8f62a288
                    v11 = v24;
                    v8 = v9;
                    v39 = v38;
                    v15 = v16;
                    // branch -> 0x8f62a28c
                    goto lab_0x8f62a28c_2;
                }
                // 0x8f62a5cc
                free((char *)0);
                v45 = v34;
                v17 = v18;
                // branch -> 0x8f62a5d4
                goto lab_0x8f62a5d4;
            }
            // 0x8f62a5d4
            v25 = &str6;
            g42 = v25;
            if (utag_parent_exists(1) == 0) {
                goto lab_if_8f62a5e4_0_true_15;
            }
            goto lab_0x8f62a5f0_15;
        } else {
            int32_t str2 = *(int32_t *)(g45 + 4); // 0x8f629330
            int32_t result3; // 0x8f6294cc
            if (result2 == 1) {
                // 0x8f629330
                g45 = str2;
                if (strcmp((char *)str2, "help") == 0) {
                    // 0x8f629348
                    fboot_info((int32_t)"INFO", (int32_t)"usage: fastboot oem config [options]", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"options:", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  (none given)      list all supported utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  list              list all configured utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  <name> <value>    set a utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  <name>            query a utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  <name> \"\"", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  unset <name>      unset a utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  clear             unset all utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  protect <name>    mark utag as read-only", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  unprotect <name>  unmark utag as read-only", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)"  help              show usage", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v1, 0, v32, v31, str6, 0, 0);
                    v42 = v2;
                    v22 = v31;
                    // branch -> 0x8f62a554
                    // 0x8f62a554
                    v43 = g32;
                    g44 = v43;
                    if (v6 != v43) {
                        goto lab_0x8f62a564_24;
                    }
                    // 0x8f62a63c
                    g45 = v3;
                    g47 = v4;
                    return result2;
                }
                int32_t strcmp_rc = strcmp((char *)g45, "list"); // 0x8f629400
                if (strcmp_rc != 0) {
                    // 0x8f6294cc
                    result3 = list_utag(g45, (int32_t)"list", v7, strcmp_rc, v1, 0, v32, v31, str6, 0, 0, 0);
                    v42 = v2;
                    v22 = v31;
                    // branch -> 0x8f62a554
                    // 0x8f62a554
                    v43 = g32;
                    g44 = v43;
                    if (v6 != v43) {
                        goto lab_0x8f62a564_24;
                    }
                    // 0x8f62a63c
                    g45 = v3;
                    g47 = v4;
                    return result3;
                }
                // 0x8f6293f8
                v50 = result2;
                // branch -> 0x8f629414
                // 0x8f629414
                v32 = 0;
                v51 = __utags_walk(0, (int32_t)&g2, (int32_t)&v32, 0, v1, 0, 0, v50, str6, 0, 0, 0, 0, 0, 0);
                if (v51 == 0) {
                    // after_if_8f629424_0
                    result = 1;
                    v42 = v2;
                    v22 = v50;
                    // branch -> 0x8f62a554
                } else {
                    // if_8f629428_0_true
                    result = 3;
                    v42 = v2;
                    v22 = v50;
                    // branch -> 0x8f62a554
                }
                // 0x8f62a554
                v43 = g32;
                g44 = v43;
                if (v6 != v43) {
                    goto lab_0x8f62a564_24;
                }
                // 0x8f62a63c
                g45 = v3;
                g47 = v4;
                return result;
            }
            // 0x8f629438
            if (config_cmd_allowed(str2, str, v7, 0, v1, 0, v32, v31, str6, 0, 0, 0) == 0) {
                // if_8f629444_0_true
                // branch -> 0x8f629eb4
                // 0x8f629eb4
                fboot_info((int32_t)"INFO", (int32_t)"Not allowed command", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                // branch -> 0x8f62a550
            } else {
                int32_t str3 = *(int32_t *)(g45 + 4); // 0x8f629450
                g47 = str3;
                v28 = (int32_t)"clear";
                if (strcmp((char *)str3, "clear") == 0) {
                    // 0x8f629468
                    if (__utags_clear(0, v28, v7, g44, v1, 0, v32, v31, str6, 0, 0) == 0) {
                        // 0x8f6295d8
                        v26 = __utags_flush(0, v28, v7, g44, v1, 0, v32, v31);
                        if (v26 == 0) {
                            // if_8f6295e4_0_true
                            result = 1;
                            v42 = v2;
                            v22 = v31;
                            // branch -> 0x8f62a554
                        } else {
                            // after_if_8f6295e0_0
                            result = 3;
                            v42 = v2;
                            v22 = v31;
                            // branch -> 0x8f62a554
                        }
                        // 0x8f62a554
                        v43 = g32;
                        g44 = v43;
                        if (v6 != v43) {
                            goto lab_0x8f62a564_24;
                        }
                        // 0x8f62a63c
                        g45 = v3;
                        g47 = v4;
                        return result;
                    }
                } else {
                    // 0x8f629478
                    int32_t v60; // 0x8f6294bc
                    int32_t v61; // 0x8f6294bc
                    int32_t v62;
                    if (strcmp((char *)g47, "protect") != 0) {
                        // 0x8f629498
                        int32_t result4; // 0x8f629508
                        if (strcmp((char *)g47, "unprotect") == 0) {
                            int32_t v63 = *(int32_t *)(g45 + 8); // 0x8f6294ac
                            v28 = v63;
                            v60 = __utag_unprotect(0, v63, v7, g44, v1, 0, v32, v31, str6, 0);
                            // branch -> 0x8f6294b4
                            // 0x8f6294b4
                            if (v60 == 0) {
                                // 0x8f6294bc
                                v61 = __utags_flush(0, v28, v7, g44, v1, 0, v32, v31);
                                if (v61 == 0) {
                                    // 0x8f6294c8
                                    // branch -> 0x8f6294cc
                                    // 0x8f6294cc
                                    v62 = *(int32_t *)(g45 + 8);
                                    result3 = list_utag(v62, v28, v7, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                    result = result3;
                                    v42 = v2;
                                    v22 = v31;
                                    // branch -> 0x8f62a554
                                  lab_0x8f62a554_5:
                                    // 0x8f62a554
                                    v43 = g32;
                                    g44 = v43;
                                    if (v6 != v43) {
                                        goto lab_0x8f62a564_24;
                                    }
                                    // 0x8f62a63c
                                    g45 = v3;
                                    g47 = v4;
                                    return result;
                                }
                            }
                            // 0x8f62a550
                            result = 3;
                            v42 = v2;
                            v22 = v31;
                            // branch -> 0x8f62a554
                            goto lab_0x8f62a554_5;
                        } else {
                            // 0x8f6294d4
                            if (strcmp((char *)g47, "unset") != 0) {
                                int32_t v64 = g45; // 0x8f6294f4
                                int32_t v65; // 0x8f6294f8
                                if (result2 == 2) {
                                    char v66 = *(char *)*(int32_t *)(v64 + 8); // 0x8f6294f8
                                    v65 = v66;
                                    if (v66 == 0) {
                                        // 0x8f629508
                                        result4 = unset_utag(g47, (int32_t)"unset", v7, v65, v1, 0, v32);
                                        v42 = v2;
                                        v22 = v31;
                                        // branch -> 0x8f62a554
                                        // 0x8f62a554
                                        v43 = g32;
                                        g44 = v43;
                                        if (v6 != v43) {
                                            goto lab_0x8f62a564_24;
                                        }
                                        // 0x8f62a63c
                                        g45 = v3;
                                        g47 = v4;
                                        return result4;
                                    }
                                } else {
                                    // 0x8f6294ec
                                    v65 = g44;
                                    // branch -> 0x8f629510
                                }
                                // 0x8f629510
                                result = set_utag(result2, v64 + 4, v7, v65, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                v42 = v2;
                                v22 = v31;
                                // branch -> 0x8f62a554
                                // 0x8f62a554
                                v43 = g32;
                                g44 = v43;
                                if (v6 != v43) {
                                    goto lab_0x8f62a564_24;
                                }
                                // 0x8f62a63c
                                g45 = v3;
                                g47 = v4;
                                return result;
                            }
                            // if_8f6294e4_0_true
                            // branch -> 0x8f629508
                            int32_t v67 = *(int32_t *)(g45 + 8);
                            result4 = unset_utag(v67, (int32_t)"unset", v7, g44, v1, 0, v32);
                            v42 = v2;
                            v22 = v31;
                            // branch -> 0x8f62a554
                        }
                        // 0x8f62a554
                        v43 = g32;
                        g44 = v43;
                        if (v6 != v43) {
                            goto lab_0x8f62a564_24;
                        }
                        // 0x8f62a63c
                        g45 = v3;
                        g47 = v4;
                        return result4;
                    }
                    int32_t v68 = *(int32_t *)(g45 + 8); // 0x8f62948c
                    v28 = v68;
                    v60 = __utag_protect(0, v68, v7, g44, v1, 0, v32, v31, str6, 0);
                    // branch -> 0x8f6294b4
                    // 0x8f6294b4
                    if (v60 == 0) {
                        // 0x8f6294bc
                        v61 = __utags_flush(0, v28, v7, g44, v1, 0, v32, v31);
                        if (v61 == 0) {
                            // 0x8f6294c8
                            // branch -> 0x8f6294cc
                            // 0x8f6294cc
                            v62 = *(int32_t *)(g45 + 8);
                            result3 = list_utag(v62, v28, v7, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                            result = result3;
                            v42 = v2;
                            v22 = v31;
                            // branch -> 0x8f62a554
                          lab_0x8f62a554_7:
                            // 0x8f62a554
                            v43 = g32;
                            g44 = v43;
                            if (v6 != v43) {
                                goto lab_0x8f62a564_24;
                            }
                            // 0x8f62a63c
                            g45 = v3;
                            g47 = v4;
                            return result;
                        }
                    }
                }
                // 0x8f62a550
                result = 3;
                v42 = v2;
                v22 = v31;
                // branch -> 0x8f62a554
                goto lab_0x8f62a554_7;
            }
            // 0x8f62a550
            result = 3;
            v42 = v2;
            v22 = v31;
            // branch -> 0x8f62a554
            goto lab_0x8f62a554_7;
        }
    } else {
        int32_t str4 = g47; // 0x8f629528
        v28 = str4;
        int32_t n2 = strlen("hw") + 1; // 0x8f62952c
        v7 = n2;
        if (strncmp("hw", (char *)str4, n2) == 0) {
            int32_t v69 = result2; // 0x8f629540
            int32_t v70 = 0;
            if (v69 != 0) {
                int32_t str5 = *(int32_t *)(g45 + 4); // 0x8f629554
                g47 = str5;
                int32_t v71; // 0x8f62a2b0
                if (v69 == 1) {
                    // 0x8f62955c
                    if (strlen((char *)str5) == 1) {
                        char v72 = *(char *)g47; // 0x8f62956c
                        g44 = v72;
                        if (v72 == 47) {
                            // 0x8f62a2b0
                            v71 = list_existing_utags_constprop_34(0, v28, v7, g44, v1, 0, v32, v31);
                            result = v71;
                            v42 = v2;
                            v22 = v31;
                            // branch -> 0x8f62a554
                          lab_0x8f62a554_8:
                            // 0x8f62a554
                            v43 = g32;
                            g44 = v43;
                            if (v6 != v43) {
                                goto lab_0x8f62a564_24;
                            }
                            // 0x8f62a63c
                            g45 = v3;
                            g47 = v4;
                            return result;
                        }
                    }
                } else {
                    // 0x8f62957c
                    if (!((v69 < 1 ^ (v69 & -v69) < 0))) {
                        // 0x8f629580
                        if (strlen((char *)str5) == 1) {
                            char v73 = *(char *)g47; // 0x8f629590
                            g44 = v73;
                            if (v73 == 47) {
                                // if_8f629598_0_true
                                // branch -> 0x8f629eb4
                                // 0x8f629eb4
                                fboot_info((int32_t)"INFO", (int32_t)"syntax error", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                // branch -> 0x8f62a550
                                // 0x8f62a550
                                result = 3;
                                v42 = v2;
                                v22 = v31;
                                // branch -> 0x8f62a554
                                goto lab_0x8f62a554_8;
                            }
                        }
                    }
                }
                // 0x8f6295a4
                v28 = (int32_t)"clear";
                if (strcmp((char *)g47, "clear") == 0) {
                    // 0x8f6295b8
                    v41 = v2;
                    v23 = v31;
                    if (is_utags_ext_locked_constprop_30(0, v28, v7, g44) == 0) {
                        // 0x8f6295c4
                        if (__utags_clear(1, v28, v7, g44, v1, 0, v32, v31, str6, 0, 0) == 0) {
                            // 0x8f6295d4
                            // branch -> 0x8f6295d8
                            // 0x8f6295d8
                            v26 = __utags_flush(1, v28, v7, g44, v1, 0, v32, v31);
                            if (v26 == 0) {
                                // if_8f6295e4_0_true
                                result = 1;
                                v42 = v2;
                                v22 = v31;
                                // branch -> 0x8f62a554
                            } else {
                                // after_if_8f6295e0_0
                                result = 3;
                                v42 = v2;
                                v22 = v31;
                                // branch -> 0x8f62a554
                            }
                          lab_0x8f62a554_13:
                            // 0x8f62a554
                            v43 = g32;
                            g44 = v43;
                            if (v6 != v43) {
                                goto lab_0x8f62a564_24;
                            }
                            // 0x8f62a63c
                            g45 = v3;
                            g47 = v4;
                            return result;
                        }
                        v41 = v2;
                        v23 = v31;
                    }
                  lab_0x8f62a550_2:
                    // 0x8f62a550
                    result = 3;
                    v42 = v41;
                    v22 = v23;
                    // branch -> 0x8f62a554
                    goto lab_0x8f62a554_13;
                } else {
                    // 0x8f6295ec
                    int32_t v74; // 0x8f62a61834
                    char * v75;
                    if (strcmp((char *)g47, "help") == 0) {
                        // 0x8f629600
                        fboot_info((int32_t)"INFO", (int32_t)"usage: fastboot oem hw [options]", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"options:", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  (none given)      list all defined utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  /                 list all existing utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  +<name>           create empty utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  -<name>           delete utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"     use \"fastboot oem -- hw -<name>\"", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  @<name>           set current utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  @                 show current utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  @/                reset current utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  <name> <value>    set a utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  <name> +<value>   append value to current", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"                    utag value", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  <name>            query a utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  <name>/           query child utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  clear             unset all utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  lock              lock utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  unlock            unlock utags", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  status            check lock status", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  help              show usage", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"special utags:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .features         list of defined utags", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .attributes       list of attribute utags", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"                    defined for each utag", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  attribute utags", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .range            comma separated list of", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"                    acceptable values", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  following utags pass values to upper layers", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .chosen           add property to device tree", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      <value of .chosen><parent utag name>=", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"                            <parent utag value>", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .cmdline          add value to cmdline", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      <value of .cmdline><parent utag name>=", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"                            <parent utag value>", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .system           populate system property", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      <value of .system><parent utag name>=", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"                            <parent utag value>", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"  .auto             autodetect utag value", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      if utag is empty and .auto rule is set", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      the rule is executed and result is saved", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      to the utag. Format of the .auto rule:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      key=<key>;index=<index within key>;map=<mapping to user friendly value>", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      map is optional", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"Example of .chosen usage:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag nfc is set to \"true\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag nfc/.chosen is set to \"mmi,\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      device tree property under chosen is set to", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          mmi,nfc=true", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"Example of .cmdline usage:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag radio is set to \"ROW\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag radio/.cmdline is set to \"androidboot.\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      option is added to kernel command line", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          androidboot.radio=ROW", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"Example of .system usage:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag fps is set to \"false\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag fps/.system is set to \"ro.hw.\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      android system property is set to", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          ro.hw.fps=false", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"Examples of .auto usage:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag radio/.auto is set to ", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"key=hwid;index=2;map=1:US,2:China,3:EMEA\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          this rule takes value in column 2", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          of current hwid line, e.g.:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"B A 1 P1A athene_13mp\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          and maps it to US, China or EMEA", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag imager/.auto is set to ", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"key=hwid;index=5;separator=_;", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"            map=13mp:13MP,16mp:16MP,power:13MP\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          this rule takes value in column 5", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          of current hwid line, e.g.:", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"B A 1 P1A athene_13mp\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          considering default and '_' separators", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          and maps it to 13MP or 16MP", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag ram/.auto is set to", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"key=hwprobe;index=__ram\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          utag ram is set to RAM size", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag frontcolor/.auto is set to", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"uspace=config;name=build_vars\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          HW utag frontcolor is set to value of", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          CONFIG utag build_vars", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"      utag nfc/.auto is set to", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          \"default=false\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)"          HW utag nfc is set to \"false\"", v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        fboot_info((int32_t)"INFO", (int32_t)&g14, v7, g44, v30, 0, 0, 0, 0, 0, 0);
                        v75 = v2;
                        v74 = v31;
                        // branch -> 0x8f62a278
                      lab_0x8f62a278_2:
                        // 0x8f62a278
                        result = 1;
                        v42 = v75;
                        v22 = v74;
                        // branch -> 0x8f62a554
                        goto lab_0x8f62a554_13;
                    } else {
                        // 0x8f629a60
                        if (strcmp((char *)g47, "lock") != 0) {
                            // 0x8f629ad0
                            if (strcmp((char *)g47, "unlock") == 0) {
                                int32_t v76 = __utags_is_protected(1, (int32_t)"unlock", v7, g44, v1, 0, v32, v31); // 0x8f629ae8
                                if (v76 == 0) {
                                    // 0x8f629af4
                                    v11 = get_utags_name(1, (int32_t)"unlock", v7, g44);
                                    v8 = (int32_t)"utags [%s] is not locked";
                                    v39 = v2;
                                    v15 = v31;
                                    // branch -> 0x8f62a28c
                                } else {
                                    int32_t v77 = is_validation_enabled((char *)v76, (int32_t)"unlock", v7, g44); // 0x8f629b0c
                                    if (v77 != 0) {
                                        // 0x8f629b18
                                        if (is_factory_product(v77, (int32_t)"unlock", v7, g44) == 0) {
                                            // 0x8f629b24
                                            v11 = get_utags_name(1, (int32_t)"unlock", v7, g44);
                                            v39 = v2;
                                            v15 = v31;
                                            // branch -> 0x8f62a28c
                                            // 0x8f62a28c
                                            fboot_info((int32_t)"INFO", (int32_t)"utags [%s] unlock is blocked for secure HW", v11, g44, (int32_t)v39, 0, v32, v15, str6, 0, 0);
                                            v41 = v39;
                                            v23 = v15;
                                            // branch -> 0x8f62a550
                                            goto lab_0x8f62a550_4;
                                        }
                                    }
                                    // 0x8f629b3c
                                    if (__utags_unprotect(1, (int32_t)"unlock", v7, g44, v1, 0, v32, v31) == 0) {
                                        // 0x8f629b64
                                        if (__utags_flush(1, (int32_t)"unlock", v7, g44, v1, 0, v32, v31) == 0) {
                                            // 0x8f629b74
                                            v10 = get_utags_name(1, (int32_t)"unlock", v7, g44);
                                            v37 = v2;
                                            v12 = v31;
                                            // branch -> 0x8f62a274
                                            // 0x8f62a274
                                            fboot_info((int32_t)"INFO", (int32_t)"utags [%s] unlocked", v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                            v75 = v37;
                                            v74 = v12;
                                            // branch -> 0x8f62a278
                                            goto lab_0x8f62a278_2;
                                        }
                                    }
                                    // 0x8f629b4c
                                    v11 = get_utags_name(1, (int32_t)"unlock", v7, g44);
                                    v8 = (int32_t)"failed to unlock [%s] utags";
                                    v39 = v2;
                                    v15 = v31;
                                    // branch -> 0x8f62a28c
                                }
                              lab_0x8f62a28c_24:
                                // 0x8f62a28c
                                fboot_info((int32_t)"INFO", v8, v11, g44, (int32_t)v39, 0, v32, v15, str6, 0, 0);
                                v41 = v39;
                                v23 = v15;
                                // branch -> 0x8f62a550
                                goto lab_0x8f62a550_4;
                            } else {
                                // 0x8f629b8c
                                if (strcmp((char *)g47, "status") == 0) {
                                    // 0x8f629ba0
                                    g45 = get_utags_name(1, (int32_t)"status", v7, g44);
                                    int32_t v78 = __utags_is_protected(1, (int32_t)"status", v7, g44, v1, 0, v32, v31); // 0x8f629bb0
                                    int32_t v79 = &g14; // 0x8f629bd0
                                    if (v78 == 0) {
                                        // if_8f629bc8_0_true
                                        v79 = (int32_t)"un";
                                        // branch -> after_if_8f629bc8_0
                                    }
                                    // after_if_8f629bc8_0
                                    fboot_info((int32_t)"INFO", (int32_t)"utags [%s] is %slocked", g45, v79, v1, 0, v32, v31, str6, 0, 0);
                                    v75 = v2;
                                    v74 = v31;
                                    // branch -> 0x8f62a278
                                  lab_0x8f62a278_6:
                                    // 0x8f62a278
                                    result = 1;
                                    v42 = v75;
                                    v22 = v74;
                                    // branch -> 0x8f62a554
                                    goto lab_0x8f62a554_13;
                                } else {
                                    int32_t c = (int32_t)*(char *)g47; // 0x8f629bd8
                                    int32_t v80 = c; // R7
                                    char * found_char_pos = strchr("+-@", c); // 0x8f629be4
                                    int32_t v81; // 0x8f62a150
                                    int32_t v82; // 0x8f62a274
                                    int32_t v83; // 0x8f629c50_0
                                    int32_t v84; // 0x8f629d10_0
                                    int32_t v85; // 0x8f629d9c_3
                                    int32_t v86; // 0x8f629e3c_11
                                    char * v87; // 0x8f629e8c_0
                                    int32_t v88; // 0x8f629f2c_0
                                    int32_t v89; // 0x8f62a180_0
                                    int32_t v90; // 0x8f629c54
                                    char * v91; // 0x8f629cac
                                    int32_t v92; // 0x8f629cc4
                                    int32_t v93; // 0x8f629d74
                                    char * mem; // 0x8f629d9c
                                    int32_t v94; // 0x8f629dcc
                                    int32_t v95; // 0x8f629e10
                                    char * v96; // 0x8f629e3c
                                    int32_t len; // 0x8f629e7c
                                    int32_t len2; // 0x8f629f78
                                    int32_t len3; // 0x8f629fd4
                                    int32_t v97; // 0x8f62a0f8
                                    char * v98; // 0x8f62a10c
                                    int32_t v99; // 0x8f62a1a4
                                    int32_t v100; // 0x8f62a1c0
                                    int32_t v101; // 0x8f62a1d0
                                    int32_t v102; // 0x8f62a1f0
                                    int32_t v103;
                                    int32_t v104;
                                    int32_t str7;
                                    int32_t v105; // 0x8f629c58
                                    int32_t v106; // 0x8f629c6c
                                    int32_t v107; // 0x8f629c70
                                    int32_t v108; // 0x8f629e1c
                                    int32_t v109; // 0x8f629e40
                                    int32_t v110; // 0x8f629e54
                                    int32_t v111; // 0x8f62a078
                                    int32_t v112; // 0x8f629d20
                                    int32_t size; // 0x8f629d88
                                    int32_t v113; // 0x8f629dc8
                                    int32_t v114; // 0x8f629df0
                                    int32_t v115; // 0x8f629df4
                                    int32_t v116; // 0x8f629e30
                                    int32_t v117; // 0x8f62a028
                                    int32_t v118; // 0x8f629d14
                                    int32_t v119; // 0x8f629d48
                                    char v120; // 0x8f629c88
                                    int32_t v121; // 0x8f629d28
                                    int32_t v122; // 0x8f629d48
                                    char v123; // 0x8f629e8c
                                    char c3; // 0x8f629eec188
                                    char v124; // 0x8f629f84
                                    uint32_t v125; // 0x8f629fd8
                                    int32_t v126; // 0x8f629c88
                                    int32_t v127; // 0x8f629d58
                                    int32_t v128; // 0x8f629e8c
                                    if (found_char_pos == NULL) {
                                        // 0x8f629c34
                                        apply_current_path_constprop_33(g47, (int32_t)&str6, v7, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                        v80 = (int32_t)found_char_pos;
                                        // branch -> 0x8f629c44
                                    } else {
                                        // 0x8f629bf0
                                        print_log(2, (int32_t)"%s: utag op: %c", (int32_t)"oem_utags_ext", v80, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                        int32_t v129 = *(int32_t *)(g45 + 4); // 0x8f629c08
                                        if (v80 == 64) {
                                            // 0x8f629c20
                                            strlcpy((int32_t)&str6, v129 + 1, 33, v80, v1);
                                            // branch -> 0x8f629c44
                                        } else {
                                            // 0x8f629c10
                                            apply_current_path_constprop_33(v129 + 1, (int32_t)&str6, (int32_t)"oem_utags_ext", v80, v1, 0, v32, v31, str6, 0, 0, 0);
                                            // branch -> 0x8f629c44
                                        }
                                        // 0x8f629c44
                                        v28 = (int32_t)"%s: name: %s";
                                        v7 = (int32_t)"oem_utags_ext";
                                        v83 = &str6;
                                        g44 = v83;
                                        v90 = print_log(2, (int32_t)"%s: name: %s", (int32_t)"oem_utags_ext", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                        v105 = result2;
                                        v81 = v90;
                                        v107 = v105;
                                        if (v105 == 2) {
                                            // 0x8f629c84
                                            v120 = *(char *)*(int32_t *)(g45 + 8);
                                            v126 = v120;
                                            g44 = v126;
                                            if (v120 == 0) {
                                                // 0x8f629c94
                                                if (is_utags_ext_locked_constprop_30(v90, v28, v7, v126) == 0) {
                                                    // 0x8f629ca0
                                                    v28 = v83;
                                                    v7 = &g14;
                                                    v91 = __utag_puts(1, v83, (int32_t)&g14, g44, v1, 0, v32, v31, str6, 0);
                                                    if (v91 == NULL) {
                                                        // if_8f629cb4_0_true
                                                        // branch -> 0x8f62a288
                                                        // 0x8f62a288
                                                        v11 = v83;
                                                        v8 = (int32_t)"failed to clear value of \"%s\"";
                                                        v39 = v2;
                                                        v15 = v31;
                                                        // branch -> 0x8f62a28c
                                                        goto lab_0x8f62a28c_24;
                                                    } else {
                                                        // 0x8f629cc0
                                                        v92 = __utags_flush(1, v28, v7, g44, v1, 0, v32, v31);
                                                        if (v92 == 0) {
                                                            // 0x8f629cc0
                                                            v81 = 0;
                                                            v107 = result2;
                                                            // branch -> 0x8f629c60
                                                            // 0x8f629c60
                                                            g47 = v107 > 1;
                                                            v106 = v80;
                                                            if (v106 != 0) {
                                                                // after_if_8f629c70_0
                                                                if (v107 != 1 && !((v107 < 1 ^ (v107 & -v107) < 0))) {
                                                                    // 0x8f629c78
                                                                    // branch -> 0x8f629eb4
                                                                    // 0x8f629eb4
                                                                    fboot_info((int32_t)"INFO", (int32_t)"syntax error - operator present", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                    // branch -> 0x8f62a550
                                                                    // 0x8f62a550
                                                                    result = 3;
                                                                    v42 = v2;
                                                                    v22 = v31;
                                                                    // branch -> 0x8f62a554
                                                                    goto lab_0x8f62a554_13;
                                                                }
                                                            }
                                                            // 0x8f629cd4
                                                            if (v107 <= 1) {
                                                                // 0x8f629e60
                                                                switch (v106) {
                                                                    default: {
                                                                        // 0x8f629e78
                                                                        len = strlen((char *)&str6);
                                                                        v87 = (char *)((int32_t)&v3 - 1 + len - 168);
                                                                        v123 = *v87;
                                                                        v128 = v123;
                                                                        g44 = v128;
                                                                        if (v123 == 47) {
                                                                            // 0x8f62a294
                                                                            *v87 = (char)g47;
                                                                            if (__utag_exists(1, v83, v7, g44) != 0) {
                                                                                // 0x8f62a2b0
                                                                                v71 = list_existing_utags_constprop_34(v83, v83, v7, g44, v1, 0, v32, v31);
                                                                                result = v71;
                                                                                v42 = v2;
                                                                                v22 = v31;
                                                                                // branch -> 0x8f62a554
                                                                              lab_0x8f62a554_16:
                                                                                // 0x8f62a554
                                                                                v43 = g32;
                                                                                g44 = v43;
                                                                                if (v6 != v43) {
                                                                                    goto lab_0x8f62a564_24;
                                                                                }
                                                                                // 0x8f62a63c
                                                                                g45 = v3;
                                                                                g47 = v4;
                                                                                return result;
                                                                            }
                                                                        } else {
                                                                            // 0x8f629e98
                                                                            if (__utag_exists(1, v83, v7, v128) != 0) {
                                                                                v40 = v2;
                                                                                v13 = v31;
                                                                                // 0x8f62a540
                                                                                v27 = list_str_utag_short(1, v83, v7, g44, (int32_t)v40, 0, v32, v13, str6, 0, 0, 0);
                                                                                result = v27;
                                                                                v42 = v40;
                                                                                v22 = v13;
                                                                                // branch -> 0x8f62a554
                                                                                goto lab_0x8f62a554_16;
                                                                            }
                                                                        }
                                                                        // 0x8f629eac
                                                                        // branch -> 0x8f629eb4
                                                                        // 0x8f629eb4
                                                                        fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                        // branch -> 0x8f62a550
                                                                        // 0x8f62a550
                                                                        result = 3;
                                                                        v42 = v2;
                                                                        v22 = v31;
                                                                        // branch -> 0x8f62a554
                                                                        goto lab_0x8f62a554_16;
                                                                    }
                                                                    case 45: {
                                                                        // 0x8f62a150
                                                                        if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) != 0) {
                                                                            // 0x8f62a550
                                                                            result = 3;
                                                                            v42 = v2;
                                                                            v22 = v31;
                                                                            // branch -> 0x8f62a554
                                                                            goto lab_0x8f62a554_16;
                                                                        }
                                                                        break;
                                                                    }
                                                                    case 64: {
                                                                        // 0x8f62a208
                                                                        if (strncmp((char *)&str6, g13, 2) != 0) {
                                                                            // 0x8f62a23c
                                                                            if (__utag_exists(1, v83, 2, g44) == 0) {
                                                                                // 0x8f62a250
                                                                                if (strlen((char *)&str6) == 0) {
                                                                                    // 0x8f62a260
                                                                                    v10 = get_current_path(1, v83, 2, g44);
                                                                                    v82 = (int32_t)"current path set to [%s]";
                                                                                    v37 = v2;
                                                                                    v12 = v31;
                                                                                    // branch -> 0x8f62a274
                                                                                  lab_0x8f62a274_2:
                                                                                    // 0x8f62a274
                                                                                    fboot_info((int32_t)"INFO", v82, v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                                                                    v75 = v37;
                                                                                    v74 = v12;
                                                                                    // branch -> 0x8f62a278
                                                                                    goto lab_0x8f62a278_6;
                                                                                } else {
                                                                                    // 0x8f62a280
                                                                                    v24 = v83;
                                                                                    v38 = v2;
                                                                                    v16 = v31;
                                                                                    v9 = (int32_t)"path validation failed for [%s]";
                                                                                    // branch -> 0x8f62a288
                                                                                  lab_0x8f62a288_3:
                                                                                    // 0x8f62a288
                                                                                    v11 = v24;
                                                                                    v8 = v9;
                                                                                    v39 = v38;
                                                                                    v15 = v16;
                                                                                    // branch -> 0x8f62a28c
                                                                                    goto lab_0x8f62a28c_24;
                                                                                }
                                                                              lab_0x8f62a554_30:
                                                                                // 0x8f62a554
                                                                                v43 = g32;
                                                                                g44 = v43;
                                                                                if (v6 != v43) {
                                                                                    goto lab_0x8f62a564_24;
                                                                                }
                                                                                // 0x8f62a63c
                                                                                g45 = v3;
                                                                                g47 = v4;
                                                                                return 3;
                                                                            }
                                                                        }
                                                                        // 0x8f62a220
                                                                        set_current_path(1, v83, 2, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                        // branch -> 0x8f62a234
                                                                        // 0x8f62a234
                                                                        v10 = &str6;
                                                                        v82 = (int32_t)"current path set to [%s]";
                                                                        v37 = v2;
                                                                        v12 = v31;
                                                                        // branch -> 0x8f62a274
                                                                        goto lab_0x8f62a274_2;
                                                                    }
                                                                    case 43: {
                                                                        // 0x8f629ebc
                                                                        if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                                            // 0x8f629ec8
                                                                            if (strlen((char *)&str6) == 0) {
                                                                                // if_8f629ed8_0_true
                                                                                v33 = v83;
                                                                                // branch -> 0x8f62a0c4
                                                                                // 0x8f62a0c4
                                                                                g44 = v33;
                                                                                print_log(-1, (int32_t)"%s: empty utag name\n", (int32_t)"validate_hw_utag_name_full", v33, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                v36 = v2;
                                                                                v20 = v31;
                                                                                // branch -> 0x8f62a144
                                                                                goto lab_0x8f62a144_3;
                                                                            } else {
                                                                                // if_8f629ed4_0_true
                                                                                g45 = (int32_t)&g12 + 1;
                                                                                c3 = *(char *)((int32_t)&g12 + 1);
                                                                                if (c3 != 0) {
                                                                                    int32_t c2 = c3; // 0x8f629eec191
                                                                                    while (true) {
                                                                                        // 0x8f629ef8
                                                                                        if (strchr((char *)&str6, c2) == NULL) {
                                                                                          lab_0x8f629ef8_3:;
                                                                                            int32_t v130 = g45 + 1; // 0x8f629eec
                                                                                            g45 = v130;
                                                                                            char v131 = *(char *)v130; // 0x8f629eec
                                                                                            if (v131 == 0) {
                                                                                                // break (via goto) -> 0x8f629f2c
                                                                                                goto lab_0x8f629f2c;
                                                                                            }
                                                                                            c2 = v131;
                                                                                            // continue -> 0x8f629ef8
                                                                                            continue;
                                                                                        } else {
                                                                                            // 0x8f629f08
                                                                                            g44 = v83;
                                                                                            print_log(-1, (int32_t)"%s: utag name includes special characters\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                            fboot_info((int32_t)"INFO", (int32_t)"utag name includes special character", (int32_t)"validate_hw_utag_name_full", g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                            v36 = v2;
                                                                                            v20 = v31;
                                                                                            // branch -> 0x8f62a144
                                                                                        }
                                                                                      lab_0x8f62a144_7:
                                                                                        // 0x8f62a144
                                                                                        v24 = &str6;
                                                                                        v38 = v36;
                                                                                        v16 = v20;
                                                                                        v9 = (int32_t)"failed to add utag [%s]";
                                                                                        // branch -> 0x8f62a288
                                                                                        goto lab_0x8f62a288_3;
                                                                                    }
                                                                                    int32_t v132; // 0x8f629f40
                                                                                    if (v132 < 23) {
                                                                                        if (v124 == 47) {
                                                                                            // branch -> 0x8f62a000
                                                                                        } else {
                                                                                            char * v133; // 0x8f629fb8
                                                                                            if (v133 == NULL) {
                                                                                                // branch -> 0x8f62a018
                                                                                                char * v134; // 0x8f62a008_0
                                                                                                while (true) {
                                                                                                    // 0x8f62a018
                                                                                                    if (v117 < v125) {
                                                                                                      lab_0x8f62a008_4:
                                                                                                        // 0x8f62a008
                                                                                                        v134 = (char *)v117;
                                                                                                        if (*v134 == 47) {
                                                                                                            // break (via goto) -> 0x8f62a028
                                                                                                            goto lab_0x8f62a028;
                                                                                                        }
                                                                                                        v117--;
                                                                                                        // continue -> 0x8f62a018
                                                                                                        continue;
                                                                                                    }
                                                                                                    // 0x8f62a05c
                                                                                                    if (0x1000000 * str7 == 0x2e000000) {
                                                                                                        // 0x8f62a630
                                                                                                        g45 = v88;
                                                                                                        // branch -> 0x8f62a634
                                                                                                        // 0x8f62a634
                                                                                                        g46 = 0;
                                                                                                        v48 = v88;
                                                                                                        v34 = v2;
                                                                                                        v18 = v31;
                                                                                                        // branch -> 0x8f62a080
                                                                                                        goto lab_0x8f62a080;
                                                                                                    } else {
                                                                                                        // if_8f62a064_0_true
                                                                                                        g45 = 0;
                                                                                                        // branch -> 0x8f62a0e0
                                                                                                        // 0x8f62a0e0
                                                                                                        v29 = v88;
                                                                                                        print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                        v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                        g47 = v97;
                                                                                                        if (v97 != 0) {
                                                                                                            // 0x8f62a104
                                                                                                            v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                            if (v98 == NULL) {
                                                                                                                // 0x8f62a118
                                                                                                                g44 = v88;
                                                                                                                print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                                fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                                                // branch -> 0x8f62a13c
                                                                                                                // 0x8f62a13c
                                                                                                                free((char *)g47);
                                                                                                                v36 = v2;
                                                                                                                v20 = v31;
                                                                                                                // branch -> 0x8f62a144
                                                                                                                goto lab_0x8f62a144_7;
                                                                                                            } else {
                                                                                                                // 0x8f62a070
                                                                                                                free((char *)g47);
                                                                                                                // branch -> 0x8f62a078
                                                                                                                // 0x8f62a078
                                                                                                                v111 = g45;
                                                                                                                v45 = v2;
                                                                                                                v17 = v31;
                                                                                                                if (v111 != 0) {
                                                                                                                    v48 = v111;
                                                                                                                    v34 = v2;
                                                                                                                    v18 = v31;
                                                                                                                    // 0x8f62a080
                                                                                                                    v29 = v48;
                                                                                                                    print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                                    if (g46 == 0) {
                                                                                                                        goto lab_0x8f62a09c_14;
                                                                                                                    }
                                                                                                                    goto lab_0x8f62a574_14;
                                                                                                                }
                                                                                                                // 0x8f62a5d4
                                                                                                                v25 = &str6;
                                                                                                                g42 = v25;
                                                                                                                if (utag_parent_exists(1) == 0) {
                                                                                                                    goto lab_if_8f62a5e4_0_true_15;
                                                                                                                }
                                                                                                                goto lab_0x8f62a5f0_15;
                                                                                                            }
                                                                                                        }
                                                                                                        // 0x8f62a078
                                                                                                        v111 = g45;
                                                                                                        if (v111 == 0) {
                                                                                                            v45 = v2;
                                                                                                            v17 = v31;
                                                                                                            // 0x8f62a5d4
                                                                                                            v25 = &str6;
                                                                                                            g42 = v25;
                                                                                                            if (utag_parent_exists(1) == 0) {
                                                                                                                goto lab_if_8f62a5e4_0_true_15;
                                                                                                            }
                                                                                                            goto lab_0x8f62a5f0_15;
                                                                                                        } else {
                                                                                                            v48 = v111;
                                                                                                            v34 = v2;
                                                                                                            v18 = v31;
                                                                                                        }
                                                                                                    }
                                                                                                  lab_0x8f62a080_2:
                                                                                                    // 0x8f62a080
                                                                                                    v29 = v48;
                                                                                                    print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                    if (g46 == 0) {
                                                                                                        goto lab_0x8f62a09c_14;
                                                                                                    }
                                                                                                    goto lab_0x8f62a574_14;
                                                                                                }
                                                                                              lab_0x8f62a028:
                                                                                                // 0x8f62a028
                                                                                                g45 = v117 + 1;
                                                                                                *v134 = 0;
                                                                                                if (g45 == 0) {
                                                                                                    // 0x8f62a05c
                                                                                                    if (0x1000000 * str7 == 0x2e000000) {
                                                                                                        // 0x8f62a630
                                                                                                        g45 = v88;
                                                                                                        v49 = v88;
                                                                                                        v46 = v2;
                                                                                                        v19 = v31;
                                                                                                        // branch -> 0x8f62a634
                                                                                                      lab_0x8f62a634:
                                                                                                        // 0x8f62a634
                                                                                                        g46 = 0;
                                                                                                        v48 = v49;
                                                                                                        v34 = v46;
                                                                                                        v18 = v19;
                                                                                                        // branch -> 0x8f62a080
                                                                                                        goto lab_0x8f62a080_2;
                                                                                                    } else {
                                                                                                        // if_8f62a064_0_true
                                                                                                        g45 = 0;
                                                                                                        // branch -> 0x8f62a0e0
                                                                                                        // 0x8f62a0e0
                                                                                                        v29 = v88;
                                                                                                        print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                        v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                        g47 = v97;
                                                                                                        if (v97 != 0) {
                                                                                                            // 0x8f62a104
                                                                                                            v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                            if (v98 == NULL) {
                                                                                                                // 0x8f62a118
                                                                                                                g44 = v88;
                                                                                                                print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                                fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                                                // branch -> 0x8f62a13c
                                                                                                                // 0x8f62a13c
                                                                                                                free((char *)g47);
                                                                                                                v36 = v2;
                                                                                                                v20 = v31;
                                                                                                                // branch -> 0x8f62a144
                                                                                                                goto lab_0x8f62a144_7;
                                                                                                            } else {
                                                                                                                // 0x8f62a070
                                                                                                                free((char *)g47);
                                                                                                                // branch -> 0x8f62a078
                                                                                                                // 0x8f62a078
                                                                                                                v111 = g45;
                                                                                                                v45 = v2;
                                                                                                                v17 = v31;
                                                                                                                if (v111 != 0) {
                                                                                                                    v48 = v111;
                                                                                                                    v34 = v2;
                                                                                                                    v18 = v31;
                                                                                                                    // 0x8f62a080
                                                                                                                    v29 = v48;
                                                                                                                    print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                                    if (g46 == 0) {
                                                                                                                        goto lab_0x8f62a09c_14;
                                                                                                                    }
                                                                                                                    goto lab_0x8f62a574_14;
                                                                                                                }
                                                                                                                // 0x8f62a5d4
                                                                                                                v25 = &str6;
                                                                                                                g42 = v25;
                                                                                                                if (utag_parent_exists(1) == 0) {
                                                                                                                    goto lab_if_8f62a5e4_0_true_15;
                                                                                                                }
                                                                                                                goto lab_0x8f62a5f0_15;
                                                                                                            }
                                                                                                            // 0x8f62a288
                                                                                                            v11 = v24;
                                                                                                            v8 = v9;
                                                                                                            v39 = v38;
                                                                                                            v15 = v16;
                                                                                                            // branch -> 0x8f62a28c
                                                                                                            goto lab_0x8f62a28c_24;
                                                                                                        }
                                                                                                        // 0x8f62a078
                                                                                                        v111 = g45;
                                                                                                        if (v111 == 0) {
                                                                                                            v45 = v2;
                                                                                                            v17 = v31;
                                                                                                            // 0x8f62a5d4
                                                                                                            v25 = &str6;
                                                                                                            g42 = v25;
                                                                                                            if (utag_parent_exists(1) == 0) {
                                                                                                                goto lab_if_8f62a5e4_0_true_15;
                                                                                                            }
                                                                                                            goto lab_0x8f62a5f0_15;
                                                                                                        } else {
                                                                                                            v48 = v111;
                                                                                                            v34 = v2;
                                                                                                            v18 = v31;
                                                                                                        }
                                                                                                    }
                                                                                                    // 0x8f62a080
                                                                                                    v29 = v48;
                                                                                                    print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                    if (g46 == 0) {
                                                                                                        goto lab_0x8f62a09c_14;
                                                                                                    }
                                                                                                    goto lab_0x8f62a574_14;
                                                                                                } else {
                                                                                                    char v135 = *(char *)(v117 + 1); // 0x8f62a03c
                                                                                                    g44 = v135;
                                                                                                    if (v135 != 46) {
                                                                                                        // if_8f62a048_0_true
                                                                                                        g45 = 0;
                                                                                                        // branch -> after_if_8f62a048_0
                                                                                                    }
                                                                                                    // after_if_8f62a048_0
                                                                                                    if (strlen((char *)&str7) == 0) {
                                                                                                        v44 = v2;
                                                                                                        v21 = v31;
                                                                                                        // 0x8f62a568
                                                                                                        v47 = g45;
                                                                                                        if (v47 == 0) {
                                                                                                            v36 = v44;
                                                                                                            v20 = v21;
                                                                                                            goto lab_0x8f62a144_7;
                                                                                                        }
                                                                                                        v49 = v47;
                                                                                                        v46 = v44;
                                                                                                        v19 = v21;
                                                                                                        goto lab_0x8f62a634;
                                                                                                    }
                                                                                                }
                                                                                                // 0x8f62a0e0
                                                                                                v29 = v88;
                                                                                                print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                g47 = v97;
                                                                                                if (v97 != 0) {
                                                                                                    // 0x8f62a104
                                                                                                    v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                    if (v98 == NULL) {
                                                                                                        // 0x8f62a118
                                                                                                        g44 = v88;
                                                                                                        print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                        fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                                        // branch -> 0x8f62a13c
                                                                                                        // 0x8f62a13c
                                                                                                        free((char *)g47);
                                                                                                        v36 = v2;
                                                                                                        v20 = v31;
                                                                                                        // branch -> 0x8f62a144
                                                                                                        goto lab_0x8f62a144_7;
                                                                                                    } else {
                                                                                                        // 0x8f62a070
                                                                                                        free((char *)g47);
                                                                                                        // branch -> 0x8f62a078
                                                                                                        // 0x8f62a078
                                                                                                        v111 = g45;
                                                                                                        v45 = v2;
                                                                                                        v17 = v31;
                                                                                                        if (v111 != 0) {
                                                                                                            v48 = v111;
                                                                                                            v34 = v2;
                                                                                                            v18 = v31;
                                                                                                            // 0x8f62a080
                                                                                                            v29 = v48;
                                                                                                            print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                            if (g46 == 0) {
                                                                                                                goto lab_0x8f62a09c_14;
                                                                                                            }
                                                                                                            goto lab_0x8f62a574_14;
                                                                                                        }
                                                                                                        // 0x8f62a5d4
                                                                                                        v25 = &str6;
                                                                                                        g42 = v25;
                                                                                                        if (utag_parent_exists(1) == 0) {
                                                                                                            goto lab_if_8f62a5e4_0_true_15;
                                                                                                        }
                                                                                                        goto lab_0x8f62a5f0_15;
                                                                                                    }
                                                                                                  lab_0x8f62a288_6:
                                                                                                    // 0x8f62a288
                                                                                                    v11 = &str6;
                                                                                                    v8 = (int32_t)"failed to add utag [%s]";
                                                                                                    v39 = v2;
                                                                                                    v15 = v31;
                                                                                                    // branch -> 0x8f62a28c
                                                                                                    goto lab_0x8f62a28c_24;
                                                                                                }
                                                                                                // 0x8f62a078
                                                                                                v111 = g45;
                                                                                                v45 = v2;
                                                                                                v17 = v31;
                                                                                                if (v111 != 0) {
                                                                                                    v48 = v111;
                                                                                                    v34 = v2;
                                                                                                    v18 = v31;
                                                                                                  lab_0x8f62a080_4:
                                                                                                    // 0x8f62a080
                                                                                                    v29 = v48;
                                                                                                    print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                    if (g46 == 0) {
                                                                                                        goto lab_0x8f62a09c_14;
                                                                                                    }
                                                                                                    goto lab_0x8f62a574_14;
                                                                                                }
                                                                                                // 0x8f62a5d4
                                                                                                v25 = &str6;
                                                                                                g42 = v25;
                                                                                                if (utag_parent_exists(1) == 0) {
                                                                                                    goto lab_if_8f62a5e4_0_true_15;
                                                                                                }
                                                                                                goto lab_0x8f62a5f0_15;
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                    // branch -> 0x8f62a144
                                                                                  lab_0x8f62a144_8:
                                                                                    // 0x8f62a144
                                                                                    // branch -> 0x8f62a288
                                                                                    goto lab_0x8f62a288_6;
                                                                                }
                                                                                // 0x8f629f2c
                                                                                v88 = &str7;
                                                                                g46 = v88;
                                                                                utag_canonical_name_constprop_28(v83, v88, v7, g44, v1, 0, v32, v31);
                                                                                if (strlen((char *)&str7) < 23) {
                                                                                    // 0x8f629f74
                                                                                    len2 = strlen((char *)&str6);
                                                                                    v124 = *(char *)(len2 + (int32_t)&v3 - 169);
                                                                                    if (v124 == 47) {
                                                                                        // 0x8f629f90
                                                                                        g44 = v83;
                                                                                        print_log(2, (int32_t)"%s: utag name must not end with '/'[%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                        // branch -> 0x8f62a000
                                                                                    } else {
                                                                                        // 0x8f629fb0
                                                                                        if (strstr((char *)&str6, "//") == NULL) {
                                                                                            // 0x8f629fc4
                                                                                            utag_canonical_name_constprop_28(v83, v88, v7, (int32_t)v124, v1, 0, v32, v31);
                                                                                            len3 = strlen((char *)&str7);
                                                                                            v125 = g46;
                                                                                            v117 = v125 + len3;
                                                                                            // branch -> 0x8f62a018
                                                                                            while (true) {
                                                                                                // 0x8f62a018
                                                                                                if (v117 < v125) {
                                                                                                    goto lab_0x8f62a008_4;
                                                                                                }
                                                                                                // 0x8f62a05c
                                                                                                if (0x1000000 * str7 == 0x2e000000) {
                                                                                                    // 0x8f62a630
                                                                                                    g45 = v88;
                                                                                                    // branch -> 0x8f62a634
                                                                                                    // 0x8f62a634
                                                                                                    g46 = 0;
                                                                                                    v48 = v88;
                                                                                                    v34 = v2;
                                                                                                    v18 = v31;
                                                                                                    // branch -> 0x8f62a080
                                                                                                    goto lab_0x8f62a080_4;
                                                                                                } else {
                                                                                                    // if_8f62a064_0_true
                                                                                                    g45 = 0;
                                                                                                    // branch -> 0x8f62a0e0
                                                                                                    // 0x8f62a0e0
                                                                                                    v29 = v88;
                                                                                                    print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                    v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                    g47 = v97;
                                                                                                    if (v97 != 0) {
                                                                                                        // 0x8f62a104
                                                                                                        v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                        if (v98 == NULL) {
                                                                                                            // 0x8f62a118
                                                                                                            g44 = v88;
                                                                                                            print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                            fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                                            // branch -> 0x8f62a13c
                                                                                                            // 0x8f62a13c
                                                                                                            free((char *)g47);
                                                                                                            // branch -> 0x8f62a144
                                                                                                            goto lab_0x8f62a144_8;
                                                                                                        } else {
                                                                                                            // 0x8f62a070
                                                                                                            free((char *)g47);
                                                                                                            // branch -> 0x8f62a078
                                                                                                            // 0x8f62a078
                                                                                                            v111 = g45;
                                                                                                            v45 = v2;
                                                                                                            v17 = v31;
                                                                                                            if (v111 != 0) {
                                                                                                                v48 = v111;
                                                                                                                v34 = v2;
                                                                                                                v18 = v31;
                                                                                                                // 0x8f62a080
                                                                                                                v29 = v48;
                                                                                                                print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                                if (g46 == 0) {
                                                                                                                    goto lab_0x8f62a09c_14;
                                                                                                                }
                                                                                                                goto lab_0x8f62a574_14;
                                                                                                            }
                                                                                                            // 0x8f62a5d4
                                                                                                            v25 = &str6;
                                                                                                            g42 = v25;
                                                                                                            if (utag_parent_exists(1) == 0) {
                                                                                                                goto lab_if_8f62a5e4_0_true_15;
                                                                                                            }
                                                                                                            goto lab_0x8f62a5f0_15;
                                                                                                        }
                                                                                                      lab_0x8f62a288_10:
                                                                                                        // 0x8f62a288
                                                                                                        v11 = &str6;
                                                                                                        v8 = (int32_t)"failed to add utag [%s]";
                                                                                                        v39 = v2;
                                                                                                        v15 = v20;
                                                                                                        // branch -> 0x8f62a28c
                                                                                                        goto lab_0x8f62a28c_24;
                                                                                                    }
                                                                                                    // 0x8f62a078
                                                                                                    v111 = g45;
                                                                                                    if (v111 == 0) {
                                                                                                        v45 = v2;
                                                                                                        v17 = v31;
                                                                                                        // 0x8f62a5d4
                                                                                                        v25 = &str6;
                                                                                                        g42 = v25;
                                                                                                        if (utag_parent_exists(1) == 0) {
                                                                                                            goto lab_if_8f62a5e4_0_true_15;
                                                                                                        }
                                                                                                        goto lab_0x8f62a5f0_15;
                                                                                                    } else {
                                                                                                        v48 = v111;
                                                                                                        v34 = v2;
                                                                                                        v18 = v31;
                                                                                                    }
                                                                                                }
                                                                                              lab_0x8f62a080_6:
                                                                                                // 0x8f62a080
                                                                                                v29 = v48;
                                                                                                print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                if (g46 == 0) {
                                                                                                    goto lab_0x8f62a09c_14;
                                                                                                }
                                                                                                goto lab_0x8f62a574_14;
                                                                                            }
                                                                                        } else {
                                                                                            // 0x8f629fe0
                                                                                            g44 = v83;
                                                                                            print_log(2, (int32_t)"%s: utag name must not have empty name segments [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                            // branch -> 0x8f62a000
                                                                                            // 0x8f62a000
                                                                                            fboot_info((int32_t)"INFO", (int32_t)"bad utag name [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                            // branch -> 0x8f62a144
                                                                                            // 0x8f62a144
                                                                                            // branch -> 0x8f62a288
                                                                                            goto lab_0x8f62a288_10;
                                                                                        }
                                                                                    }
                                                                                    // 0x8f62a000
                                                                                    fboot_info((int32_t)"INFO", (int32_t)"utag name must not end with '/' [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                    v20 = v31;
                                                                                    // branch -> 0x8f62a144
                                                                                    // 0x8f62a144
                                                                                    // branch -> 0x8f62a288
                                                                                    goto lab_0x8f62a288_10;
                                                                                } else {
                                                                                    // 0x8f629f50
                                                                                    g44 = v83;
                                                                                    print_log(-1, (int32_t)"%s: name too long [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    // branch -> 0x8f62a000
                                                                                }
                                                                                // 0x8f62a000
                                                                                fboot_info((int32_t)"INFO", (int32_t)"utag name length must not exceed %d\n", 22, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                // branch -> 0x8f62a144
                                                                            }
                                                                            // 0x8f62a144
                                                                            // branch -> 0x8f62a288
                                                                            goto lab_0x8f62a288_10;
                                                                        } else {
                                                                            // 0x8f62a550
                                                                            v42 = v2;
                                                                            v22 = v31;
                                                                            // branch -> 0x8f62a554
                                                                            goto lab_0x8f62a554_30;
                                                                        }
                                                                      lab_0x8f62a144_9:
                                                                        // 0x8f62a144
                                                                        // branch -> 0x8f62a288
                                                                        goto lab_0x8f62a288_10;
                                                                        break;
                                                                    }
                                                                }
                                                                // 0x8f62a15c
                                                                if (__utag_exists(1, v83, v7, g44) == 0) {
                                                                    // if_8f62a16c_0_true
                                                                    // branch -> 0x8f62a288
                                                                } else {
                                                                    // 0x8f62a178
                                                                    v89 = &str7;
                                                                    strlcpy(v89, v83, 33, g44, v1);
                                                                    strlcat(v89, (int32_t)&g13, 33, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                    v99 = __utags_walk_existing(1, (int32_t)&g1, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0);
                                                                    if (v99 == -27) {
                                                                        // if_8f62a1ac_0_true
                                                                        // branch -> 0x8f62a288
                                                                        // 0x8f62a288
                                                                        v11 = v83;
                                                                        v8 = (int32_t)"can't delete [%s] it has children";
                                                                        v39 = v2;
                                                                        v15 = v31;
                                                                        // branch -> 0x8f62a28c
                                                                        goto lab_0x8f62a28c_24;
                                                                    } else {
                                                                        // 0x8f62a1b8
                                                                        v100 = __utag_delete(1, v83, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7);
                                                                        if (v100 == 0) {
                                                                            // 0x8f62a1cc
                                                                            v101 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                                            if (v101 == 0) {
                                                                                // 0x8f62a1ec
                                                                                v102 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                                                if (v102 == 0) {
                                                                                    // 0x8f62a1fc
                                                                                    // branch -> 0x8f62a234
                                                                                    // 0x8f62a234
                                                                                    v10 = &str6;
                                                                                    v82 = (int32_t)"deleted utag [%s]";
                                                                                    v37 = v2;
                                                                                    v12 = v31;
                                                                                    // branch -> 0x8f62a274
                                                                                    goto lab_0x8f62a274_2;
                                                                                }
                                                                            }
                                                                        } else {
                                                                            // 0x8f62a1e0
                                                                            // branch -> 0x8f62a288
                                                                            // 0x8f62a288
                                                                            v11 = v83;
                                                                            v8 = (int32_t)"failed to delete [%s]";
                                                                            v39 = v2;
                                                                            v15 = v31;
                                                                            // branch -> 0x8f62a28c
                                                                            goto lab_0x8f62a28c_24;
                                                                        }
                                                                        // 0x8f62a550
                                                                        v42 = v2;
                                                                        v22 = v31;
                                                                        // branch -> 0x8f62a554
                                                                        goto lab_0x8f62a554_30;
                                                                    }
                                                                  lab_0x8f62a550_5:
                                                                    // 0x8f62a550
                                                                    v42 = v35;
                                                                    v22 = v14;
                                                                    // branch -> 0x8f62a554
                                                                    goto lab_0x8f62a554_30;
                                                                }
                                                                // 0x8f62a288
                                                                v11 = v83;
                                                                v8 = (int32_t)"can't delete [%s] it does not exist";
                                                                v39 = v2;
                                                                v15 = v31;
                                                                // branch -> 0x8f62a28c
                                                                goto lab_0x8f62a28c_24;
                                                            } else {
                                                                // 0x8f629cdc
                                                                if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                                    // 0x8f629ce8
                                                                    if (__utag_exists(1, v83, v7, g44) == 0) {
                                                                        // 0x8f629eac
                                                                        // branch -> 0x8f629eb4
                                                                        // 0x8f629eb4
                                                                        fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                        // branch -> 0x8f62a550
                                                                    } else {
                                                                        // 0x8f629cfc
                                                                        print_log(2, (int32_t)"%s: writing value to [%s]", (int32_t)"oem_utags_ext", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                        v84 = &str7;
                                                                        v118 = g45 + 8;
                                                                        g45 = v118;
                                                                        strlcpy(v84, *(int32_t *)v118, 128, v83, v1);
                                                                        v112 = v5 - 2;
                                                                        if (v112 > 1) {
                                                                            strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                            v119 = g45 + 4;
                                                                            g45 = v119;
                                                                            v122 = *(int32_t *)v119;
                                                                            strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                            v121 = 2;
                                                                            while (v121 < v112) {
                                                                                // 0x8f629d30
                                                                                strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                                v119 = g45 + 4;
                                                                                g45 = v119;
                                                                                v122 = *(int32_t *)v119;
                                                                                strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                                v121++;
                                                                                // continue -> 0x8f629d30
                                                                            }
                                                                            // 0x8f629d58
                                                                            v103 = 0x1000000 * str7;
                                                                            v127 = v103 / 0x1000000;
                                                                            g44 = v127;
                                                                            if (v103 == 0x2b000000) {
                                                                                // 0x8f629d6c
                                                                                v93 = __utag_sizeof((char *)1, v83, 128, 43, v1, 0, v32, v31, str6);
                                                                                size = strlen((char *)&str7) + v93 + 1;
                                                                                result2 = size;
                                                                                if (size == 0) {
                                                                                    // if_8f629d8c_0_true
                                                                                    // branch -> 0x8f629de0
                                                                                    // 0x8f629de0
                                                                                    print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    v41 = v2;
                                                                                    v23 = v31;
                                                                                    // branch -> 0x8f62a550
                                                                                } else {
                                                                                    // 0x8f629d98
                                                                                    mem = malloc(size);
                                                                                    v85 = (int32_t)mem;
                                                                                    g45 = v85;
                                                                                    if (mem == NULL) {
                                                                                        // 0x8f629da8
                                                                                        print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                        // branch -> 0x8f62a550
                                                                                    } else {
                                                                                        // 0x8f629dbc
                                                                                        v113 = result2;
                                                                                        g44 = v113;
                                                                                        v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                                        if (v94 == 0) {
                                                                                            // 0x8f629dd8
                                                                                            // branch -> 0x8f629de0
                                                                                            // 0x8f629de0
                                                                                            print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                            // branch -> 0x8f62a550
                                                                                        } else {
                                                                                            // 0x8f629df0
                                                                                            v114 = result2;
                                                                                            v115 = g45;
                                                                                            result2 = v115;
                                                                                            strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                                            // branch -> 0x8f629e04
                                                                                            // 0x8f629e04
                                                                                            v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                                            if (v95 == 0) {
                                                                                                // 0x8f629e30
                                                                                                v116 = g45;
                                                                                                v7 = v116;
                                                                                                v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                                v86 = (int32_t)v96;
                                                                                                v109 = result2;
                                                                                                g45 = v86;
                                                                                                v110 = v86;
                                                                                                if (v109 != 0) {
                                                                                                    // 0x8f629e4c
                                                                                                    free((char *)v109);
                                                                                                    v110 = g45;
                                                                                                    // branch -> 0x8f629e54
                                                                                                }
                                                                                                // 0x8f629e54
                                                                                                if (v110 != 0) {
                                                                                                    v35 = v2;
                                                                                                    v14 = v31;
                                                                                                    // 0x8f62a0cc
                                                                                                    if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                                        goto lab_0x8f62a0cc_16;
                                                                                                    }
                                                                                                    goto lab_0x8f62a550_5;
                                                                                                }
                                                                                            } else {
                                                                                                // 0x8f629e1c
                                                                                                v108 = result2;
                                                                                                if (v108 != 0) {
                                                                                                    // 0x8f629e24
                                                                                                    free((char *)v108);
                                                                                                    // branch -> 0x8f62a550
                                                                                                }
                                                                                            }
                                                                                            // 0x8f62a550
                                                                                            v42 = v2;
                                                                                            v22 = v31;
                                                                                            // branch -> 0x8f62a554
                                                                                            goto lab_0x8f62a554_30;
                                                                                        }
                                                                                        // 0x8f62a550
                                                                                        v42 = v2;
                                                                                        v22 = v31;
                                                                                        // branch -> 0x8f62a554
                                                                                        goto lab_0x8f62a554_30;
                                                                                    }
                                                                                    // 0x8f62a550
                                                                                    v42 = v2;
                                                                                    v22 = v31;
                                                                                    // branch -> 0x8f62a554
                                                                                    goto lab_0x8f62a554_30;
                                                                                }
                                                                              lab_0x8f62a550_6:
                                                                                // 0x8f62a550
                                                                                v42 = v41;
                                                                                v22 = v23;
                                                                                // branch -> 0x8f62a554
                                                                                goto lab_0x8f62a554_30;
                                                                            } else {
                                                                                // if_8f629d60_0_true
                                                                                g45 = v84;
                                                                                result2 = 0;
                                                                                // branch -> 0x8f629e04
                                                                                // 0x8f629e04
                                                                                v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                                if (v95 == 0) {
                                                                                    // 0x8f629e30
                                                                                    v116 = g45;
                                                                                    v7 = v116;
                                                                                    v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                    v86 = (int32_t)v96;
                                                                                    v109 = result2;
                                                                                    g45 = v86;
                                                                                    v110 = v86;
                                                                                    if (v109 != 0) {
                                                                                        // 0x8f629e4c
                                                                                        free((char *)v109);
                                                                                        v110 = g45;
                                                                                        // branch -> 0x8f629e54
                                                                                    }
                                                                                    // 0x8f629e54
                                                                                    if (v110 != 0) {
                                                                                        v35 = v2;
                                                                                        v14 = v31;
                                                                                        // 0x8f62a0cc
                                                                                        if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                            goto lab_0x8f62a0cc_16;
                                                                                        }
                                                                                        v41 = v35;
                                                                                        v23 = v14;
                                                                                        goto lab_0x8f62a550_6;
                                                                                    }
                                                                                } else {
                                                                                    // 0x8f629e1c
                                                                                    v108 = result2;
                                                                                    if (v108 != 0) {
                                                                                        // 0x8f629e24
                                                                                        free((char *)v108);
                                                                                        // branch -> 0x8f62a550
                                                                                    }
                                                                                }
                                                                                // 0x8f62a550
                                                                                v42 = v2;
                                                                                v22 = v31;
                                                                                // branch -> 0x8f62a554
                                                                                goto lab_0x8f62a554_30;
                                                                            }
                                                                          lab_0x8f62a550_7:
                                                                            // 0x8f62a550
                                                                            v42 = v35;
                                                                            v22 = v14;
                                                                            // branch -> 0x8f62a554
                                                                            goto lab_0x8f62a554_30;
                                                                        }
                                                                        // 0x8f629d58
                                                                        v103 = 0x1000000 * str7;
                                                                        v127 = v103 / 0x1000000;
                                                                        g44 = v127;
                                                                        if (v103 == 0x2b000000) {
                                                                            // 0x8f629d6c
                                                                            v93 = __utag_sizeof((char *)1, v83, 128, 43, v1, 0, v32, v31, str6);
                                                                            size = strlen((char *)&str7) + v93 + 1;
                                                                            result2 = size;
                                                                            if (size == 0) {
                                                                                // if_8f629d8c_0_true
                                                                                // branch -> 0x8f629de0
                                                                                // 0x8f629de0
                                                                                print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                v41 = v2;
                                                                                v23 = v31;
                                                                                // branch -> 0x8f62a550
                                                                            } else {
                                                                                // 0x8f629d98
                                                                                mem = malloc(size);
                                                                                v85 = (int32_t)mem;
                                                                                g45 = v85;
                                                                                if (mem == NULL) {
                                                                                    // 0x8f629da8
                                                                                    print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    // branch -> 0x8f62a550
                                                                                } else {
                                                                                    // 0x8f629dbc
                                                                                    v113 = result2;
                                                                                    g44 = v113;
                                                                                    v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                                    if (v94 == 0) {
                                                                                        // 0x8f629dd8
                                                                                        // branch -> 0x8f629de0
                                                                                        // 0x8f629de0
                                                                                        print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                        // branch -> 0x8f62a550
                                                                                    } else {
                                                                                        // 0x8f629df0
                                                                                        v114 = result2;
                                                                                        v115 = g45;
                                                                                        result2 = v115;
                                                                                        strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                                        // branch -> 0x8f629e04
                                                                                        // 0x8f629e04
                                                                                        v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                                        if (v95 == 0) {
                                                                                            // 0x8f629e30
                                                                                            v116 = g45;
                                                                                            v7 = v116;
                                                                                            v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                            v86 = (int32_t)v96;
                                                                                            v109 = result2;
                                                                                            g45 = v86;
                                                                                            v110 = v86;
                                                                                            if (v109 != 0) {
                                                                                                // 0x8f629e4c
                                                                                                free((char *)v109);
                                                                                                v110 = g45;
                                                                                                // branch -> 0x8f629e54
                                                                                            }
                                                                                            // 0x8f629e54
                                                                                            if (v110 != 0) {
                                                                                                v35 = v2;
                                                                                                v14 = v31;
                                                                                                // 0x8f62a0cc
                                                                                                if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                                    goto lab_0x8f62a0cc_16;
                                                                                                }
                                                                                                goto lab_0x8f62a550_7;
                                                                                            }
                                                                                        } else {
                                                                                            // 0x8f629e1c
                                                                                            v108 = result2;
                                                                                            if (v108 != 0) {
                                                                                                // 0x8f629e24
                                                                                                free((char *)v108);
                                                                                                // branch -> 0x8f62a550
                                                                                            }
                                                                                        }
                                                                                        // 0x8f62a550
                                                                                        v42 = v2;
                                                                                        v22 = v31;
                                                                                        // branch -> 0x8f62a554
                                                                                        goto lab_0x8f62a554_30;
                                                                                    }
                                                                                    // 0x8f62a550
                                                                                    v42 = v2;
                                                                                    v22 = v31;
                                                                                    // branch -> 0x8f62a554
                                                                                    goto lab_0x8f62a554_30;
                                                                                }
                                                                                // 0x8f62a550
                                                                                v42 = v2;
                                                                                v22 = v31;
                                                                                // branch -> 0x8f62a554
                                                                                goto lab_0x8f62a554_30;
                                                                            }
                                                                          lab_0x8f62a550_8:
                                                                            // 0x8f62a550
                                                                            v42 = v41;
                                                                            v22 = v23;
                                                                            // branch -> 0x8f62a554
                                                                            goto lab_0x8f62a554_30;
                                                                        } else {
                                                                            // if_8f629d60_0_true
                                                                            g45 = v84;
                                                                            result2 = 0;
                                                                            // branch -> 0x8f629e04
                                                                            // 0x8f629e04
                                                                            v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                            if (v95 == 0) {
                                                                                // 0x8f629e30
                                                                                v116 = g45;
                                                                                v7 = v116;
                                                                                v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                v86 = (int32_t)v96;
                                                                                v109 = result2;
                                                                                g45 = v86;
                                                                                v110 = v86;
                                                                                if (v109 != 0) {
                                                                                    // 0x8f629e4c
                                                                                    free((char *)v109);
                                                                                    v110 = g45;
                                                                                    // branch -> 0x8f629e54
                                                                                }
                                                                                // 0x8f629e54
                                                                                if (v110 != 0) {
                                                                                    v35 = v2;
                                                                                    v14 = v31;
                                                                                    // 0x8f62a0cc
                                                                                    if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                        goto lab_0x8f62a0cc_16;
                                                                                    }
                                                                                    v41 = v35;
                                                                                    v23 = v14;
                                                                                    goto lab_0x8f62a550_8;
                                                                                } else {
                                                                                    v41 = v2;
                                                                                    v23 = v31;
                                                                                }
                                                                            } else {
                                                                                // 0x8f629e1c
                                                                                v108 = result2;
                                                                                if (v108 != 0) {
                                                                                    // 0x8f629e24
                                                                                    free((char *)v108);
                                                                                    v41 = v2;
                                                                                    v23 = v31;
                                                                                    // branch -> 0x8f62a550
                                                                                } else {
                                                                                    v41 = v2;
                                                                                    v23 = v31;
                                                                                }
                                                                            }
                                                                          lab_0x8f62a550_21:
                                                                            // 0x8f62a550
                                                                            v42 = v41;
                                                                            v22 = v23;
                                                                            // branch -> 0x8f62a554
                                                                            goto lab_0x8f62a554_30;
                                                                        }
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                        }
                                                    }
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            } else {
                                                v81 = v90;
                                                v107 = 2;
                                            }
                                        }
                                        // 0x8f629c60
                                        g47 = v107 > 1;
                                        v106 = v80;
                                        if (v106 != 0) {
                                            // after_if_8f629c70_0
                                            if (v107 != 1 && !((v107 < 1 ^ (v107 & -v107) < 0))) {
                                                // 0x8f629c78
                                                // branch -> 0x8f629eb4
                                                // 0x8f629eb4
                                                fboot_info((int32_t)"INFO", (int32_t)"syntax error - operator present", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                // branch -> 0x8f62a550
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                        }
                                        // 0x8f629cd4
                                        if (v107 <= 1) {
                                            // 0x8f629e60
                                            switch (v106) {
                                                default: {
                                                    // 0x8f629e78
                                                    len = strlen((char *)&str6);
                                                    v87 = (char *)((int32_t)&v3 - 1 + len - 168);
                                                    v123 = *v87;
                                                    v128 = v123;
                                                    g44 = v128;
                                                    if (v123 == 47) {
                                                        // 0x8f62a294
                                                        *v87 = (char)g47;
                                                        if (__utag_exists(1, v83, v7, g44) != 0) {
                                                            // 0x8f62a2b0
                                                            v71 = list_existing_utags_constprop_34(v83, v83, v7, g44, v1, 0, v32, v31);
                                                            result = v71;
                                                            v42 = v2;
                                                            v22 = v31;
                                                            // branch -> 0x8f62a554
                                                          lab_0x8f62a554_31:
                                                            // 0x8f62a554
                                                            v43 = g32;
                                                            g44 = v43;
                                                            if (v6 != v43) {
                                                                goto lab_0x8f62a564_24;
                                                            }
                                                            // 0x8f62a63c
                                                            g45 = v3;
                                                            g47 = v4;
                                                            return result;
                                                        }
                                                    } else {
                                                        // 0x8f629e98
                                                        if (__utag_exists(1, v83, v7, v128) != 0) {
                                                            v40 = v2;
                                                            v13 = v31;
                                                            // 0x8f62a540
                                                            v27 = list_str_utag_short(1, v83, v7, g44, (int32_t)v40, 0, v32, v13, str6, 0, 0, 0);
                                                            result = v27;
                                                            v42 = v40;
                                                            v22 = v13;
                                                            // branch -> 0x8f62a554
                                                            goto lab_0x8f62a554_31;
                                                        }
                                                    }
                                                    // 0x8f629eac
                                                    // branch -> 0x8f629eb4
                                                    // 0x8f629eb4
                                                    fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                    // branch -> 0x8f62a550
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                    break;
                                                }
                                                case 45: {
                                                    // 0x8f62a150
                                                    if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) != 0) {
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                    break;
                                                }
                                                case 64: {
                                                    // 0x8f62a208
                                                    if (strncmp((char *)&str6, g13, 2) != 0) {
                                                        // 0x8f62a23c
                                                        if (__utag_exists(1, v83, 2, g44) == 0) {
                                                            // 0x8f62a250
                                                            if (strlen((char *)&str6) == 0) {
                                                                // 0x8f62a260
                                                                v10 = get_current_path(1, v83, 2, g44);
                                                                v82 = (int32_t)"current path set to [%s]";
                                                                v37 = v2;
                                                                v12 = v31;
                                                                // branch -> 0x8f62a274
                                                              lab_0x8f62a274_4:
                                                                // 0x8f62a274
                                                                fboot_info((int32_t)"INFO", v82, v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                                                v75 = v37;
                                                                v74 = v12;
                                                                // branch -> 0x8f62a278
                                                                goto lab_0x8f62a278_6;
                                                            } else {
                                                                // 0x8f62a280
                                                                v24 = v83;
                                                                v9 = (int32_t)"path validation failed for [%s]";
                                                                // branch -> 0x8f62a288
                                                              lab_0x8f62a288_11:
                                                                // 0x8f62a288
                                                                v11 = v24;
                                                                v8 = v9;
                                                                v39 = v2;
                                                                v15 = v31;
                                                                // branch -> 0x8f62a28c
                                                                goto lab_0x8f62a28c_24;
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62a220
                                                    set_current_path(1, v83, 2, g44, v1, 0, v32, v31, str6, 0, 0);
                                                    // branch -> 0x8f62a234
                                                    // 0x8f62a234
                                                    v10 = &str6;
                                                    v82 = (int32_t)"current path set to [%s]";
                                                    v37 = v2;
                                                    v12 = v31;
                                                    // branch -> 0x8f62a274
                                                    goto lab_0x8f62a274_4;
                                                }
                                                case 43: {
                                                    // 0x8f629ebc
                                                    if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                        // 0x8f629ec8
                                                        if (strlen((char *)&str6) == 0) {
                                                            // if_8f629ed8_0_true
                                                            v33 = v83;
                                                            // branch -> 0x8f62a0c4
                                                            // 0x8f62a0c4
                                                            g44 = v33;
                                                            print_log(-1, (int32_t)"%s: empty utag name\n", (int32_t)"validate_hw_utag_name_full", v33, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                            v20 = v31;
                                                            // branch -> 0x8f62a144
                                                            goto lab_0x8f62a144_9;
                                                        } else {
                                                            // if_8f629ed4_0_true
                                                            g45 = (int32_t)&g12 + 1;
                                                            c3 = *(char *)((int32_t)&g12 + 1);
                                                            if (c3 != 0) {
                                                                while (true) {
                                                                    // 0x8f629ef8
                                                                    if (strchr((char *)&str6, (int32_t)c3) == NULL) {
                                                                        goto lab_0x8f629ef8_3;
                                                                    }
                                                                    // 0x8f629f08
                                                                    g44 = v83;
                                                                    print_log(-1, (int32_t)"%s: utag name includes special characters\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    fboot_info((int32_t)"INFO", (int32_t)"utag name includes special character", (int32_t)"validate_hw_utag_name_full", g44, v1, 0, v32, v31, str6, 0, 0);
                                                                    // branch -> 0x8f62a144
                                                                  lab_0x8f62a144_10:
                                                                    // 0x8f62a144
                                                                    v24 = &str6;
                                                                    v9 = (int32_t)"failed to add utag [%s]";
                                                                    // branch -> 0x8f62a288
                                                                    goto lab_0x8f62a288_11;
                                                                }
                                                            }
                                                            // 0x8f629f2c
                                                            v88 = &str7;
                                                            g46 = v88;
                                                            utag_canonical_name_constprop_28(v83, v88, v7, g44, v1, 0, v32, v31);
                                                            if (strlen((char *)&str7) < 23) {
                                                                // 0x8f629f74
                                                                len2 = strlen((char *)&str6);
                                                                v124 = *(char *)(len2 + (int32_t)&v3 - 169);
                                                                if (v124 == 47) {
                                                                    // 0x8f629f90
                                                                    g44 = v83;
                                                                    print_log(2, (int32_t)"%s: utag name must not end with '/'[%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    // branch -> 0x8f62a000
                                                                } else {
                                                                    // 0x8f629fb0
                                                                    if (strstr((char *)&str6, "//") == NULL) {
                                                                        // 0x8f629fc4
                                                                        utag_canonical_name_constprop_28(v83, v88, v7, (int32_t)v124, v1, 0, v32, v31);
                                                                        len3 = strlen((char *)&str7);
                                                                        v125 = g46;
                                                                        v117 = v125 + len3;
                                                                        // branch -> 0x8f62a018
                                                                        while (true) {
                                                                            // 0x8f62a018
                                                                            if (v117 < v125) {
                                                                                goto lab_0x8f62a008_4;
                                                                            }
                                                                            // 0x8f62a05c
                                                                            if (0x1000000 * str7 == 0x2e000000) {
                                                                                // 0x8f62a630
                                                                                g45 = v88;
                                                                                // branch -> 0x8f62a634
                                                                                // 0x8f62a634
                                                                                g46 = 0;
                                                                                v48 = v88;
                                                                                v34 = v2;
                                                                                v18 = v31;
                                                                                // branch -> 0x8f62a080
                                                                                goto lab_0x8f62a080_6;
                                                                            } else {
                                                                                // if_8f62a064_0_true
                                                                                g45 = 0;
                                                                                // branch -> 0x8f62a0e0
                                                                                // 0x8f62a0e0
                                                                                v29 = v88;
                                                                                print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                g47 = v97;
                                                                                if (v97 != 0) {
                                                                                    // 0x8f62a104
                                                                                    v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                    if (v98 == NULL) {
                                                                                        // 0x8f62a118
                                                                                        g44 = v88;
                                                                                        print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                        fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                        // branch -> 0x8f62a13c
                                                                                        // 0x8f62a13c
                                                                                        free((char *)g47);
                                                                                        // branch -> 0x8f62a144
                                                                                        goto lab_0x8f62a144_10;
                                                                                    } else {
                                                                                        // 0x8f62a070
                                                                                        free((char *)g47);
                                                                                        // branch -> 0x8f62a078
                                                                                        // 0x8f62a078
                                                                                        v111 = g45;
                                                                                        v45 = v2;
                                                                                        v17 = v31;
                                                                                        if (v111 != 0) {
                                                                                            v48 = v111;
                                                                                            v34 = v2;
                                                                                            v18 = v31;
                                                                                            // 0x8f62a080
                                                                                            v29 = v48;
                                                                                            print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                            if (g46 == 0) {
                                                                                                goto lab_0x8f62a09c_14;
                                                                                            }
                                                                                            goto lab_0x8f62a574_14;
                                                                                        }
                                                                                        // 0x8f62a5d4
                                                                                        v25 = &str6;
                                                                                        g42 = v25;
                                                                                        if (utag_parent_exists(1) == 0) {
                                                                                            goto lab_if_8f62a5e4_0_true_15;
                                                                                        }
                                                                                        goto lab_0x8f62a5f0_15;
                                                                                    }
                                                                                  lab_0x8f62a288_15:
                                                                                    // 0x8f62a288
                                                                                    v11 = &str6;
                                                                                    v8 = (int32_t)"failed to add utag [%s]";
                                                                                    v39 = v38;
                                                                                    v15 = v20;
                                                                                    // branch -> 0x8f62a28c
                                                                                    goto lab_0x8f62a28c_24;
                                                                                }
                                                                                // 0x8f62a078
                                                                                v111 = g45;
                                                                                if (v111 == 0) {
                                                                                    v45 = v2;
                                                                                    v17 = v31;
                                                                                    // 0x8f62a5d4
                                                                                    v25 = &str6;
                                                                                    g42 = v25;
                                                                                    if (utag_parent_exists(1) == 0) {
                                                                                        goto lab_if_8f62a5e4_0_true_15;
                                                                                    }
                                                                                    goto lab_0x8f62a5f0_15;
                                                                                } else {
                                                                                    v48 = v111;
                                                                                    v34 = v2;
                                                                                    v18 = v31;
                                                                                }
                                                                            }
                                                                          lab_0x8f62a080_8:
                                                                            // 0x8f62a080
                                                                            v29 = v48;
                                                                            print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                            if (g46 == 0) {
                                                                                goto lab_0x8f62a09c_14;
                                                                            }
                                                                            goto lab_0x8f62a574_14;
                                                                        }
                                                                    } else {
                                                                        // 0x8f629fe0
                                                                        g44 = v83;
                                                                        print_log(2, (int32_t)"%s: utag name must not have empty name segments [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                        // branch -> 0x8f62a000
                                                                        // 0x8f62a000
                                                                        fboot_info((int32_t)"INFO", (int32_t)"bad utag name [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                        // branch -> 0x8f62a144
                                                                        // 0x8f62a144
                                                                        v38 = v2;
                                                                        // branch -> 0x8f62a288
                                                                        goto lab_0x8f62a288_15;
                                                                    }
                                                                }
                                                                // 0x8f62a000
                                                                fboot_info((int32_t)"INFO", (int32_t)"utag name must not end with '/' [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                v20 = v31;
                                                                // branch -> 0x8f62a144
                                                                // 0x8f62a144
                                                                v38 = v2;
                                                                // branch -> 0x8f62a288
                                                                goto lab_0x8f62a288_15;
                                                            } else {
                                                                // 0x8f629f50
                                                                g44 = v83;
                                                                print_log(-1, (int32_t)"%s: name too long [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                // branch -> 0x8f62a000
                                                            }
                                                            // 0x8f62a000
                                                            fboot_info((int32_t)"INFO", (int32_t)"utag name length must not exceed %d\n", 22, g44, v1, 0, v32, v31, str6, 0, 0);
                                                            // branch -> 0x8f62a144
                                                        }
                                                        // 0x8f62a144
                                                        v38 = v2;
                                                        // branch -> 0x8f62a288
                                                        goto lab_0x8f62a288_15;
                                                    }
                                                  lab_0x8f62a144_11:
                                                    // 0x8f62a144
                                                    v38 = v36;
                                                    // branch -> 0x8f62a288
                                                    goto lab_0x8f62a288_15;
                                                    break;
                                                }
                                            }
                                            // 0x8f62a15c
                                            if (__utag_exists(1, v83, v7, g44) == 0) {
                                                // if_8f62a16c_0_true
                                                v24 = v83;
                                                v38 = v2;
                                                v16 = v31;
                                                v9 = (int32_t)"can't delete [%s] it does not exist";
                                                // branch -> 0x8f62a288
                                            } else {
                                                // 0x8f62a178
                                                v89 = &str7;
                                                strlcpy(v89, v83, 33, g44, v1);
                                                strlcat(v89, (int32_t)&g13, 33, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                v99 = __utags_walk_existing(1, (int32_t)&g1, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0);
                                                if (v99 == -27) {
                                                    // if_8f62a1ac_0_true
                                                    // branch -> 0x8f62a288
                                                    // 0x8f62a288
                                                    v11 = v83;
                                                    v8 = (int32_t)"can't delete [%s] it has children";
                                                    v39 = v2;
                                                    v15 = v31;
                                                    // branch -> 0x8f62a28c
                                                    goto lab_0x8f62a28c_24;
                                                } else {
                                                    // 0x8f62a1b8
                                                    v100 = __utag_delete(1, v83, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7);
                                                    if (v100 == 0) {
                                                        // 0x8f62a1cc
                                                        v101 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                        if (v101 == 0) {
                                                            // 0x8f62a1ec
                                                            v102 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                            if (v102 == 0) {
                                                                // 0x8f62a1fc
                                                                // branch -> 0x8f62a234
                                                                // 0x8f62a234
                                                                v10 = &str6;
                                                                v82 = (int32_t)"deleted utag [%s]";
                                                                v37 = v2;
                                                                v12 = v31;
                                                                // branch -> 0x8f62a274
                                                                goto lab_0x8f62a274_4;
                                                            }
                                                        }
                                                    } else {
                                                        // 0x8f62a1e0
                                                        // branch -> 0x8f62a288
                                                        // 0x8f62a288
                                                        v11 = v83;
                                                        v8 = (int32_t)"failed to delete [%s]";
                                                        v39 = v2;
                                                        v15 = v31;
                                                        // branch -> 0x8f62a28c
                                                        goto lab_0x8f62a28c_24;
                                                    }
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                            // 0x8f62a288
                                            v11 = v24;
                                            v8 = v9;
                                            v39 = v38;
                                            v15 = v16;
                                            // branch -> 0x8f62a28c
                                            goto lab_0x8f62a28c_24;
                                        } else {
                                            // 0x8f629cdc
                                            if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                // 0x8f629ce8
                                                if (__utag_exists(1, v83, v7, g44) == 0) {
                                                    // 0x8f629eac
                                                    // branch -> 0x8f629eb4
                                                    // 0x8f629eb4
                                                    fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                    // branch -> 0x8f62a550
                                                } else {
                                                    // 0x8f629cfc
                                                    print_log(2, (int32_t)"%s: writing value to [%s]", (int32_t)"oem_utags_ext", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                    v84 = &str7;
                                                    v118 = g45 + 8;
                                                    g45 = v118;
                                                    v7 = 128;
                                                    strlcpy(v84, *(int32_t *)v118, 128, v83, v1);
                                                    v112 = v5 - 2;
                                                    v5 = v112;
                                                    if (v112 > 1) {
                                                        strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                        v119 = g45 + 4;
                                                        g45 = v119;
                                                        v122 = *(int32_t *)v119;
                                                        v7 = 128;
                                                        strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                        v121 = 2;
                                                        while (v121 < v5) {
                                                            // 0x8f629d30
                                                            strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                            v119 = g45 + 4;
                                                            g45 = v119;
                                                            v122 = *(int32_t *)v119;
                                                            v7 = 128;
                                                            strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                            v121++;
                                                            // continue -> 0x8f629d30
                                                        }
                                                        // 0x8f629d58
                                                        v103 = 0x1000000 * str7;
                                                        v127 = v103 / 0x1000000;
                                                        g44 = v127;
                                                        if (v103 == 0x2b000000) {
                                                            // 0x8f629d6c
                                                            v93 = __utag_sizeof((char *)1, v83, v7, 43, v1, 0, v32, v31, str6);
                                                            size = strlen((char *)&str7) + v93 + 1;
                                                            result2 = size;
                                                            if (size == 0) {
                                                                // if_8f629d8c_0_true
                                                                // branch -> 0x8f629de0
                                                                // 0x8f629de0
                                                                print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                // branch -> 0x8f62a550
                                                            } else {
                                                                // 0x8f629d98
                                                                mem = malloc(size);
                                                                v85 = (int32_t)mem;
                                                                g45 = v85;
                                                                if (mem == NULL) {
                                                                    // 0x8f629da8
                                                                    print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    // branch -> 0x8f62a550
                                                                } else {
                                                                    // 0x8f629dbc
                                                                    v113 = result2;
                                                                    g44 = v113;
                                                                    v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                    if (v94 == 0) {
                                                                        // 0x8f629dd8
                                                                        // branch -> 0x8f629de0
                                                                        // 0x8f629de0
                                                                        print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                        // branch -> 0x8f62a550
                                                                    } else {
                                                                        // 0x8f629df0
                                                                        v114 = result2;
                                                                        v115 = g45;
                                                                        result2 = v115;
                                                                        strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                        // branch -> 0x8f629e04
                                                                        // 0x8f629e04
                                                                        v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                        if (v95 == 0) {
                                                                            // 0x8f629e30
                                                                            v116 = g45;
                                                                            v7 = v116;
                                                                            v28 = v83;
                                                                            v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                            v86 = (int32_t)v96;
                                                                            v109 = result2;
                                                                            g45 = v86;
                                                                            v110 = v86;
                                                                            if (v109 != 0) {
                                                                                // 0x8f629e4c
                                                                                free((char *)v109);
                                                                                v110 = g45;
                                                                                // branch -> 0x8f629e54
                                                                            }
                                                                            // 0x8f629e54
                                                                            if (v110 != 0) {
                                                                                v35 = v2;
                                                                                v14 = v31;
                                                                                // 0x8f62a0cc
                                                                                if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                    goto lab_0x8f62a0cc_16;
                                                                                }
                                                                                v41 = v35;
                                                                                v23 = v14;
                                                                                goto lab_0x8f62a550_21;
                                                                            }
                                                                        } else {
                                                                            // 0x8f629e1c
                                                                            v108 = result2;
                                                                            if (v108 != 0) {
                                                                                // 0x8f629e24
                                                                                free((char *)v108);
                                                                                // branch -> 0x8f62a550
                                                                            }
                                                                        }
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        } else {
                                                            // if_8f629d60_0_true
                                                            g45 = v84;
                                                            result2 = 0;
                                                            // branch -> 0x8f629e04
                                                            // 0x8f629e04
                                                            v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                            if (v95 == 0) {
                                                                // 0x8f629e30
                                                                v116 = g45;
                                                                v7 = v116;
                                                                v28 = v83;
                                                                v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                v86 = (int32_t)v96;
                                                                v109 = result2;
                                                                g45 = v86;
                                                                v110 = v86;
                                                                if (v109 != 0) {
                                                                    // 0x8f629e4c
                                                                    free((char *)v109);
                                                                    v110 = g45;
                                                                    // branch -> 0x8f629e54
                                                                }
                                                                // 0x8f629e54
                                                                if (v110 != 0) {
                                                                    v35 = v2;
                                                                    v14 = v31;
                                                                    // 0x8f62a0cc
                                                                    if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                        goto lab_0x8f62a0cc_16;
                                                                    }
                                                                    v41 = v35;
                                                                    v23 = v14;
                                                                    goto lab_0x8f62a550_21;
                                                                }
                                                            } else {
                                                                // 0x8f629e1c
                                                                v108 = result2;
                                                                if (v108 != 0) {
                                                                    // 0x8f629e24
                                                                    free((char *)v108);
                                                                    // branch -> 0x8f62a550
                                                                }
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                    // 0x8f629d58
                                                    v103 = 0x1000000 * str7;
                                                    v127 = v103 / 0x1000000;
                                                    g44 = v127;
                                                    if (v103 == 0x2b000000) {
                                                        // 0x8f629d6c
                                                        v93 = __utag_sizeof((char *)1, v83, v7, 43, v1, 0, v32, v31, str6);
                                                        size = strlen((char *)&str7) + v93 + 1;
                                                        result2 = size;
                                                        if (size == 0) {
                                                            // if_8f629d8c_0_true
                                                            // branch -> 0x8f629de0
                                                            // 0x8f629de0
                                                            print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                            // branch -> 0x8f62a550
                                                        } else {
                                                            // 0x8f629d98
                                                            mem = malloc(size);
                                                            v85 = (int32_t)mem;
                                                            g45 = v85;
                                                            if (mem == NULL) {
                                                                // 0x8f629da8
                                                                print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                // branch -> 0x8f62a550
                                                            } else {
                                                                // 0x8f629dbc
                                                                v113 = result2;
                                                                g44 = v113;
                                                                v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                if (v94 == 0) {
                                                                    // 0x8f629dd8
                                                                    // branch -> 0x8f629de0
                                                                    // 0x8f629de0
                                                                    print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    // branch -> 0x8f62a550
                                                                } else {
                                                                    // 0x8f629df0
                                                                    v114 = result2;
                                                                    v115 = g45;
                                                                    result2 = v115;
                                                                    strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                    // branch -> 0x8f629e04
                                                                    // 0x8f629e04
                                                                    v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                    if (v95 == 0) {
                                                                        // 0x8f629e30
                                                                        v116 = g45;
                                                                        v7 = v116;
                                                                        v28 = v83;
                                                                        v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                        v86 = (int32_t)v96;
                                                                        v109 = result2;
                                                                        g45 = v86;
                                                                        v110 = v86;
                                                                        if (v109 != 0) {
                                                                            // 0x8f629e4c
                                                                            free((char *)v109);
                                                                            v110 = g45;
                                                                            // branch -> 0x8f629e54
                                                                        }
                                                                        // 0x8f629e54
                                                                        if (v110 != 0) {
                                                                            v35 = v2;
                                                                            v14 = v31;
                                                                            // 0x8f62a0cc
                                                                            if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                goto lab_0x8f62a0cc_16;
                                                                            }
                                                                            v41 = v35;
                                                                            v23 = v14;
                                                                            goto lab_0x8f62a550_21;
                                                                        }
                                                                    } else {
                                                                        // 0x8f629e1c
                                                                        v108 = result2;
                                                                        if (v108 != 0) {
                                                                            // 0x8f629e24
                                                                            free((char *)v108);
                                                                            // branch -> 0x8f62a550
                                                                        }
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    } else {
                                                        // if_8f629d60_0_true
                                                        g45 = v84;
                                                        result2 = 0;
                                                        // branch -> 0x8f629e04
                                                        // 0x8f629e04
                                                        v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                        if (v95 == 0) {
                                                            // 0x8f629e30
                                                            v116 = g45;
                                                            v7 = v116;
                                                            v28 = v83;
                                                            v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                            v86 = (int32_t)v96;
                                                            v109 = result2;
                                                            g45 = v86;
                                                            v110 = v86;
                                                            if (v109 != 0) {
                                                                // 0x8f629e4c
                                                                free((char *)v109);
                                                                v110 = g45;
                                                                // branch -> 0x8f629e54
                                                            }
                                                            // 0x8f629e54
                                                            if (v110 != 0) {
                                                                v35 = v2;
                                                                v14 = v31;
                                                                // 0x8f62a0cc
                                                                if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                    goto lab_0x8f62a0cc_16;
                                                                }
                                                                v41 = v35;
                                                                v23 = v14;
                                                                goto lab_0x8f62a550_21;
                                                            }
                                                        } else {
                                                            // 0x8f629e1c
                                                            v108 = result2;
                                                            if (v108 != 0) {
                                                                // 0x8f629e24
                                                                free((char *)v108);
                                                                // branch -> 0x8f62a550
                                                            }
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        }
                                    }
                                    // 0x8f629c44
                                    v28 = (int32_t)"%s: name: %s";
                                    v7 = (int32_t)"oem_utags_ext";
                                    v83 = &str6;
                                    g44 = v83;
                                    v90 = print_log(2, (int32_t)"%s: name: %s", (int32_t)"oem_utags_ext", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                    v105 = result2;
                                    v81 = v90;
                                    v107 = v105;
                                    if (v105 == 2) {
                                        // 0x8f629c84
                                        v120 = *(char *)*(int32_t *)(g45 + 8);
                                        v126 = v120;
                                        g44 = v126;
                                        if (v120 == 0) {
                                            // 0x8f629c94
                                            if (is_utags_ext_locked_constprop_30(v90, v28, v7, v126) == 0) {
                                                // 0x8f629ca0
                                                v28 = v83;
                                                v7 = &g14;
                                                v91 = __utag_puts(1, v83, (int32_t)&g14, g44, v1, 0, v32, v31, str6, 0);
                                                if (v91 == NULL) {
                                                    // if_8f629cb4_0_true
                                                    // branch -> 0x8f62a288
                                                    // 0x8f62a288
                                                    v11 = v83;
                                                    v8 = (int32_t)"failed to clear value of \"%s\"";
                                                    v39 = v2;
                                                    v15 = v31;
                                                    // branch -> 0x8f62a28c
                                                    goto lab_0x8f62a28c_24;
                                                } else {
                                                    // 0x8f629cc0
                                                    v92 = __utags_flush(1, v28, v7, g44, v1, 0, v32, v31);
                                                    if (v92 == 0) {
                                                        // 0x8f629cc0
                                                        v81 = 0;
                                                        v107 = result2;
                                                        // branch -> 0x8f629c60
                                                        // 0x8f629c60
                                                        g47 = v107 > 1;
                                                        v106 = v80;
                                                        if (v106 != 0) {
                                                            // after_if_8f629c70_0
                                                            if (v107 != 1 && !((v107 < 1 ^ (v107 & -v107) < 0))) {
                                                                // 0x8f629c78
                                                                // branch -> 0x8f629eb4
                                                                // 0x8f629eb4
                                                                fboot_info((int32_t)"INFO", (int32_t)"syntax error - operator present", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                // branch -> 0x8f62a550
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                        }
                                                        // 0x8f629cd4
                                                        if (v107 <= 1) {
                                                            // 0x8f629e60
                                                            switch (v106) {
                                                                default: {
                                                                    // 0x8f629e78
                                                                    len = strlen((char *)&str6);
                                                                    v87 = (char *)((int32_t)&v3 - 1 + len - 168);
                                                                    v123 = *v87;
                                                                    v128 = v123;
                                                                    g44 = v128;
                                                                    if (v123 == 47) {
                                                                        // 0x8f62a294
                                                                        *v87 = (char)g47;
                                                                        if (__utag_exists(1, v83, v7, g44) != 0) {
                                                                            // 0x8f62a2b0
                                                                            v71 = list_existing_utags_constprop_34(v83, v83, v7, g44, v1, 0, v32, v31);
                                                                            result = v71;
                                                                            v42 = v2;
                                                                            v22 = v31;
                                                                            // branch -> 0x8f62a554
                                                                          lab_0x8f62a554_32:
                                                                            // 0x8f62a554
                                                                            v43 = g32;
                                                                            g44 = v43;
                                                                            if (v6 != v43) {
                                                                                goto lab_0x8f62a564_24;
                                                                            }
                                                                            // 0x8f62a63c
                                                                            g45 = v3;
                                                                            g47 = v4;
                                                                            return result;
                                                                        }
                                                                    } else {
                                                                        // 0x8f629e98
                                                                        if (__utag_exists(1, v83, v7, v128) != 0) {
                                                                            v40 = v2;
                                                                            v13 = v31;
                                                                            // 0x8f62a540
                                                                            v27 = list_str_utag_short(1, v83, v7, g44, (int32_t)v40, 0, v32, v13, str6, 0, 0, 0);
                                                                            result = v27;
                                                                            v42 = v40;
                                                                            v22 = v13;
                                                                            // branch -> 0x8f62a554
                                                                            goto lab_0x8f62a554_32;
                                                                        }
                                                                    }
                                                                    // 0x8f629eac
                                                                    // branch -> 0x8f629eb4
                                                                    // 0x8f629eb4
                                                                    fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                    // branch -> 0x8f62a550
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    break;
                                                                }
                                                                case 45: {
                                                                    // 0x8f62a150
                                                                    if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) != 0) {
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    }
                                                                    break;
                                                                }
                                                                case 64: {
                                                                    // 0x8f62a208
                                                                    if (strncmp((char *)&str6, g13, 2) != 0) {
                                                                        // 0x8f62a23c
                                                                        if (__utag_exists(1, v83, 2, g44) == 0) {
                                                                            // 0x8f62a250
                                                                            if (strlen((char *)&str6) == 0) {
                                                                                // 0x8f62a260
                                                                                v10 = get_current_path(1, v83, 2, g44);
                                                                                v82 = (int32_t)"current path set to [%s]";
                                                                                v37 = v2;
                                                                                v12 = v31;
                                                                                // branch -> 0x8f62a274
                                                                              lab_0x8f62a274_6:
                                                                                // 0x8f62a274
                                                                                fboot_info((int32_t)"INFO", v82, v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                                                                v75 = v37;
                                                                                v74 = v12;
                                                                                // branch -> 0x8f62a278
                                                                                goto lab_0x8f62a278_6;
                                                                            } else {
                                                                                // 0x8f62a280
                                                                                v24 = v83;
                                                                                v9 = (int32_t)"path validation failed for [%s]";
                                                                                // branch -> 0x8f62a288
                                                                              lab_0x8f62a288_16:
                                                                                // 0x8f62a288
                                                                                v11 = v24;
                                                                                v8 = v9;
                                                                                v39 = v2;
                                                                                v15 = v31;
                                                                                // branch -> 0x8f62a28c
                                                                                goto lab_0x8f62a28c_24;
                                                                            }
                                                                        }
                                                                    }
                                                                    // 0x8f62a220
                                                                    set_current_path(1, v83, 2, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                    // branch -> 0x8f62a234
                                                                    // 0x8f62a234
                                                                    v10 = &str6;
                                                                    v82 = (int32_t)"current path set to [%s]";
                                                                    v37 = v2;
                                                                    v12 = v31;
                                                                    // branch -> 0x8f62a274
                                                                    goto lab_0x8f62a274_6;
                                                                }
                                                                case 43: {
                                                                    // 0x8f629ebc
                                                                    if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                                        // 0x8f629ec8
                                                                        if (strlen((char *)&str6) == 0) {
                                                                            // if_8f629ed8_0_true
                                                                            v33 = v83;
                                                                            // branch -> 0x8f62a0c4
                                                                            // 0x8f62a0c4
                                                                            g44 = v33;
                                                                            print_log(-1, (int32_t)"%s: empty utag name\n", (int32_t)"validate_hw_utag_name_full", v33, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                            v36 = v2;
                                                                            v20 = v31;
                                                                            // branch -> 0x8f62a144
                                                                            goto lab_0x8f62a144_11;
                                                                        } else {
                                                                            // if_8f629ed4_0_true
                                                                            g45 = (int32_t)&g12 + 1;
                                                                            c3 = *(char *)((int32_t)&g12 + 1);
                                                                            if (c3 != 0) {
                                                                                while (true) {
                                                                                    // 0x8f629ef8
                                                                                    if (strchr((char *)&str6, (int32_t)c3) == NULL) {
                                                                                        goto lab_0x8f629ef8_3;
                                                                                    }
                                                                                    // 0x8f629f08
                                                                                    g44 = v83;
                                                                                    print_log(-1, (int32_t)"%s: utag name includes special characters\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    fboot_info((int32_t)"INFO", (int32_t)"utag name includes special character", (int32_t)"validate_hw_utag_name_full", g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                    // branch -> 0x8f62a144
                                                                                  lab_0x8f62a144_12:
                                                                                    // 0x8f62a144
                                                                                    v24 = &str6;
                                                                                    v9 = (int32_t)"failed to add utag [%s]";
                                                                                    // branch -> 0x8f62a288
                                                                                    goto lab_0x8f62a288_16;
                                                                                }
                                                                            }
                                                                            // 0x8f629f2c
                                                                            v88 = &str7;
                                                                            g46 = v88;
                                                                            utag_canonical_name_constprop_28(v83, v88, v7, g44, v1, 0, v32, v31);
                                                                            if (strlen((char *)&str7) < 23) {
                                                                                // 0x8f629f74
                                                                                len2 = strlen((char *)&str6);
                                                                                v124 = *(char *)(len2 + (int32_t)&v3 - 169);
                                                                                if (v124 == 47) {
                                                                                    // 0x8f629f90
                                                                                    g44 = v83;
                                                                                    print_log(2, (int32_t)"%s: utag name must not end with '/'[%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    // branch -> 0x8f62a000
                                                                                } else {
                                                                                    // 0x8f629fb0
                                                                                    if (strstr((char *)&str6, "//") == NULL) {
                                                                                        // 0x8f629fc4
                                                                                        utag_canonical_name_constprop_28(v83, v88, v7, (int32_t)v124, v1, 0, v32, v31);
                                                                                        len3 = strlen((char *)&str7);
                                                                                        v125 = g46;
                                                                                        v117 = v125 + len3;
                                                                                        // branch -> 0x8f62a018
                                                                                        while (true) {
                                                                                            // 0x8f62a018
                                                                                            if (v117 < v125) {
                                                                                                goto lab_0x8f62a008_4;
                                                                                            }
                                                                                            // 0x8f62a05c
                                                                                            if (0x1000000 * str7 == 0x2e000000) {
                                                                                                // 0x8f62a630
                                                                                                g45 = v88;
                                                                                                // branch -> 0x8f62a634
                                                                                                // 0x8f62a634
                                                                                                g46 = 0;
                                                                                                v48 = v88;
                                                                                                v34 = v2;
                                                                                                v18 = v31;
                                                                                                // branch -> 0x8f62a080
                                                                                                goto lab_0x8f62a080_8;
                                                                                            } else {
                                                                                                // if_8f62a064_0_true
                                                                                                g45 = 0;
                                                                                                // branch -> 0x8f62a0e0
                                                                                                // 0x8f62a0e0
                                                                                                v29 = v88;
                                                                                                print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                g47 = v97;
                                                                                                if (v97 != 0) {
                                                                                                    // 0x8f62a104
                                                                                                    v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                                    if (v98 == NULL) {
                                                                                                        // 0x8f62a118
                                                                                                        g44 = v88;
                                                                                                        print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                        fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                                        // branch -> 0x8f62a13c
                                                                                                        // 0x8f62a13c
                                                                                                        free((char *)g47);
                                                                                                        // branch -> 0x8f62a144
                                                                                                        goto lab_0x8f62a144_12;
                                                                                                    } else {
                                                                                                        // 0x8f62a070
                                                                                                        free((char *)g47);
                                                                                                        // branch -> 0x8f62a078
                                                                                                        // 0x8f62a078
                                                                                                        v111 = g45;
                                                                                                        v45 = v2;
                                                                                                        v17 = v31;
                                                                                                        if (v111 != 0) {
                                                                                                            v48 = v111;
                                                                                                            v34 = v2;
                                                                                                            v18 = v31;
                                                                                                            // 0x8f62a080
                                                                                                            v29 = v48;
                                                                                                            print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                                            if (g46 == 0) {
                                                                                                                goto lab_0x8f62a09c_14;
                                                                                                            }
                                                                                                            goto lab_0x8f62a574_14;
                                                                                                        }
                                                                                                        // 0x8f62a5d4
                                                                                                        v25 = &str6;
                                                                                                        g42 = v25;
                                                                                                        if (utag_parent_exists(1) == 0) {
                                                                                                            goto lab_if_8f62a5e4_0_true_15;
                                                                                                        }
                                                                                                        goto lab_0x8f62a5f0_15;
                                                                                                    }
                                                                                                  lab_0x8f62a288_20:
                                                                                                    // 0x8f62a288
                                                                                                    v11 = &str6;
                                                                                                    v8 = (int32_t)"failed to add utag [%s]";
                                                                                                    v39 = v38;
                                                                                                    v15 = v20;
                                                                                                    // branch -> 0x8f62a28c
                                                                                                    goto lab_0x8f62a28c_24;
                                                                                                }
                                                                                                // 0x8f62a078
                                                                                                v111 = g45;
                                                                                                if (v111 == 0) {
                                                                                                    v45 = v2;
                                                                                                    v17 = v31;
                                                                                                    // 0x8f62a5d4
                                                                                                    v25 = &str6;
                                                                                                    g42 = v25;
                                                                                                    if (utag_parent_exists(1) == 0) {
                                                                                                        goto lab_if_8f62a5e4_0_true_15;
                                                                                                    }
                                                                                                    goto lab_0x8f62a5f0_15;
                                                                                                } else {
                                                                                                    v48 = v111;
                                                                                                    v34 = v2;
                                                                                                    v18 = v31;
                                                                                                }
                                                                                            }
                                                                                          lab_0x8f62a080_10:
                                                                                            // 0x8f62a080
                                                                                            v29 = v48;
                                                                                            print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                            if (g46 == 0) {
                                                                                                goto lab_0x8f62a09c_14;
                                                                                            }
                                                                                            goto lab_0x8f62a574_14;
                                                                                        }
                                                                                    } else {
                                                                                        // 0x8f629fe0
                                                                                        g44 = v83;
                                                                                        print_log(2, (int32_t)"%s: utag name must not have empty name segments [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                        // branch -> 0x8f62a000
                                                                                        // 0x8f62a000
                                                                                        fboot_info((int32_t)"INFO", (int32_t)"bad utag name [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                        // branch -> 0x8f62a144
                                                                                        // 0x8f62a144
                                                                                        v38 = v2;
                                                                                        // branch -> 0x8f62a288
                                                                                        goto lab_0x8f62a288_20;
                                                                                    }
                                                                                }
                                                                                // 0x8f62a000
                                                                                fboot_info((int32_t)"INFO", (int32_t)"utag name must not end with '/' [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                                v20 = v31;
                                                                                // branch -> 0x8f62a144
                                                                                // 0x8f62a144
                                                                                v38 = v2;
                                                                                // branch -> 0x8f62a288
                                                                                goto lab_0x8f62a288_20;
                                                                            } else {
                                                                                // 0x8f629f50
                                                                                g44 = v83;
                                                                                print_log(-1, (int32_t)"%s: name too long [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                // branch -> 0x8f62a000
                                                                            }
                                                                            // 0x8f62a000
                                                                            fboot_info((int32_t)"INFO", (int32_t)"utag name length must not exceed %d\n", 22, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                            // branch -> 0x8f62a144
                                                                        }
                                                                        // 0x8f62a144
                                                                        v38 = v2;
                                                                        // branch -> 0x8f62a288
                                                                        goto lab_0x8f62a288_20;
                                                                    }
                                                                  lab_0x8f62a144_13:
                                                                    // 0x8f62a144
                                                                    v38 = v36;
                                                                    // branch -> 0x8f62a288
                                                                    goto lab_0x8f62a288_20;
                                                                    break;
                                                                }
                                                            }
                                                            // 0x8f62a15c
                                                            if (__utag_exists(1, v83, v7, g44) == 0) {
                                                                // if_8f62a16c_0_true
                                                                v24 = v83;
                                                                v38 = v2;
                                                                v16 = v31;
                                                                v9 = (int32_t)"can't delete [%s] it does not exist";
                                                                // branch -> 0x8f62a288
                                                            } else {
                                                                // 0x8f62a178
                                                                v89 = &str7;
                                                                strlcpy(v89, v83, 33, g44, v1);
                                                                strlcat(v89, (int32_t)&g13, 33, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                v99 = __utags_walk_existing(1, (int32_t)&g1, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0);
                                                                if (v99 == -27) {
                                                                    // if_8f62a1ac_0_true
                                                                    // branch -> 0x8f62a288
                                                                    // 0x8f62a288
                                                                    v11 = v83;
                                                                    v8 = (int32_t)"can't delete [%s] it has children";
                                                                    v39 = v2;
                                                                    v15 = v31;
                                                                    // branch -> 0x8f62a28c
                                                                    goto lab_0x8f62a28c_24;
                                                                } else {
                                                                    // 0x8f62a1b8
                                                                    v100 = __utag_delete(1, v83, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7);
                                                                    if (v100 == 0) {
                                                                        // 0x8f62a1cc
                                                                        v101 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                                        if (v101 == 0) {
                                                                            // 0x8f62a1ec
                                                                            v102 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                                            if (v102 == 0) {
                                                                                // 0x8f62a1fc
                                                                                // branch -> 0x8f62a234
                                                                                // 0x8f62a234
                                                                                v10 = &str6;
                                                                                v82 = (int32_t)"deleted utag [%s]";
                                                                                v37 = v2;
                                                                                v12 = v31;
                                                                                // branch -> 0x8f62a274
                                                                                goto lab_0x8f62a274_6;
                                                                            }
                                                                        }
                                                                    } else {
                                                                        // 0x8f62a1e0
                                                                        // branch -> 0x8f62a288
                                                                        // 0x8f62a288
                                                                        v11 = v83;
                                                                        v8 = (int32_t)"failed to delete [%s]";
                                                                        v39 = v2;
                                                                        v15 = v31;
                                                                        // branch -> 0x8f62a28c
                                                                        goto lab_0x8f62a28c_24;
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                            // 0x8f62a288
                                                            v11 = v24;
                                                            v8 = v9;
                                                            v39 = v38;
                                                            v15 = v16;
                                                            // branch -> 0x8f62a28c
                                                            goto lab_0x8f62a28c_24;
                                                        } else {
                                                            // 0x8f629cdc
                                                            if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                                // 0x8f629ce8
                                                                if (__utag_exists(1, v83, v7, g44) == 0) {
                                                                    // 0x8f629eac
                                                                    // branch -> 0x8f629eb4
                                                                    // 0x8f629eb4
                                                                    fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                    // branch -> 0x8f62a550
                                                                } else {
                                                                    // 0x8f629cfc
                                                                    print_log(2, (int32_t)"%s: writing value to [%s]", (int32_t)"oem_utags_ext", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    v84 = &str7;
                                                                    v118 = g45 + 8;
                                                                    g45 = v118;
                                                                    v7 = 128;
                                                                    strlcpy(v84, *(int32_t *)v118, 128, v83, v1);
                                                                    v112 = v5 - 2;
                                                                    v5 = v112;
                                                                    if (v112 > 1) {
                                                                        strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                        v119 = g45 + 4;
                                                                        g45 = v119;
                                                                        v122 = *(int32_t *)v119;
                                                                        v7 = 128;
                                                                        strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                        v121 = 2;
                                                                        while (v121 < v5) {
                                                                            // 0x8f629d30
                                                                            strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                            v119 = g45 + 4;
                                                                            g45 = v119;
                                                                            v122 = *(int32_t *)v119;
                                                                            v7 = 128;
                                                                            strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                            v121++;
                                                                            // continue -> 0x8f629d30
                                                                        }
                                                                        // 0x8f629d58
                                                                        v103 = 0x1000000 * str7;
                                                                        v127 = v103 / 0x1000000;
                                                                        g44 = v127;
                                                                        if (v103 == 0x2b000000) {
                                                                            // 0x8f629d6c
                                                                            v93 = __utag_sizeof((char *)1, v83, v7, 43, v1, 0, v32, v31, str6);
                                                                            size = strlen((char *)&str7) + v93 + 1;
                                                                            result2 = size;
                                                                            if (size == 0) {
                                                                                // if_8f629d8c_0_true
                                                                                // branch -> 0x8f629de0
                                                                                // 0x8f629de0
                                                                                print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                // branch -> 0x8f62a550
                                                                            } else {
                                                                                // 0x8f629d98
                                                                                mem = malloc(size);
                                                                                v85 = (int32_t)mem;
                                                                                g45 = v85;
                                                                                if (mem == NULL) {
                                                                                    // 0x8f629da8
                                                                                    print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    // branch -> 0x8f62a550
                                                                                } else {
                                                                                    // 0x8f629dbc
                                                                                    v113 = result2;
                                                                                    g44 = v113;
                                                                                    v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                                    if (v94 == 0) {
                                                                                        // 0x8f629dd8
                                                                                        // branch -> 0x8f629de0
                                                                                        // 0x8f629de0
                                                                                        print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                        // branch -> 0x8f62a550
                                                                                    } else {
                                                                                        // 0x8f629df0
                                                                                        v114 = result2;
                                                                                        v115 = g45;
                                                                                        result2 = v115;
                                                                                        strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                                        // branch -> 0x8f629e04
                                                                                        // 0x8f629e04
                                                                                        v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                                        if (v95 == 0) {
                                                                                            // 0x8f629e30
                                                                                            v116 = g45;
                                                                                            v7 = v116;
                                                                                            v28 = v83;
                                                                                            v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                            v86 = (int32_t)v96;
                                                                                            v109 = result2;
                                                                                            g45 = v86;
                                                                                            v110 = v86;
                                                                                            if (v109 != 0) {
                                                                                                // 0x8f629e4c
                                                                                                free((char *)v109);
                                                                                                v110 = g45;
                                                                                                // branch -> 0x8f629e54
                                                                                            }
                                                                                            // 0x8f629e54
                                                                                            if (v110 != 0) {
                                                                                                v35 = v2;
                                                                                                v14 = v31;
                                                                                                // 0x8f62a0cc
                                                                                                if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                                    goto lab_0x8f62a0cc_16;
                                                                                                }
                                                                                                v41 = v35;
                                                                                                v23 = v14;
                                                                                                goto lab_0x8f62a550_21;
                                                                                            }
                                                                                        } else {
                                                                                            // 0x8f629e1c
                                                                                            v108 = result2;
                                                                                            if (v108 != 0) {
                                                                                                // 0x8f629e24
                                                                                                free((char *)v108);
                                                                                                // branch -> 0x8f62a550
                                                                                            }
                                                                                        }
                                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                    }
                                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                }
                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                            }
                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                        } else {
                                                                            // if_8f629d60_0_true
                                                                            g45 = v84;
                                                                            result2 = 0;
                                                                            // branch -> 0x8f629e04
                                                                            // 0x8f629e04
                                                                            v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                            if (v95 == 0) {
                                                                                // 0x8f629e30
                                                                                v116 = g45;
                                                                                v7 = v116;
                                                                                v28 = v83;
                                                                                v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                v86 = (int32_t)v96;
                                                                                v109 = result2;
                                                                                g45 = v86;
                                                                                v110 = v86;
                                                                                if (v109 != 0) {
                                                                                    // 0x8f629e4c
                                                                                    free((char *)v109);
                                                                                    v110 = g45;
                                                                                    // branch -> 0x8f629e54
                                                                                }
                                                                                // 0x8f629e54
                                                                                if (v110 != 0) {
                                                                                    v35 = v2;
                                                                                    v14 = v31;
                                                                                    // 0x8f62a0cc
                                                                                    if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                        goto lab_0x8f62a0cc_16;
                                                                                    }
                                                                                    v41 = v35;
                                                                                    v23 = v14;
                                                                                    goto lab_0x8f62a550_21;
                                                                                }
                                                                            } else {
                                                                                // 0x8f629e1c
                                                                                v108 = result2;
                                                                                if (v108 != 0) {
                                                                                    // 0x8f629e24
                                                                                    free((char *)v108);
                                                                                    // branch -> 0x8f62a550
                                                                                }
                                                                            }
                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                        }
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    }
                                                                    // 0x8f629d58
                                                                    v103 = 0x1000000 * str7;
                                                                    v127 = v103 / 0x1000000;
                                                                    g44 = v127;
                                                                    if (v103 == 0x2b000000) {
                                                                        // 0x8f629d6c
                                                                        v93 = __utag_sizeof((char *)1, v83, v7, 43, v1, 0, v32, v31, str6);
                                                                        size = strlen((char *)&str7) + v93 + 1;
                                                                        result2 = size;
                                                                        if (size == 0) {
                                                                            // if_8f629d8c_0_true
                                                                            // branch -> 0x8f629de0
                                                                            // 0x8f629de0
                                                                            print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                            // branch -> 0x8f62a550
                                                                        } else {
                                                                            // 0x8f629d98
                                                                            mem = malloc(size);
                                                                            v85 = (int32_t)mem;
                                                                            g45 = v85;
                                                                            if (mem == NULL) {
                                                                                // 0x8f629da8
                                                                                print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                // branch -> 0x8f62a550
                                                                            } else {
                                                                                // 0x8f629dbc
                                                                                v113 = result2;
                                                                                g44 = v113;
                                                                                v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                                if (v94 == 0) {
                                                                                    // 0x8f629dd8
                                                                                    // branch -> 0x8f629de0
                                                                                    // 0x8f629de0
                                                                                    print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                                    // branch -> 0x8f62a550
                                                                                } else {
                                                                                    // 0x8f629df0
                                                                                    v114 = result2;
                                                                                    v115 = g45;
                                                                                    result2 = v115;
                                                                                    strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                                    // branch -> 0x8f629e04
                                                                                    // 0x8f629e04
                                                                                    v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                                    if (v95 == 0) {
                                                                                        // 0x8f629e30
                                                                                        v116 = g45;
                                                                                        v7 = v116;
                                                                                        v28 = v83;
                                                                                        v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                                        v86 = (int32_t)v96;
                                                                                        v109 = result2;
                                                                                        g45 = v86;
                                                                                        v110 = v86;
                                                                                        if (v109 != 0) {
                                                                                            // 0x8f629e4c
                                                                                            free((char *)v109);
                                                                                            v110 = g45;
                                                                                            // branch -> 0x8f629e54
                                                                                        }
                                                                                        // 0x8f629e54
                                                                                        if (v110 != 0) {
                                                                                            v35 = v2;
                                                                                            v14 = v31;
                                                                                            // 0x8f62a0cc
                                                                                            if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                                goto lab_0x8f62a0cc_16;
                                                                                            }
                                                                                            v41 = v35;
                                                                                            v23 = v14;
                                                                                            goto lab_0x8f62a550_21;
                                                                                        }
                                                                                    } else {
                                                                                        // 0x8f629e1c
                                                                                        v108 = result2;
                                                                                        if (v108 != 0) {
                                                                                            // 0x8f629e24
                                                                                            free((char *)v108);
                                                                                            // branch -> 0x8f62a550
                                                                                        }
                                                                                    }
                                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                                }
                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                            }
                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                        }
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    } else {
                                                                        // if_8f629d60_0_true
                                                                        g45 = v84;
                                                                        result2 = 0;
                                                                        // branch -> 0x8f629e04
                                                                        // 0x8f629e04
                                                                        v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                        if (v95 == 0) {
                                                                            // 0x8f629e30
                                                                            v116 = g45;
                                                                            v7 = v116;
                                                                            v28 = v83;
                                                                            v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                            v86 = (int32_t)v96;
                                                                            v109 = result2;
                                                                            g45 = v86;
                                                                            v110 = v86;
                                                                            if (v109 != 0) {
                                                                                // 0x8f629e4c
                                                                                free((char *)v109);
                                                                                v110 = g45;
                                                                                // branch -> 0x8f629e54
                                                                            }
                                                                            // 0x8f629e54
                                                                            if (v110 != 0) {
                                                                                v35 = v2;
                                                                                v14 = v31;
                                                                                // 0x8f62a0cc
                                                                                if (__utags_flush(1, v28, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                    goto lab_0x8f62a0cc_16;
                                                                                }
                                                                                v41 = v35;
                                                                                v23 = v14;
                                                                                goto lab_0x8f62a550_21;
                                                                            }
                                                                        } else {
                                                                            // 0x8f629e1c
                                                                            v108 = result2;
                                                                            if (v108 != 0) {
                                                                                // 0x8f629e24
                                                                                free((char *)v108);
                                                                                // branch -> 0x8f62a550
                                                                            }
                                                                        }
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                    }
                                                }
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        } else {
                                            v81 = v90;
                                            v107 = 2;
                                        }
                                    }
                                    // 0x8f629c60
                                    g47 = v107 > 1;
                                    v106 = v80;
                                    if (v106 != 0) {
                                        // after_if_8f629c70_0
                                        if (v107 != 1 && !((v107 < 1 ^ (v107 & -v107) < 0))) {
                                            // 0x8f629c78
                                            // branch -> 0x8f629eb4
                                            // 0x8f629eb4
                                            fboot_info((int32_t)"INFO", (int32_t)"syntax error - operator present", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                            // branch -> 0x8f62a550
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        }
                                    }
                                    // 0x8f629cd4
                                    if (v107 <= 1) {
                                        // 0x8f629e60
                                        switch (v106) {
                                            default: {
                                                // 0x8f629e78
                                                len = strlen((char *)&str6);
                                                v87 = (char *)((int32_t)&v3 - 1 + len - 168);
                                                v123 = *v87;
                                                v128 = v123;
                                                g44 = v128;
                                                if (v123 == 47) {
                                                    // 0x8f62a294
                                                    *v87 = (char)g47;
                                                    if (__utag_exists(1, v83, v7, g44) != 0) {
                                                        // 0x8f62a2b0
                                                        v71 = list_existing_utags_constprop_34(v83, v83, v7, g44, v1, 0, v32, v31);
                                                        result = v71;
                                                        v42 = v2;
                                                        v22 = v31;
                                                        // branch -> 0x8f62a554
                                                      lab_0x8f62a554_33:
                                                        // 0x8f62a554
                                                        v43 = g32;
                                                        g44 = v43;
                                                        if (v6 != v43) {
                                                            goto lab_0x8f62a564_24;
                                                        }
                                                        // 0x8f62a63c
                                                        g45 = v3;
                                                        g47 = v4;
                                                        return result;
                                                    }
                                                } else {
                                                    // 0x8f629e98
                                                    if (__utag_exists(1, v83, v7, v128) != 0) {
                                                        v40 = v2;
                                                        v13 = v31;
                                                        // 0x8f62a540
                                                        v27 = list_str_utag_short(1, v83, v7, g44, (int32_t)v40, 0, v32, v13, str6, 0, 0, 0);
                                                        result = v27;
                                                        v42 = v40;
                                                        v22 = v13;
                                                        // branch -> 0x8f62a554
                                                        goto lab_0x8f62a554_33;
                                                    }
                                                }
                                                // 0x8f629eac
                                                // branch -> 0x8f629eb4
                                                // 0x8f629eb4
                                                fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                // branch -> 0x8f62a550
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                break;
                                            }
                                            case 45: {
                                                // 0x8f62a150
                                                if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) != 0) {
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                break;
                                            }
                                            case 64: {
                                                // 0x8f62a208
                                                if (strncmp((char *)&str6, g13, 2) != 0) {
                                                    // 0x8f62a23c
                                                    if (__utag_exists(1, v83, 2, g44) == 0) {
                                                        // 0x8f62a250
                                                        if (strlen((char *)&str6) == 0) {
                                                            // 0x8f62a260
                                                            v10 = get_current_path(1, v83, 2, g44);
                                                            v82 = (int32_t)"current path set to [%s]";
                                                            v37 = v2;
                                                            v12 = v31;
                                                            // branch -> 0x8f62a274
                                                          lab_0x8f62a274_8:
                                                            // 0x8f62a274
                                                            fboot_info((int32_t)"INFO", v82, v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                                            v75 = v37;
                                                            v74 = v12;
                                                            // branch -> 0x8f62a278
                                                            goto lab_0x8f62a278_6;
                                                        } else {
                                                            // 0x8f62a280
                                                            v24 = v83;
                                                            v9 = (int32_t)"path validation failed for [%s]";
                                                            // branch -> 0x8f62a288
                                                          lab_0x8f62a288_21:
                                                            // 0x8f62a288
                                                            v11 = v24;
                                                            v8 = v9;
                                                            v39 = v2;
                                                            v15 = v31;
                                                            // branch -> 0x8f62a28c
                                                            goto lab_0x8f62a28c_24;
                                                        }
                                                    }
                                                }
                                                // 0x8f62a220
                                                set_current_path(1, v83, 2, g44, v1, 0, v32, v31, str6, 0, 0);
                                                // branch -> 0x8f62a234
                                                // 0x8f62a234
                                                v10 = &str6;
                                                v82 = (int32_t)"current path set to [%s]";
                                                v37 = v2;
                                                v12 = v31;
                                                // branch -> 0x8f62a274
                                                goto lab_0x8f62a274_8;
                                            }
                                            case 43: {
                                                // 0x8f629ebc
                                                if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                                    // 0x8f629ec8
                                                    if (strlen((char *)&str6) == 0) {
                                                        // if_8f629ed8_0_true
                                                        v33 = v83;
                                                        // branch -> 0x8f62a0c4
                                                        // 0x8f62a0c4
                                                        g44 = v33;
                                                        print_log(-1, (int32_t)"%s: empty utag name\n", (int32_t)"validate_hw_utag_name_full", v33, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                        v36 = v2;
                                                        v20 = v31;
                                                        // branch -> 0x8f62a144
                                                        goto lab_0x8f62a144_13;
                                                    } else {
                                                        // if_8f629ed4_0_true
                                                        g45 = (int32_t)&g12 + 1;
                                                        c3 = *(char *)((int32_t)&g12 + 1);
                                                        if (c3 != 0) {
                                                            while (true) {
                                                                // 0x8f629ef8
                                                                if (strchr((char *)&str6, (int32_t)c3) == NULL) {
                                                                    goto lab_0x8f629ef8_3;
                                                                }
                                                                // 0x8f629f08
                                                                g44 = v83;
                                                                print_log(-1, (int32_t)"%s: utag name includes special characters\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                fboot_info((int32_t)"INFO", (int32_t)"utag name includes special character", (int32_t)"validate_hw_utag_name_full", g44, v1, 0, v32, v31, str6, 0, 0);
                                                                // branch -> 0x8f62a144
                                                              lab_0x8f62a144_14:
                                                                // 0x8f62a144
                                                                v24 = &str6;
                                                                v9 = (int32_t)"failed to add utag [%s]";
                                                                // branch -> 0x8f62a288
                                                                goto lab_0x8f62a288_21;
                                                            }
                                                        }
                                                      lab_0x8f629f2c:
                                                        // 0x8f629f2c
                                                        v88 = &str7;
                                                        g46 = v88;
                                                        utag_canonical_name_constprop_28(v83, v88, v7, g44, v1, 0, v32, v31);
                                                        if (strlen((char *)&str7) < 23) {
                                                            // 0x8f629f74
                                                            len2 = strlen((char *)&str6);
                                                            v124 = *(char *)(len2 + (int32_t)&v3 - 169);
                                                            if (v124 == 47) {
                                                                // 0x8f629f90
                                                                g44 = v83;
                                                                print_log(2, (int32_t)"%s: utag name must not end with '/'[%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                // branch -> 0x8f62a000
                                                            } else {
                                                                // 0x8f629fb0
                                                                if (strstr((char *)&str6, "//") == NULL) {
                                                                    // 0x8f629fc4
                                                                    utag_canonical_name_constprop_28(v83, v88, v7, (int32_t)v124, v1, 0, v32, v31);
                                                                    len3 = strlen((char *)&str7);
                                                                    v125 = g46;
                                                                    v117 = v125 + len3;
                                                                    // branch -> 0x8f62a018
                                                                    while (true) {
                                                                        // 0x8f62a018
                                                                        if (v117 < v125) {
                                                                            goto lab_0x8f62a008_4;
                                                                        }
                                                                        // 0x8f62a05c
                                                                        if (0x1000000 * str7 == 0x2e000000) {
                                                                            // 0x8f62a630
                                                                            g45 = v88;
                                                                            // branch -> 0x8f62a634
                                                                            // 0x8f62a634
                                                                            g46 = 0;
                                                                            v48 = v88;
                                                                            v34 = v2;
                                                                            v18 = v31;
                                                                            // branch -> 0x8f62a080
                                                                            goto lab_0x8f62a080_10;
                                                                        } else {
                                                                            // if_8f62a064_0_true
                                                                            g45 = 0;
                                                                            // branch -> 0x8f62a0e0
                                                                            // 0x8f62a0e0
                                                                            v29 = v88;
                                                                            print_log(2, (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                            v97 = load_string_utag_constprop_29((int32_t)".features", (int32_t)"DEBUG: %s: check utag [%s]", (int32_t)"utag_allowed", v29, v30, 0, 0, 0, 0, 0, 0);
                                                                            g47 = v97;
                                                                            if (v97 != 0) {
                                                                                // 0x8f62a104
                                                                                v98 = token_present(v97, (int32_t)&g11, v88, v29, v30, 0, 0, 0, 0, 0, 0);
                                                                                if (v98 == NULL) {
                                                                                    // 0x8f62a118
                                                                                    g44 = v88;
                                                                                    print_log(-1, (int32_t)"%s: utag [%s] not in .features", (int32_t)"utag_allowed", v88, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                    fboot_info((int32_t)"INFO", (int32_t)"validation failed [%s] not in .features", v88, g44, v30, 0, 0, 0, 0, 0, 0);
                                                                                    // branch -> 0x8f62a13c
                                                                                    // 0x8f62a13c
                                                                                    free((char *)g47);
                                                                                    // branch -> 0x8f62a144
                                                                                    goto lab_0x8f62a144_14;
                                                                                } else {
                                                                                    // 0x8f62a070
                                                                                    free((char *)g47);
                                                                                    // branch -> 0x8f62a078
                                                                                    // 0x8f62a078
                                                                                    v111 = g45;
                                                                                    v45 = v2;
                                                                                    v17 = v31;
                                                                                    if (v111 != 0) {
                                                                                        v48 = v111;
                                                                                        v34 = v2;
                                                                                        v18 = v31;
                                                                                        // 0x8f62a080
                                                                                        v29 = v48;
                                                                                        print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                                        if (g46 == 0) {
                                                                                            goto lab_0x8f62a09c_14;
                                                                                        }
                                                                                        goto lab_0x8f62a574_14;
                                                                                    }
                                                                                    // 0x8f62a5d4
                                                                                    v25 = &str6;
                                                                                    g42 = v25;
                                                                                    if (utag_parent_exists(1) == 0) {
                                                                                        goto lab_if_8f62a5e4_0_true_15;
                                                                                    }
                                                                                    goto lab_0x8f62a5f0_15;
                                                                                }
                                                                              lab_0x8f62a288_25:
                                                                                // 0x8f62a288
                                                                                v11 = &str6;
                                                                                v8 = (int32_t)"failed to add utag [%s]";
                                                                                v39 = v38;
                                                                                v15 = v20;
                                                                                // branch -> 0x8f62a28c
                                                                                goto lab_0x8f62a28c_24;
                                                                            }
                                                                            // 0x8f62a078
                                                                            v111 = g45;
                                                                            if (v111 == 0) {
                                                                                v45 = v2;
                                                                                v17 = v31;
                                                                                // 0x8f62a5d4
                                                                                v25 = &str6;
                                                                                g42 = v25;
                                                                                if (utag_parent_exists(1) == 0) {
                                                                                    goto lab_if_8f62a5e4_0_true_15;
                                                                                }
                                                                                goto lab_0x8f62a5f0_15;
                                                                            } else {
                                                                                v48 = v111;
                                                                                v34 = v2;
                                                                                v18 = v31;
                                                                            }
                                                                        }
                                                                      lab_0x8f62a080_11:
                                                                        // 0x8f62a080
                                                                        v29 = v48;
                                                                        print_log(2, (int32_t)"DEBUG: %s: check attribute [%s]", (int32_t)"utag_allowed", v48, v30, 0, 0, 0, 0, 0, 0, 0, 0);
                                                                        if (g46 == 0) {
                                                                            goto lab_0x8f62a09c_14;
                                                                        }
                                                                        goto lab_0x8f62a574_14;
                                                                    }
                                                                } else {
                                                                    // 0x8f629fe0
                                                                    g44 = v83;
                                                                    print_log(2, (int32_t)"%s: utag name must not have empty name segments [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    // branch -> 0x8f62a000
                                                                    // 0x8f62a000
                                                                    fboot_info((int32_t)"INFO", (int32_t)"bad utag name [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                                    // branch -> 0x8f62a144
                                                                    // 0x8f62a144
                                                                    v38 = v2;
                                                                    // branch -> 0x8f62a288
                                                                    goto lab_0x8f62a288_25;
                                                                }
                                                                // 0x8f62a634
                                                                g46 = 0;
                                                                v48 = v49;
                                                                v34 = v46;
                                                                v18 = v19;
                                                                // branch -> 0x8f62a080
                                                                goto lab_0x8f62a080_11;
                                                            }
                                                            // 0x8f62a000
                                                            fboot_info((int32_t)"INFO", (int32_t)"utag name must not end with '/' [%s]", v83, g44, v1, 0, v32, v31, str6, 0, 0);
                                                            v20 = v31;
                                                            // branch -> 0x8f62a144
                                                            // 0x8f62a144
                                                            v38 = v2;
                                                            // branch -> 0x8f62a288
                                                            goto lab_0x8f62a288_25;
                                                        } else {
                                                            // 0x8f629f50
                                                            g44 = v83;
                                                            print_log(-1, (int32_t)"%s: name too long [%s]\n", (int32_t)"validate_hw_utag_name_full", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                            // branch -> 0x8f62a000
                                                        }
                                                        // 0x8f62a000
                                                        fboot_info((int32_t)"INFO", (int32_t)"utag name length must not exceed %d\n", 22, g44, v1, 0, v32, v31, str6, 0, 0);
                                                        // branch -> 0x8f62a144
                                                    }
                                                    // 0x8f62a144
                                                    v38 = v2;
                                                    // branch -> 0x8f62a288
                                                    goto lab_0x8f62a288_25;
                                                }
                                                // 0x8f62a144
                                                v38 = v36;
                                                // branch -> 0x8f62a288
                                                goto lab_0x8f62a288_25;
                                            }
                                        }
                                        // 0x8f62a15c
                                        if (__utag_exists(1, v83, v7, g44) == 0) {
                                            // if_8f62a16c_0_true
                                            // branch -> 0x8f62a288
                                        } else {
                                            // 0x8f62a178
                                            v89 = &str7;
                                            strlcpy(v89, v83, 33, g44, v1);
                                            strlcat(v89, (int32_t)&g13, 33, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                            v99 = __utags_walk_existing(1, (int32_t)&g1, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0);
                                            if (v99 == -27) {
                                                // if_8f62a1ac_0_true
                                                // branch -> 0x8f62a288
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            } else {
                                                // 0x8f62a1b8
                                                v100 = __utag_delete(1, v83, v89, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7);
                                                if (v100 == 0) {
                                                    // 0x8f62a1cc
                                                    v101 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                    if (v101 == 0) {
                                                        // 0x8f62a1ec
                                                        v102 = __utags_flush(1, v83, v89, g44, v1, 0, v32, v31);
                                                        if (v102 == 0) {
                                                            // 0x8f62a1fc
                                                            // branch -> 0x8f62a234
                                                            // 0x8f62a234
                                                            v10 = &str6;
                                                            v82 = (int32_t)"deleted utag [%s]";
                                                            v37 = v2;
                                                            v12 = v31;
                                                            // branch -> 0x8f62a274
                                                            goto lab_0x8f62a274_8;
                                                        }
                                                    }
                                                }
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        }
                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                    } else {
                                        // 0x8f629cdc
                                        if (is_utags_ext_locked_constprop_30(v81, v28, v7, g44) == 0) {
                                            // 0x8f629ce8
                                            if (__utag_exists(1, v83, v7, g44) == 0) {
                                                // 0x8f629eac
                                                // branch -> 0x8f629eb4
                                                // 0x8f629eb4
                                                fboot_info((int32_t)"INFO", (int32_t)"no such utag", v7, g44, v1, 0, v32, v31, str6, 0, 0);
                                                // branch -> 0x8f62a550
                                            } else {
                                                // 0x8f629cfc
                                                print_log(2, (int32_t)"%s: writing value to [%s]", (int32_t)"oem_utags_ext", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                v84 = &str7;
                                                v118 = g45 + 8;
                                                g45 = v118;
                                                v7 = 128;
                                                strlcpy(v84, *(int32_t *)v118, 128, v83, v1);
                                                v112 = v5 - 2;
                                                if (v112 > 1) {
                                                    strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                    v119 = g45 + 4;
                                                    g45 = v119;
                                                    v122 = *(int32_t *)v119;
                                                    v7 = 128;
                                                    strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                    v121 = 2;
                                                    while (v121 < v112) {
                                                        // 0x8f629d30
                                                        strlcat(v84, (int32_t)&g15, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                        v119 = g45 + 4;
                                                        g45 = v119;
                                                        v122 = *(int32_t *)v119;
                                                        v7 = 128;
                                                        strlcat(v84, v122, 128, v83, v1, 0, v32, v31, str6, 0, 0, 0);
                                                        v121++;
                                                        // continue -> 0x8f629d30
                                                    }
                                                    // 0x8f629d58
                                                    v103 = 0x1000000 * str7;
                                                    v127 = v103 / 0x1000000;
                                                    g44 = v127;
                                                    if (v103 == 0x2b000000) {
                                                        // 0x8f629d6c
                                                        v93 = __utag_sizeof((char *)1, v83, v7, 43, v1, 0, v32, v31, str6);
                                                        size = strlen((char *)&str7) + v93 + 1;
                                                        result2 = size;
                                                        if (size == 0) {
                                                            // if_8f629d8c_0_true
                                                            // branch -> 0x8f629de0
                                                            // 0x8f629de0
                                                            print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                            // branch -> 0x8f62a550
                                                        } else {
                                                            // 0x8f629d98
                                                            mem = malloc(size);
                                                            v85 = (int32_t)mem;
                                                            g45 = v85;
                                                            if (mem == NULL) {
                                                                // 0x8f629da8
                                                                print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                // branch -> 0x8f62a550
                                                            } else {
                                                                // 0x8f629dbc
                                                                v113 = result2;
                                                                g44 = v113;
                                                                v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                                if (v94 == 0) {
                                                                    // 0x8f629dd8
                                                                    // branch -> 0x8f629de0
                                                                    // 0x8f629de0
                                                                    print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                    // branch -> 0x8f62a550
                                                                } else {
                                                                    // 0x8f629df0
                                                                    v114 = result2;
                                                                    v115 = g45;
                                                                    result2 = v115;
                                                                    strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                    // branch -> 0x8f629e04
                                                                    // 0x8f629e04
                                                                    v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                    if (v95 == 0) {
                                                                        // 0x8f629e30
                                                                        v116 = g45;
                                                                        v7 = v116;
                                                                        v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                        v86 = (int32_t)v96;
                                                                        v109 = result2;
                                                                        g45 = v86;
                                                                        v110 = v86;
                                                                        if (v109 != 0) {
                                                                            // 0x8f629e4c
                                                                            free((char *)v109);
                                                                            v110 = g45;
                                                                            // branch -> 0x8f629e54
                                                                        }
                                                                        // 0x8f629e54
                                                                        if (v110 != 0) {
                                                                            v35 = v2;
                                                                            v14 = v31;
                                                                            // 0x8f62a0cc
                                                                            if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                                goto lab_0x8f62a0cc_16;
                                                                            }
                                                                            v41 = v35;
                                                                            v23 = v14;
                                                                            goto lab_0x8f62a550_21;
                                                                        }
                                                                    } else {
                                                                        // 0x8f629e1c
                                                                        v108 = result2;
                                                                        if (v108 != 0) {
                                                                            // 0x8f629e24
                                                                            free((char *)v108);
                                                                            // branch -> 0x8f62a550
                                                                        }
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    } else {
                                                        // if_8f629d60_0_true
                                                        g45 = v84;
                                                        result2 = 0;
                                                        // branch -> 0x8f629e04
                                                        // 0x8f629e04
                                                        v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                        if (v95 == 0) {
                                                            // 0x8f629e30
                                                            v116 = g45;
                                                            v7 = v116;
                                                            v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                            v86 = (int32_t)v96;
                                                            v109 = result2;
                                                            g45 = v86;
                                                            v110 = v86;
                                                            if (v109 != 0) {
                                                                // 0x8f629e4c
                                                                free((char *)v109);
                                                                v110 = g45;
                                                                // branch -> 0x8f629e54
                                                            }
                                                            // 0x8f629e54
                                                            if (v110 != 0) {
                                                                v35 = v2;
                                                                v14 = v31;
                                                                // 0x8f62a0cc
                                                                if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                    goto lab_0x8f62a0cc_16;
                                                                }
                                                                v41 = v35;
                                                                v23 = v14;
                                                                goto lab_0x8f62a550_21;
                                                            }
                                                        } else {
                                                            // 0x8f629e1c
                                                            v108 = result2;
                                                            if (v108 != 0) {
                                                                // 0x8f629e24
                                                                free((char *)v108);
                                                                // branch -> 0x8f62a550
                                                            }
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                // 0x8f629d58
                                                v103 = 0x1000000 * str7;
                                                v127 = v103 / 0x1000000;
                                                g44 = v127;
                                                if (v103 == 0x2b000000) {
                                                    // 0x8f629d6c
                                                    v93 = __utag_sizeof((char *)1, v83, v7, 43, v1, 0, v32, v31, str6);
                                                    size = strlen((char *)&str7) + v93 + 1;
                                                    result2 = size;
                                                    if (size == 0) {
                                                        // if_8f629d8c_0_true
                                                        // branch -> 0x8f629de0
                                                        // 0x8f629de0
                                                        print_log(2, (int32_t)"%s: utag [%s] does not exist\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                        // branch -> 0x8f62a550
                                                    } else {
                                                        // 0x8f629d98
                                                        mem = malloc(size);
                                                        v85 = (int32_t)mem;
                                                        g45 = v85;
                                                        if (mem == NULL) {
                                                            // 0x8f629da8
                                                            print_log(-1, (int32_t)"%s: out of memory", (int32_t)"set_utag2", g44, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                            // branch -> 0x8f62a550
                                                        } else {
                                                            // 0x8f629dbc
                                                            v113 = result2;
                                                            g44 = v113;
                                                            v94 = __utag_gets(1, v83, v85, v113, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0, 0, str7, 0, 0);
                                                            if (v94 == 0) {
                                                                // 0x8f629dd8
                                                                // branch -> 0x8f629de0
                                                                // 0x8f629de0
                                                                print_log(2, (int32_t)"%s: failed to read utag [%s]\n", (int32_t)"set_utag2", v83, v1, 0, v32, v31, str6, 0, 0, 0, 0);
                                                                // branch -> 0x8f62a550
                                                            } else {
                                                                // 0x8f629df0
                                                                v114 = result2;
                                                                v115 = g45;
                                                                result2 = v115;
                                                                strlcat(v115, (int32_t)&v104, v114, g44, v1, 0, v32, v31, str6, 0, 0, 0);
                                                                // branch -> 0x8f629e04
                                                                // 0x8f629e04
                                                                v95 = validate_utag_range(1, v83, g45, g44, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                                if (v95 == 0) {
                                                                    // 0x8f629e30
                                                                    v116 = g45;
                                                                    v7 = v116;
                                                                    v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                                    v86 = (int32_t)v96;
                                                                    v109 = result2;
                                                                    g45 = v86;
                                                                    v110 = v86;
                                                                    if (v109 != 0) {
                                                                        // 0x8f629e4c
                                                                        free((char *)v109);
                                                                        v110 = g45;
                                                                        // branch -> 0x8f629e54
                                                                    }
                                                                    // 0x8f629e54
                                                                    if (v110 != 0) {
                                                                        v35 = v2;
                                                                        v14 = v31;
                                                                        // 0x8f62a0cc
                                                                        if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                            goto lab_0x8f62a0cc_16;
                                                                        }
                                                                        v41 = v35;
                                                                        v23 = v14;
                                                                        goto lab_0x8f62a550_21;
                                                                    }
                                                                } else {
                                                                    // 0x8f629e1c
                                                                    v108 = result2;
                                                                    if (v108 != 0) {
                                                                        // 0x8f629e24
                                                                        free((char *)v108);
                                                                        // branch -> 0x8f62a550
                                                                    }
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                } else {
                                                    // if_8f629d60_0_true
                                                    g45 = v84;
                                                    result2 = 0;
                                                    // branch -> 0x8f629e04
                                                    // 0x8f629e04
                                                    v95 = validate_utag_range(1, v83, v84, v127, v1, 0, v32, v31, str6, 0, 0, 0, 0, 0, 0, 0);
                                                    if (v95 == 0) {
                                                        // 0x8f629e30
                                                        v116 = g45;
                                                        v7 = v116;
                                                        v96 = __utag_puts(1, v83, v116, g44, v1, 0, v32, v31, str6, 0);
                                                        v86 = (int32_t)v96;
                                                        v109 = result2;
                                                        g45 = v86;
                                                        v110 = v86;
                                                        if (v109 != 0) {
                                                            // 0x8f629e4c
                                                            free((char *)v109);
                                                            v110 = g45;
                                                            // branch -> 0x8f629e54
                                                        }
                                                        // 0x8f629e54
                                                        if (v110 != 0) {
                                                            v35 = v2;
                                                            v14 = v31;
                                                            // 0x8f62a0cc
                                                            if (__utags_flush(1, v83, v7, g44, v30, 0, 0, 0) == 0) {
                                                                goto lab_0x8f62a0cc_16;
                                                            }
                                                            v41 = v35;
                                                            v23 = v14;
                                                            goto lab_0x8f62a550_21;
                                                        }
                                                    } else {
                                                        // 0x8f629e1c
                                                        v108 = result2;
                                                        if (v108 != 0) {
                                                            // 0x8f629e24
                                                            free((char *)v108);
                                                            // branch -> 0x8f62a550
                                                        }
                                                    }
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        }
                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                    }
                                }
                                // Detected a possible infinite recursion (goto support failed); quitting...
                            }
                            // 0x8f62a554
                            v43 = g32;
                            g44 = v43;
                            if (v6 != v43) {
                                goto lab_0x8f62a564_24;
                            }
                            // 0x8f62a63c
                            g45 = v3;
                            g47 = v4;
                            return result;
                        }
                        // 0x8f629a74
                        v41 = v2;
                        v23 = v31;
                        if (is_utags_ext_locked_constprop_30(0, (int32_t)"lock", v7, g44) == 0) {
                            // 0x8f629a80
                            if (__utags_protect(1, (int32_t)"lock", v7, g44, v1, 0, v32, v31) == 0) {
                                // 0x8f629aa8
                                if (__utags_flush(1, (int32_t)"lock", v7, g44, v1, 0, v32, v31) == 0) {
                                    // 0x8f629ab8
                                    v10 = get_utags_name(1, (int32_t)"lock", v7, g44);
                                    v37 = v2;
                                    v12 = v31;
                                    // branch -> 0x8f62a274
                                    // 0x8f62a274
                                    fboot_info((int32_t)"INFO", (int32_t)"utags [%s] locked", v10, g44, (int32_t)v37, 0, v32, v12, str6, 0, 0);
                                    v75 = v37;
                                    v74 = v12;
                                    // branch -> 0x8f62a278
                                    goto lab_0x8f62a278_2;
                                }
                            }
                            // 0x8f629a90
                            v11 = get_utags_name(1, (int32_t)"lock", v7, g44);
                            v39 = v2;
                            v15 = v31;
                            // branch -> 0x8f62a28c
                            // 0x8f62a28c
                            fboot_info((int32_t)"INFO", (int32_t)"failed to lock [%s] utags", v11, g44, (int32_t)v39, 0, v32, v15, str6, 0, 0);
                            v41 = v39;
                            v23 = v15;
                            // branch -> 0x8f62a550
                            goto lab_0x8f62a550_2;
                        }
                      lab_0x8f62a550_4:
                        // 0x8f62a550
                        result = 3;
                        v42 = v41;
                        v22 = v23;
                        // branch -> 0x8f62a554
                        goto lab_0x8f62a554_13;
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
            }
            list_existing_utags_constprop_34(v70, v28, v7, g44, v1, 0, v32, v31);
            list_existing_utags_constprop_34(v70, v28, v7, g44, v1, 0, v32, v31);
            // branch -> 0x8f62a554
        }
        // Detected a possible infinite recursion (goto support failed); quitting...
    }
    // Detected a possible infinite recursion (goto support failed); quitting...
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// void free(void * ptr);
// void * malloc(size_t size);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// char * strchr(char * s, int c);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strstr(char * haystack, const char * needle);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 30
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:25:51

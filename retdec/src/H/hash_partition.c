//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------------ Structures ------------------------

struct _TYPEDEF_lldiv_t {
    int64_t e0;
    int64_t e1;
};

// ------------------- Function Prototypes --------------------

int32_t config_cmd_allowed(char * a1, int32_t a2);
int32_t confirm_unlock(int32_t a1, int32_t a2);
int32_t handle_fboot_oem_command_lock(int32_t a1, int32_t a2);
int32_t hash_partition(int32_t a1, int32_t a2, int32_t a3);
int32_t list_partition(int32_t a1);
int32_t list_utag(char * a1);
int32_t oem_blankflash(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t oem_partition(int32_t a1, int32_t a2);
int32_t oem_partitions(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_ramdump_usage(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_show_screen(int32_t a1, int32_t a2);
int32_t send_emmc_data(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t test_bool(char * str, int32_t a2, int32_t a3);
int32_t type_atoi_9(char * str, int32_t a2);
int32_t type_itoa_8(int32_t a1, int32_t a2);
int32_t unset_utag(int32_t a1, int32_t a2, int32_t a3);
int32_t validate_device(int32_t a1, char * a2);

// --------------------- Global Variables ---------------------

int32_t g7 = 0; // R1
int32_t g8 = 0; // R2
int32_t g9 = 0; // R3
int32_t g10 = 0; // R4
int32_t g11 = 0; // R5
int32_t g12 = 0; // R6
int32_t g1 = -0x16d2bc09; // 0x8f638ab0
char * g2[6] = {
    "fsg-id",
    "battery",
    "carrier",
    "bootmode",
    "enable_dump_gpt",
    "num-sims"
}; // 0x8f688974
int32_t g3 = 0x746e6300; // 0x8f6a4e20
int64_t g4 = 0; // 0x8f7112f4
int32_t g5 = 0; // 0x8f711514
char * g6; // 0x8f711530

// ------------------------ Functions -------------------------

// Address range: 0x8f625e1c - 0x8f626143
int32_t hash_partition(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1 = a2; // R1
    int32_t v2 = a3; // R2
    int32_t v3 = *(int32_t *)(a2 + 4); // 0x8f625e2c
    int32_t v4 = v3; // R8
    int32_t v5 = a2; // R5
    int32_t v6 = 0; // R10
    int32_t v7 = g4;
    int32_t v8 = v7; // R3
    int32_t v9;
    int32_t v10;
    int32_t v11 = partition_get_index(v3, a2, a3, v7, v10, v9); // 0x8f625e48
    int32_t v12 = v6; // 0x8f625e50
    int32_t v13 = v12;
    int32_t v14 = v12;
    int32_t v15 = v11;
    int32_t v16; // 0x8f6260b419
    int32_t v17; // 0x8f6260b421
    int32_t v18; // 0x8f6260b410
    int32_t v19; // 0x8f6260b48
    int32_t v20; // 0x8f6260b411
    int32_t v21; // 0x8f6260b413
    int32_t v22; // 0x8f6260b414
    int32_t v23; // 0x8f6260b416
    int32_t v24; // 0x8f625ecc_0
    int32_t v25; // 0x8f625fd8_0
    int32_t v26; // 0x8f62606c_0
    int32_t v27; // 0x8f625ed0
    char * mem; // 0x8f625f94
    int32_t v28; // R6
    int32_t v29; // R7
    int32_t v30; // R9
    int32_t v31;
    int32_t v32;
    int32_t v33;
    int32_t v34;
    bool v35; // 0x8f625f34
    bool v36; // 0x8f626030
    int32_t v37; // 0x8f6260f4
    int32_t v38; // 0x8f625f0c
    int32_t v39; // 0x8f625ff826
    int32_t v40; // 0x8f625f0c
    int32_t v41; // 0x8f625f1c
    int32_t v42; // 0x8f625ff824
    bool v43; // 0x8f626030
    int32_t v44; // 0x8f625f6c
    int32_t v45; // 0x8f626008
    int32_t v46; // 0x8f626028
    bool v47; // 0x8f625f34
    uint32_t v48; // 0x8f625ef4
    int32_t v49; // 0x8f625ef8
    int32_t v50; // 0x8f625efc
    int32_t v51; // 0x8f625f7c
    uint32_t v52; // 0x8f625f84
    int32_t v53; // 0x8f625f1c
    uint32_t v54; // 0x8f625f24
    int32_t v55; // 0x8f625f8c
    int32_t v56; // 0x8f625f7c
    uint32_t v57; // 0x8f625f28
    int32_t v58; // 0x8f625f20
    if (a1 < 3) {
        // 0x8f625e9c
        v28 = v12;
        v29 = v12;
        a1 = v12;
        v5 = v12;
        // branch -> 0x8f625eac
        // 0x8f625eac
        if (is_validation_enabled((char *)v11, v1, v2, v8) != 0) {
            // after_if_8f625eb8_0.dec_label_pc_8f625f40_crit_edge
            // branch -> 0x8f625f40
            // 0x8f625f40
            fboot_info((int32_t)"INFO", (int32_t)"Command restricted!", v2, v8, v10, v9, v33, v32, 0, v15, v13);
            v17 = v10;
            v23 = v32;
            v21 = v33;
            v18 = v9;
            // branch -> 0x8f6260c4
            // 0x8f6260c4
            if (v7 != (int32_t)g4) {
                goto lab_0x8f6260d8_20;
            }
            // 0x8f626104
            return 3;
        }
        // 0x8f625ec0
        v24 = &v14;
        v27 = ptn_stat(v4, (int32_t)&v15, (int32_t)&v13, v24, v10, v9, v33, v32, 0, v15, v13, v12, v14, v12, 0, v31, 0, 0);
        if (v27 == 0) {
            // 0x8f625edc
            // branch -> 0x8f625ee8
            // 0x8f625ee8
            fboot_info((int32_t)"INFO", (int32_t)"partition: %s not found", v4, v24, v10, v9, v33, v32, 0, v15, v13);
            v17 = v10;
            v23 = v32;
            v21 = v33;
            v18 = v9;
            // branch -> 0x8f6260c4
        } else {
            // 0x8f625ef4
            v48 = v14;
            v49 = v29;
            if (v12 == v49) {
                // if_8f625efc_0_true
                v50 = v28;
                if (v50 < v48) {
                    v41 = v50;
                    // 0x8f625f0c
                    v40 = v5;
                    v38 = a1;
                    v56 = v40;
                    v51 = v38;
                    if ((v38 || v40) == 0) {
                        // 0x8f625f14
                        v53 = v48 - v41;
                        a1 = v53;
                        v58 = (int32_t)(v48 < v41) + v12 - v49;
                        v5 = v58;
                        v56 = v58;
                        v51 = v53;
                        // branch -> 0x8f625f24
                    }
                    // 0x8f625f24
                    v54 = v51 + v41;
                    v57 = v56 + v49 + (int32_t)(v54 < v51);
                    v47 = false;
                    v35 = v57 >= v12;
                    if (v57 == v12) {
                        // if_8f625f30_0_true
                        v47 = v54 == v48;
                        v35 = v54 >= v48;
                        // branch -> after_if_8f625f30_0
                    }
                    // after_if_8f625f30_0
                    if (v47 || v35 ^ true) {
                        // 0x8f625f48
                        v8 = 0;
                        if ((v41 & (v48 & -0x10000 || 511)) == 0) {
                            // 0x8f625f6c
                            v44 = v4;
                            v2 = v44;
                            fboot_info((int32_t)"INFO", (int32_t)"%s: offset=0x%llx, size=0x%llx", v44, 0, v41, v49, v51, v56, 0, v15, v13);
                            v52 = v13;
                            v55 = v28 + v52;
                            v4 = v55;
                            v30 = v29 + v12 + (int32_t)(v55 < v52);
                            mem = malloc(0x20000);
                            v6 = (int32_t)mem;
                            if (mem == NULL) {
                                // 0x8f625fa0
                                print_log(-1, (int32_t)"Error: out of memory\n", v2, v8, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                v17 = v41;
                                v23 = v56;
                                v21 = v51;
                                v18 = v49;
                                // branch -> 0x8f6260c4
                                // 0x8f6260c4
                                if (v7 != (int32_t)g4) {
                                    goto lab_0x8f6260d8_20;
                                }
                                // 0x8f626104
                                return 3;
                            }
                            // 0x8f625fb0
                            if (a3 == 0) {
                                // 0x8f625fb8
                                md5_init((int32_t)&v31, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8);
                                // branch -> 0x8f625ff8
                            } else {
                                // 0x8f625fc4
                                SecHashInit(256, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8, v41, v49, v51);
                                // branch -> 0x8f625ff8
                            }
                            // 0x8f625ff8
                            v42 = v5;
                            v39 = a1;
                            if ((v39 || v42) == 0) {
                                // 0x8f626068
                                v26 = &v34;
                                v5 = v26;
                                if (a3 == 0) {
                                    // 0x8f626074
                                    md5_finish((int32_t)&v31, v26, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                    // branch -> 0x8f626090
                                } else {
                                    // 0x8f626084
                                    SecHashFinal(v26, 32, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12);
                                    // branch -> 0x8f626090
                                }
                                // 0x8f626090
                                a1 = 0;
                                v37 = 0;
                                v16 = v41;
                                v22 = v56;
                                v20 = v51;
                                v19 = v49;
                                // branch -> 0x8f626094
                                // 0x8f626094
                                if (a3 == 0) {
                                    goto lab_0x8f6260f4_9;
                                }
                                goto lab_0x8f62609c_9;
                            } else {
                                // 0x8f626000
                                v25 = &v31;
                                v45 = v39;
                                v46 = v42;
                                // branch -> 0x8f626000
                                while (true) {
                                    // 0x8f626000
                                    if (v46 == 0) {
                                        goto lab_if_8f626004_0_true_3;
                                    }
                                    v43 = false;
                                    v36 = true;
                                    goto lab_after_if_8f626004_0_3;
                                }
                            }
                        } else {
                            // if_8f625f5c_0_true
                            // branch -> 0x8f625ee8
                            // 0x8f625ee8
                            fboot_info((int32_t)"INFO", (int32_t)"Offset not aligned on %d", 512, 0, v10, v9, v33, v32, 0, v15, v13);
                            v17 = v10;
                            v23 = v32;
                            v21 = v33;
                            v18 = v9;
                            // branch -> 0x8f6260c4
                        }
                        // 0x8f6260c4
                        if (v7 != (int32_t)g4) {
                            goto lab_0x8f6260d8_20;
                        }
                        // 0x8f626104
                        return 3;
                    }
                    // 0x8f625f38
                    // branch -> 0x8f625f40
                    // 0x8f625f40
                    fboot_info((int32_t)"INFO", (int32_t)"offset+size out of range", v48, v12, v10, v9, v33, v32, 0, v15, v13);
                    v17 = v10;
                    v23 = v32;
                    v21 = v33;
                    v18 = v9;
                    // branch -> 0x8f6260c4
                    // 0x8f6260c4
                    if (v7 != (int32_t)g4) {
                        goto lab_0x8f6260d8_20;
                    }
                    // 0x8f626104
                    return 3;
                }
            } else {
                // after_if_8f625efc_0
                if (v12 > v49) {
                    // after_if_8f625efc_0.dec_label_pc_8f625f0c_crit_edge
                    v41 = v28;
                    // branch -> 0x8f625f0c
                    // 0x8f625f0c
                    v40 = v5;
                    v38 = a1;
                    v56 = v40;
                    v51 = v38;
                    if ((v38 || v40) == 0) {
                        // 0x8f625f14
                        v53 = v48 - v41;
                        a1 = v53;
                        v58 = (int32_t)(v48 < v41) + v12 - v49;
                        v5 = v58;
                        v56 = v58;
                        v51 = v53;
                        // branch -> 0x8f625f24
                    }
                    // 0x8f625f24
                    v54 = v51 + v41;
                    v57 = v56 + v49 + (int32_t)(v54 < v51);
                    v47 = false;
                    v35 = v57 >= v12;
                    if (v57 == v12) {
                        // if_8f625f30_0_true
                        v47 = v54 == v48;
                        v35 = v54 >= v48;
                        // branch -> after_if_8f625f30_0
                    }
                    // after_if_8f625f30_0
                    if (v47 || v35 ^ true) {
                        // 0x8f625f48
                        v8 = 0;
                        if ((v41 & (v48 & -0x10000 || 511)) == 0) {
                            // 0x8f625f6c
                            v44 = v4;
                            v2 = v44;
                            fboot_info((int32_t)"INFO", (int32_t)"%s: offset=0x%llx, size=0x%llx", v44, 0, v41, v49, v51, v56, 0, v15, v13);
                            v52 = v13;
                            v55 = v28 + v52;
                            v4 = v55;
                            v30 = v29 + v12 + (int32_t)(v55 < v52);
                            mem = malloc(0x20000);
                            v6 = (int32_t)mem;
                            if (mem == NULL) {
                                // 0x8f625fa0
                                print_log(-1, (int32_t)"Error: out of memory\n", v2, v8, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                v17 = v41;
                                v23 = v56;
                                v21 = v51;
                                v18 = v49;
                                // branch -> 0x8f6260c4
                                // 0x8f6260c4
                                if (v7 != (int32_t)g4) {
                                    goto lab_0x8f6260d8_20;
                                }
                                // 0x8f626104
                                return 3;
                            }
                            // 0x8f625fb0
                            if (a3 == 0) {
                                // 0x8f625fb8
                                md5_init((int32_t)&v31, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8);
                                // branch -> 0x8f625ff8
                            } else {
                                // 0x8f625fc4
                                SecHashInit(256, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8, v41, v49, v51);
                                // branch -> 0x8f625ff8
                            }
                            // 0x8f625ff8
                            v42 = v5;
                            v39 = a1;
                            if ((v39 || v42) == 0) {
                                // 0x8f626068
                                v26 = &v34;
                                v5 = v26;
                                if (a3 == 0) {
                                    // 0x8f626074
                                    md5_finish((int32_t)&v31, v26, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                    // branch -> 0x8f626090
                                } else {
                                    // 0x8f626084
                                    SecHashFinal(v26, 32, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12);
                                    // branch -> 0x8f626090
                                }
                                // 0x8f626090
                                a1 = 0;
                                v37 = 0;
                                v16 = v41;
                                v22 = v56;
                                v20 = v51;
                                v19 = v49;
                                // branch -> 0x8f626094
                                // 0x8f626094
                                if (a3 == 0) {
                                    goto lab_0x8f6260f4_9;
                                }
                                goto lab_0x8f62609c_9;
                            } else {
                                // 0x8f626000
                                v25 = &v31;
                                v45 = v39;
                                v46 = v42;
                                // branch -> 0x8f626000
                                while (true) {
                                    // 0x8f626000
                                    if (v46 == 0) {
                                        goto lab_if_8f626004_0_true_3;
                                    }
                                    v43 = false;
                                    v36 = true;
                                    goto lab_after_if_8f626004_0_3;
                                }
                            }
                        } else {
                            // if_8f625f5c_0_true
                            // branch -> 0x8f625ee8
                            // 0x8f625ee8
                            fboot_info((int32_t)"INFO", (int32_t)"Offset not aligned on %d", 512, 0, v10, v9, v33, v32, 0, v15, v13);
                            v17 = v10;
                            v23 = v32;
                            v21 = v33;
                            v18 = v9;
                            // branch -> 0x8f6260c4
                        }
                        // 0x8f6260c4
                        if (v7 != (int32_t)g4) {
                            goto lab_0x8f6260d8_20;
                        }
                        // 0x8f626104
                        return 3;
                    }
                    // 0x8f625f38
                    // branch -> 0x8f625f40
                    // 0x8f625f40
                    fboot_info((int32_t)"INFO", (int32_t)"offset+size out of range", v48, v12, v10, v9, v33, v32, 0, v15, v13);
                    v17 = v10;
                    v23 = v32;
                    v21 = v33;
                    v18 = v9;
                    // branch -> 0x8f6260c4
                    // 0x8f6260c4
                    if (v7 != (int32_t)g4) {
                        goto lab_0x8f6260d8_20;
                    }
                    // 0x8f626104
                    return 3;
                }
            }
            // after_if_8f625f04_0
            // branch -> 0x8f625f40
            // 0x8f625f40
            fboot_info((int32_t)"INFO", (int32_t)"offset out of range", v48, v12, v10, v9, v33, v32, 0, v15, v13);
            v17 = v10;
            v23 = v32;
            v21 = v33;
            v18 = v9;
            // branch -> 0x8f6260c4
        }
        // 0x8f6260c4
        if (v7 != (int32_t)g4) {
            goto lab_0x8f6260d8_20;
        }
        // 0x8f626104
        return 3;
    }
    int32_t v59 = *(int32_t *)(v5 + 8); // 0x8f625e68
    int32_t v60 = atoull(v59, v1, v2, v8, v10, v9, v33, v32, 0, v11, v12, v12, v12, v12); // 0x8f625e6c
    int32_t v61; // 0x8f625eac
    if (a1 == 3) {
        int32_t v62 = v6; // 0x8f625e74
        a1 = v62;
        v5 = v62;
        v28 = v60;
        v29 = v1;
        v61 = v60;
        // branch -> 0x8f625eac
    } else {
        // 0x8f625e88
        v28 = v60;
        v29 = v1;
        int32_t v63 = *(int32_t *)(v5 + 12); // 0x8f625e88
        int32_t v64 = atoull(v63, v1, v2, v8, v10, v9, v33, v32, 0, v15, v13, v12, v14, v12); // 0x8f625e8c
        a1 = v64;
        v5 = v1;
        v61 = v64;
        // branch -> 0x8f625eac
    }
    // 0x8f625eac
    if (is_validation_enabled((char *)v61, v1, v2, v8) != 0) {
        // after_if_8f625eb8_0.dec_label_pc_8f625f40_crit_edge
        // branch -> 0x8f625f40
        // 0x8f625f40
        fboot_info((int32_t)"INFO", (int32_t)"Command restricted!", v2, v8, v10, v9, v33, v32, 0, v15, v13);
        v17 = v10;
        v23 = v32;
        v21 = v33;
        v18 = v9;
        // branch -> 0x8f6260c4
        // 0x8f6260c4
        if (v7 != (int32_t)g4) {
            goto lab_0x8f6260d8_20;
        }
        // 0x8f626104
        return 3;
    }
    // 0x8f625ec0
    v24 = &v14;
    v27 = ptn_stat(v4, (int32_t)&v15, (int32_t)&v13, v24, v10, v9, v33, v32, 0, v15, v13, v12, v14, v12, 0, v31, 0, 0);
    if (v27 == 0) {
        // 0x8f625edc
        // branch -> 0x8f625ee8
        // 0x8f625ee8
        fboot_info((int32_t)"INFO", (int32_t)"partition: %s not found", v4, v24, v10, v9, v33, v32, 0, v15, v13);
        v17 = v10;
        v23 = v32;
        v21 = v33;
        v18 = v9;
        // branch -> 0x8f6260c4
    } else {
        // 0x8f625ef4
        v48 = v14;
        v49 = v29;
        if (v12 == v49) {
            // if_8f625efc_0_true
            v50 = v28;
            if (v50 < v48) {
                v41 = v50;
                // 0x8f625f0c
                v40 = v5;
                v38 = a1;
                v56 = v40;
                v51 = v38;
                if ((v38 || v40) == 0) {
                    // 0x8f625f14
                    v53 = v48 - v41;
                    a1 = v53;
                    v58 = (int32_t)(v48 < v41) + v12 - v49;
                    v5 = v58;
                    v56 = v58;
                    v51 = v53;
                    // branch -> 0x8f625f24
                }
                // 0x8f625f24
                v54 = v51 + v41;
                v57 = v56 + v49 + (int32_t)(v54 < v51);
                v47 = false;
                v35 = v57 >= v12;
                if (v57 == v12) {
                    // if_8f625f30_0_true
                    v47 = v54 == v48;
                    v35 = v54 >= v48;
                    // branch -> after_if_8f625f30_0
                }
                // after_if_8f625f30_0
                if (v47 || v35 ^ true) {
                    // 0x8f625f48
                    v8 = 0;
                    if ((v41 & (v48 & -0x10000 || 511)) == 0) {
                        // 0x8f625f6c
                        v44 = v4;
                        v2 = v44;
                        fboot_info((int32_t)"INFO", (int32_t)"%s: offset=0x%llx, size=0x%llx", v44, 0, v41, v49, v51, v56, 0, v15, v13);
                        v52 = v13;
                        v55 = v28 + v52;
                        v4 = v55;
                        v30 = v29 + v12 + (int32_t)(v55 < v52);
                        mem = malloc(0x20000);
                        v6 = (int32_t)mem;
                        int32_t v65; // 0x8f6260b420
                        int32_t v66; // 0x8f6260b49
                        int32_t v67; // 0x8f6260b412
                        int32_t v68; // 0x8f6260b415
                        int32_t result; // 0x8f626108_2
                        int32_t v69; // 0x8f6260e8
                        if (mem == NULL) {
                            // 0x8f625fa0
                            print_log(-1, (int32_t)"Error: out of memory\n", v2, v8, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                            v17 = v41;
                            v23 = v56;
                            v21 = v51;
                            v18 = v49;
                            result = 3;
                            // branch -> 0x8f6260c4
                          lab_0x8f6260c4_2:
                            // 0x8f6260c4
                            if (v7 == (int32_t)g4) {
                                // 0x8f626104
                                return result;
                            }
                          lab_0x8f6260d8_20:
                            // 0x8f6260d8
                            __stack_chk_fail();
                            v69 = a1;
                            v65 = v17;
                            v68 = v23;
                            v67 = v21;
                            v66 = v18;
                            // branch -> 0x8f6260dc
                          lab_0x8f6260dc_2:;
                            char v70 = *(char *)(v5 + v69); // 0x8f6260e0
                            a1 = v69 + 1;
                            sprintf((char *)(v6 + 2 * v69), "%02x", (int32_t)v70);
                            v37 = a1;
                            v16 = v65;
                            v22 = v68;
                            v20 = v67;
                            v19 = v66;
                            // branch -> 0x8f626094
                        } else {
                            // 0x8f625fb0
                            if (a3 == 0) {
                                // 0x8f625fb8
                                md5_init((int32_t)&v31, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8);
                                // branch -> 0x8f625ff8
                            } else {
                                // 0x8f625fc4
                                SecHashInit(256, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8, v41, v49, v51);
                                // branch -> 0x8f625ff8
                            }
                            // 0x8f625ff8
                            v42 = v5;
                            v39 = a1;
                            if ((v39 || v42) == 0) {
                                // 0x8f626068
                                v26 = &v34;
                                v5 = v26;
                                if (a3 == 0) {
                                    // 0x8f626074
                                    md5_finish((int32_t)&v31, v26, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                    // branch -> 0x8f626090
                                } else {
                                    // 0x8f626084
                                    SecHashFinal(v26, 32, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12);
                                    // branch -> 0x8f626090
                                }
                                // 0x8f626090
                                a1 = 0;
                                v37 = 0;
                                v16 = v41;
                                v22 = v56;
                                v20 = v51;
                                v19 = v49;
                                // branch -> 0x8f626094
                                // 0x8f626094
                                int32_t v71;
                                if (a3 == 0) {
                                  lab_0x8f6260f4_9:
                                    // 0x8f6260f4
                                    if (v37 < 16) {
                                        v69 = v37;
                                        v65 = v16;
                                        v68 = v22;
                                        v67 = v20;
                                        v66 = v19;
                                        goto lab_0x8f6260dc_2;
                                    }
                                    v71 = (int32_t)"md5";
                                  lab_0x8f6260a8:
                                    // 0x8f6260a8
                                    fboot_info((int32_t)"INFO", (int32_t)"%ssum: %s", v71, v6, v16, v19, v20, v22, 0, v15, v13);
                                    free((char *)v6);
                                    v17 = v16;
                                    v23 = v22;
                                    v21 = v20;
                                    v18 = v19;
                                    result = 1;
                                    // branch -> 0x8f6260c4
                                    goto lab_0x8f6260c4_2;
                                } else {
                                  lab_0x8f62609c_9:
                                    // 0x8f62609c
                                    if (v37 == 32) {
                                        v71 = (int32_t)"sha256";
                                        goto lab_0x8f6260a8;
                                    }
                                    v69 = v37;
                                    v65 = v16;
                                    v68 = v22;
                                    v67 = v20;
                                    v66 = v19;
                                    goto lab_0x8f6260dc_2;
                                }
                            } else {
                                // 0x8f626000
                                v25 = &v31;
                                v45 = v39;
                                v46 = v42;
                                // branch -> 0x8f626000
                                while (true) {
                                    // 0x8f626000
                                    v43 = false;
                                    v36 = true;
                                    if (v46 == 0) {
                                      lab_if_8f626004_0_true_3:
                                        // if_8f626004_0_true
                                        v43 = v45 == 0x20000;
                                        v36 = v45 > 0x1ffff;
                                        // branch -> after_if_8f626004_0
                                    }
                                  lab_after_if_8f626004_0_3:
                                    // after_if_8f626004_0
                                    v28 = v45;
                                    int32_t v72; // 0x8f62602c67
                                    if (v36 && v43 ^ true) {
                                        // if_8f626030_0_true
                                        v28 = 0x20000;
                                        v2 = v6;
                                        v29 = 0;
                                        v72 = 0x20000;
                                        // branch -> after_if_8f626030_0
                                    } else {
                                        // after_if_8f626014_0.thread69
                                        v2 = v6;
                                        v29 = v46;
                                        v72 = v45 + 511 & -512;
                                        // branch -> after_if_8f626030_0
                                    }
                                    // after_if_8f626030_0
                                    if (mmc_read(v4, v30, v6, v72, v41, v49, v51, v56, 0, v15, v13, v12, v14) != 0) {
                                        // 0x8f626040
                                        fboot_info((int32_t)"INFO", (int32_t)"Error reading partition", v2, v72, v41, v49, v51, v56, 0, v15, v13);
                                        free((char *)v6);
                                        v17 = v41;
                                        v23 = v56;
                                        v21 = v51;
                                        v18 = v49;
                                        // branch -> 0x8f6260c4
                                        // 0x8f6260c4
                                        if (v7 != (int32_t)g4) {
                                            goto lab_0x8f6260d8_20;
                                        }
                                        // 0x8f626104
                                        return 3;
                                    }
                                    // 0x8f625fd0
                                    if (a3 == 0) {
                                        int32_t v73 = v28; // 0x8f625fe0
                                        v2 = v73;
                                        md5_append(v25, v6, v73, v72, v41, v49, v51, v56, 0, v15, v13, v12, v14, v12);
                                        // branch -> 0x8f625fe8
                                    } else {
                                        // 0x8f626058
                                        SecHashUpdate(v6, v28, v2, v72);
                                        // branch -> 0x8f625fe8
                                    }
                                    uint32_t v74 = v28; // 0x8f625fe8
                                    uint32_t v75 = v4; // 0x8f625fe8
                                    int32_t v76 = v75 + v74; // 0x8f625fe8
                                    v4 = v76;
                                    int32_t v77 = v29; // 0x8f625fec
                                    v30 = v30 + v77 + (int32_t)(v76 < v75);
                                    uint32_t v78 = a1; // 0x8f625ff0
                                    int32_t v79 = v78 - v74; // 0x8f625ff0
                                    a1 = v79;
                                    int32_t v80 = v5 - v77 + (int32_t)(v78 < v74); // 0x8f625ff4
                                    v5 = v80;
                                    if ((v80 || v79) == 0) {
                                        // break -> 0x8f626068
                                        break;
                                    }
                                    v45 = v79;
                                    v46 = v80;
                                    // continue -> 0x8f626000
                                    continue;
                                }
                                // 0x8f626068
                                v26 = &v34;
                                v5 = v26;
                                if (a3 == 0) {
                                    // 0x8f626074
                                    md5_finish((int32_t)&v31, v26, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                    // branch -> 0x8f626090
                                } else {
                                    // 0x8f626084
                                    SecHashFinal(v26, 32, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12);
                                    // branch -> 0x8f626090
                                }
                                // 0x8f626090
                                a1 = 0;
                                v37 = 0;
                                v16 = v41;
                                v22 = v56;
                                v20 = v51;
                                v19 = v49;
                                // branch -> 0x8f626094
                                // 0x8f626094
                                if (a3 == 0) {
                                    goto lab_0x8f6260f4_9;
                                }
                                goto lab_0x8f62609c_9;
                            }
                        }
                        // 0x8f626094
                        if (a3 == 0) {
                            goto lab_0x8f6260f4_9;
                        }
                        goto lab_0x8f62609c_9;
                    } else {
                        // if_8f625f5c_0_true
                        // branch -> 0x8f625ee8
                        // 0x8f625ee8
                        fboot_info((int32_t)"INFO", (int32_t)"Offset not aligned on %d", 512, 0, v10, v9, v33, v32, 0, v15, v13);
                        v17 = v10;
                        v23 = v32;
                        v21 = v33;
                        v18 = v9;
                        // branch -> 0x8f6260c4
                    }
                    // 0x8f6260c4
                    if (v7 != (int32_t)g4) {
                        goto lab_0x8f6260d8_20;
                    }
                    // 0x8f626104
                    return 3;
                }
                // 0x8f625f38
                // branch -> 0x8f625f40
                // 0x8f625f40
                fboot_info((int32_t)"INFO", (int32_t)"offset+size out of range", v48, v12, v10, v9, v33, v32, 0, v15, v13);
                v17 = v10;
                v23 = v32;
                v21 = v33;
                v18 = v9;
                // branch -> 0x8f6260c4
                // 0x8f6260c4
                if (v7 != (int32_t)g4) {
                    goto lab_0x8f6260d8_20;
                }
                // 0x8f626104
                return 3;
            }
        } else {
            // after_if_8f625efc_0
            if (v12 > v49) {
                // after_if_8f625efc_0.dec_label_pc_8f625f0c_crit_edge
                v41 = v28;
                // branch -> 0x8f625f0c
                // 0x8f625f0c
                v40 = v5;
                v38 = a1;
                v56 = v40;
                v51 = v38;
                if ((v38 || v40) == 0) {
                    // 0x8f625f14
                    v53 = v48 - v41;
                    a1 = v53;
                    v58 = (int32_t)(v48 < v41) + v12 - v49;
                    v5 = v58;
                    v56 = v58;
                    v51 = v53;
                    // branch -> 0x8f625f24
                }
                // 0x8f625f24
                v54 = v51 + v41;
                v57 = v56 + v49 + (int32_t)(v54 < v51);
                v47 = false;
                v35 = v57 >= v12;
                if (v57 == v12) {
                    // if_8f625f30_0_true
                    v47 = v54 == v48;
                    v35 = v54 >= v48;
                    // branch -> after_if_8f625f30_0
                }
                // after_if_8f625f30_0
                if (v47 || v35 ^ true) {
                    // 0x8f625f48
                    v8 = 0;
                    if ((v41 & (v48 & -0x10000 || 511)) == 0) {
                        // 0x8f625f6c
                        v44 = v4;
                        v2 = v44;
                        fboot_info((int32_t)"INFO", (int32_t)"%s: offset=0x%llx, size=0x%llx", v44, 0, v41, v49, v51, v56, 0, v15, v13);
                        v52 = v13;
                        v55 = v28 + v52;
                        v4 = v55;
                        v30 = v29 + v12 + (int32_t)(v55 < v52);
                        mem = malloc(0x20000);
                        v6 = (int32_t)mem;
                        if (mem == NULL) {
                            // 0x8f625fa0
                            print_log(-1, (int32_t)"Error: out of memory\n", v2, v8, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                            v17 = v41;
                            v23 = v56;
                            v21 = v51;
                            v18 = v49;
                            // branch -> 0x8f6260c4
                            // 0x8f6260c4
                            if (v7 != (int32_t)g4) {
                                goto lab_0x8f6260d8_20;
                            }
                            // 0x8f626104
                            return 3;
                        }
                        // 0x8f625fb0
                        if (a3 == 0) {
                            // 0x8f625fb8
                            md5_init((int32_t)&v31, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8);
                            // branch -> 0x8f625ff8
                        } else {
                            // 0x8f625fc4
                            SecHashInit(256, (int32_t)"%s: offset=0x%llx, size=0x%llx", v2, v8, v41, v49, v51);
                            // branch -> 0x8f625ff8
                        }
                        // 0x8f625ff8
                        v42 = v5;
                        v39 = a1;
                        if ((v39 || v42) == 0) {
                            // 0x8f626068
                            v26 = &v34;
                            v5 = v26;
                            if (a3 == 0) {
                                // 0x8f626074
                                md5_finish((int32_t)&v31, v26, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12, v14);
                                // branch -> 0x8f626090
                            } else {
                                // 0x8f626084
                                SecHashFinal(v26, 32, v2, 0, v41, v49, v51, v56, 0, v15, v13, v12);
                                // branch -> 0x8f626090
                            }
                            // 0x8f626090
                            a1 = 0;
                            v37 = 0;
                            v16 = v41;
                            v22 = v56;
                            v20 = v51;
                            v19 = v49;
                            // branch -> 0x8f626094
                            // 0x8f626094
                            if (a3 == 0) {
                                goto lab_0x8f6260f4_9;
                            }
                            goto lab_0x8f62609c_9;
                        } else {
                            // 0x8f626000
                            v25 = &v31;
                            v45 = v39;
                            v46 = v42;
                            // branch -> 0x8f626000
                            while (true) {
                                // 0x8f626000
                                if (v46 == 0) {
                                    goto lab_if_8f626004_0_true_3;
                                }
                                v43 = false;
                                v36 = true;
                                goto lab_after_if_8f626004_0_3;
                            }
                        }
                    } else {
                        // if_8f625f5c_0_true
                        // branch -> 0x8f625ee8
                        // 0x8f625ee8
                        fboot_info((int32_t)"INFO", (int32_t)"Offset not aligned on %d", 512, 0, v10, v9, v33, v32, 0, v15, v13);
                        v17 = v10;
                        v23 = v32;
                        v21 = v33;
                        v18 = v9;
                        // branch -> 0x8f6260c4
                    }
                    // 0x8f6260c4
                    if (v7 != (int32_t)g4) {
                        goto lab_0x8f6260d8_20;
                    }
                    // 0x8f626104
                    return 3;
                }
                // 0x8f625f38
                // branch -> 0x8f625f40
                // 0x8f625f40
                fboot_info((int32_t)"INFO", (int32_t)"offset+size out of range", v48, v12, v10, v9, v33, v32, 0, v15, v13);
                v17 = v10;
                v23 = v32;
                v21 = v33;
                v18 = v9;
                // branch -> 0x8f6260c4
                // 0x8f6260c4
                if (v7 != (int32_t)g4) {
                    goto lab_0x8f6260d8_20;
                }
                // 0x8f626104
                return 3;
            }
        }
        // after_if_8f625f04_0
        // branch -> 0x8f625f40
        // 0x8f625f40
        fboot_info((int32_t)"INFO", (int32_t)"offset out of range", v48, v12, v10, v9, v33, v32, 0, v15, v13);
        v17 = v10;
        v23 = v32;
        v21 = v33;
        v18 = v9;
        // branch -> 0x8f6260c4
    }
    // 0x8f6260c4
    if (v7 != (int32_t)g4) {
        goto lab_0x8f6260d8_20;
    }
    // 0x8f626104
    return 3;
}

// --------------- Statically Linked Functions ----------------

// lldiv_t __aeabi_ldivmod(long long n, long long d);
// void __stack_chk_fail(void);
// void free(void * ptr);
// void * malloc(size_t size);
// void * memalign(size_t alignment, size_t size);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// int sprintf(char * restrict s, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);
// int strncasecmp(const char * s1, const char * s2, size_t n);
// int strncmp(const char * s1, const char * s2, size_t n);
// size_t strnlen(const char * string, size_t maxlen);
// char * strrchr(char * s, int c);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 17
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:38:38

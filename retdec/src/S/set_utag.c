//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t __utag_gets(char * a1, char * a2, int32_t a3, int32_t a4);
int32_t bin2hex(int32_t a1, char * a2, int32_t a3);
int32_t handle_fboot_command_oem(int32_t a1, int32_t a2);
int32_t handle_fboot_oem_command_write_protect_test(int32_t a1, int32_t a2);
int32_t list_existing_utags_cb(int32_t a1, char * a2, int32_t * a3);
int32_t list_str_utag_short(int32_t a1, int32_t a2);
int32_t list_utags_cb(int32_t a1, char * a2, int32_t * a3);
int32_t load_string_utag_constprop_29(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_boot_mode_clear(char * a1);
int32_t oem_bp_tools_off(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_bp_tools_on(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_fb_mode_clear(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_fb_mode_set(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_off_mode_charge(int32_t a1, int32_t a2);
int32_t oem_off_mode_charge_usage(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_qcom_off(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_qcom_on(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_utag(int32_t a1, int32_t * a2);
int32_t set_utag(int32_t a1, int32_t * a2, int32_t a3, int32_t a4);
int32_t validate_utag_range(char * a1, int32_t a2, char * str);

// --------------------- Global Variables ---------------------

bool g15 = false; // LR
int32_t g16 = 0; // R0
int32_t g17 = 0; // R1
int32_t g18 = 0; // R2
int32_t g19 = 0; // R3
int32_t g20 = 0; // R4
int32_t g21 = 0; // R5
int32_t g22 = 0; // R6
int32_t g23 = 0; // R7
int32_t g24 = 0; // R8
int32_t g25 = 0; // R9
int32_t g1 = -0x16d2bf8d; // 0x8f624998
int32_t g2 = -0x16d2bf10; // 0x8f6287bc
int32_t g3 = 0x7325002c; // 0x8f682749
int32_t g4 = 0x2020003a; // 0x8f686ac4
int32_t g5 = 0x402d2b00; // 0x8f686e33
char g6[2] = "/"; // 0x8f686fbc
char g7[2] = "0"; // 0x8f69c66f
char g8[2] = "1"; // 0x8f69c693
int32_t g9 = 0x746e6300; // 0x8f6a4e20
int32_t g10 = 0x70750020; // 0x8f6a4f1e
int32_t g11 = 0x10100; // 0x8f6a9f58
int32_t g12 = 0x10100; // 0x8f6a9f64
int32_t g13 = 0x7ffd14f4; // 0x8f6aa114
int32_t g14 = 0; // 0x8f7112f4

// ------------------------ Functions -------------------------

// Address range: 0x8f628a28 - 0x8f629093
int32_t set_utag(int32_t a1, int32_t * a2, int32_t a3, int32_t a4) {
    // 0x8f628a28
    int32_t v1;
    char * v2 = (char *)v1;
    int32_t v3 = (int32_t)a2;
    int32_t v4 = g20; // 0x8f628a28
    int32_t v5 = g22; // 0x8f628a28
    int32_t v6 = 32; // R2
    g20 = *(int32_t *)(v3 + 4);
    g22 = v3;
    int32_t str;
    int32_t v7 = &str; // 0x8f628a44_0
    int32_t v8 = g14;
    int32_t v9 = v8; // R3
    int32_t v10 = g15 ? -0x709d4b24 : 0; // 0x8f628a4c
    strlcpy(v7, *a2, 32, v8, v1);
    int32_t v11;
    int32_t v12;
    if (__utag_defined(0, v7, v6, v9, v1, 0, v12, v11, 0, str, 0) == 0) {
        // if_8f628a6c_0_true
        // branch -> 0x8f628aa4
        // 0x8f628aa4
        fboot_info((int32_t)"INFO", (int32_t)"no such utag", v6, v9, v1, 0, v12, v11, 0, str, 0);
        // branch -> 0x8f629028
        // 0x8f629028
        if (v8 != g14) {
            // 0x8f629038
            __stack_chk_fail();
            // branch -> 0x8f62903c
        }
        // 0x8f62903c
        g20 = v4;
        g22 = v5;
        return 3;
    }
    char * found_char_pos = strrchr((char *)&str, 58); // 0x8f628a80
    int32_t v13 = type_atoi_9((int32_t)(found_char_pos != NULL) + (int32_t)found_char_pos, 58, v6, v9, v1, 0); // 0x8f628a8c
    int32_t v14;
    int32_t v15; // 0x8f62902415
    int32_t v16; // 0x8f62902417
    int32_t v17; // 0x8f628b90_0
    int32_t v18; // 0x8f628c2c_0
    int32_t v19;
    int32_t v20; // 0x8f628c48_0
    int32_t v21; // 0x8f628cb0_0
    int32_t v22; // 0x8f628d44_0
    int32_t v23; // 0x8f628d54_0
    int32_t v24; // 0x8f628df4_0
    int32_t v25; // 0x8f628e94_0
    int32_t v26; // 0x8f628f2c_0
    int32_t v27; // 0x8f628f34_0
    int32_t v28; // 0x8f628f48_0
    int32_t v29; // 0x8f628fe4_0
    int32_t v30; // 0x8f628fec_0
    int32_t v31; // 0x8f628b20
    int32_t v32; // 0x8f628b74
    char * found_char_pos13; // 0x8f628ba8
    int32_t v33; // 0x8f628bb4
    char * found_char_pos14; // 0x8f628be8
    int32_t v34; // 0x8f628bf4
    int32_t v35; // 0x8f628c3c
    char * v36; // 0x8f628c98
    char * found_char_pos3; // 0x8f628cc8
    int32_t v37; // 0x8f628cd4
    char * found_char_pos4; // 0x8f628d08
    int32_t v38; // 0x8f628d14
    char * found_char_pos5; // 0x8f628d6c
    int32_t v39; // 0x8f628d78
    char * found_char_pos6; // 0x8f628dac
    int32_t v40; // 0x8f628db8
    char * found_char_pos9; // 0x8f628e0c
    int32_t v41; // 0x8f628e18
    char * found_char_pos10; // 0x8f628e4c
    int32_t v42; // 0x8f628e58
    char * found_char_pos7; // 0x8f628eac
    int32_t v43; // 0x8f628eb8
    char * found_char_pos8; // 0x8f628eec
    int32_t v44; // 0x8f628ef8
    int32_t v45; // 0x8f628f24
    char * found_char_pos11; // 0x8f628f60
    int32_t v46; // 0x8f628f6c
    char * found_char_pos12; // 0x8f628fa0
    int32_t v47; // 0x8f628fac
    int32_t v48; // 0x8f628fd8
    int32_t v49; // 0x8f629014
    int32_t v50; // R1
    int32_t str4;
    int32_t str3;
    int32_t v51;
    int32_t str2;
    int32_t str_as_l;
    int32_t str_as_ll;
    char * v52;
    int32_t v53;
    int32_t v54; // 0x8f628c14
    int32_t v55; // 0x8f628d34
    int32_t v56; // 0x8f628dd8
    int32_t v57; // 0x8f628e78
    int32_t v58; // 0x8f628f18
    int32_t v59; // 0x8f628fcc
    int32_t v60; // 0x8f628c80
    int32_t v61; // 0x8f628c44
    int32_t v62; // 0x8f628d3c
    int32_t v63; // 0x8f628c70
    int32_t v64; // 0x8f628fe4
    uint32_t v65; // 0x8f628f00
    uint32_t v66; // 0x8f628fb4
    switch (v13) {
        case 255: {
            // 0x8f628a9c
            // branch -> 0x8f628aa4
            break;
        }
        case 0: {
            int32_t v67 = test_bool(g20, 58, v6, v9, v1, 0, v12); // 0x8f628abc
            strlcat(v7, (int32_t)&g4, 31, v9, v1, 0, v12, v11, 0, str, 0, 0);
            v6 = 31;
            int32_t v68 = v67 < 0 ? (int32_t)"str" : (int32_t)"bool";
            strlcat(v7, v68, 31, v9, v1, 0, v12, v11, 0, str, 0, 0);
            char * found_char_pos2 = strrchr((char *)&str, 58); // 0x8f628af4
            int32_t v69 = type_atoi_9((int32_t)(found_char_pos2 != NULL) + (int32_t)found_char_pos2, 58, v6, v9, v1, 0); // 0x8f628b00
            if (v69 == 255) {
                // if_8f628b0c_0_true
                // branch -> 0x8f628aa4
                // 0x8f628aa4
                fboot_info((int32_t)"INFO", (int32_t)"name too long", v6, v9, v1, 0, v12, v11, 0, str, 0);
                // branch -> 0x8f629028
                // 0x8f629028
                if (v8 != g14) {
                    // 0x8f629038
                    __stack_chk_fail();
                    // branch -> 0x8f62903c
                }
                // 0x8f62903c
                g20 = v4;
                g22 = v5;
                return 3;
            }
            // 0x8f628b18
            v31 = __utag_is_protected(0, v7, v6, v9, v1, 0, v12, v11, 0, str);
            if (v31 != 0) {
                // 0x8f628b2c
                fboot_info((int32_t)"INFO", (int32_t)"utag is read-only!", v6, v9, v1, 0, v12, v11, 0, str, 0);
                // branch -> 0x8f628aa4
                // 0x8f628aa4
                fboot_info((int32_t)"INFO", (int32_t)"unprotect with 'fastboot oem config unprotect <name>'", v6, v9, v1, 0, v12, v11, 0, str, 0);
                // branch -> 0x8f629028
                // 0x8f629028
                if (v8 != g14) {
                    // 0x8f629038
                    __stack_chk_fail();
                    // branch -> 0x8f62903c
                }
                // 0x8f62903c
                g20 = v4;
                g22 = v5;
                return 3;
            }
            // 0x8f628b44
            int32_t v70; // 0x8f629024
            int32_t result;
            switch (v69) {
                default: {
                    // 0x8f628ff4
                    v50 = (int32_t)"ASSERT FAILED at (%s:%d): %s\n";
                    v6 = (int32_t)"app/mbm/fastboot_oem.c";
                    v9 = (int32_t)"((void *)0) == \"should not reach here\"" & -0x10000 | 653;
                    _panic(v10, (int32_t)"ASSERT FAILED at (%s:%d): %s\n", (int32_t)"app/mbm/fastboot_oem.c", (int32_t)"((void *)0) == \"should not reach here\"" & -0x10000 | 653, (int32_t)"((void *)0) == \"should not reach here\"", 0, v12);
                    v52 = "((void *)0) == \"should not reach here\"";
                    v15 = v11;
                    // branch -> 0x8f629010
                    // 0x8f629010
                    v53 = (int32_t)v52;
                    v49 = __utags_flush(0, v50, v6, v9, v53, 0, v12, v15);
                    result = 3;
                    if (v49 == 0) {
                        // 0x8f629020
                        v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                        result = v70;
                        // branch -> 0x8f629028
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
                case 1: {
                    // 0x8f628b70
                    v32 = test_bool(g20, v7, v6, v9, v1, 0, v12);
                    g20 = v32;
                    if (v32 < 0) {
                        // if_8f628b7c_0_true
                        // branch -> 0x8f628aa4
                        // 0x8f628aa4
                        fboot_info((int32_t)"INFO", (int32_t)"not a boolean value", v6, v9, v1, 0, v12, v11, 0, str, 0);
                        // branch -> 0x8f629028
                        // 0x8f629028
                        if (v8 != g14) {
                            // 0x8f629038
                            __stack_chk_fail();
                            // branch -> 0x8f62903c
                        }
                        // 0x8f62903c
                        g20 = v4;
                        g22 = v5;
                        return 3;
                    }
                    break;
                }
                case 2: {
                    // 0x8f628c44
                    v61 = g20;
                    v20 = &str2;
                    g20 = 2;
                    strlcpy(v20, v61, 128, v9, v1);
                    if (g20 < a1) {
                        while (true) {
                            // 0x8f628c60
                            strlcat(v20, (int32_t)&g10, 127, v9, v1, 0, v12, v11, 0, str, 0, 0);
                            v63 = *(int32_t *)(4 * g20 + g22);
                            strlcat(v20, v63, 127, v9, v1, 0, v12, v11, 0, str, 0, 0);
                            v60 = g20 + 1;
                            g20 = v60;
                            if (v60 >= a1) {
                                // break (via goto) -> 0x8f628c88
                                goto lab_0x8f628c88_2;
                            }
                            // continue -> 0x8f628c60
                        }
                    }
                    // 0x8f628c88
                    v50 = v7;
                    v6 = v20;
                    v36 = __utag_puts(0, v7, v20, v9, v1, 0, v12, v11, 0, str);
                    // branch -> 0x8f628c9c
                    // 0x8f628c9c
                    result = 3;
                    if ((int32_t)v36 != 0) {
                        v15 = v11;
                        // 0x8f629010
                        v53 = (int32_t)v2;
                        if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                            // 0x8f629020
                            v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                            result = v70;
                            // branch -> 0x8f629028
                        } else {
                            result = 3;
                        }
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
                case 3: {
                    // 0x8f628ca8
                    v21 = &str2;
                    strncpy((char *)&str2, (char *)&str, 31);
                    found_char_pos3 = strrchr((char *)&str2, 58);
                    v37 = type_atoi_9((int32_t)(found_char_pos3 != NULL) + (int32_t)found_char_pos3, 58, 31, 0, v1, 0);
                    v55 = v37;
                    if (v37 == 0) {
                        // 0x8f628ce0
                        strlcat(v21, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        strlcat(v21, (int32_t)"char", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        found_char_pos4 = strrchr((char *)&str2, 58);
                        v38 = type_atoi_9((int32_t)(found_char_pos4 != NULL) + (int32_t)found_char_pos4, 58, 31, 0, v1, 0);
                        v55 = v38;
                        // branch -> 0x8f628d18
                    }
                    // 0x8f628d18
                    if ((v55 + 255) % 256 > 253) {
                        // 0x8f628d34
                        if (v55 == 255) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    } else {
                        // 0x8f628d28
                        if (v55 != 3) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    }
                    // 0x8f628d3c
                    v62 = (int32_t)*(char *)g20;
                    v22 = &v12;
                    v6 = v22;
                    v12 = v62;
                    v19 = v21;
                    // branch -> 0x8f628c30
                    // 0x8f628c30
                    v50 = v19;
                    v9 = 1;
                    v16 = v11;
                    // branch -> 0x8f628c3c
                    // 0x8f628c3c
                    v35 = __utag_write(0, v19, v22, 1, v1, 0, v62, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                    // branch -> 0x8f628c9c
                    // 0x8f628c9c
                    result = 3;
                    if (v35 != 0) {
                        v15 = v16;
                        // 0x8f629010
                        v53 = (int32_t)v2;
                        if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                            // 0x8f629020
                            v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                            result = v70;
                            // branch -> 0x8f629028
                        } else {
                            result = 3;
                        }
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
                case 4: {
                    // 0x8f628d4c
                    v23 = &str2;
                    strncpy((char *)&str2, (char *)&str, 31);
                    found_char_pos5 = strrchr((char *)&str2, 58);
                    v39 = type_atoi_9((int32_t)(found_char_pos5 != NULL) + (int32_t)found_char_pos5, 58, 31, 0, v1, 0);
                    v56 = v39;
                    if (v39 == 0) {
                        // 0x8f628d84
                        strlcat(v23, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        strlcat(v23, (int32_t)"long", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        found_char_pos6 = strrchr((char *)&str2, 58);
                        v40 = type_atoi_9((int32_t)(found_char_pos6 != NULL) + (int32_t)found_char_pos6, 58, 31, 0, v1, 0);
                        v56 = v40;
                        // branch -> 0x8f628dbc
                    }
                    // 0x8f628dbc
                    if ((v56 + 255) % 256 > 253) {
                        // 0x8f628dd8
                        if (v56 == 255) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    } else {
                        // 0x8f628dcc
                        if (v56 != 4) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    }
                    // 0x8f628de0
                    str_as_l = atol((char *)g20);
                    // branch -> 0x8f628f28
                    // 0x8f628f28
                    v26 = &str2;
                    v50 = v26;
                    v9 = 4;
                    v27 = &v12;
                    v6 = v27;
                    v12 = str_as_l;
                    v16 = v11;
                    // branch -> 0x8f628c3c
                    // 0x8f628c3c
                    v35 = __utag_write(0, v26, v27, 4, v1, 0, str_as_l, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                    // branch -> 0x8f628c9c
                    // 0x8f628c9c
                    result = 3;
                    if (v35 != 0) {
                        v15 = v16;
                        // 0x8f629010
                        v53 = (int32_t)v2;
                        if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                            // 0x8f629020
                            v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                            result = v70;
                            // branch -> 0x8f629028
                        } else {
                            result = 3;
                        }
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
                case 5: {
                    // 0x8f628e8c
                    v6 = 31;
                    v25 = &str2;
                    strncpy((char *)&str2, (char *)&str, 31);
                    v50 = 58;
                    found_char_pos7 = strrchr((char *)&str2, 58);
                    v43 = type_atoi_9((int32_t)(found_char_pos7 != NULL) + (int32_t)found_char_pos7, v50, v6, 0, v1, 0);
                    v58 = v43;
                    if (v43 == 0) {
                        // 0x8f628ec4
                        strlcat(v25, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        v6 = 31;
                        strlcat(v25, (int32_t)"ulong", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        v50 = 58;
                        found_char_pos8 = strrchr((char *)&str2, 58);
                        v44 = type_atoi_9((int32_t)(found_char_pos8 != NULL) + (int32_t)found_char_pos8, v50, v6, 0, v1, 0);
                        v58 = v44;
                        // branch -> 0x8f628efc
                    }
                    // 0x8f628efc
                    v65 = (v58 + 255) % 256;
                    if (v65 > 253) {
                        // 0x8f628f18
                        if (v58 == 255) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    } else {
                        // 0x8f628f0c
                        if (v58 != 5) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    }
                    // 0x8f628f20
                    v45 = atoul(g20, v50, v6, v65, v1, 0, v12, v11, 0);
                    str_as_l = v45;
                    // branch -> 0x8f628f28
                    // 0x8f628f28
                    v26 = &str2;
                    v50 = v26;
                    v9 = 4;
                    v27 = &v12;
                    v6 = v27;
                    v12 = str_as_l;
                    v16 = v11;
                    // branch -> 0x8f628c3c
                    // 0x8f628c3c
                    v35 = __utag_write(0, v26, v27, 4, v1, 0, str_as_l, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                    // branch -> 0x8f628c9c
                    // 0x8f628c9c
                    result = 3;
                    if (v35 != 0) {
                        v15 = v16;
                        // 0x8f629010
                        v53 = (int32_t)v2;
                        if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                            // 0x8f629020
                            v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                            result = v70;
                            // branch -> 0x8f629028
                        } else {
                            result = 3;
                        }
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
                case 6: {
                    // 0x8f628dec
                    v24 = &str2;
                    strncpy((char *)&str2, (char *)&str, 31);
                    v50 = 58;
                    found_char_pos9 = strrchr((char *)&str2, 58);
                    v41 = type_atoi_9((int32_t)(found_char_pos9 != NULL) + (int32_t)found_char_pos9, v50, 31, 0, v1, 0);
                    v57 = v41;
                    if (v41 == 0) {
                        // 0x8f628e24
                        strlcat(v24, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        strlcat(v24, (int32_t)"llong", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        v50 = 58;
                        found_char_pos10 = strrchr((char *)&str2, 58);
                        v42 = type_atoi_9((int32_t)(found_char_pos10 != NULL) + (int32_t)found_char_pos10, v50, 31, 0, v1, 0);
                        v57 = v42;
                        // branch -> 0x8f628e5c
                    }
                    // 0x8f628e5c
                    if ((v57 + 255) % 256 > 253) {
                        // 0x8f628e78
                        if (v57 == 255) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    } else {
                        // 0x8f628e6c
                        if (v57 != 6) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    }
                    // 0x8f628e80
                    str_as_ll = atoll((char *)g20);
                    // branch -> 0x8f628fdc
                    // 0x8f628fdc
                    v9 = 8;
                    v29 = &v12;
                    v6 = v29;
                    v12 = str_as_ll;
                    v64 = v50;
                    v30 = &str2;
                    v50 = v30;
                    v16 = v64;
                    // branch -> 0x8f628c3c
                    // 0x8f628c3c
                    v35 = __utag_write(0, v30, v29, 8, v1, 0, str_as_ll, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                    // branch -> 0x8f628c9c
                    // 0x8f628c9c
                    result = 3;
                    if (v35 != 0) {
                        v15 = v16;
                        // 0x8f629010
                        v53 = (int32_t)v2;
                        if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                            // 0x8f629020
                            v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                            result = v70;
                            // branch -> 0x8f629028
                        } else {
                            result = 3;
                        }
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
                case 7: {
                    // 0x8f628f40
                    v6 = 31;
                    v28 = &str2;
                    strncpy((char *)&str2, (char *)&str, 31);
                    v50 = 58;
                    found_char_pos11 = strrchr((char *)&str2, 58);
                    v46 = type_atoi_9((int32_t)(found_char_pos11 != NULL) + (int32_t)found_char_pos11, v50, v6, 0, v1, 0);
                    v59 = v46;
                    if (v46 == 0) {
                        // 0x8f628f78
                        strlcat(v28, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        v6 = 31;
                        strlcat(v28, (int32_t)"ullong", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                        v50 = 58;
                        found_char_pos12 = strrchr((char *)&str2, 58);
                        v47 = type_atoi_9((int32_t)(found_char_pos12 != NULL) + (int32_t)found_char_pos12, v50, v6, 0, v1, 0);
                        v59 = v47;
                        // branch -> 0x8f628fb0
                    }
                    // 0x8f628fb0
                    v66 = (v59 + 255) % 256;
                    if (v66 > 253) {
                        // 0x8f628fcc
                        if (v59 == 255) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    } else {
                        // 0x8f628fc0
                        if (v59 != 7) {
                            // 0x8f629028
                            if (v8 != g14) {
                                // 0x8f629038
                                __stack_chk_fail();
                                // branch -> 0x8f62903c
                            }
                            // 0x8f62903c
                            g20 = v4;
                            g22 = v5;
                            return 3;
                        }
                    }
                    // 0x8f628fd4
                    v48 = atoull(g20, v50, v6, v66, v1, 0, v12, v11, 0, str, 0, 0, 0, 0);
                    str_as_ll = v48;
                    // branch -> 0x8f628fdc
                    // 0x8f628fdc
                    v9 = 8;
                    v29 = &v12;
                    v6 = v29;
                    v12 = str_as_ll;
                    v64 = v50;
                    v30 = &str2;
                    v50 = v30;
                    v16 = v64;
                    // branch -> 0x8f628c3c
                    // 0x8f628c3c
                    v35 = __utag_write(0, v30, v29, 8, v1, 0, str_as_ll, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                    // branch -> 0x8f628c9c
                    // 0x8f628c9c
                    result = 3;
                    if (v35 != 0) {
                        v15 = v16;
                        // 0x8f629010
                        v53 = (int32_t)v2;
                        if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                            // 0x8f629020
                            v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                            result = v70;
                            // branch -> 0x8f629028
                        } else {
                            result = 3;
                        }
                    }
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return result;
                }
            }
            // 0x8f628b88
            v17 = &str3;
            strncpy((char *)&str3, (char *)&str4, 31);
            found_char_pos13 = strrchr((char *)&str3, 58);
            v33 = type_atoi_9((int32_t)(found_char_pos13 != NULL) + (int32_t)found_char_pos13, 58, 31, 0, v1, 0);
            v54 = v33;
            if (v33 == 0) {
                // 0x8f628bc0
                strlcat(v17, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                strlcat(v17, (int32_t)"bool", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                found_char_pos14 = strrchr((char *)&str3, 58);
                v34 = type_atoi_9((int32_t)(found_char_pos14 != NULL) + (int32_t)found_char_pos14, 58, 31, 0, v1, 0);
                v54 = v34;
                // branch -> 0x8f628bf8
            }
            // 0x8f628bf8
            if ((v54 + 255) % 256 > 253) {
                // 0x8f628c14
                if (v54 == 255) {
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return 3;
                }
            } else {
                // 0x8f628c08
                if (v54 != 1) {
                    // 0x8f629028
                    if (v8 != g14) {
                        // 0x8f629038
                        __stack_chk_fail();
                        // branch -> 0x8f62903c
                    }
                    // 0x8f62903c
                    g20 = v4;
                    g22 = v5;
                    return 3;
                }
            }
            // 0x8f628c1c
            v14 = g20 > 0;
            g20 = v14;
            v18 = &v51;
            v6 = v18;
            v51 = v14;
            v19 = &str2;
            // branch -> 0x8f628c30
            // 0x8f628c30
            v50 = v19;
            v9 = 1;
            v16 = v11;
            // branch -> 0x8f628c3c
            // 0x8f628c3c
            v35 = __utag_write(0, v19, v18, 1, v1, 0, v12, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
            // branch -> 0x8f628c9c
            // 0x8f628c9c
            result = 3;
            if (v35 != 0) {
                v15 = v16;
                // 0x8f629010
                v53 = (int32_t)v2;
                if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                    // 0x8f629020
                    v70 = list_utag(v7, v50, v6, v9, v53, 0, v12, v15, 0, str, 0, 0);
                    result = v70;
                    // branch -> 0x8f629028
                } else {
                    result = 3;
                }
            }
            // 0x8f629028
            if (v8 != g14) {
                // 0x8f629038
                __stack_chk_fail();
                // branch -> 0x8f62903c
            }
            // 0x8f62903c
            g20 = v4;
            g22 = v5;
            return result;
        }
    }
    // 0x8f628b18
    v31 = __utag_is_protected(0, v7, v6, v9, v1, 0, v12, v11, 0, str);
    if (v31 == 0) {
        // 0x8f628b44
        int32_t v71; // 0x8f629024
        int32_t v72; // 0x8f629024
        int32_t v73; // 0x8f629024
        int32_t v74; // 0x8f629024
        int32_t v75; // 0x8f62902416
        switch (v13) {
            default: {
                // 0x8f628ff4
                v50 = (int32_t)"ASSERT FAILED at (%s:%d): %s\n";
                v6 = (int32_t)"app/mbm/fastboot_oem.c";
                v9 = (int32_t)"((void *)0) == \"should not reach here\"" & -0x10000 | 653;
                _panic(v10, (int32_t)"ASSERT FAILED at (%s:%d): %s\n", (int32_t)"app/mbm/fastboot_oem.c", (int32_t)"((void *)0) == \"should not reach here\"" & -0x10000 | 653, (int32_t)"((void *)0) == \"should not reach here\"", 0, v12);
                v52 = "((void *)0) == \"should not reach here\"";
                v15 = v11;
                // branch -> 0x8f629010
                // 0x8f629010
                v53 = (int32_t)v52;
                v49 = __utags_flush(0, v50, v6, v9, v53, 0, v12, v15);
                if (v49 == 0) {
                    // 0x8f629020
                    v71 = v50;
                    v72 = v6;
                    v73 = v9;
                    v74 = v12;
                    list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                    list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                    // branch -> 0x8f629028
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
            case 1: {
                // 0x8f628b70
                v32 = test_bool(g20, v7, v6, v9, v1, 0, v12);
                g20 = v32;
                if (v32 < 0) {
                    // if_8f628b7c_0_true
                    // branch -> 0x8f628aa4
                    // 0x8f628aa4
                    fboot_info((int32_t)"INFO", (int32_t)"not a boolean value", v6, v9, v1, 0, v12, v11, 0, str, 0);
                    // branch -> 0x8f629028
                    // Detected a possible infinite recursion (goto support failed); quitting...
                }
                break;
            }
            case 2: {
                // 0x8f628c44
                v61 = g20;
                v20 = &str2;
                g20 = 2;
                strlcpy(v20, v61, 128, v9, v1);
                if (g20 < a1) {
                    while (true) {
                        // 0x8f628c60
                        strlcat(v20, (int32_t)&g10, 127, v9, v1, 0, v12, v11, 0, str, 0, 0);
                        v63 = *(int32_t *)(4 * g20 + g22);
                        strlcat(v20, v63, 127, v9, v1, 0, v12, v11, 0, str, 0, 0);
                        v60 = g20 + 1;
                        g20 = v60;
                        if (v60 >= a1) {
                            // break (via goto) -> 0x8f628c88
                            goto lab_0x8f628c88_2;
                        }
                        // continue -> 0x8f628c60
                    }
                    // branch -> 0x8f628c9c
                    // Detected a possible infinite recursion (goto support failed); quitting...
                }
              lab_0x8f628c88_2:
                // 0x8f628c88
                v50 = v7;
                v6 = v20;
                v36 = __utag_puts(0, v7, v20, v9, v1, 0, v12, v11, 0, str);
                // branch -> 0x8f628c9c
                // 0x8f628c9c
                if ((int32_t)v36 != 0) {
                    v15 = v11;
                    // 0x8f629010
                    v53 = (int32_t)v2;
                    if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                        // 0x8f629020
                        v71 = v50;
                        v72 = v6;
                        v73 = v9;
                        v74 = v12;
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        // branch -> 0x8f629028
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
            case 3: {
                // 0x8f628ca8
                v21 = &str2;
                strncpy((char *)&str2, (char *)&str, 31);
                found_char_pos3 = strrchr((char *)&str2, 58);
                v37 = type_atoi_9((int32_t)(found_char_pos3 != NULL) + (int32_t)found_char_pos3, 58, 31, 0, v1, 0);
                v55 = v37;
                if (v37 == 0) {
                    // 0x8f628ce0
                    strlcat(v21, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    strlcat(v21, (int32_t)"char", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    found_char_pos4 = strrchr((char *)&str2, 58);
                    v38 = type_atoi_9((int32_t)(found_char_pos4 != NULL) + (int32_t)found_char_pos4, 58, 31, 0, v1, 0);
                    v55 = v38;
                    // branch -> 0x8f628d18
                }
                // 0x8f628d18
                if ((v55 + 255) % 256 > 253) {
                    // 0x8f628d34
                    if (v55 == 255) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                } else {
                    // 0x8f628d28
                    if (v55 != 3) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                }
                // 0x8f628d3c
                v62 = (int32_t)*(char *)g20;
                v22 = &v12;
                v6 = v22;
                v12 = v62;
                v19 = v21;
                // branch -> 0x8f628c30
                // 0x8f628c30
                v50 = v19;
                v9 = 1;
                v16 = v11;
                // branch -> 0x8f628c3c
                // 0x8f628c3c
                v35 = __utag_write(0, v19, v22, 1, v1, 0, v62, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                v75 = v16;
                // branch -> 0x8f628c9c
                // 0x8f628c9c
                if (v35 != 0) {
                    v15 = v75;
                    // 0x8f629010
                    v53 = (int32_t)v2;
                    if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                        // 0x8f629020
                        v71 = v50;
                        v72 = v6;
                        v73 = v9;
                        v74 = v12;
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        // branch -> 0x8f629028
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
            case 4: {
                // 0x8f628d4c
                v23 = &str2;
                strncpy((char *)&str2, (char *)&str, 31);
                found_char_pos5 = strrchr((char *)&str2, 58);
                v39 = type_atoi_9((int32_t)(found_char_pos5 != NULL) + (int32_t)found_char_pos5, 58, 31, 0, v1, 0);
                v56 = v39;
                if (v39 == 0) {
                    // 0x8f628d84
                    strlcat(v23, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    strlcat(v23, (int32_t)"long", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    found_char_pos6 = strrchr((char *)&str2, 58);
                    v40 = type_atoi_9((int32_t)(found_char_pos6 != NULL) + (int32_t)found_char_pos6, 58, 31, 0, v1, 0);
                    v56 = v40;
                    // branch -> 0x8f628dbc
                }
                // 0x8f628dbc
                if ((v56 + 255) % 256 > 253) {
                    // 0x8f628dd8
                    if (v56 == 255) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                } else {
                    // 0x8f628dcc
                    if (v56 != 4) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                }
                // 0x8f628de0
                str_as_l = atol((char *)g20);
                // branch -> 0x8f628f28
                // 0x8f628f28
                v26 = &str2;
                v50 = v26;
                v9 = 4;
                v27 = &v12;
                v6 = v27;
                v12 = str_as_l;
                v16 = v11;
                // branch -> 0x8f628c3c
                // 0x8f628c3c
                v35 = __utag_write(0, v26, v27, 4, v1, 0, str_as_l, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                v75 = v16;
                // branch -> 0x8f628c9c
                // 0x8f628c9c
                if (v35 != 0) {
                    v15 = v75;
                    // 0x8f629010
                    v53 = (int32_t)v2;
                    if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                        // 0x8f629020
                        v71 = v50;
                        v72 = v6;
                        v73 = v9;
                        v74 = v12;
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        // branch -> 0x8f629028
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
            case 5: {
                // 0x8f628e8c
                v6 = 31;
                v25 = &str2;
                strncpy((char *)&str2, (char *)&str, 31);
                v50 = 58;
                found_char_pos7 = strrchr((char *)&str2, 58);
                v43 = type_atoi_9((int32_t)(found_char_pos7 != NULL) + (int32_t)found_char_pos7, v50, v6, 0, v1, 0);
                v58 = v43;
                if (v43 == 0) {
                    // 0x8f628ec4
                    strlcat(v25, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    v6 = 31;
                    strlcat(v25, (int32_t)"ulong", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    v50 = 58;
                    found_char_pos8 = strrchr((char *)&str2, 58);
                    v44 = type_atoi_9((int32_t)(found_char_pos8 != NULL) + (int32_t)found_char_pos8, v50, v6, 0, v1, 0);
                    v58 = v44;
                    // branch -> 0x8f628efc
                }
                // 0x8f628efc
                v65 = (v58 + 255) % 256;
                if (v65 > 253) {
                    // 0x8f628f18
                    if (v58 == 255) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                } else {
                    // 0x8f628f0c
                    if (v58 != 5) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                }
                // 0x8f628f20
                v45 = atoul(g20, v50, v6, v65, v1, 0, v12, v11, 0);
                str_as_l = v45;
                // branch -> 0x8f628f28
                // 0x8f628f28
                v26 = &str2;
                v50 = v26;
                v9 = 4;
                v27 = &v12;
                v6 = v27;
                v12 = str_as_l;
                v16 = v11;
                // branch -> 0x8f628c3c
                // 0x8f628c3c
                v35 = __utag_write(0, v26, v27, 4, v1, 0, str_as_l, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                v75 = v16;
                // branch -> 0x8f628c9c
                // 0x8f628c9c
                if (v35 != 0) {
                    v15 = v75;
                    // 0x8f629010
                    v53 = (int32_t)v2;
                    if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                        // 0x8f629020
                        v71 = v50;
                        v72 = v6;
                        v73 = v9;
                        v74 = v12;
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        // branch -> 0x8f629028
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
            case 6: {
                // 0x8f628dec
                v24 = &str2;
                strncpy((char *)&str2, (char *)&str, 31);
                v50 = 58;
                found_char_pos9 = strrchr((char *)&str2, 58);
                v41 = type_atoi_9((int32_t)(found_char_pos9 != NULL) + (int32_t)found_char_pos9, v50, 31, 0, v1, 0);
                v57 = v41;
                if (v41 == 0) {
                    // 0x8f628e24
                    strlcat(v24, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    strlcat(v24, (int32_t)"llong", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    v50 = 58;
                    found_char_pos10 = strrchr((char *)&str2, 58);
                    v42 = type_atoi_9((int32_t)(found_char_pos10 != NULL) + (int32_t)found_char_pos10, v50, 31, 0, v1, 0);
                    v57 = v42;
                    // branch -> 0x8f628e5c
                }
                // 0x8f628e5c
                if ((v57 + 255) % 256 > 253) {
                    // 0x8f628e78
                    if (v57 == 255) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                } else {
                    // 0x8f628e6c
                    if (v57 != 6) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                }
                // 0x8f628e80
                str_as_ll = atoll((char *)g20);
                // branch -> 0x8f628fdc
                // 0x8f628fdc
                v9 = 8;
                v29 = &v12;
                v6 = v29;
                v12 = str_as_ll;
                v64 = v50;
                v30 = &str2;
                v50 = v30;
                v16 = v64;
                // branch -> 0x8f628c3c
                // 0x8f628c3c
                v35 = __utag_write(0, v30, v29, 8, v1, 0, str_as_ll, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                v75 = v16;
                // branch -> 0x8f628c9c
                // 0x8f628c9c
                if (v35 != 0) {
                    v15 = v75;
                    // 0x8f629010
                    v53 = (int32_t)v2;
                    if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                        // 0x8f629020
                        v71 = v50;
                        v72 = v6;
                        v73 = v9;
                        v74 = v12;
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        // branch -> 0x8f629028
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
            case 7: {
                // 0x8f628f40
                v6 = 31;
                v28 = &str2;
                strncpy((char *)&str2, (char *)&str, 31);
                v50 = 58;
                found_char_pos11 = strrchr((char *)&str2, 58);
                v46 = type_atoi_9((int32_t)(found_char_pos11 != NULL) + (int32_t)found_char_pos11, v50, v6, 0, v1, 0);
                v59 = v46;
                if (v46 == 0) {
                    // 0x8f628f78
                    strlcat(v28, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    v6 = 31;
                    strlcat(v28, (int32_t)"ullong", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
                    v50 = 58;
                    found_char_pos12 = strrchr((char *)&str2, 58);
                    v47 = type_atoi_9((int32_t)(found_char_pos12 != NULL) + (int32_t)found_char_pos12, v50, v6, 0, v1, 0);
                    v59 = v47;
                    // branch -> 0x8f628fb0
                }
                // 0x8f628fb0
                v66 = (v59 + 255) % 256;
                if (v66 > 253) {
                    // 0x8f628fcc
                    if (v59 == 255) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                } else {
                    // 0x8f628fc0
                    if (v59 != 7) {
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                }
                // 0x8f628fd4
                v48 = atoull(g20, v50, v6, v66, v1, 0, v12, v11, 0, str, 0, 0, 0, 0);
                str_as_ll = v48;
                // branch -> 0x8f628fdc
                // 0x8f628fdc
                v9 = 8;
                v29 = &v12;
                v6 = v29;
                v12 = str_as_ll;
                v64 = v50;
                v30 = &str2;
                v50 = v30;
                v16 = v64;
                // branch -> 0x8f628c3c
                // 0x8f628c3c
                v35 = __utag_write(0, v30, v29, 8, v1, 0, str_as_ll, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
                v75 = v16;
                // branch -> 0x8f628c9c
                // 0x8f628c9c
                if (v35 != 0) {
                    v15 = v75;
                    // 0x8f629010
                    v53 = (int32_t)v2;
                    if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                        // 0x8f629020
                        v71 = v50;
                        v72 = v6;
                        v73 = v9;
                        v74 = v12;
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                        // branch -> 0x8f629028
                    }
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
                break;
            }
        }
        // 0x8f628b88
        v17 = &str3;
        strncpy((char *)&str3, (char *)&str4, 31);
        found_char_pos13 = strrchr((char *)&str3, 58);
        v33 = type_atoi_9((int32_t)(found_char_pos13 != NULL) + (int32_t)found_char_pos13, 58, 31, 0, v1, 0);
        v54 = v33;
        if (v33 == 0) {
            // 0x8f628bc0
            strlcat(v17, (int32_t)&g4, 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
            strlcat(v17, (int32_t)"bool", 31, 0, v1, 0, v12, v11, 0, str, 0, 0);
            found_char_pos14 = strrchr((char *)&str3, 58);
            v34 = type_atoi_9((int32_t)(found_char_pos14 != NULL) + (int32_t)found_char_pos14, 58, 31, 0, v1, 0);
            v54 = v34;
            // branch -> 0x8f628bf8
        }
        // 0x8f628bf8
        if ((v54 + 255) % 256 > 253) {
            // 0x8f628c14
            if (v54 == 255) {
                // Detected a possible infinite recursion (goto support failed); quitting...
            }
        } else {
            // 0x8f628c08
            if (v54 != 1) {
                // Detected a possible infinite recursion (goto support failed); quitting...
            }
        }
        // 0x8f628c1c
        v14 = g20 > 0;
        g20 = v14;
        v18 = &v51;
        v6 = v18;
        v51 = v14;
        v19 = &str2;
        // branch -> 0x8f628c30
        // 0x8f628c30
        v50 = v19;
        v9 = 1;
        v16 = v11;
        // branch -> 0x8f628c3c
        // 0x8f628c3c
        v35 = __utag_write(0, v19, v18, 1, v1, 0, v12, v16, 0, str, 0, 0, 0, 0, 0, 0, 0);
        // branch -> 0x8f628c9c
        // 0x8f628c9c
        if (v35 != 0) {
            v15 = v16;
            // 0x8f629010
            v53 = (int32_t)v2;
            if (__utags_flush(0, v50, v6, v9, v53, 0, v12, v15) == 0) {
                // 0x8f629020
                v71 = v50;
                v72 = v6;
                v73 = v9;
                v74 = v12;
                list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                list_utag(v7, v71, v72, v73, v53, 0, v74, v15, 0, str, 0, 0);
                // branch -> 0x8f629028
            }
        }
        // Detected a possible infinite recursion (goto support failed); quitting...
    } else {
        // 0x8f628b2c
        fboot_info((int32_t)"INFO", (int32_t)"utag is read-only!", v6, v9, v1, 0, v12, v11, 0, str, 0);
        // branch -> 0x8f628aa4
        // 0x8f628aa4
        fboot_info((int32_t)"INFO", (int32_t)"unprotect with 'fastboot oem config unprotect <name>'", v6, v9, v1, 0, v12, v11, 0, str, 0);
        // branch -> 0x8f629028
        // Detected a possible infinite recursion (goto support failed); quitting...
    }
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// int atoi(const char * nptr);
// long int atol(const char * nptr);
// long long int atoll(const char * nptr);
// void free(void * ptr);
// void * malloc(size_t size);
// char * strchr(char * s, int c);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);
// char * strrchr(char * s, int c);
// char * strstr(char * haystack, const char * needle);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 20
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:38:46

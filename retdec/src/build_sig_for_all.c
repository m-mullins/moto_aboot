//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

// ------------------------ Structures ------------------------

struct tm {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    char * e10;
};

// ------------------- Function Prototypes --------------------

int32_t __utag_gets_107(char * a1, char * a2, int32_t a3, int32_t a4);
int32_t __utag_sizeof(char * a1, int32_t a2, int32_t a3);
int32_t _dputc(char a1, int32_t a2);
int32_t board_baseband(int32_t a1);
int32_t board_hardware_id(int32_t a1, int32_t a2, int32_t a3);
int32_t boot_linux(int32_t (*a1)(int32_t, int32_t, int32_t), int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t bs_set_timestamp(int32_t a1);
int32_t build_sig_for_all(char * str, int32_t (*a2)(int32_t, int32_t), int32_t a3);
int32_t build_sig_is_uniform(void);
int32_t dev_tree_add_mem_info(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t dev_tree_get_entry_info(int32_t a1, int32_t * a2);
int32_t disable_usbin_valid_irq(int32_t a1);
int32_t do_dead_battery_recovery(int32_t a1, int32_t a2, int32_t a3);
int32_t enable_usbin_valid_irq(int32_t a1, int32_t a2);
void function_8f64aa80(void);
void function_8f64aacc(int32_t a1, int32_t a2, int32_t a3);
void function_8f678528(void);
void function_8f6786f0(int32_t * timep, int32_t a2, int32_t a3);
int32_t get_udc_device(char * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t get_ui_coordinates(int32_t a1, int32_t a2);
int32_t init(int32_t a1, int32_t a2, int32_t a3);
int32_t is_fastboot_busy(int32_t a1, int32_t a2, int32_t a3);
int32_t mdss_dsi_phy_regulator_init(int32_t * a1, int32_t a2);
int32_t mdss_dsi_phy_sw_reset(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t on_confirm_timeout(int32_t a1, int32_t a2, char * a3);
int32_t select_device_tree(int32_t a1, int32_t a2);
int32_t start_charging(int32_t a1);
int32_t stop_charging(int32_t a1, int32_t a2);
int32_t target_platform_id(char * a1, int32_t a2, int32_t a3);
int32_t target_restart_reason_addr(int32_t a1, int32_t a2);

// --------------------- Global Variables ---------------------

int32_t g58 = 0; // LR
int32_t g59 = 0; // R0
int32_t g60 = 0; // R1
int32_t g61 = 0; // R10
int32_t g62 = 0; // R11
int32_t g63 = 0; // R2
int32_t g64 = 0; // R3
int32_t g65 = 0; // R4
int32_t g66 = 0; // R5
int32_t g67 = 0; // R6
int32_t g68 = 0; // R7
int32_t g69 = 0; // R8
int32_t g70 = 0; // R9
int32_t g1 = -0x1a60cfd8; // 0x8f603944
int32_t g2 = -0x1a60cfd0; // 0x8f603978
int32_t g3 = -0x16d2bfc9; // 0x8f603ad8
int32_t g4 = -0x16d2bfc9; // 0x8f603c64
int32_t g5 = -0x1a60cd10; // 0x8f637e98
int32_t g6 = -0x1a60cf7c; // 0x8f63867c
int32_t g7 = -0x16d2bfc9; // 0x8f6387c0
int32_t (*g8)() = (int32_t (*)())-0x16d2bf8d; // 0x8f64338c
int32_t g9 = -0x16d2bf8d; // 0x8f64385c
int32_t g10 = -0x16d2bf8d; // 0x8f645798
int32_t g11 = -0x16d2bf10; // 0x8f651560
int32_t g12 = 0x2020003a; // 0x8f686ac4
int32_t g13 = 0x65440030; // 0x8f69c66f
char * g14 = "S"; // 0x8f6a4aed
char * g15; // 0x8f6a4e20
int32_t g16 = 31; // 0x8f6a9020
int32_t g17 = 365; // 0x8f6a9080
char * g18 = "\x01"; // 0x8f6ab02c
int32_t g19 = 0x1000; // 0x8f6ab03c
int32_t g20 = 0; // 0x8f6ab040
int32_t g21 = 0; // 0x8f6ab044
int32_t g22 = 0; // 0x8f6ab048
int32_t g23 = 0x2e8022b8; // 0x8f6ac050
char * g24; // 0x8f6ac05c
int32_t g25 = 0; // 0x8f6ac074
int32_t g26 = 0; // 0x8f6ac080
int32_t g27 = -1; // 0x8f6ac0c0
int32_t g28 = 1; // 0x8f6ac0f0
int32_t g29 = 1; // 0x8f6afe1c
int32_t g30 = 0; // 0x8f6b5064
int32_t g31 = 0; // 0x8f6b5080
char * g32; // 0x8f6b509c
int32_t g33 = 0; // 0x8f6b50a0
int32_t g34 = 0; // 0x8f6b7950
char * g35; // 0x8f6b7954
int32_t g36 = 0; // 0x8f6b8bdc
int32_t g37 = 0; // 0x8f6b8be0
int32_t g38 = 0; // 0x8f6b8be4
int32_t g39 = 0; // 0x8f6b8be8
int32_t g40 = 0; // 0x8f6b8bec
int32_t g41 = 0; // 0x8f6c0398
int32_t g42 = 0; // 0x8f6c03d0
int32_t g43 = 0; // 0x8f6e07ac
int32_t g44 = 0; // 0x8f6e07cc
int32_t g45 = 0; // 0x8f6e07e8
int32_t g46 = 0; // 0x8f6e07ec
int32_t g47 = 0; // 0x8f6e07f4
int32_t g48 = 0; // 0x8f6e0808
int32_t g49 = 0; // 0x8f6e080c
char * g50; // 0x8f6e0848
char * g51; // 0x8f6e1000
char * g52; // 0x8f6e1200
int32_t g53 = 0; // 0x8f6e1228
int32_t g54 = 0; // 0x8f6e12dc
int32_t g55 = 0; // 0x8f6e12e0
struct tm * g56 = NULL; // 0x8f710e90
int32_t g57 = 0; // 0x8f7112f4

// ------------------------ Functions -------------------------

// Address range: 0x8f6516d0 - 0x8f651957
int32_t build_sig_for_all(char * str, int32_t (*a2)(int32_t, int32_t), int32_t a3) {
    // 0x8f6516d0
    int32_t v1;
    char * v2 = (char *)v1; // bp-52
    int32_t v3 = (int32_t)str;
    g59 = v3;
    g64 = &g57;
    int32_t v4 = g65; // 0x8f6516d4
    int32_t v5 = g66; // 0x8f6516d4
    int32_t v6 = g67; // 0x8f6516d4
    int32_t v7 = g68; // 0x8f6516d4
    int32_t v8 = g69; // 0x8f6516d4
    int32_t v9 = g70; // 0x8f6516d4
    int32_t v10 = g61; // 0x8f6516d4
    int32_t v11 = g62; // 0x8f6516d4
    g62 = a3;
    int32_t v12 = g57;
    g61 = (int32_t)a2;
    g69 = v3;
    if (a2 == NULL) {
        // 0x8f6518e8
        if (v12 != g57) {
            // 0x8f6518fc
            __stack_chk_fail();
            // branch -> 0x8f651900
        }
        // 0x8f651900
        g65 = v4;
        g66 = v5;
        g67 = v6;
        g68 = v7;
        g69 = v8;
        g70 = v9;
        g61 = v10;
        g62 = v11;
        return g59;
    }
    int32_t v13 = (int32_t)"sbl1"; // R1
    g63 = 72;
    int32_t v14; // 0x8f651774
    int32_t v15; // 0x8f65177c
    int32_t v16; // 0x8f65179c
    uint32_t v17; // 0x8f6517a8
    int32_t v18; // 0x8f6517dc
    int32_t v19; // 0x8f65182c55
    int32_t v20; // 0x8f651860
    int32_t str2; // R8
    int32_t v21;
    int32_t v22;
    int32_t v23;
    bool v24; // 0x8f6517c4
    uint32_t v25; // 0x8f6517ac
    uint32_t v26; // 0x8f6517ac
    int32_t v27; // 0x8f6517b0
    int32_t v28; // 0x8f651844
    int32_t v29; // 0x8f651788
    int32_t v30; // 0x8f6517b0
    uint32_t v31; // 0x8f6517b4
    bool v32; // 0x8f6517c4
    int32_t v33; // 0x8f651784
    int32_t v34; // 0x8f65184c
    uint32_t v35; // 0x8f6517cc
    int32_t str3; // 0x8f65181c
    if (strncmp(str, "sbl1", 72) == 0) {
        // 0x8f651758
        // branch -> 0x8f65176c
        // 0x8f65176c
        g66 = 0;
        v14 = partition_get_index(g69, v13, g63, g64, v22, (int32_t)v2);
        v15 = partition_get_offset(v14, v13, g63);
        g67 = v15;
        v33 = v13;
        g68 = v33;
        v29 = v33 | v15;
        if (v15 == v33) {
            // 0x8f651790
            v16 = print_log(1, (int32_t)"Partition %s not found\n", g69, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            g59 = v16;
            // branch -> 0x8f6518e8
        } else {
            // 0x8f6517a4
            v17 = partition_get_size(v14, v29, g63, g64, v22, (int32_t)v2, v21, v12);
            v25 = 0x7ec00;
            v26 = v25 + 512;
            v27 = g66;
            v30 = (int32_t)(v25 > 0xfffffdff) + v27;
            g70 = v30;
            v31 = v29;
            v32 = true;
            v24 = v30 >= v31;
            if (v30 == v31) {
                // if_8f6517b8_0_true
                v32 = v26 != v17;
                v24 = v26 >= v17;
                // branch -> after_if_8f6517b8_0
            }
            // after_if_8f6517b8_0
            if (!v32 || !v24) {
                // 0x8f6517c8
                str2 = (int32_t)&g51;
                v35 = g67 + v25;
                g64 = 512;
                g63 = (int32_t)&g51;
                v18 = mmc_read(v35, g68 + v27 + (int32_t)(v35 < v25), (int32_t)&g51, 512, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                if (v18 != 0) {
                    // if_8f6517e4_0_true
                    // branch -> 0x8f651860
                    // 0x8f651860
                    v20 = print_log(1, (int32_t)"Failed to read build signature sector\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                    g59 = v20;
                    // branch -> 0x8f6518e8
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // 0x8f6517f0
                g63 = 100;
                if (strncmp((char *)str2, "BEGIN BUILD SIGNATURE", 100) != 0) {
                    // if_8f651804_0_true
                    // branch -> 0x8f651860
                    // 0x8f651860
                    v20 = print_log(1, (int32_t)"Build signature not found\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                    g59 = v20;
                    // branch -> 0x8f6518e8
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // 0x8f651810
                str3 = str2 + strlen("BEGIN BUILD SIGNATURE") + 1;
                g65 = str3;
                g69 = (int32_t)&g52;
                v23 = (int32_t)&v2;
                v19 = strnlen((char *)str3, 100);
                if (v19 == 100) {
                    // if_8f651838_0_true
                    // branch -> 0x8f651860
                } else {
                    while (true) {
                        // 0x8f651844
                        v28 = v19 + 1;
                        v34 = g65;
                        if (v34 + v28 <= g69) {
                            goto lab_0x8f651868_3;
                        }
                        // 0x8f651858
                        // branch -> 0x8f651860
                    }
                }
                // 0x8f651860
                v20 = print_log(1, (int32_t)"Build signature line too long\n", g63, g64, v22, (int32_t)v2, 100, v12, 0, v4, v5, v6, v7);
                g59 = v20;
                // branch -> 0x8f6518e8
                // 0x8f6518e8
                if (v12 != g57) {
                    // 0x8f6518fc
                    __stack_chk_fail();
                    // branch -> 0x8f651900
                }
                // 0x8f651900
                g65 = v4;
                g66 = v5;
                g67 = v6;
                g68 = v7;
                g69 = v8;
                g70 = v9;
                g61 = v10;
                g62 = v11;
                return g59;
            }
            // after_if_8f6517c0_0.thread
            // branch -> 0x8f651860
            // 0x8f651860
            v20 = print_log(1, (int32_t)"Build signature offset out of partition boundary\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            g59 = v20;
            // branch -> 0x8f6518e8
        }
        // 0x8f6518e8
        if (v12 != g57) {
            // 0x8f6518fc
            __stack_chk_fail();
            // branch -> 0x8f651900
        }
        // 0x8f651900
        g65 = v4;
        g66 = v5;
        g67 = v6;
        g68 = v7;
        g69 = v8;
        g70 = v9;
        g61 = v10;
        g62 = v11;
        return g59;
    }
    // 0x8f651708
    v13 = (int32_t)"rpm";
    g63 = 72;
    if (strncmp((char *)g69, "rpm", 72) == 0) {
        // 0x8f651760
        // branch -> 0x8f65176c
        // 0x8f65176c
        g66 = 0;
        v14 = partition_get_index(g69, v13, g63, g64, v22, (int32_t)v2);
        v15 = partition_get_offset(v14, v13, g63);
        g67 = v15;
        v33 = v13;
        g68 = v33;
        v29 = v33 | v15;
        if (v15 == v33) {
            // 0x8f651790
            v16 = print_log(1, (int32_t)"Partition %s not found\n", g69, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            g59 = v16;
            // branch -> 0x8f6518e8
        } else {
            // 0x8f6517a4
            v17 = partition_get_size(v14, v29, g63, g64, v22, (int32_t)v2, v21, v12);
            v25 = 0x3d400;
            v26 = v25 + 512;
            v27 = g66;
            v30 = (int32_t)(v25 > 0xfffffdff) + v27;
            g70 = v30;
            v31 = v29;
            v32 = true;
            v24 = v30 >= v31;
            if (v30 == v31) {
                // if_8f6517b8_0_true
                v32 = v26 != v17;
                v24 = v26 >= v17;
                // branch -> after_if_8f6517b8_0
            }
            // after_if_8f6517b8_0
            if (!v32 || !v24) {
                // 0x8f6517c8
                str2 = (int32_t)&g51;
                v35 = g67 + v25;
                g64 = 512;
                g63 = (int32_t)&g51;
                v18 = mmc_read(v35, g68 + v27 + (int32_t)(v35 < v25), (int32_t)&g51, 512, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                if (v18 != 0) {
                    // if_8f6517e4_0_true
                    // branch -> 0x8f651860
                    // 0x8f651860
                    v20 = print_log(1, (int32_t)"Failed to read build signature sector\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                    g59 = v20;
                    // branch -> 0x8f6518e8
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // 0x8f6517f0
                g63 = 100;
                if (strncmp((char *)str2, "BEGIN BUILD SIGNATURE", 100) != 0) {
                    // if_8f651804_0_true
                    // branch -> 0x8f651860
                    // 0x8f651860
                    v20 = print_log(1, (int32_t)"Build signature not found\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                    g59 = v20;
                    // branch -> 0x8f6518e8
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // 0x8f651810
                str3 = str2 + strlen("BEGIN BUILD SIGNATURE") + 1;
                g65 = str3;
                g69 = (int32_t)&g52;
                v23 = (int32_t)&v2;
                v19 = strnlen((char *)str3, 100);
                if (v19 == 100) {
                    // if_8f651838_0_true
                    // branch -> 0x8f651860
                } else {
                    while (true) {
                        // 0x8f651844
                        v28 = v19 + 1;
                        v34 = g65;
                        if (v34 + v28 <= g69) {
                            goto lab_0x8f651868_3;
                        }
                        // 0x8f651858
                        // branch -> 0x8f651860
                    }
                }
                // 0x8f651860
                v20 = print_log(1, (int32_t)"Build signature line too long\n", g63, g64, v22, (int32_t)v2, 100, v12, 0, v4, v5, v6, v7);
                g59 = v20;
                // branch -> 0x8f6518e8
                // 0x8f6518e8
                if (v12 != g57) {
                    // 0x8f6518fc
                    __stack_chk_fail();
                    // branch -> 0x8f651900
                }
                // 0x8f651900
                g65 = v4;
                g66 = v5;
                g67 = v6;
                g68 = v7;
                g69 = v8;
                g70 = v9;
                g61 = v10;
                g62 = v11;
                return g59;
            }
            // after_if_8f6517c0_0.thread
            // branch -> 0x8f651860
            // 0x8f651860
            v20 = print_log(1, (int32_t)"Build signature offset out of partition boundary\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            g59 = v20;
            // branch -> 0x8f6518e8
        }
        // 0x8f6518e8
        if (v12 != g57) {
            // 0x8f6518fc
            __stack_chk_fail();
            // branch -> 0x8f651900
        }
        // 0x8f651900
        g65 = v4;
        g66 = v5;
        g67 = v6;
        g68 = v7;
        g69 = v8;
        g70 = v9;
        g61 = v10;
        g62 = v11;
        return g59;
    }
    // 0x8f651720
    v13 = (int32_t)"tz";
    g63 = 72;
    if (strncmp((char *)g69, "tz", 72) == 0) {
        // 0x8f651768
        // branch -> 0x8f65176c
        // 0x8f65176c
        g66 = 0;
        v14 = partition_get_index(g69, v13, g63, g64, v22, (int32_t)v2);
        v15 = partition_get_offset(v14, v13, g63);
        g67 = v15;
        v33 = v13;
        g68 = v33;
        v29 = v33 | v15;
        if (v15 == v33) {
            // 0x8f651790
            v16 = print_log(1, (int32_t)"Partition %s not found\n", g69, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            g59 = v16;
            // branch -> 0x8f6518e8
        } else {
            // 0x8f6517a4
            v17 = partition_get_size(v14, v29, g63, g64, v22, (int32_t)v2, v21, v12);
            v25 = 0x8ac00;
            v26 = v25 + 512;
            v27 = g66;
            v30 = (int32_t)(v25 > 0xfffffdff) + v27;
            g70 = v30;
            v31 = v29;
            v32 = true;
            v24 = v30 >= v31;
            if (v30 == v31) {
                // if_8f6517b8_0_true
                v32 = v26 != v17;
                v24 = v26 >= v17;
                // branch -> after_if_8f6517b8_0
            }
            // after_if_8f6517b8_0
            if (!v32 || !v24) {
                // 0x8f6517c8
                str2 = (int32_t)&g51;
                v35 = g67 + v25;
                g64 = 512;
                g63 = (int32_t)&g51;
                v18 = mmc_read(v35, g68 + v27 + (int32_t)(v35 < v25), (int32_t)&g51, 512, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                if (v18 != 0) {
                    // if_8f6517e4_0_true
                    // branch -> 0x8f651860
                    // 0x8f651860
                    v20 = print_log(1, (int32_t)"Failed to read build signature sector\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                    g59 = v20;
                    // branch -> 0x8f6518e8
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // 0x8f6517f0
                g63 = 100;
                if (strncmp((char *)str2, "BEGIN BUILD SIGNATURE", 100) != 0) {
                    // if_8f651804_0_true
                    // branch -> 0x8f651860
                    // 0x8f651860
                    v20 = print_log(1, (int32_t)"Build signature not found\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                    g59 = v20;
                    // branch -> 0x8f6518e8
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // 0x8f651810
                str3 = str2 + strlen("BEGIN BUILD SIGNATURE") + 1;
                g65 = str3;
                g69 = (int32_t)&g52;
                v23 = (int32_t)&v2;
                v19 = strnlen((char *)str3, 100);
                if (v19 == 100) {
                    // if_8f651838_0_true
                    // branch -> 0x8f651860
                } else {
                    while (true) {
                        // 0x8f651844
                        v28 = v19 + 1;
                        v34 = g65;
                        if (v34 + v28 <= g69) {
                            goto lab_0x8f651868_3;
                        }
                        // 0x8f651858
                        // branch -> 0x8f651860
                    }
                }
                // 0x8f651860
                v20 = print_log(1, (int32_t)"Build signature line too long\n", g63, g64, v22, (int32_t)v2, 100, v12, 0, v4, v5, v6, v7);
                g59 = v20;
                // branch -> 0x8f6518e8
                // 0x8f6518e8
                if (v12 != g57) {
                    // 0x8f6518fc
                    __stack_chk_fail();
                    // branch -> 0x8f651900
                }
                // 0x8f651900
                g65 = v4;
                g66 = v5;
                g67 = v6;
                g68 = v7;
                g69 = v8;
                g70 = v9;
                g61 = v10;
                g62 = v11;
                return g59;
            }
            // after_if_8f6517c0_0.thread
            // branch -> 0x8f651860
            // 0x8f651860
            v20 = print_log(1, (int32_t)"Build signature offset out of partition boundary\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            g59 = v20;
            // branch -> 0x8f6518e8
        }
        // 0x8f6518e8
        if (v12 != g57) {
            // 0x8f6518fc
            __stack_chk_fail();
            // branch -> 0x8f651900
        }
        // 0x8f651900
        g65 = v4;
        g66 = v5;
        g67 = v6;
        g68 = v7;
        g69 = v8;
        g70 = v9;
        g61 = v10;
        g62 = v11;
        return g59;
    }
    // 0x8f651738
    v13 = (int32_t)"hyp";
    g63 = 72;
    if (strncmp((char *)g69, "hyp", 72) != 0) {
        // 0x8f65189c
        g63 = 72;
        int32_t strncmp_rc = strncmp((char *)g69, "aboot", 72); // 0x8f6518a8
        g59 = strncmp_rc;
        if (strncmp_rc == 0) {
            int32_t strcmp_rc = strcmp("MBM-NG-V81.04-0-g3220316", (char *)&g15); // 0x8f6518bc
            g59 = strcmp_rc;
            if (strcmp_rc != 0) {
                // 0x8f6518c8
                v2 = "git=MBM-NG-V81.04-0-g3220316";
                strlen("git=MBM-NG-V81.04-0-g3220316");
                int32_t v36 = g62; // 0x8f6518d4
                g60 = v36;
                int32_t v37 = (int32_t)&v2;
                g59 = v37;
                g58 = -0x709ae718;
                ((int32_t (*)(int32_t, int32_t))g61)(v37, v36);
                // branch -> 0x8f6518e8
            }
        }
        // 0x8f6518e8
        if (v12 != g57) {
            // 0x8f6518fc
            __stack_chk_fail();
            // branch -> 0x8f651900
        }
        // 0x8f651900
        g65 = v4;
        g66 = v5;
        g67 = v6;
        g68 = v7;
        g69 = v8;
        g70 = v9;
        g61 = v10;
        g62 = v11;
        return g59;
    }
    // 0x8f651750
    // branch -> 0x8f65176c
    // 0x8f65176c
    g66 = 0;
    v14 = partition_get_index(g69, v13, g63, g64, v22, (int32_t)v2);
    v15 = partition_get_offset(v14, v13, g63);
    g67 = v15;
    v33 = v13;
    g68 = v33;
    v29 = v33 | v15;
    if (v15 == v33) {
        // 0x8f651790
        v16 = print_log(1, (int32_t)"Partition %s not found\n", g69, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
        g59 = v16;
        // branch -> 0x8f6518e8
    } else {
        // 0x8f6517a4
        v17 = partition_get_size(v14, v29, g63, g64, v22, (int32_t)v2, v21, v12);
        v25 = 0x1ec00;
        v26 = v25 + 512;
        v27 = g66;
        v30 = (int32_t)(v25 > 0xfffffdff) + v27;
        g70 = v30;
        v31 = v29;
        v32 = true;
        v24 = v30 >= v31;
        if (v30 == v31) {
            // if_8f6517b8_0_true
            v32 = v26 != v17;
            v24 = v26 >= v17;
            // branch -> after_if_8f6517b8_0
        }
        // after_if_8f6517b8_0
        if (!v32 || !v24) {
            // 0x8f6517c8
            str2 = (int32_t)&g51;
            v35 = g67 + v25;
            g64 = 512;
            g63 = (int32_t)&g51;
            v18 = mmc_read(v35, g68 + v27 + (int32_t)(v35 < v25), (int32_t)&g51, 512, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
            if (v18 != 0) {
                // if_8f6517e4_0_true
                // branch -> 0x8f651860
                // 0x8f651860
                v20 = print_log(1, (int32_t)"Failed to read build signature sector\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                g59 = v20;
                // branch -> 0x8f6518e8
                // 0x8f6518e8
                if (v12 != g57) {
                    // 0x8f6518fc
                    __stack_chk_fail();
                    // branch -> 0x8f651900
                }
                // 0x8f651900
                g65 = v4;
                g66 = v5;
                g67 = v6;
                g68 = v7;
                g69 = v8;
                g70 = v9;
                g61 = v10;
                g62 = v11;
                return g59;
            }
            // 0x8f6517f0
            g63 = 100;
            if (strncmp((char *)str2, "BEGIN BUILD SIGNATURE", 100) != 0) {
                // if_8f651804_0_true
                // branch -> 0x8f651860
                // 0x8f651860
                v20 = print_log(1, (int32_t)"Build signature not found\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
                g59 = v20;
                // branch -> 0x8f6518e8
                // 0x8f6518e8
                if (v12 != g57) {
                    // 0x8f6518fc
                    __stack_chk_fail();
                    // branch -> 0x8f651900
                }
                // 0x8f651900
                g65 = v4;
                g66 = v5;
                g67 = v6;
                g68 = v7;
                g69 = v8;
                g70 = v9;
                g61 = v10;
                g62 = v11;
                return g59;
            }
            // 0x8f651810
            str3 = str2 + strlen("BEGIN BUILD SIGNATURE") + 1;
            g65 = str3;
            g69 = (int32_t)&g52;
            v23 = (int32_t)&v2;
            v19 = strnlen((char *)str3, 100);
            if (v19 == 100) {
                // if_8f651838_0_true
                // branch -> 0x8f651860
            } else {
                int32_t v38 = v19; // 0x8f65182c57
                while (true) {
                    // 0x8f651844
                    v28 = v38 + 1;
                    v34 = g65;
                    if (v34 + v28 > g69) {
                        // 0x8f651858
                        // branch -> 0x8f651860
                        // 0x8f651860
                        v20 = print_log(1, (int32_t)"Build signature out of range\n", g63, g64, v22, (int32_t)v2, v28, v12, 0, v4, v5, v6, v7);
                        g59 = v20;
                        // branch -> 0x8f6518e8
                    } else {
                      lab_0x8f651868_3:;
                        char * str4 = (char *)v34;
                        g63 = 100;
                        v2 = str4;
                        int32_t strncmp_rc2 = strncmp(str4, "END BUILD SIGNATURE", 100); // 0x8f651878
                        g59 = strncmp_rc2;
                        if (strncmp_rc2 != 0) {
                            // 0x8f651884
                            g59 = v23;
                            int32_t v39 = g62; // 0x8f651888
                            g60 = v39;
                            g58 = -0x709ae770;
                            ((int32_t (*)(int32_t, int32_t))g61)(v23, v39);
                            g64 = v28;
                            int32_t str5 = g65 + v28; // 0x8f651894
                            g65 = str5;
                            int32_t v40 = strnlen((char *)str5, 100); // 0x8f65182c
                            if (v40 == 100) {
                                // break -> if_8f651838_0_true
                                break;
                            }
                            v38 = v40;
                            // continue -> 0x8f651844
                            continue;
                        }
                    }
                    // 0x8f6518e8
                    if (v12 != g57) {
                        // 0x8f6518fc
                        __stack_chk_fail();
                        // branch -> 0x8f651900
                    }
                    // 0x8f651900
                    g65 = v4;
                    g66 = v5;
                    g67 = v6;
                    g68 = v7;
                    g69 = v8;
                    g70 = v9;
                    g61 = v10;
                    g62 = v11;
                    return g59;
                }
                // if_8f651838_0_true
                // branch -> 0x8f651860
            }
            // 0x8f651860
            v20 = print_log(1, (int32_t)"Build signature line too long\n", g63, g64, v22, (int32_t)v2, 100, v12, 0, v4, v5, v6, v7);
            g59 = v20;
            // branch -> 0x8f6518e8
            // 0x8f6518e8
            if (v12 != g57) {
                // 0x8f6518fc
                __stack_chk_fail();
                // branch -> 0x8f651900
            }
            // 0x8f651900
            g65 = v4;
            g66 = v5;
            g67 = v6;
            g68 = v7;
            g69 = v8;
            g70 = v9;
            g61 = v10;
            g62 = v11;
            return g59;
        }
        // after_if_8f6517c0_0.thread
        // branch -> 0x8f651860
        // 0x8f651860
        v20 = print_log(1, (int32_t)"Build signature offset out of partition boundary\n", g63, g64, v22, (int32_t)v2, v21, v12, 0, v4, v5, v6, v7);
        g59 = v20;
        // branch -> 0x8f6518e8
    }
    // 0x8f6518e8
    if (v12 != g57) {
        // 0x8f6518fc
        __stack_chk_fail();
        // branch -> 0x8f651900
    }
    // 0x8f651900
    g65 = v4;
    g66 = v5;
    g67 = v6;
    g68 = v7;
    g69 = v8;
    g70 = v9;
    g61 = v10;
    g62 = v11;
    return g59;
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// void free(void * ptr);
// struct tm * gmtime_r(const time_t * restrict timer, struct tm * restrict tp);
// void * malloc(size_t size);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);
// size_t strnlen(const char * string, size_t maxlen);
// char * strrchr(char * s, int c);
// int vsprintf(char * restrict s, const char * restrict format, _G_va_list arg);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 30
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:51:25

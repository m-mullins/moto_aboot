//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t handle_fboot_oem_command_get_unlock_data(void);
int32_t handle_fboot_oem_command_prod_fuse(int32_t a1, int32_t a2);
int32_t oem_build_sig(int32_t a1, int32_t a2);
int32_t oem_display(int32_t a1, int32_t a2);
int32_t oem_dump_logs(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_led(int32_t a1, int32_t a2);
int32_t oem_logo(int32_t a1, int32_t a2);
int32_t oem_partition_usage(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_partitions(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_pmic(int32_t a1, int32_t a2, int32_t a3);
int32_t oem_read_sv(void);
int32_t oem_security_test(int32_t a1, int32_t a2);
int32_t oem_test_sp(int32_t a1, int32_t a2);
int32_t oem_usb_tune(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t ptn_stat(char * a1, int32_t * a2, int32_t * a3, int32_t * a4);
int32_t require_mot_fastboot(int32_t a1, int32_t a2, int32_t a3);
int32_t utag_name_prefix_found_cb(int32_t a1, char * str2, char * str);
int32_t utag_shortnameof(void);

// --------------------- Global Variables ---------------------

int32_t g22 = 0; // LR
int32_t g23 = 0; // R0
int32_t g24 = 0; // R1
int32_t g25 = 0; // R2
int32_t g26 = 0; // R3
int32_t g27 = 0; // R4
int32_t g28 = 0; // R5
int32_t g29 = 0; // R6
int32_t g30 = 0; // R7
int32_t g31 = 0; // R8
int32_t g1 = -0x16d2bfed; // 0x8f61c43c
int32_t g2 = -0x16d2bfed; // 0x8f61c478
int32_t g3 = -0x16d2bf10; // 0x8f61c4ac
int32_t g4 = -0x16d2bff0; // 0x8f61c534
int32_t g5 = -0x1a60cf20; // 0x8f61c5a8
int32_t g6 = -0x1a60cfc8; // 0x8f624774
int32_t g7 = -0x15ffffc8; // 0x8f625868
int32_t g8 = -0x1a60cf7c; // 0x8f63867c
int32_t g9 = -0x16d2bc09; // 0x8f638ab0
int32_t g10 = 0x746e6300; // 0x8f6a4e20
int32_t g11 = -0x709c73f8; // 0x8f6ac374
int32_t g12 = 0; // 0x8f6c05e0
char * g13; // 0x8f6c0600
int32_t g14 = 0; // 0x8f6c0624
int32_t (*g15)() = NULL; // 0x8f7112f4
char * g16; // 0x8f711580
char * g17; // 0x8f711588
char * g18; // 0x8f711589
char g19 = 0; // 0x8f71158a
char g20 = 0; // 0x8f71158b
int32_t g21 = 0; // 0x8f7125ec

// ------------------------ Functions -------------------------

// Address range: 0x8f6257c8 - 0x8f6259bb
int32_t oem_display(int32_t a1, int32_t a2) {
    // 0x8f6257c8
    int32_t v1;
    int32_t v2 = v1; // bp-44
    int32_t v3;
    int32_t v4 = v3; // bp-40
    int32_t v5 = g27; // 0x8f6257c8
    g31 = a2;
    int32_t (*v6)() = g15;
    int32_t v7 = (int32_t)v6;
    int32_t v8 = v7; // R3
    g30 = (int32_t)&g15;
    int32_t v9;
    int32_t v10;
    int32_t v11 = get_current_panel(a1, a2, g25, v7, v10, v1, v3, v9, 0, v7, v5); // 0x8f6257e8
    int32_t v12 = a1 - 1; // 0x8f6257ec
    g29 = v12;
    g27 = v11;
    if (a1 == 1) {
        int32_t v13 = (int32_t)"Display is off"; // 0x8f62594c
        if (is_display_on(v11) != 0) {
            // if_8f62580c_0_true
            v13 = (int32_t)"Display is on";
            // branch -> 0x8f62594c
        }
        // 0x8f62594c
        fboot_info((int32_t)"INFO", v13, v3, (int32_t)"Display is on", v10, v2, v4, v9, 0, v7, v5);
        // branch -> 0x8f625950
        // 0x8f625950
        if (v6 != g15) {
            // 0x8f625964
            __stack_chk_fail();
            // branch -> 0x8f625968
        }
        // 0x8f625968
        return 1;
    }
    // 0x8f625814
    if (v12 == 1) {
        int32_t str = *(int32_t *)(g31 + 4); // 0x8f625824
        g28 = str;
        g24 = (int32_t)"on";
        int32_t v14;
        if (strcmp((char *)str, "on") == 0) {
            // if_8f625838_0_true
            g23 = g29;
            v14 = *(int32_t *)((int32_t)&g11 + 28);
            // branch -> 0x8f625864
        } else {
            // 0x8f625848
            g24 = (int32_t)"off";
            int32_t strcmp_rc = strcmp((char *)g28, "off"); // 0x8f625850
            g23 = strcmp_rc;
            if (strcmp_rc != 0) {
                int32_t v15 = (int32_t)"info"; // R1
                int32_t strcmp_rc2 = strcmp((char *)g28, "info"); // 0x8f625874
                if (strcmp_rc2 != 0) {
                    // 0x8f62581c
                    oem_display_usage(strcmp_rc2, v15, g25, v8);
                    // branch -> 0x8f625950
                    // 0x8f625950
                    if (v6 != g15) {
                        // 0x8f625964
                        __stack_chk_fail();
                        // branch -> 0x8f625968
                    }
                    // 0x8f625968
                    return 1;
                }
                int32_t v16 = display_get_state(0, v15, g25); // 0x8f625880
                g28 = v16;
                int32_t v17; // 0x8f6258b8
                int32_t v18; // R2
                switch (v16) {
                    default: {
                        // 0x8f625898
                        v8 = (int32_t)"UNINIT";
                        v18 = (int32_t)"UNKNOWN";
                        if (v16 == 2) {
                            // if_8f6258a4_0_true
                            v18 = (int32_t)"UNINIT";
                            v17 = (int32_t)"UNINIT";
                            // branch -> 0x8f6258b0
                        } else {
                            v17 = (int32_t)"UNKNOWN";
                        }
                        break;
                    }
                    case 0: {
                        // if_8f625888_0_true
                        v18 = (int32_t)"OK";
                        v17 = (int32_t)"OK";
                        // branch -> 0x8f6258b0
                        break;
                    }
                    case 1: {
                        // 0x8f6258ac
                        v18 = (int32_t)"ERR";
                        v17 = (int32_t)"ERR";
                        // branch -> 0x8f6258b0
                        break;
                    }
                }
                int32_t v19 = fboot_info((int32_t)"INFO", (int32_t)"Status : %s", v17, v8, v10, v1, v3, v9, 0, v7, v5); // 0x8f6258b8
                fboot_info((int32_t)"INFO", (int32_t)"Auto detect status: %d", display_get_auto_detect_state(v19, (int32_t)"Status : %s", v18, v8), v8, v10, v1, v3, v9, 0, v7, v5);
                int32_t v20 = g27 + 8; // 0x8f6258d8
                fboot_info((int32_t)"INFO", (int32_t)"Panel name : %s", v20, v8, v10, v1, v3, v9, 0, v7, v5);
                if (g28 == 0) {
                    // 0x8f6258e8
                    get_panel_ver(g27, (int32_t)&v4, v20, v8, v10, v1, v3, v9, 0, v7);
                    int32_t v21 = v4; // 0x8f6258f4
                    g25 = v21;
                    g24 = (int32_t)"Panel version : 0x%llx";
                    fboot_info((int32_t)"INFO", (int32_t)"Panel version : 0x%llx", v21, v9, v10, v1, v21, v9, 0, v7, v5);
                    int32_t v22 = *(int32_t *)(g27 + 564); // 0x8f625904
                    g26 = v22;
                    if (v22 != 0) {
                        int32_t v23 = &v2; // 0x8f625910_0
                        g23 = v23;
                        g22 = -0x709da6e8;
                        ((int32_t (*)(int32_t))v22)(v23);
                        int32_t v24; // 0x8f625924
                        if (g23 == 0) {
                            // if_8f625924_0_true
                            v24 = v2;
                            // branch -> after_if_8f625928_0
                        } else {
                            // if_8f625928_0_true
                            v24 = g25 | 0xffff;
                            // branch -> after_if_8f625928_0
                        }
                        // after_if_8f625928_0
                        fboot_info((int32_t)"INFO", (int32_t)"Supplier ID : 0x%04x", v24, v22, v10, v24, v4, v9, 0, v7, v5);
                        // branch -> 0x8f625950
                    }
                } else {
                    // 0x8f625934
                    fboot_info((int32_t)"INFO", (int32_t)"Panel version : NA", v3, v9, v10, v1, v3, v9, 0, v7, v5);
                    // branch -> 0x8f62594c
                    // 0x8f62594c
                    fboot_info((int32_t)"INFO", (int32_t)"Supplier ID : NA", v3, v9, v10, v2, v4, v9, 0, v7, v5);
                    // branch -> 0x8f625950
                }
                // 0x8f625950
                if (v6 != g15) {
                    // 0x8f625964
                    __stack_chk_fail();
                    // branch -> 0x8f625968
                }
                // 0x8f625968
                return 1;
            }
            v14 = &g8;
        }
        // 0x8f625864
        g26 = v14;
        g22 = &g7;
        ((int32_t (*)())v14)();
        // branch -> 0x8f625950
    } else {
        // 0x8f62581c
        oem_display_usage(v11, a2, g25, v8);
        // branch -> 0x8f625950
    }
    // 0x8f625950
    if (v6 != g15) {
        // 0x8f625964
        __stack_chk_fail();
        // branch -> 0x8f625968
    }
    // 0x8f625968
    return 1;
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// int atoi(const char * nptr);
// long int atol(const char * nptr);
// void free(void * ptr);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strrchr(char * s, int c);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 18
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:38:36

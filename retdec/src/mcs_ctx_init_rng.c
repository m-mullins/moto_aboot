//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

// ------------------- Function Prototypes --------------------

int32_t __utag_is_protected(int32_t a1, int32_t a2);
int32_t __utag_unprotect(int32_t a1, int32_t a2, int32_t a3);
int32_t bq24296_get_ibuslim(int32_t a1, int32_t a2);
int32_t dbval_memcmp_value(int32_t a1, int32_t a2, int32_t a3);
int32_t dbval_sigreq_create_outer(char * a1, int32_t a2, int32_t a3);
int32_t display_get_left_lines(int32_t a1);
int32_t display_get_total_lines(int32_t a1, int32_t a2);
int32_t fan54046_modify(int32_t a1, int32_t a2, int32_t a3);
int32_t font_draw_char(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t font_draw_char_horizontal(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t font_get_x(int32_t a1, int32_t a2, int32_t a3);
int32_t font_get_y(int32_t a1, int32_t a2, int32_t a3);
void function_8f64b000(void);
void function_8f64b05c(char * a1, uint32_t a2, int32_t a3);
int32_t mcs_ctx_init_rng(int32_t a1, int32_t a2, int32_t a3, char * a4);
int32_t mcs_return_rng_data(char * a1, int32_t a2, int32_t a3);
int32_t mdp_get_revision(int32_t a1, int32_t a2, int32_t a3);
int32_t mdss_mdp_intf_offset(int32_t a1);
int32_t mipi_cmd_trigger(int32_t a1, int32_t a2);
int32_t mipi_dsi_cmdmode_enable(void);
int32_t panel_manager_get_panel_hbm_feat(void);
int32_t panel_manager_set_panel_hbm_feat(char a1, int32_t a2, int32_t a3);
int32_t sod_ramdump_enable(void);
int32_t sod_ramdump_pending_pull(int32_t a1, int32_t a2, int32_t a3);
int32_t tps65132_config(int32_t a1, int32_t a2, int32_t a3);
int32_t tps65132_init(int32_t a1);
int32_t ufs_get_page_size(int32_t a1);
int32_t ufs_get_serial_num(int32_t a1);

// --------------------- Global Variables ---------------------

int32_t g12 = 0; // LR
int32_t g13 = 0; // R0
int32_t g14 = 0; // R1
int32_t g15 = 0; // R12
int32_t g16 = 0; // R2
int32_t g17 = 0; // R3
int32_t g18 = 0; // R4
int32_t g19 = 0; // R5
int32_t g20 = 0; // R6
int32_t g21 = 0; // R7
int32_t g22 = 0; // R8
int32_t g23 = 0; // R9
int32_t g1 = 1; // 0x8f6ac0f0
char * g2 = "\x01"; // 0x8f6ac21c
int32_t g3 = 0; // 0x8f6b8af8
char * g4; // 0x8f6e0794
int32_t g5 = 0; // 0x8f6e0aa0
int32_t g6 = 0; // 0x8f6e0aac
int32_t g7 = 0; // 0x8f6e0bd8
int32_t g8 = 0; // 0x8f6e0bdc
int32_t g9 = 0; // 0x8f6e0be0
int32_t g10 = 0; // 0x8f6e0be4
int32_t g11 = 0; // 0x8f7112f4

// ------------------------ Functions -------------------------

// Address range: 0x8f667b28 - 0x8f667c6f
int32_t mcs_ctx_init_rng(int32_t a1, int32_t a2, int32_t a3, char * a4) {
    // 0x8f667b28
    int32_t v1;
    int32_t v2 = v1; // bp-152
    int32_t v3 = (int32_t)a4;
    int32_t v4 = v3; // R3
    int32_t v5 = 20; // R5
    int32_t v6 = g11;
    int32_t v7 = 20; // bp-156
    int32_t v8;
    int32_t v9;
    if (a4 == NULL) {
      lab_0x8f667c5c:;
        // 0x8f667c5c
        // branch -> 0x8f667c34
    } else {
        uint32_t v10 = (a1 + 242) % 256; // 0x8f667b60
        v4 = v10;
        int32_t result; // R4
        if (v10 < 4) {
            // if_8f667b68_0_true
            // branch -> 0x8f667c34
            // 0x8f667c34
            mcs_memset((int32_t)&v8, 0, 20, v4);
            v9 = g11;
            v4 = v9;
            if (v6 == v9) {
                // 0x8f667c64
                return 5;
            }
          lab_0x8f667c58_3:
            // 0x8f667c58
            __stack_chk_fail();
            // branch -> 0x8f667c5c
            goto lab_0x8f667c5c;
        } else {
            // 0x8f667b70
            if (a1 == 13) {
                int32_t v11 = v3 + 1; // R7
                int32_t v12 = mcs_memset(v3, 0, 21, v10); // 0x8f667b88
                int32_t v13 = &v8; // 0x8f667b8c_0
                mcs_rng_seed_data(v13, v5, v12, v4);
                int32_t v14 = v13; // R2
                v4 = v5;
                mcs_Random_secure_generate(v13, v5, v13, v5, v11, 0, 0, 20, v1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
                if (a2 != 0 && a3 != 0) {
                    int32_t v15 = &v2; // 0x8f667bc0_0
                    int32_t v16 = v15; // R1
                    int32_t v17 = mcs_ctx_init_hash(a1, v15, v14, v4, v11, 0, 0, 20); // 0x8f667bc4
                    result = v17;
                    if (v17 == 0) {
                        // 0x8f667bd0
                        v16 = a2;
                        v14 = a3;
                        int32_t v18 = mcs_hash_data(v15, a2, a3, v4, v11, 0, 0, 20, v2, 0, 0, 0, 0, 0, 0); // 0x8f667bdc
                        result = v15;
                        if (v18 == 0) {
                            // 0x8f667be8
                            v16 = v13;
                            int32_t v19 = &v7; // 0x8f667bf0_0
                            v14 = v19;
                            int32_t v20 = mcs_hash_end(v15, v13, v19, v4, v11, 0, 0, 20, v2, 0, 0, 0, 0, 0); // 0x8f667bf4
                            result = v15;
                            if (v20 == 0) {
                                // 0x8f667c00
                                v16 = v5;
                                v4 = v5;
                                v14 = v13;
                                mcs_Random_secure_generate(v13, v5, v13, v5, v11, 0, 0, v7, v2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
                                // branch -> 0x8f667c18
                            }
                        }
                    }
                    // 0x8f667c18
                    mcs_clear_hash_ctx(v15, v16, v14, v4, v11, 0, 0);
                    if (result != 0) {
                        // 0x8f667c34
                        mcs_memset((int32_t)&v8, 0, 20, v4);
                        v9 = g11;
                        v4 = v9;
                        if (v6 != v9) {
                            goto lab_0x8f667c58_3;
                        }
                        // 0x8f667c64
                        return result;
                    }
                }
                // 0x8f667c28
                result = 0;
                v4 = 18;
                *(char *)v3 = 18;
                // branch -> 0x8f667c34
              lab_0x8f667c34:
                // 0x8f667c34
                mcs_memset((int32_t)&v8, 0, 20, v4);
                v9 = g11;
                v4 = v9;
                if (v6 != v9) {
                    goto lab_0x8f667c58_3;
                }
                // 0x8f667c64
                return result;
            }
        }
        // 0x8f667c5c
        result = 1;
        // branch -> 0x8f667c34
        goto lab_0x8f667c34;
    }
    // 0x8f667c34
    mcs_memset((int32_t)&v8, 0, 20, v4);
    v9 = g11;
    v4 = v9;
    if (v6 != v9) {
        goto lab_0x8f667c58_3;
    }
    // 0x8f667c64
    return 1;
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// void * calloc(size_t nmemb, size_t size);
// void free(void * ptr);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 28
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:20:53

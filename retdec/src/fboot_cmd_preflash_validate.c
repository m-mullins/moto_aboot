//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t __gnu_ldivmod_helper(uint32_t a1, int32_t a2, int64_t a3, int32_t a4);
int32_t __gnu_uldivmod_helper(uint32_t a1, int32_t a2, int64_t a3, int32_t a4, int32_t * a5, int32_t a6, int32_t a7);
int32_t __utag_protect(int32_t a1, int32_t a2, int32_t a3);
int32_t __utag_unprotect(int32_t a1, int32_t a2, int32_t a3);
int32_t copy_git_line(int32_t * a1, int32_t a2, int32_t a3);
int32_t dbval_calc_hash(int32_t a1, int32_t a2, int32_t a3, int32_t * a4);
int32_t dbval_pal_get_serial_num_type(char * a1, int32_t a2, int32_t a3);
int32_t dbval_provision_cid_req(char * a1, int32_t * a2, int16_t * a3);
int32_t dbval_validate_signature(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t dbval_write_partition(int32_t a1, int32_t a2, int32_t a3);
int32_t display_draw_image_left(char * str, uint32_t a2, uint32_t a3, int32_t a4);
int32_t display_draw_image_right(char * str, uint32_t a2, uint32_t a3, int32_t a4);
int32_t fboot_cmd_preflash_validate(int32_t * a1);
int32_t fboot_oem_early_init(void);
int32_t get_accessory_type(int32_t a1);
int32_t is_ever_unlocked(int32_t a1, int32_t a2);
int32_t is_hv_charger_present(int32_t a1, int32_t a2);
int32_t is_ramdump_mode(int32_t a1, int32_t a2, int32_t a3);
int32_t is_reboot_bl_flag_set(int32_t a1, int32_t a2);
int32_t is_verified_boot_flow(int32_t a1, int32_t a2);
int32_t is_write_protect_supported(int32_t a1, int32_t a2);
int32_t oem_smb1359_usage(int32_t a1, int32_t a2, int32_t a3);
char * scm_elexec_call(int32_t a1, int32_t a2, int32_t a3);
char * scm_random(int32_t a1, int32_t a2, int32_t a3);
int32_t set_boot_item(int32_t result, int32_t a2, int32_t a3);
int32_t sod_ramdump_flag_pulled(int32_t a1, int32_t a2);
int32_t sod_reason(int32_t a1, int32_t a2);
int32_t target_early_init(void);
int32_t target_sdc_init(void);
int32_t unknown_69732061(int32_t a1);

// --------------------- Global Variables ---------------------

int32_t g44 = 0; // LR
int32_t g45 = 0; // R0
int32_t g46 = 0; // R1
int32_t g47 = 0; // R10
int32_t g48 = 0; // R11
int32_t g49 = 0; // R12
int32_t g50 = 0; // R2
int32_t g51 = 0; // R3
int32_t g52 = 0; // R4
int32_t g53 = 0; // R5
int32_t g54 = 0; // R6
int32_t g55 = 0; // R7
int32_t g56 = 0; // R8
int32_t g57 = 0; // R9
int32_t g1 = -0x1a60df7c; // 0x8f627e38
int32_t g2 = 6; // 0x8f67c000
int32_t g3 = 1799; // 0x8f67c004
int32_t g4 = 0x110a000; // 0x8f67c008
int32_t g5 = 3; // 0x8f67c00c
int32_t g6 = 1796; // 0x8f67c010
int32_t g7 = 0x110a000; // 0x8f67c014
int32_t g8 = 0; // 0x8f67c018
int32_t g9 = 1796; // 0x8f67c01c
int32_t g10 = 0x110a000; // 0x8f67c020
int32_t g11 = 13; // 0x8f67c024
int32_t g12 = 768; // 0x8f67c028
int32_t g13 = 0x110a000; // 0x8f67c02c
int32_t g14 = 11; // 0x8f67c030
int32_t g15 = 771; // 0x8f67c034
int32_t g16 = 0x110a000; // 0x8f67c038
int32_t g17 = 9; // 0x8f67c03c
int32_t g18 = 771; // 0x8f67c040
int32_t g19 = 0x110a000; // 0x8f67c044
int32_t g20 = 0x5b5e0029; // 0x8f687c45
int32_t g21 = 0x65440030; // 0x8f69c66f
int32_t g22 = 0x746e6300; // 0x8f6a4e20
int32_t g23 = 1; // 0x8f6ac0f0
char * g24 = "\n"; // 0x8f6afe00
int32_t g25 = 2; // 0x8f6afe0c
int32_t g26 = 0; // 0x8f6c02e0
char * g27; // 0x8f6c03bc
int32_t g28 = 0; // 0x8f6c0688
int32_t g29 = 0; // 0x8f6c068c
char * g30; // 0x8f6c0690
int32_t g31 = 0; // 0x8f6e0690
char * g32; // 0x8f6e0694
char * g33; // 0x8f6e0698
int32_t g34 = 0; // 0x8f6e0c38
int32_t g35 = 0; // 0x8f6e0c3c
char * g36; // 0x8f6e0c40
int32_t g37 = 0; // 0x8f70dac8
int32_t g38 = 0; // 0x8f70dacc
int32_t g39 = 0; // 0x8f70dad0
int32_t g40 = 0; // 0x8f70dad4
int32_t g41 = 0; // 0x8f7112dc
int32_t g42 = 0; // 0x8f7112f4
int32_t g43 = 0; // 0x8f7125ec

// ------------------------ Functions -------------------------

// Address range: 0x8f62f18c - 0x8f630637
int32_t fboot_cmd_preflash_validate(int32_t * a1) {
    // 0x8f62f18c
    int32_t v1;
    char * v2 = (char *)v1;
    int32_t v3;
    char * v4 = (char *)v3;
    int32_t v5;
    char * v6 = (char *)v5;
    int32_t v7;
    char * v8 = (char *)v7;
    int32_t v9 = (int32_t)a1;
    int32_t v10 = g42;
    g48 = *a1;
    g52 = *(int32_t *)(v9 + 8);
    int32_t str = *(int32_t *)(v9 + 12) + 1; // 0x8f62f1b0
    int32_t v11 = is_verified_boot_flow(v9, g46); // 0x8f62f1b8
    int32_t v12; // 0x8f63043c111
    int32_t v13; // 0x8f63043c112
    int32_t v14; // 0x8f63043c113
    int32_t v15; // 0x8f63043c114
    int32_t v16; // 0x8f63043c115
    int32_t v17; // 0x8f63043c117
    int32_t v18; // 0x8f63043c118
    int32_t v19; // 0x8f63043c121
    int32_t v20; // 0x8f63043c122
    int32_t v21; // 0x8f63043c123319
    int32_t v22; // 0x8f63043c127751
    int32_t v23;
    int32_t v24; // 0x8f63043c134
    int32_t v25; // 0x8f63043c135
    int32_t v26; // 0x8f63043c136
    int32_t v27; // 0x8f63043c137
    int32_t v28; // 0x8f63043c138
    int32_t v29; // 0x8f63043c140
    int32_t v30; // 0x8f63043c141
    int32_t v31; // 0x8f63043c144
    int32_t v32; // 0x8f63043c145
    int32_t v33; // 0x8f63043c146318
    int32_t v34; // 0x8f62f800
    int32_t v35; // 0x8f62fa00
    int32_t v36; // 0x8f62ff98
    int32_t v37; // 0x8f630160
    int32_t set_mem;
    int32_t v38; // 0x8f62f800
    int32_t v39; // 0x8f6305ac
    int32_t v40; // 0x8f62f88c
    int32_t v41; // 0x8f6305e458
    int32_t v42; // 0x8f6305e460
    int32_t v43; // 0x8f6305e461
    int32_t v44; // 0x8f6305e462
    int32_t v45; // 0x8f6305e463
    int32_t v46; // 0x8f6305e464
    int32_t v47; // 0x8f6305e465
    int32_t v48; // 0x8f6305e468
    int32_t v49; // 0x8f6305e469
    int32_t v50; // 0x8f6305e470
    int32_t v51; // 0x8f62f438_12
    int32_t * v52; // 0x8f62f794_0
    int32_t * v53; // 0x8f62f794_1
    int32_t * v54; // 0x8f62f8f0_0
    int32_t * v55; // 0x8f62f8f0_1
    int32_t v56; // 0x8f62f23c
    int32_t strcmp_rc2; // 0x8f62f24c
    int32_t v57; // 0x8f62f260
    int32_t len; // 0x8f62f2b8
    int32_t strncmp_rc; // 0x8f62f2c8
    char * v58; // 0x8f62f438
    int32_t v59; // 0x8f62f50c
    int32_t v60; // 0x8f62f574
    int32_t v61; // 0x8f62f5a0
    int32_t v62; // 0x8f62f7e0
    int32_t v63; // 0x8f62f800
    int32_t v64; // 0x8f62f824
    int32_t v65; // 0x8f62f83c
    int32_t v66; // 0x8f62f93c
    int32_t v67; // 0x8f62ff8c
    int32_t v68; // 0x8f62ffac
    int32_t v69; // 0x8f630150
    int32_t v70; // R1
    int32_t v71; // R4
    int32_t v72;
    int32_t v73;
    int32_t v74;
    int32_t v75;
    int32_t v76;
    int32_t v77;
    int32_t v78;
    int32_t v79;
    int32_t v80;
    int32_t v81;
    int32_t v82;
    int32_t v83;
    int32_t v84;
    int32_t v85;
    int32_t v86;
    int32_t v87;
    int32_t v88;
    int32_t v89;
    int32_t v90;
    int32_t v91;
    int32_t v92;
    int32_t v93;
    int32_t v94;
    int32_t v95;
    int32_t v96;
    int32_t v97;
    int32_t v98;
    int32_t v99;
    int32_t v100;
    int32_t v101;
    int32_t v102;
    int32_t v103;
    int32_t v104;
    int32_t v105;
    int32_t v106;
    int32_t v107;
    int32_t v108;
    int32_t v109;
    int32_t v110;
    int32_t v111;
    int32_t v112;
    int32_t v113;
    int32_t v114;
    int32_t v115;
    int32_t v116;
    int32_t v117;
    int32_t v118;
    int32_t v119;
    int32_t v120;
    int32_t v121;
    int32_t v122;
    int32_t v123;
    int32_t v124;
    int32_t v125;
    int32_t v126;
    int32_t v127;
    int32_t v128;
    int32_t v129;
    int32_t v130;
    int32_t v131;
    int32_t v132;
    int32_t v133;
    int32_t v134;
    int32_t v135;
    int32_t v136;
    int32_t v137;
    int32_t v138;
    int32_t v139;
    int32_t v140;
    int32_t v141;
    int32_t v142;
    int32_t v143;
    int32_t v144;
    int32_t v145;
    int32_t v146;
    char * str3;
    int32_t v147;
    int32_t v148;
    char * v149;
    char * v150;
    char * v151;
    char * v152;
    char * v153;
    char * v154;
    char * v155;
    char * v156;
    char * v157;
    char * v158;
    char * v159;
    char * v160;
    char * v161;
    char * v162;
    char * v163;
    char * v164;
    char * v165;
    char * v166;
    char * v167;
    char * v168;
    char * v169;
    char * v170;
    char * v171;
    int32_t v172;
    char * v173;
    char * v174;
    char * v175;
    char * v176;
    char * v177;
    char * v178;
    char * v179;
    char * v180;
    char * v181;
    char * v182;
    char * v183;
    char * v184;
    char * v185;
    char * v186;
    char * v187;
    char * v188;
    char * v189;
    char * v190;
    char * v191;
    char * v192;
    char * v193;
    char * v194;
    char * v195;
    char * v196;
    unsigned char v197;
    unsigned char v198;
    int32_t v199; // 0x8f62f268
    int32_t v200; // 0x8f62f5dc327
    int32_t v201;
    int32_t v202; // 0x8f62f7cc
    int32_t v203; // 0x8f62f8b8
    int32_t v204; // 0x8f62f90c
    int32_t v205; // 0x8f62f268
    int32_t v206; // 0x8f62f284
    uint32_t v207; // 0x8f62f488
    int32_t v208;
    int32_t v209;
    int32_t v210; // 0x8f62f79c
    int32_t v211; // 0x8f62f84c
    int32_t v212; // 0x8f62f8e0
    int32_t v213; // 0x8f62f8f8
    int32_t v214; // 0x8f62f94c
    int32_t v215; // 0x8f62f8e4
    int32_t v216; // 0x8f62f8fc
    int32_t v217; // 0x8f62f558
    int32_t v218; // 0x8f62f66c
    int32_t v219; // 0x8f62f7a4
    int32_t v220; // 0x8f62f7c0
    int32_t v221; // 0x8f62f8f0
    int32_t v222; // 0x8f62f904
    int32_t v223; // 0x8f62f238
    int32_t v224; // 0x8f62f26c
    int32_t v225; // 0x8f62f7ac
    int32_t v226; // 0x8f62f8d0
    int32_t v227; // 0x8f63011c
    int32_t v228; // 0x8f630144
    int32_t v229; // 0x8f630148
    int32_t v230; // 0x8f62f4d0
    uint32_t v231; // 0x8f62f270312
    int32_t v232; // 0x8f62f2a8
    char v233; // 0x8f62f44c
    char v234; // 0x8f62f450
    char v235; // 0x8f62f454
    char v236; // 0x8f62f45c
    char v237; // 0x8f62f460
    char v238; // 0x8f62f468
    char v239; // 0x8f62f470
    char v240; // 0x8f62f478
    char v241; // 0x8f62f47c
    char v242; // 0x8f62f484
    char v243; // 0x8f62f490
    char v244; // 0x8f62f498
    char v245; // 0x8f62f4a4
    char v246; // 0x8f62f4ac
    char v247; // 0x8f62f4b4
    int32_t v248; // 0x8f62f528
    char v249; // 0x8f62f540
    int32_t v250; // 0x8f62f55c
    int32_t v251; // 0x8f62f5c4
    int32_t v252; // 0x8f62f5f8
    uint32_t v253; // 0x8f62f794
    int32_t v254; // 0x8f62f798
    int32_t v255; // 0x8f62f7b0
    int32_t v256; // 0x8f62f7c0
    char v257; // 0x8f62f874
    int32_t v258; // 0x8f62f8b0
    uint32_t v259; // 0x8f62f8cc
    uint32_t v260; // 0x8f62f8f0
    int32_t v261; // 0x8f62f904
    char v262; // 0x8f62f9f4
    char v263; // 0x8f6304a8
    int32_t v264; // 0x8f62f27c
    int32_t v265; // 0x8f62f474
    uint32_t v266; // 0x8f62f4a0
    int32_t v267; // 0x8f62f4b8
    uint32_t v268; // 0x8f62f4c4
    int32_t v269; // 0x8f62f540
    int32_t v270; // 0x8f62f578
    int32_t v271; // 0x8f62f7ec
    uint32_t v272; // 0x8f62f80c
    int32_t v273; // 0x8f62f874
    int32_t v274; // 0x8f62f4d4
    int32_t v275; // 0x8f62f798
    int32_t v276; // 0x8f62f7b0
    int32_t v277; // 0x8f62f8cc
    if (v11 != 0) {
        // 0x8f62f1c4
        if (get_current_secure_state(v11, g46, g50, g51, v1, v3) == 3) {
            // 0x8f62f1d0
            g46 = (int32_t)"cid_prov";
            int32_t strcmp_rc = strcmp((char *)str, "cid_prov"); // 0x8f62f1d8
            int32_t v278; // R3
            char * v279;
            if (strcmp_rc != 0) {
                // 0x8f62f1e4
                show_locked_command_restriction(strcmp_rc, g46);
                char * v280 = v2;
                int32_t v281 = v73;
                int32_t v282 = v83;
                int32_t v283 = v84;
                int32_t v284 = v85; // 0x8f63043c142
                int32_t v285 = v86; // 0x8f63043c119
                int32_t v286 = v87;
                char * v287 = v8;
                int32_t v288 = v100;
                int32_t v289 = v111; // 0x8f6305e466
                char * v290 = v6;
                int32_t v291 = v112;
                char * v292 = v4;
                int32_t result = 3;
                // branch -> 0x8f6304cc
              lab_0x8f6304cc_6:
                // 0x8f6304cc
                g50 = v10;
                int32_t v293 = g42;
                g51 = v293;
                if (v10 == v293) {
                    // 0x8f630630
                    return result;
                }
                // 0x8f6304e0
                __stack_chk_fail();
                v189 = v280;
                v82 = v281;
                v143 = v282;
                v130 = v283;
                v30 = v284;
                v18 = v285;
                v92 = v286;
                v190 = v287;
                v104 = v288;
                v47 = v289;
                v191 = v290;
                v116 = v291;
                v192 = v292;
                // branch -> 0x8f6304e4
                // 0x8f6304e4
                if (is_skip_validation(result, g46, g50) == 0) {
                  lab_0x8f6304f0_6:;
                    int32_t v294 = (int32_t)v189;
                    int32_t v295 = (int32_t)v192;
                    int32_t v296 = (int32_t)v191;
                    if (is_skip_sparse_preflash_validation(g56, g46, g50, g51, v294, v295, v116, v296) == 0) {
                        unsigned char v297 = *(char *)(g56 + 49) % 16;
                        int32_t v298 = v297; // 0x8f630504
                        g51 = v298;
                        if (v297 == 6) {
                            // 0x8f630510
                            g51 = (int32_t)&g33;
                            *(char *)&g33 = 1;
                            char * v299 = get_partition_by_name(str, g46, g50, (int32_t)&g33, v294, v295, v116, v296, v47, 0, v104); // 0x8f630520
                            int32_t v300 = (int32_t)v299; // 0x8f630520_12
                            int32_t v301; // 0x8f630550
                            int32_t v302; // 0x8f630550
                            if (v299 == NULL) {
                                // if_8f630528_0_true
                                v302 = g51;
                                v301 = (int32_t)"Invalid partition name %s";
                                // branch -> 0x8f63054c
                              lab_0x8f63054c:
                                // 0x8f63054c
                                print_log(5, v301, str, v302, v294, v295, v116, v296, v47, 0, v104, (int32_t)v190, 0);
                                // branch -> 0x8f630554
                            } else {
                                unsigned char v303 = *(char *)(v300 + 49) % 16;
                                int32_t v304 = v303; // 0x8f630538
                                g51 = v304;
                                if (v303 == 6) {
                                    // 0x8f62f978
                                    memcpy((char *)&v72, v299, 128);
                                    int32_t v305 = g47; // 0x8f62f9a4
                                    g51 = v305;
                                    int32_t v306 = (int32_t)v190;
                                    int32_t v307 = validate_partition((int32_t)&v72, (int32_t)&g30, 0x20000, v305, v294, v295, v116, v296, v47, 0, v104, v306, 0, v92, v18, v30, 0, str, v130, v143); // 0x8f62f9b4
                                    if (v307 == 0) {
                                        int32_t v308 = (int32_t)&g30; // 0x8f62f9c4
                                        int32_t v309;
                                        int32_t v310 = remove_sp_block(str, v308, 0x20000, g51, v294, v295, v116, v296, v47, 0, v104, v306, 0, v92, v18, v30, 0, str, v130, v143, v9, v82, v309) == 0 ? (int32_t)"SP block for %s cleared" : (int32_t)"SP block not found for %s";
                                        print_log(1, v310, str, g51, v294, v295, v116, v296, v47, 0, v104, v306, 0);
                                        g46 = (int32_t)"PIV block for %s validated\n";
                                        g50 = str;
                                        v35 = print_log(1, (int32_t)"PIV block for %s validated\n", str, g51, v294, v295, v116, v296, v47, 0, v104, v306, 0);
                                        v173 = v189;
                                        v78 = v82;
                                        v138 = v143;
                                        v125 = v130;
                                        v25 = v30;
                                        v13 = v18;
                                        v88 = v92;
                                        v174 = v190;
                                        v108 = v104;
                                        v42 = v47;
                                        v175 = v191;
                                        v120 = v116;
                                        v176 = v192;
                                        // branch -> 0x8f62f9f0
                                      lab_0x8f62f9f0_2:
                                        // 0x8f62f9f0
                                        v262 = *(char *)&g30;
                                        int32_t v311; // 0x8f62fab4
                                        int32_t v312; // R0
                                        int32_t v313; // 0x8f62fb68
                                        if (v262 == 0) {
                                          lab_0x8f62fabc_20:
                                            // 0x8f62fabc
                                            g52 = (int32_t)&g27;
                                            int32_t v314 = (int32_t)g27;
                                            g45 = v314;
                                            int32_t v315 = *(int32_t *)(v314 + 4); // 0x8f62fac4
                                            g51 = v315;
                                            g44 = -0x709d0534;
                                            ((int32_t (*)(int32_t, int32_t))v315)(v314, v315);
                                            int32_t v316 = g45; // 0x8f62facc
                                            g53 = v316;
                                            char * v317 = g27;
                                            int32_t v318 = (int32_t)v317;
                                            g45 = v318;
                                            int32_t v319 = *(int32_t *)v317; // 0x8f62fad4
                                            g50 = v319;
                                            g44 = -0x709d0524;
                                            ((int32_t (*)(int32_t, int32_t))v319)(v318, v319);
                                            int32_t v320 = g56; // 0x8f62fadc
                                            char v321 = *(char *)(v320 + 41); // 0x8f62fadc
                                            char v322 = *(char *)(v320 + 40); // 0x8f62fae0
                                            g46 = 0;
                                            char v323 = *(char *)(v320 + 33); // 0x8f62fae8
                                            char v324 = *(char *)(v320 + 42); // 0x8f62faf0
                                            char v325 = *(char *)(v320 + 32); // 0x8f62faf4
                                            char v326 = *(char *)(v320 + 43); // 0x8f62fafc
                                            char v327 = *(char *)(v320 + 34); // 0x8f62fb04
                                            int32_t v328 = 0x1000000 * (int32_t)v326 | 0x10000 * (int32_t)v324 | (int32_t)v322 | 256 * (int32_t)v321; // 0x8f62fb08
                                            char v329 = *(char *)(v320 + 45); // 0x8f62fb0c
                                            char v330 = *(char *)(v320 + 44); // 0x8f62fb10
                                            char v331 = *(char *)(v320 + 35); // 0x8f62fb18
                                            uint32_t v332 = v328 + 1; // 0x8f62fb1c
                                            char v333 = *(char *)(v320 + 46); // 0x8f62fb24
                                            char v334 = *(char *)(v320 + 47); // 0x8f62fb2c
                                            v312 = g45 * v316;
                                            uint32_t v335 = 0x1000000 * (int32_t)v331 | 0x10000 * (int32_t)v327 | (int32_t)v325 | 256 * (int32_t)v323; // 0x8f62fb38
                                            char v336 = *(char *)(v320 + 37); // 0x8f62fb3c
                                            char v337 = *(char *)(v320 + 36); // 0x8f62fb40
                                            int32_t v338 = g56; // 0x8f62fb4c
                                            char v339 = *(char *)(v338 + 38); // 0x8f62fb4c
                                            int32_t v340 = 0x10000 * (int32_t)v339 | (int32_t)v337 | 256 * (int32_t)v336; // 0x8f62fb50
                                            g49 = v340;
                                            char v341 = *(char *)(v338 + 39); // 0x8f62fb54
                                            int32_t v342 = v332 - v335; // 0x8f62fb5c
                                            g52 = v342;
                                            int32_t v343 = (0x1000000 * (int32_t)v334 | 0x10000 * (int32_t)v333 | (int32_t)v330 | 256 * (int32_t)v329) + (int32_t)(v328 == -1) - (0x1000000 * (int32_t)v341 | v340) + (int32_t)(v332 < v335); // 0x8f62fb60
                                            g53 = v343;
                                            v313 = 512 * v342;
                                            g50 = v313;
                                            v311 = 512 * v343 | v342 / 0x800000;
                                            // branch -> 0x8f62faa0
                                        } else {
                                          lab_0x8f62fa00_20:;
                                            int32_t v344 = get_piv_image_size(v35, g46, g50, (int32_t)v262, (int32_t)v173, (int32_t)v176, v120); // 0x8f62fa00
                                            v312 = v344;
                                            int32_t v345 = g56; // 0x8f62fa08
                                            char v346 = *(char *)(v345 + 41); // 0x8f62fa08
                                            char v347 = *(char *)(v345 + 33); // 0x8f62fa0c
                                            char v348 = *(char *)(v345 + 32); // 0x8f62fa10
                                            char v349 = *(char *)(v345 + 34); // 0x8f62fa18
                                            char v350 = *(char *)(v345 + 35); // 0x8f62fa20
                                            g31 = v344;
                                            g32 = (char *)g46;
                                            char v351 = *(char *)(v345 + 40); // 0x8f62fa28
                                            char v352 = *(char *)(v345 + 42); // 0x8f62fa30
                                            char v353 = *(char *)(v345 + 43); // 0x8f62fa38
                                            int32_t v354 = 0x1000000 * (int32_t)v353 | 0x10000 * (int32_t)v352 | (int32_t)v351 | 256 * (int32_t)v346; // 0x8f62fa3c
                                            char v355 = *(char *)(v345 + 45); // 0x8f62fa40
                                            char v356 = *(char *)(v345 + 44); // 0x8f62fa44
                                            uint32_t v357 = v354 + 1; // 0x8f62fa48
                                            char v358 = *(char *)(v345 + 46); // 0x8f62fa50
                                            char v359 = *(char *)(v345 + 47); // 0x8f62fa58
                                            uint32_t v360 = 0x1000000 * (int32_t)v350 | 0x10000 * (int32_t)v349 | (int32_t)v348 | 256 * (int32_t)v347; // 0x8f62fa60
                                            char v361 = *(char *)(v345 + 37); // 0x8f62fa64
                                            char v362 = *(char *)(v345 + 36); // 0x8f62fa6c
                                            char v363 = *(char *)(v345 + 38); // 0x8f62fa74
                                            int32_t v364 = 0x10000 * (int32_t)v363 | (int32_t)v362 | 256 * (int32_t)v361; // 0x8f62fa78
                                            g49 = v364;
                                            char v365 = *(char *)(v345 + 39); // 0x8f62fa7c
                                            int32_t v366 = v357 - v360; // 0x8f62fa84
                                            g52 = v366;
                                            int32_t v367 = (0x1000000 * (int32_t)v359 | 0x10000 * (int32_t)v358 | (int32_t)v356 | 256 * (int32_t)v355) + (int32_t)(v354 == -1) - (0x1000000 * (int32_t)v365 | v364) + (int32_t)(v357 < v360); // 0x8f62fa88
                                            g53 = v367;
                                            int32_t v368 = 512 * v366 | 64; // 0x8f62fa98221
                                            g50 = v368;
                                            v313 = v368;
                                            v311 = 512 * v367 | v366 / 0x800000;
                                            // branch -> 0x8f62faa0
                                        }
                                        uint32_t v369 = g46; // 0x8f62faa0
                                        bool v370 = false; // 0x8f62faa8
                                        bool v371 = v369 >= v311; // 0x8f62faa8
                                        if (v369 == v311) {
                                            uint32_t v372 = v312; // 0x8f62faa4
                                            v370 = v372 == v313;
                                            v371 = v372 >= v313;
                                            // branch -> after_if_8f62faa4_0
                                        }
                                        // after_if_8f62faa4_0
                                        if (v370 || v371 ^ true) {
                                            char v373 = *(char *)&g30; // 0x8f62fb78
                                            g51 = v373;
                                            if (v373 == 0) {
                                                // 0x8f62fb74
                                                set_mem = v312;
                                                v177 = v173;
                                                v77 = v78;
                                                v137 = v138;
                                                v124 = v125;
                                                v24 = v25;
                                                v12 = v13;
                                                v99 = v88;
                                                v178 = v174;
                                                v107 = v108;
                                                v50 = v42;
                                                v179 = v175;
                                                v119 = v120;
                                                v180 = v176;
                                                // branch -> 0x8f63015c
                                              lab_0x8f63015c_4:
                                                // 0x8f63015c
                                                v71 = 1;
                                                v181 = v177;
                                                v76 = v77;
                                                v145 = v137;
                                                v132 = v124;
                                                v32 = v24;
                                                v20 = v12;
                                                v98 = v99;
                                                v182 = v178;
                                                v106 = v107;
                                                v49 = v50;
                                                v183 = v179;
                                                v118 = v119;
                                                v184 = v180;
                                                // branch -> 0x8f630160
                                              lab_0x8f630160_2:
                                                // 0x8f630160
                                                v279 = v181;
                                                if (is_validation_enabled((char *)set_mem, g46, g50, g51) == 0) {
                                                  lab_0x8f63016c_2:
                                                    // 0x8f63016c
                                                    g46 = (int32_t)"boot";
                                                    if (strcmp((char *)str, "boot") == 0) {
                                                        int32_t v374 = (int32_t)v184;
                                                        int32_t v375 = partition_get_index(str, g46, g50, g51, (int32_t)v181, v374); // 0x8f630184
                                                        if (v375 != -1) {
                                                            int32_t v376 = partition_get_offset(v375, g46, g50); // 0x8f630190
                                                            g53 = -0x79000000;
                                                            int32_t v377 = g46; // 0x8f6301a4
                                                            g55 = v377;
                                                            g54 = v376;
                                                            int32_t v378 = (int32_t)v183;
                                                            int32_t v379 = (int32_t)v182;
                                                            int32_t v380 = generic_mmc_read_logical(v376, v377, 2048, 0, -0x79000000, v374, v118, v378, v49, 0, v106, v379, 0, v98, v20, v32, 0, str, v132, v145, v9, v76, v309); // 0x8f6301ac
                                                            g50 = v380;
                                                            int32_t v381; // 0x8f630450
                                                            int32_t v382; // 0x8f63043c
                                                            char * v383;
                                                            if (v380 == 0) {
                                                                // 0x8f6301c0
                                                                g46 = (int32_t)"ANDROID!";
                                                                g50 = 8;
                                                                if (memcmp((char *)g53, "ANDROID!", 8) == 0) {
                                                                    int32_t v384 = *(int32_t *)(g53 + 36); // 0x8f6301d8
                                                                    g53 = v384;
                                                                    int32_t str2 = g48 + 64; // 0x8f6301dc
                                                                    g56 = str2;
                                                                    if (v384 == 0) {
                                                                        // if_8f6301e8_0_true
                                                                        g53 = 2048;
                                                                        // branch -> after_if_8f6301e8_0
                                                                    }
                                                                    // after_if_8f6301e8_0
                                                                    if (strlen((char *)str2) == 0) {
                                                                        // 0x8f6301f8
                                                                        if (strlen("@") != 0) {
                                                                            // 0x8f630208
                                                                            strncpy((char *)g56, "@", 512);
                                                                            // branch -> 0x8f630218
                                                                        }
                                                                    }
                                                                    int32_t v385 = *(int32_t *)(g48 + 16); // 0x8f630220
                                                                    print_log(2, (int32_t)"ramdisk_size=0x%08X in downloaded image\n", v385, 0, -0x79000000, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                    int32_t v386 = g48; // 0x8f630228
                                                                    int32_t v387 = *(int32_t *)(v386 + 16); // 0x8f630228
                                                                    v278 = v387;
                                                                    char * v388 = (char *)-0x79000000;
                                                                    int32_t v389;
                                                                    int32_t v390; // 0x8f6302f8
                                                                    int32_t v391; // 0x8f6302f0
                                                                    if (v387 == 0) {
                                                                        // 0x8f630234
                                                                        g57 = -0x79000000;
                                                                        int32_t v392 = *(int32_t *)-0x78fffff0; // 0x8f630238
                                                                        g56 = v392;
                                                                        if (v392 != 0) {
                                                                            int32_t v393 = g53; // 0x8f630248
                                                                            int32_t v394 = -v393; // 0x8f630248
                                                                            int32_t v395 = *(int32_t *)(v386 + 8); // 0x8f63024c
                                                                            uint32_t v396 = g54; // 0x8f630250
                                                                            uint32_t v397 = v396 + v393; // 0x8f630250
                                                                            uint32_t v398 = v397 + (*(int32_t *)-0x78fffff8 - 1 + v393 & v394); // 0x8f630270
                                                                            int32_t v399 = v392 - 1 + v393 & v394; // 0x8f63027c
                                                                            g56 = v399;
                                                                            int32_t v400 = v393 + v386 + (v393 - 1 + v395 & v394); // 0x8f630294
                                                                            g47 = v400;
                                                                            v278 = 0;
                                                                            char * v401 = (char *)v400;
                                                                            int32_t v402 = generic_mmc_read_logical(v398, (int32_t)(v397 < v396) + g55 + (int32_t)(v398 < v397), v399, 0, v400, v374, v118, v378, v49, 0, v106, v379, 0, v98, v20, v32, 0, str, v132, v145, v9, v76, v309); // 0x8f6302a0
                                                                            if (v402 == 0) {
                                                                                // 0x8f6302bc
                                                                                print_log(1, (int32_t)"load ramdisk from emmc to 0x%x, size 0x%x\n", g47, g56, v400, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                                int32_t v403 = *(int32_t *)(g57 + 16); // 0x8f6302d0
                                                                                g57 = v9;
                                                                                *(int32_t *)(g48 + 16) = v403;
                                                                                int32_t * v404 = (int32_t *)(g57 + 8); // 0x8f6302dc_0
                                                                                int32_t v405 = *v404; // 0x8f6302dc
                                                                                v278 = v405;
                                                                                int32_t v406 = g56 + v405; // 0x8f6302e0
                                                                                g56 = v406;
                                                                                *v404 = v406;
                                                                                v388 = v401;
                                                                                // branch -> 0x8f6302e8
                                                                            } else {
                                                                                // 0x8f6302ac
                                                                                print_log(-1, (int32_t)"Failed in loading ramdisk from boot image, %d\n", v402, v278, v400, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                                v388 = v401;
                                                                                // branch -> 0x8f6302e8
                                                                            }
                                                                            // 0x8f6302e8
                                                                            g46 = (int32_t)"dt_size=0x%08X in downloaded image\n";
                                                                            v391 = *(int32_t *)(g48 + 40);
                                                                            g50 = v391;
                                                                            v389 = (int32_t)v388;
                                                                            print_log(2, (int32_t)"dt_size=0x%08X in downloaded image\n", v391, v278, v389, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                            v390 = g48;
                                                                            v279 = v388;
                                                                            if (*(int32_t *)(v390 + 40) == 0) {
                                                                              lab_0x8f630304:
                                                                                // 0x8f630304
                                                                                v309 = 0;
                                                                                memcpy((char *)&v309, (char *)(v390 + 44 + g53), 4);
                                                                                int32_t v407 = v309; // 0x8f630324
                                                                                g50 = v407;
                                                                                print_log(2, (int32_t)"app_dtb_offset=0x%08X in zImage\n", v407, 0, v389, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                                int32_t v408 = v309; // 0x8f63032c
                                                                                g46 = v408;
                                                                                if (v408 != 0) {
                                                                                    int32_t v409 = g48; // 0x8f63034c
                                                                                    uint32_t v410 = *(int32_t *)(v409 + 8); // 0x8f63034c
                                                                                    if (v408 >= v410) {
                                                                                        // 0x8f630358
                                                                                        int32_t v411;
                                                                                        memcpy((char *)&v411, (char *)(v409 + v408 + g53), 40);
                                                                                        g46 = (int32_t)"dtb_hdr magic 0x%08X\n";
                                                                                        int32_t v412 = v411; // 0x8f630374
                                                                                        g50 = v412;
                                                                                        print_log(2, (int32_t)"dtb_hdr magic 0x%08X\n", v412, v410, v389, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                                        int32_t v413 = fdt_check_header((int32_t)&v411, g46, g50, v410, v389, v374, v118, v378, v49, 0, v106, v379, 0, v98, v20); // 0x8f630380
                                                                                        if (v413 == 0) {
                                                                                            v279 = v388;
                                                                                          lab_0x8f63048c_3:
                                                                                            // 0x8f63048c
                                                                                            if (v71 != 0) {
                                                                                                v280 = v279;
                                                                                                v281 = v76;
                                                                                                v282 = v145;
                                                                                                v283 = v132;
                                                                                                v284 = v32;
                                                                                                v285 = v20;
                                                                                                v286 = v98;
                                                                                                v287 = v182;
                                                                                                v288 = v106;
                                                                                                v289 = v49;
                                                                                                v290 = v183;
                                                                                                v291 = v118;
                                                                                                v292 = v184;
                                                                                                result = 1;
                                                                                                goto lab_0x8f6304cc_6;
                                                                                            }
                                                                                            v185 = v279;
                                                                                            v74 = v76;
                                                                                            v144 = v145;
                                                                                            v131 = v132;
                                                                                            v31 = v32;
                                                                                            v19 = v20;
                                                                                            v96 = v98;
                                                                                            v186 = v182;
                                                                                            v105 = v106;
                                                                                            v48 = v49;
                                                                                            v187 = v183;
                                                                                            v117 = v118;
                                                                                            v188 = v184;
                                                                                          lab_0x8f630498_7:
                                                                                            // 0x8f630498
                                                                                            *(char *)&g33 = 0;
                                                                                            v263 = *(char *)&g30;
                                                                                            if (v263 != 0) {
                                                                                              lab_0x8f6304b4_21:
                                                                                                // 0x8f6304b4
                                                                                                g50 = 0x20000;
                                                                                                memset((char *)&g30, 0, 0x20000);
                                                                                                // branch -> 0x8f6304bc
                                                                                            }
                                                                                          lab_0x8f6304bc_21:
                                                                                            // 0x8f6304bc
                                                                                            g46 = (int32_t)"Preflash validation failed";
                                                                                            fboot_info((int32_t)"INFO", (int32_t)"Preflash validation failed", g50, (int32_t)v263, (int32_t)v185, (int32_t)v188, v117, (int32_t)v187, v48, 0, v105);
                                                                                            v280 = v185;
                                                                                            v281 = v74;
                                                                                            v282 = v144;
                                                                                            v283 = v131;
                                                                                            v284 = v31;
                                                                                            v285 = v19;
                                                                                            v286 = v96;
                                                                                            v287 = v186;
                                                                                            v288 = v105;
                                                                                            v289 = v48;
                                                                                            v290 = v187;
                                                                                            v291 = v117;
                                                                                            v292 = v188;
                                                                                            result = 3;
                                                                                            // branch -> 0x8f6304cc
                                                                                            goto lab_0x8f6304cc_6;
                                                                                        }
                                                                                    }
                                                                                }
                                                                                // 0x8f630338
                                                                                g56 = -0x79000000;
                                                                                int32_t v414 = *(int32_t *)-0x78ffffd8; // 0x8f63033c
                                                                                g57 = v414;
                                                                                if (v414 == 0) {
                                                                                    v279 = v388;
                                                                                    goto lab_0x8f63048c_3;
                                                                                }
                                                                                int32_t v415 = g48; // 0x8f630390
                                                                                int32_t v416 = *(int32_t *)(v415 + 8); // 0x8f630390
                                                                                int32_t v417 = g53; // 0x8f630394
                                                                                int32_t v418 = -v417; // 0x8f630394
                                                                                int32_t v419 = *(int32_t *)(v415 + 16); // 0x8f630398
                                                                                uint32_t v420 = g54; // 0x8f63039c
                                                                                uint32_t v421 = v420 + v417; // 0x8f63039c
                                                                                int32_t v422 = v417 - 1; // 0x8f6303a8
                                                                                int32_t v423 = *(int32_t *)(v415 + 24); // 0x8f6303c4
                                                                                int32_t v424 = v417 + v414 - 1 & v418; // 0x8f6303d4
                                                                                g57 = v424;
                                                                                int32_t v425 = (v422 + v419 & v418) + (v416 - 1 + v417 & v418) + v417 + (v422 + v423 & v418) + v415; // 0x8f6303e8
                                                                                g47 = v425;
                                                                                uint32_t v426 = (v422 + *(int32_t *)-0x78fffff8 & v418) + v421; // 0x8f6303f8
                                                                                g54 = v426;
                                                                                int32_t v427 = (int32_t)(v426 < v421) + (int32_t)(v421 < v420) + g55; // 0x8f630400
                                                                                g55 = v427;
                                                                                uint32_t v428 = (v422 + *(int32_t *)-0x78fffff0 & v418) + v426; // 0x8f630410
                                                                                v383 = (char *)v425;
                                                                                int32_t v429 = v422 + *(int32_t *)-0x78ffffe8; // 0x8f630424
                                                                                g53 = v429;
                                                                                uint32_t v430 = (v429 & v418) + v428; // 0x8f630430
                                                                                v382 = generic_mmc_read_logical(v430, (int32_t)(v428 < v426) + v427 + (int32_t)(v430 < v428), v424, 0, v425, v374, v118, v378, v49, 0, v106, v379, 0, v98, v20, v32, 0, str, v132, v145, v9, v76, v309);
                                                                                g50 = v382;
                                                                                if (v382 == 0) {
                                                                                    // 0x8f630458
                                                                                    g46 = (int32_t)"load DT from emmc to 0x%x, size 0x%x\n";
                                                                                    int32_t v431 = g47; // 0x8f630464
                                                                                    g50 = v431;
                                                                                    print_log(1, (int32_t)"load DT from emmc to 0x%x, size 0x%x\n", v431, g57, v425, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                                    g53 = v9;
                                                                                    int32_t v432 = g48; // 0x8f630474
                                                                                    *(int32_t *)(v432 + 40) = *(int32_t *)(g56 + 40);
                                                                                    int32_t * v433 = (int32_t *)(g53 + 8); // 0x8f63047c_0
                                                                                    int32_t v434 = *v433; // 0x8f63047c
                                                                                    int32_t v435 = g57 + v434; // 0x8f630480
                                                                                    g57 = v435;
                                                                                    *v433 = v435;
                                                                                    update_ker_tags_rdisk_addr(v432, g46, g50, v434, v425, v374, v118);
                                                                                    v279 = v383;
                                                                                    // branch -> 0x8f63048c
                                                                                    goto lab_0x8f63048c_3;
                                                                                } else {
                                                                                    // 0x8f630448
                                                                                    g46 = (int32_t)"Failed in loading DT from boot image, %d\n";
                                                                                    v381 = (int32_t)"Failed in loading DT from boot image, %d\n";
                                                                                    // branch -> 0x8f630450
                                                                                  lab_0x8f630450:
                                                                                    // 0x8f630450
                                                                                    print_log(-1, v381, v382, 0, (int32_t)v383, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                                    v279 = v383;
                                                                                    // branch -> 0x8f63048c
                                                                                    goto lab_0x8f63048c_3;
                                                                                }
                                                                                int32_t v436 = v71; // 0x8f63048c
                                                                                if (v436 == 0) {
                                                                                    v185 = v279;
                                                                                    v74 = v76;
                                                                                    v144 = v145;
                                                                                    v131 = v132;
                                                                                    v31 = v32;
                                                                                    v19 = v20;
                                                                                    v96 = v98;
                                                                                    v186 = v182;
                                                                                    v105 = v106;
                                                                                    v48 = v49;
                                                                                    v187 = v183;
                                                                                    v117 = v118;
                                                                                    v188 = v184;
                                                                                    goto lab_0x8f630498_7;
                                                                                }
                                                                                v280 = v279;
                                                                                v281 = v76;
                                                                                v282 = v145;
                                                                                v283 = v132;
                                                                                v284 = v32;
                                                                                v285 = v20;
                                                                                v286 = v98;
                                                                                v287 = v182;
                                                                                v288 = v106;
                                                                                v289 = v49;
                                                                                v290 = v183;
                                                                                v291 = v118;
                                                                                v292 = v184;
                                                                                result = 1;
                                                                                goto lab_0x8f6304cc_6;
                                                                            }
                                                                          lab_0x8f63048c_4:
                                                                            // 0x8f63048c
                                                                            if (v71 == 0) {
                                                                                v185 = v279;
                                                                                v74 = v76;
                                                                                v144 = v145;
                                                                                v131 = v132;
                                                                                v31 = v32;
                                                                                v19 = v20;
                                                                                v96 = v98;
                                                                                v186 = v182;
                                                                                v105 = v106;
                                                                                v48 = v49;
                                                                                v187 = v183;
                                                                                v117 = v118;
                                                                                v188 = v184;
                                                                                goto lab_0x8f630498_7;
                                                                            }
                                                                            v280 = v279;
                                                                            v281 = v76;
                                                                            v282 = v145;
                                                                            v283 = v132;
                                                                            v284 = v32;
                                                                            v285 = v20;
                                                                            v286 = v98;
                                                                            v287 = v182;
                                                                            v288 = v106;
                                                                            v289 = v49;
                                                                            v290 = v183;
                                                                            v291 = v118;
                                                                            v292 = v184;
                                                                            result = 1;
                                                                            goto lab_0x8f6304cc_6;
                                                                        } else {
                                                                            v388 = (char *)-0x79000000;
                                                                        }
                                                                    }
                                                                    // 0x8f6302e8
                                                                    g46 = (int32_t)"dt_size=0x%08X in downloaded image\n";
                                                                    v391 = *(int32_t *)(g48 + 40);
                                                                    g50 = v391;
                                                                    v389 = (int32_t)v388;
                                                                    print_log(2, (int32_t)"dt_size=0x%08X in downloaded image\n", v391, v278, v389, v374, v118, v378, v49, 0, v106, v379, 0);
                                                                    v390 = g48;
                                                                    if (*(int32_t *)(v390 + 40) == 0) {
                                                                        goto lab_0x8f630304;
                                                                    }
                                                                    v279 = v388;
                                                                    goto lab_0x8f63048c_4;
                                                                } else {
                                                                    v279 = (char *)-0x79000000;
                                                                }
                                                            } else {
                                                                // if_8f6301b4_0_true
                                                                g46 = (int32_t)"Failed in loading boot image header, %d\n";
                                                                v382 = v380;
                                                                v383 = (char *)-0x79000000;
                                                                v381 = (int32_t)"Failed in loading boot image header, %d\n";
                                                                // branch -> 0x8f630450
                                                                goto lab_0x8f630450;
                                                            }
                                                            // 0x8f63048c
                                                            if (v71 == 0) {
                                                                v185 = v279;
                                                                v74 = v76;
                                                                v144 = v145;
                                                                v131 = v132;
                                                                v31 = v32;
                                                                v19 = v20;
                                                                v96 = v98;
                                                                v186 = v182;
                                                                v105 = v106;
                                                                v48 = v49;
                                                                v187 = v183;
                                                                v117 = v118;
                                                                v188 = v184;
                                                                goto lab_0x8f630498_7;
                                                            }
                                                            v280 = v279;
                                                            v281 = v76;
                                                            v282 = v145;
                                                            v283 = v132;
                                                            v284 = v32;
                                                            v285 = v20;
                                                            v286 = v98;
                                                            v287 = v182;
                                                            v288 = v106;
                                                            v289 = v49;
                                                            v290 = v183;
                                                            v291 = v118;
                                                            v292 = v184;
                                                            result = 1;
                                                            goto lab_0x8f6304cc_6;
                                                        } else {
                                                            v279 = v181;
                                                        }
                                                    } else {
                                                        v279 = v181;
                                                    }
                                                }
                                              lab_0x8f63048c_6:
                                                // 0x8f63048c
                                                if (v71 == 0) {
                                                    v185 = v279;
                                                    v74 = v76;
                                                    v144 = v145;
                                                    v131 = v132;
                                                    v31 = v32;
                                                    v19 = v20;
                                                    v96 = v98;
                                                    v186 = v182;
                                                    v105 = v106;
                                                    v48 = v49;
                                                    v187 = v183;
                                                    v117 = v118;
                                                    v188 = v184;
                                                    goto lab_0x8f630498_7;
                                                }
                                                v280 = v279;
                                                v281 = v76;
                                                v282 = v145;
                                                v283 = v132;
                                                v284 = v32;
                                                v285 = v20;
                                                v286 = v98;
                                                v287 = v182;
                                                v288 = v106;
                                                v289 = v49;
                                                v290 = v183;
                                                v291 = v118;
                                                v292 = v184;
                                                result = 1;
                                                goto lab_0x8f6304cc_6;
                                            } else {
                                                int32_t v437 = (int32_t)g27;
                                                g47 = v437;
                                                int32_t v438 = *(int32_t *)(v437 + 8); // 0x8f62fb8c
                                                g51 = v438;
                                                g45 = v437;
                                                g44 = -0x709d0468;
                                                ((int32_t (*)(int32_t, int32_t))v438)(v437, v438);
                                                int32_t v439 = g45; // 0x8f62fb98
                                                char * v440 = (char *)v439; // 0x8f62fb98_0
                                                g55 = v439;
                                                char * v441; // 0x8f62fbf8_0
                                                int32_t v442; // 0x8f62fbec
                                                int32_t v443; // 0x8f62fbf8
                                                int32_t v444; // 0x8f62fbec
                                                char v445; // 0x8f62fbf8
                                                int32_t v446; // 0x8f62fc9c
                                                int32_t v447; // 0x8f62fca0
                                                int32_t v448; // 0x8f62fbf8
                                                if (*v440 == 2) {
                                                    int32_t v449; // 0x8f62fbe4
                                                    int32_t v450; // 0x8f62fbe4
                                                    if (*v440 == 2) {
                                                        int32_t v451 = g47; // 0x8f62fbd0
                                                        int32_t v452 = *(int32_t *)(v451 + 12); // 0x8f62fbd0
                                                        g51 = v452;
                                                        g45 = v451;
                                                        g44 = -0x709d0424;
                                                        ((int32_t (*)(int32_t, int32_t))v452)(v451, v452);
                                                        int32_t v453 = g45; // 0x8f62fbdc
                                                        g55 = v453;
                                                        v439 = v453;
                                                        while (*(char *)v453 == 2) {
                                                            // 0x8f62fbd0
                                                            v451 = g47;
                                                            v452 = *(int32_t *)(v451 + 12);
                                                            g51 = v452;
                                                            g45 = v451;
                                                            g44 = -0x709d0424;
                                                            ((int32_t (*)(int32_t, int32_t))v452)(v451, v452);
                                                            v453 = g45;
                                                            g55 = v453;
                                                            v439 = v453;
                                                            // continue -> 0x8f62fbd0
                                                        }
                                                        // 0x8f62fbe4
                                                        v449 = *(int32_t *)(v439 + 8);
                                                        g52 = v449;
                                                        v450 = *(int32_t *)(v439 + 12);
                                                        g53 = v450;
                                                        v447 = v450;
                                                        v446 = v449;
                                                        // branch -> 0x8f62fbec
                                                      lab_0x8f62fbec_2:
                                                        // 0x8f62fbec
                                                        v442 = g47;
                                                        v444 = *(int32_t *)(v442 + 20);
                                                        g51 = v444;
                                                        g45 = v442;
                                                        g44 = -0x709d0408;
                                                        ((int32_t (*)(int32_t, int32_t))v444)(v442, v444);
                                                        v443 = g45;
                                                        v441 = (char *)v443;
                                                        v445 = *v441;
                                                        v448 = v445;
                                                        g57 = v443;
                                                        int32_t v454;
                                                        int32_t v455;
                                                        int32_t v456;
                                                        int32_t v457;
                                                        char * v458;
                                                        char * v459;
                                                        char * v460;
                                                        int32_t v461;
                                                        char * v462;
                                                        int32_t v463; // 0x8f62fc7c
                                                        if (v445 == 0) {
                                                          lab_0x8f62fc08:
                                                            // 0x8f62fc08
                                                            v457 = (int32_t)v174;
                                                            print_log(1, (int32_t)"Found last sparse image\n", g50, v448, (int32_t)v173, (int32_t)v176, v120, (int32_t)v175, v42, 0, v108, v457, 0);
                                                            v455 = 0;
                                                            v456 = 0;
                                                            // branch -> 0x8f62fc58
                                                        } else {
                                                          lab_0x8f62fc24:;
                                                            uint32_t v464; // 0x8f62fc44
                                                            int32_t v465; // 0x8f62fc4c
                                                            int32_t v466; // 0x8f62fc44
                                                            int32_t v467; // 0x8f62fc48
                                                            if (*v441 == 2) {
                                                                int32_t v468 = g47; // 0x8f62fc30
                                                                int32_t v469 = *(int32_t *)(v468 + 16); // 0x8f62fc30
                                                                g51 = v469;
                                                                g45 = v468;
                                                                g44 = -0x709d03c4;
                                                                ((int32_t (*)(int32_t, int32_t))v469)(v468, v469);
                                                                int32_t v470 = g45; // 0x8f62fc3c
                                                                g57 = v470;
                                                                v443 = v470;
                                                                while (*(char *)v470 == 2) {
                                                                    // 0x8f62fc30
                                                                    v468 = g47;
                                                                    v469 = *(int32_t *)(v468 + 16);
                                                                    g51 = v469;
                                                                    g45 = v468;
                                                                    g44 = -0x709d03c4;
                                                                    ((int32_t (*)(int32_t, int32_t))v469)(v468, v469);
                                                                    v470 = g45;
                                                                    g57 = v470;
                                                                    v443 = v470;
                                                                    // continue -> 0x8f62fc30
                                                                }
                                                                // 0x8f62fc44
                                                                v464 = *(int32_t *)(v443 + 16);
                                                                v466 = *(int32_t *)(v443 + 20);
                                                                v467 = *(int32_t *)(v443 + 12);
                                                                v465 = *(int32_t *)(v443 + 8) + v464;
                                                                v457 = (int32_t)v174;
                                                                v455 = v465;
                                                                v456 = v467 + v466 + (int32_t)(v465 < v464);
                                                                // branch -> 0x8f62fc58
                                                              lab_0x8f62fc58:
                                                                // 0x8f62fc58
                                                                g54 = &g28;
                                                                v458 = (char *)v446;
                                                                v459 = (char *)v447;
                                                                g52 = v455;
                                                                v460 = (char *)v456;
                                                                print_log(2, (int32_t)"currently: prev_offset = 0x%llx, head_offset = 0x%llx, tail_offset = 0x%llx\n", g28, g29, v446, v447, v455, v456, v42, 0, v108, v457, 0);
                                                                v461 = g28;
                                                                g50 = v461;
                                                                v463 = g29;
                                                                g51 = v463;
                                                                g53 = v463 | v461;
                                                                v462 = v458;
                                                                v454 = v88;
                                                                int32_t v471;
                                                                int32_t v472; // 0x8f62fd1c
                                                                int32_t v473; // 0x8f62fd24
                                                                int32_t v474; // 0x8f62fd1c
                                                                if (v461 != v463) {
                                                                  lab_0x8f62fc88:
                                                                    // 0x8f62fc88
                                                                    g52 = v446;
                                                                    g53 = v447;
                                                                    int32_t v475; // 0x8f63043c129
                                                                    int32_t v476; // 0x8f63043c148
                                                                    int32_t v477; // 0x8f6305e459
                                                                    int32_t v478;
                                                                    int32_t v479;
                                                                    int32_t v480;
                                                                    int32_t v481;
                                                                    char * v482;
                                                                    char * v483;
                                                                    char * v484;
                                                                    char * v485;
                                                                    if (v447 == v463) {
                                                                        // if_8f62fc90_0_true
                                                                        if (v446 >= v461) {
                                                                          lab_0x8f62fc98:
                                                                            // 0x8f62fc98
                                                                            g49 = &g43;
                                                                            int32_t v486 = v446 - v461; // 0x8f62fc9c
                                                                            g50 = v486;
                                                                            char v487 = *(char *)(g43 + 48); // 0x8f62fcac
                                                                            g46 = (int32_t)"hash the overlapped area: size=0x%llx, val=%d\n";
                                                                            print_log(1, (int32_t)"hash the overlapped area: size=0x%llx, val=%d\n", v486, v447 - v463 + (int32_t)(v446 < v461), (int32_t)v487, v447, v455, v456, v42, 0, v108, v457, 0);
                                                                            int32_t v488 = g47; // 0x8f62fcc0
                                                                            int32_t v489 = *(int32_t *)v488; // 0x8f62fcc0
                                                                            g51 = v489;
                                                                            g45 = v488;
                                                                            g44 = -0x709d0334;
                                                                            ((int32_t (*)(int32_t, int32_t))v489)(v488, v489);
                                                                            g49 = &g43;
                                                                            uint32_t v490 = g28;
                                                                            uint32_t v491 = g52; // 0x8f62fcdc
                                                                            int32_t v492 = v491 - v490; // 0x8f62fcdc
                                                                            g50 = v492;
                                                                            int32_t v493 = g53 - g29 + (int32_t)(v491 < v490); // 0x8f62fce0
                                                                            g51 = v493;
                                                                            int32_t v494 = (int32_t)*(char *)(g43 + 48); // 0x8f62fce4
                                                                            char * v495 = (char *)v494;
                                                                            int32_t v496 = validate_sparse_filled_data_isra_3(g56, v494, v492, v493, v494, v447, v455, v456, v42, 0, v108, v457, 0, (int32_t)&g43, v446, v447, 0, str, v455, v456); // 0x8f62fcec
                                                                            v482 = v495;
                                                                            v478 = v78;
                                                                            v476 = v447;
                                                                            v475 = v446;
                                                                            v479 = &g43;
                                                                            v483 = v174;
                                                                            v480 = v108;
                                                                            v477 = v42;
                                                                            v484 = v460;
                                                                            v481 = v455;
                                                                            v485 = v459;
                                                                            if (v496 == 0) {
                                                                                v462 = v495;
                                                                                v454 = &g43;
                                                                                // 0x8f62fd1c
                                                                                v472 = g47;
                                                                                v474 = *(int32_t *)(v472 + 24);
                                                                                g51 = v474;
                                                                                g45 = v472;
                                                                                v473 = g55;
                                                                                g46 = v473;
                                                                                g54 = v473;
                                                                                g44 = -0x709d02d0;
                                                                                ((int32_t (*)(int32_t, int32_t, int32_t))v474)(v472, v473, v474);
                                                                                v471 = g55;
                                                                                g52 = v471;
                                                                                int32_t v497; // 0x8f62fd6c
                                                                                int32_t v498;
                                                                                char * v499;
                                                                                int32_t v500;
                                                                                int32_t v501; // 0x8f62fd78
                                                                                if (v471 == g57) {
                                                                                  lab_0x8f62fd1c:;
                                                                                    // 0x8f62fd1c
                                                                                    // branch -> 0x8f62fd6c
                                                                                } else {
                                                                                  lab_0x8f62fd3c:;
                                                                                    int32_t v502 = v471; // 0x8f62fd44
                                                                                    // branch -> 0x8f62fd3c
                                                                                    int32_t v503; // 0x8f63043c130
                                                                                    int32_t v504; // 0x8f63043c149
                                                                                    int32_t v505;
                                                                                    int32_t v506;
                                                                                    int32_t v507;
                                                                                    int32_t v508;
                                                                                    char * v509;
                                                                                    char * v510;
                                                                                    char * v511;
                                                                                    while (true) {
                                                                                        int32_t v512 = g47; // 0x8f62fd40
                                                                                        g46 = v512;
                                                                                        g50 = v502;
                                                                                        int32_t v513 = validate_sparse_data(g56, v512, v502, g51, (int32_t)v462, v447, v455, v456, v42, 0, v108, v457, 0, v454, v446, v447, 0); // 0x8f62fd48
                                                                                        v505 = v78;
                                                                                        v504 = v447;
                                                                                        v503 = v446;
                                                                                        v509 = v174;
                                                                                        v506 = v108;
                                                                                        v510 = v460;
                                                                                        v507 = v455;
                                                                                        v511 = v459;
                                                                                        if (v513 == 0) {
                                                                                            int32_t v514 = g47; // 0x8f62fd54
                                                                                            int32_t v515 = *(int32_t *)(v514 + 12); // 0x8f62fd54
                                                                                            g51 = v515;
                                                                                            g45 = v514;
                                                                                            g44 = -0x709d02a0;
                                                                                            ((int32_t (*)(int32_t, int32_t))v515)(v514, v515);
                                                                                            g54 = g52;
                                                                                            v508 = g45;
                                                                                            g52 = v508;
                                                                                            if (v508 == g57) {
                                                                                                // break -> 0x8f62fd6c
                                                                                                break;
                                                                                            }
                                                                                            v502 = v508;
                                                                                            // continue -> 0x8f62fd3c
                                                                                            continue;
                                                                                        }
                                                                                      lab_0x8f630568_4:;
                                                                                        int32_t v516 = g28;
                                                                                        int32_t v517 = g29; // 0x8f630574
                                                                                        g56 = v517 | v516;
                                                                                        int32_t v518 = v516 == v517 ? (int32_t)"first" : (int32_t)"none-first"; // 0x8f63058c
                                                                                        int32_t v519 = g55; // 0x8f630588
                                                                                        g50 = v519;
                                                                                        int32_t v520 = g57; // 0x8f630590
                                                                                        g51 = v520;
                                                                                        print_log(0, (int32_t)"Failed to validate sparse image from %p to %p: %s image\n", v519, v520, v518, (int32_t)v511, v507, (int32_t)v510, v42, 0, v506, (int32_t)v509, 0);
                                                                                        v482 = (char *)v518;
                                                                                        v478 = v505;
                                                                                        v476 = v504;
                                                                                        v475 = v503;
                                                                                        v479 = v454;
                                                                                        v483 = v509;
                                                                                        v480 = v506;
                                                                                        v477 = v42;
                                                                                        v484 = v510;
                                                                                        v481 = v507;
                                                                                        v485 = v511;
                                                                                        // branch -> 0x8f630598
                                                                                      lab_0x8f630598:
                                                                                        // 0x8f630598
                                                                                        print_log(0, (int32_t)"Failed to validate sparse image\n", g50, g51, (int32_t)v482, (int32_t)v485, v481, (int32_t)v484, v477, 0, v480, (int32_t)v483, 0);
                                                                                        v193 = v482;
                                                                                        v110 = v480;
                                                                                        v41 = v477;
                                                                                        v195 = v484;
                                                                                        v122 = v481;
                                                                                        v196 = v485;
                                                                                        // branch -> 0x8f6305ac
                                                                                      lab_0x8f6305ac:
                                                                                        // 0x8f6305ac
                                                                                        fboot_info((int32_t)"INFO", (int32_t)"Failed to validate sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                                        v185 = v193;
                                                                                        v74 = v478;
                                                                                        v144 = v456;
                                                                                        v131 = v455;
                                                                                        v31 = v476;
                                                                                        v19 = v475;
                                                                                        v96 = v479;
                                                                                        v186 = v483;
                                                                                        v105 = v110;
                                                                                        v48 = v41;
                                                                                        v187 = v195;
                                                                                        v117 = v122;
                                                                                        v188 = v196;
                                                                                        // branch -> 0x8f630498
                                                                                        goto lab_0x8f630498_7;
                                                                                    }
                                                                                    // 0x8f62fd6c
                                                                                    v497 = get_validated_piv_size(v508, g46, g50, g51);
                                                                                    v501 = g46;
                                                                                    g53 = v501;
                                                                                    v498 = g31;
                                                                                    v499 = g32;
                                                                                    v500 = (int32_t)v499;
                                                                                    int32_t v521;
                                                                                    int32_t v522;
                                                                                    int32_t v523; // 0x8f63043c132
                                                                                    int32_t v524; // 0x8f63043c151
                                                                                    int32_t v525; // 0x8f62fdf4
                                                                                    int32_t v526; // 0x8f62fdf4
                                                                                    int32_t v527;
                                                                                    int32_t v528;
                                                                                    char * v529;
                                                                                    if (v500 == v501) {
                                                                                      lab_if_8f62fd84_0_true:
                                                                                        // if_8f62fd84_0_true
                                                                                        v529 = (char *)v501;
                                                                                        if (v498 <= v497) {
                                                                                          lab_0x8f62fd90:
                                                                                            // 0x8f62fd90
                                                                                            v523 = v446;
                                                                                            v526 = v497;
                                                                                            v522 = v498;
                                                                                            v527 = v78;
                                                                                            v524 = v447;
                                                                                            v528 = v501;
                                                                                            v521 = v500;
                                                                                            v525 = (int32_t)"Mismatched validation size:[0x%llx, 0x%llx]\n";
                                                                                            // branch -> 0x8f62fdf4
                                                                                          lab_0x8f62fdf4_2:
                                                                                            // 0x8f62fdf4
                                                                                            print_log(0, v525, v526, v528, v522, v521, v455, v456, v42, 0, v498, v500, 0);
                                                                                            v505 = v527;
                                                                                            v504 = v524;
                                                                                            v503 = v523;
                                                                                            v509 = v529;
                                                                                            v506 = v498;
                                                                                            v510 = v460;
                                                                                            v507 = v455;
                                                                                            v511 = (char *)v521;
                                                                                            // branch -> 0x8f630568
                                                                                            goto lab_0x8f630568_4;
                                                                                        }
                                                                                    } else {
                                                                                      lab_after_if_8f62fd84_0:
                                                                                        // after_if_8f62fd84_0
                                                                                        if (v500 <= v501) {
                                                                                            v529 = v499;
                                                                                            goto lab_0x8f62fd90;
                                                                                        }
                                                                                        v529 = v499;
                                                                                        // 0x8f62fda8
                                                                                        int32_t v530; // 0x8f63043c131
                                                                                        int32_t v531; // 0x8f63043c150
                                                                                        int32_t v532; // 0x8f62fe24
                                                                                        int32_t v533; // 0x8f62fe24
                                                                                        char * v534;
                                                                                        char * v535;
                                                                                        char * v536;
                                                                                        int32_t v537;
                                                                                        int32_t v538;
                                                                                        int32_t v539;
                                                                                        int32_t v540; // 0x8f62fe20
                                                                                        int32_t v541; // 0x8f62fdbc236
                                                                                        int32_t v542; // 0x8f62fe04
                                                                                        if (v455 == v456) {
                                                                                          lab_0x8f62fdc4:;
                                                                                            int32_t v543 = g57; // 0x8f62fdc8
                                                                                            int32_t * v544 = (int32_t *)(v543 + 16); // 0x8f62fdc8_0
                                                                                            int32_t v545 = *v544; // 0x8f62fdc8
                                                                                            int32_t * v546 = (int32_t *)(v543 + 20); // 0x8f62fdc8_1
                                                                                            int32_t v547 = *v546; // 0x8f62fdc8
                                                                                            int32_t v548 = v498 - v497; // 0x8f62fdcc
                                                                                            int32_t v549 = v500 - v501 + (int32_t)(v498 < v497); // 0x8f62fdd0
                                                                                            v278 = v549;
                                                                                            if (v547 == v549) {
                                                                                                // if_8f62fdd8_0_true
                                                                                                if (v545 >= v548) {
                                                                                                  lab_0x8f62fdfc:
                                                                                                    // 0x8f62fdfc
                                                                                                    *v544 = v548;
                                                                                                    *v546 = v278;
                                                                                                    v542 = v497;
                                                                                                    int32_t v550 = g53; // 0x8f62fe04
                                                                                                    print_log(1, (int32_t)"for last sparse, size is adjusted to 0x%llx, according to image size (0x%llx) and validated size (0x%llx)\n", v548, v278, v498, v500, v542, v550, v42, 0, v498, v500, 0);
                                                                                                    v532 = v278;
                                                                                                    v534 = (char *)v498;
                                                                                                    v531 = v547;
                                                                                                    v530 = v545;
                                                                                                    v535 = (char *)v550;
                                                                                                    v536 = v529;
                                                                                                    v541 = 1;
                                                                                                    // branch -> 0x8f62fe18
                                                                                                  lab_0x8f62fe18:
                                                                                                    // 0x8f62fe18
                                                                                                    v540 = g57;
                                                                                                    g50 = v540;
                                                                                                    v537 = (int32_t)v534;
                                                                                                    v538 = (int32_t)v536;
                                                                                                    v539 = (int32_t)v535;
                                                                                                    v533 = validate_sparse_data(g56, g47, v540, v532, v537, v538, v542, v539, v42, 0, v498, v500, 0, v454, v530, v531, 0);
                                                                                                    g46 = v533;
                                                                                                    if (v533 != 0) {
                                                                                                        v505 = v541;
                                                                                                        v504 = v531;
                                                                                                        v503 = v530;
                                                                                                        v509 = v529;
                                                                                                        v506 = v498;
                                                                                                        v510 = v535;
                                                                                                        v507 = v542;
                                                                                                        v511 = v536;
                                                                                                        goto lab_0x8f630568_4;
                                                                                                    }
                                                                                                  lab_0x8f62fe30:
                                                                                                    // 0x8f62fe30
                                                                                                    if (v541 == 0) {
                                                                                                        // 0x8f630620
                                                                                                        g51 = &g28;
                                                                                                        g53 = v456;
                                                                                                        g28 = v455;
                                                                                                        g29 = v456;
                                                                                                        set_mem = 0;
                                                                                                        v177 = v534;
                                                                                                        v77 = 0;
                                                                                                        v137 = v456;
                                                                                                        v124 = v455;
                                                                                                        v24 = v531;
                                                                                                        v12 = v530;
                                                                                                        v99 = v454;
                                                                                                        v178 = v529;
                                                                                                        v107 = v498;
                                                                                                        v50 = v42;
                                                                                                        v179 = v535;
                                                                                                        v119 = v542;
                                                                                                        v180 = v536;
                                                                                                        // branch -> 0x8f63015c
                                                                                                        goto lab_0x8f63015c_4;
                                                                                                    } else {
                                                                                                        int32_t v551 = g57; // 0x8f62fe3c
                                                                                                        uint32_t v552 = *(int32_t *)(v551 + 16); // 0x8f62fe3c
                                                                                                        g52 = v552;
                                                                                                        int32_t v553 = *(int32_t *)(v551 + 20); // 0x8f62fe3c
                                                                                                        g53 = v553;
                                                                                                        bool v554 = false; // 0x8f62fe48
                                                                                                        bool v555 = true; // 0x8f62fe48
                                                                                                        if (v553 == 0) {
                                                                                                            // if_8f62fe44_0_true
                                                                                                            v554 = v552 == 63;
                                                                                                            v555 = v552 > 62;
                                                                                                            // branch -> after_if_8f62fe44_0
                                                                                                        }
                                                                                                        // after_if_8f62fe44_0
                                                                                                        int32_t v556; // 0x8f6305b4
                                                                                                        char * v557;
                                                                                                        char * v558;
                                                                                                        char * v559;
                                                                                                        int32_t v560; // 0x8f62ff80
                                                                                                        int32_t v561; // 0x8f62ff60
                                                                                                        if (v554 || v555 ^ true) {
                                                                                                            // 0x8f62febc
                                                                                                            int32_t v562;
                                                                                                            int32_t v563 = &v562; // 0x8f62fec0_0
                                                                                                            memset((char *)&v562, 0, 64);
                                                                                                            int32_t v564 = g54; // 0x8f62fec8
                                                                                                            int32_t v565 = *(int32_t *)(v564 + 28); // 0x8f62fec8
                                                                                                            int32_t v566 = *(int32_t *)(v564 + 16); // 0x8f62fecc
                                                                                                            int32_t v567 = 64 - g52; // 0x8f62fed0
                                                                                                            g53 = v567;
                                                                                                            memcpy((char *)&v562, (char *)(v566 + v565 - v567), v567);
                                                                                                            print_log(2, (int32_t)"copy %d bytes from prev chunk %p\n", g53, g54, v537, v538, v542, v539, v42, 0, v498, v500, 0);
                                                                                                            memcpy((char *)(g53 + v563), (char *)*(int32_t *)(g57 + 28), g52);
                                                                                                            int32_t v568 = g52; // 0x8f62ff18
                                                                                                            g50 = v568;
                                                                                                            int32_t v569 = g57; // 0x8f62ff1c
                                                                                                            v278 = v569;
                                                                                                            print_log(2, (int32_t)"copy %d bytes from last chunk %p\n", v568, v569, v537, v538, v542, v539, v42, 0, v498, v500, 0);
                                                                                                            if (is_piv_tail(v563, 64, g50, v278) != 0) {
                                                                                                                int32_t v570 = g47; // 0x8f62ff44
                                                                                                                int32_t v571 = *(int32_t *)(v570 + 28); // 0x8f62ff44
                                                                                                                g51 = v571;
                                                                                                                g45 = v570;
                                                                                                                int32_t v572 = g57; // 0x8f62ff4c
                                                                                                                g46 = v572;
                                                                                                                g44 = -0x709d00ac;
                                                                                                                ((int32_t (*)(int32_t, int32_t, int32_t))v571)(v570, v572, v571);
                                                                                                                int32_t v573 = g54; // 0x8f62ff54
                                                                                                                int32_t * v574 = (int32_t *)(v573 + 16); // 0x8f62ff54_0
                                                                                                                uint32_t v575 = *v574; // 0x8f62ff54
                                                                                                                int32_t * v576 = (int32_t *)(v573 + 20); // 0x8f62ff54_1
                                                                                                                g46 = (int32_t)"found PIV tail in last two sparse chunk(%p, %p), remove %p, and update %p size to: 0x%llx, removed len=%d\n";
                                                                                                                uint32_t v577 = g53; // 0x8f62ff60
                                                                                                                v561 = v575 - v577;
                                                                                                                v278 = *v576 - (int32_t)(v575 < v577);
                                                                                                                *v574 = v561;
                                                                                                                *v576 = v278;
                                                                                                                int32_t v578 = v278; // 0x8f62ff6c
                                                                                                                int32_t v579 = g54; // 0x8f62ff70
                                                                                                                g50 = v579;
                                                                                                                int32_t v580 = g57; // 0x8f62ff74
                                                                                                                g51 = v580;
                                                                                                                v560 = g53;
                                                                                                                v556 = print_log(1, g46, v579, v580, v580, v579, v561, v578, v560, 0, v498, v500, 0);
                                                                                                                v557 = (char *)v580;
                                                                                                                v558 = (char *)v578;
                                                                                                                v559 = (char *)v579;
                                                                                                                // branch -> 0x8f6305b4
                                                                                                              lab_0x8f6305b4_2:;
                                                                                                                int32_t v581 = is_skip_validation(v556, g46, g50); // 0x8f6305b4
                                                                                                                int32_t v582 = v581; // 0x8f6305f8
                                                                                                                if (v581 == 0) {
                                                                                                                    int32_t v583 = (int32_t)v557;
                                                                                                                    int32_t v584 = (int32_t)v559;
                                                                                                                    int32_t v585 = (int32_t)v558;
                                                                                                                    int32_t v586 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v583, v584, v561, v585); // 0x8f6305c4
                                                                                                                    if (v586 == 0) {
                                                                                                                        int32_t v587 = piv_finish(0, g46, g50, g51, v583, v584, v561, v585); // 0x8f6305d0
                                                                                                                        if (v587 == -1) {
                                                                                                                            // 0x8f6305dc
                                                                                                                            print_log(5, (int32_t)"Failed to validate sparse image", g50, g51, v583, v584, v561, v585, v560, 0, v498, v500, 0);
                                                                                                                            v482 = v557;
                                                                                                                            v478 = v541;
                                                                                                                            v476 = v531;
                                                                                                                            v475 = v530;
                                                                                                                            v483 = v529;
                                                                                                                            v480 = v498;
                                                                                                                            v477 = v560;
                                                                                                                            v484 = v558;
                                                                                                                            v481 = v561;
                                                                                                                            v485 = v559;
                                                                                                                            // branch -> 0x8f630598
                                                                                                                            goto lab_0x8f630598;
                                                                                                                        } else {
                                                                                                                            v582 = v587;
                                                                                                                        }
                                                                                                                    } else {
                                                                                                                        v582 = v586;
                                                                                                                    }
                                                                                                                }
                                                                                                                // 0x8f6305ec
                                                                                                                g51 = (int32_t)&g33;
                                                                                                                g50 = 2;
                                                                                                                *(char *)&g33 = 2;
                                                                                                                int32_t v588 = is_validation_enabled((char *)v582, g46, 2, (int32_t)&g33); // 0x8f6305f8
                                                                                                                g46 = v588;
                                                                                                                if (v588 != 0) {
                                                                                                                    set_mem = v588;
                                                                                                                    v177 = v557;
                                                                                                                    v77 = v541;
                                                                                                                    v137 = v456;
                                                                                                                    v124 = v455;
                                                                                                                    v24 = v531;
                                                                                                                    v12 = v530;
                                                                                                                    v99 = v454;
                                                                                                                    v178 = v529;
                                                                                                                    v107 = v498;
                                                                                                                    v50 = v560;
                                                                                                                    v179 = v558;
                                                                                                                    v119 = v561;
                                                                                                                    v180 = v559;
                                                                                                                    goto lab_0x8f63015c_4;
                                                                                                                }
                                                                                                                char v589 = *(char *)&g30; // 0x8f630608
                                                                                                                g51 = v589;
                                                                                                                if (v589 == 0) {
                                                                                                                    set_mem = (int32_t)&g30;
                                                                                                                    v177 = v557;
                                                                                                                    v77 = v541;
                                                                                                                    v137 = v456;
                                                                                                                    v124 = v455;
                                                                                                                    v24 = v531;
                                                                                                                    v12 = v530;
                                                                                                                    v99 = v454;
                                                                                                                    v178 = v529;
                                                                                                                    v107 = v498;
                                                                                                                    v50 = v560;
                                                                                                                    v179 = v558;
                                                                                                                    v119 = v561;
                                                                                                                    v180 = v559;
                                                                                                                    goto lab_0x8f63015c_4;
                                                                                                                }
                                                                                                                // 0x8f630614
                                                                                                                g50 = 0x20000;
                                                                                                                set_mem = (int32_t)memset((char *)&g30, 0, 0x20000);
                                                                                                                v177 = v557;
                                                                                                                v77 = v541;
                                                                                                                v137 = v456;
                                                                                                                v124 = v455;
                                                                                                                v24 = v531;
                                                                                                                v12 = v530;
                                                                                                                v99 = v454;
                                                                                                                v178 = v529;
                                                                                                                v107 = v498;
                                                                                                                v50 = v560;
                                                                                                                v179 = v558;
                                                                                                                v119 = v561;
                                                                                                                v180 = v559;
                                                                                                                // branch -> 0x8f63015c
                                                                                                                goto lab_0x8f63015c_4;
                                                                                                            }
                                                                                                        } else {
                                                                                                            int32_t v590 = *(int32_t *)(v551 + 28); // 0x8f62fe4c
                                                                                                            if (is_piv_tail(v552 - 64 + v590, 64, g50, v278) != 0) {
                                                                                                                int32_t v591 = g57; // 0x8f62fe68
                                                                                                                int32_t * v592 = (int32_t *)(v591 + 16); // 0x8f62fe68_0
                                                                                                                uint32_t v593 = *v592; // 0x8f62fe68
                                                                                                                int32_t * v594 = (int32_t *)(v591 + 20); // 0x8f62fe68_1
                                                                                                                g46 = (int32_t)"found PIV tail in last sparse chunk %p, remove from sparse data, now size is 0x%llx\n";
                                                                                                                int32_t v595 = v593 - 64; // 0x8f62fe74
                                                                                                                int32_t v596 = *v594 - (int32_t)(v593 < 64); // 0x8f62fe78
                                                                                                                *v592 = v595;
                                                                                                                *v594 = v596;
                                                                                                                char * v597 = (char *)v595;
                                                                                                                char * v598 = (char *)v596;
                                                                                                                int32_t v599 = print_log(1, g46, g57, v596, v595, v596, v542, v539, v42, 0, v498, v500, 0); // 0x8f62fe88
                                                                                                                int32_t v600 = g57; // 0x8f62fe8c
                                                                                                                int32_t v601 = *(int32_t *)(v600 + 16); // 0x8f62fe8c
                                                                                                                g50 = v601;
                                                                                                                int32_t v602 = *(int32_t *)(v600 + 20); // 0x8f62fe8c
                                                                                                                g51 = v602;
                                                                                                                g53 = v602 | v601;
                                                                                                                if (v601 != v602) {
                                                                                                                    v556 = v599;
                                                                                                                    v557 = v597;
                                                                                                                    v560 = v42;
                                                                                                                    v558 = v535;
                                                                                                                    v561 = v542;
                                                                                                                    v559 = v598;
                                                                                                                    goto lab_0x8f6305b4_2;
                                                                                                                }
                                                                                                                // 0x8f62fe98
                                                                                                                g50 = v600;
                                                                                                                print_log(1, (int32_t)"remove empty last chunk %p\n", v600, v601, v595, v596, v542, v539, v42, 0, v498, v500, 0);
                                                                                                                int32_t v603 = g47; // 0x8f62fea8
                                                                                                                int32_t v604 = *(int32_t *)(v603 + 28); // 0x8f62fea8
                                                                                                                g51 = v604;
                                                                                                                g45 = v603;
                                                                                                                int32_t v605 = g57; // 0x8f62feb0
                                                                                                                g46 = v605;
                                                                                                                g44 = -0x709d0148;
                                                                                                                ((int32_t (*)(int32_t, int32_t, int32_t))v604)(v603, v605, v604);
                                                                                                                v556 = g45;
                                                                                                                v557 = v597;
                                                                                                                v560 = v42;
                                                                                                                v558 = v535;
                                                                                                                v561 = v542;
                                                                                                                v559 = v598;
                                                                                                                // branch -> 0x8f6305b4
                                                                                                                goto lab_0x8f6305b4_2;
                                                                                                            }
                                                                                                        }
                                                                                                        // 0x8f62ff38
                                                                                                        print_log(0, (int32_t)"Not found PIV tail in last image\n", g50, v278, v537, v538, v542, v539, v42, 0, v498, v500, 0);
                                                                                                        v505 = 1;
                                                                                                        v504 = v531;
                                                                                                        v503 = v530;
                                                                                                        v509 = v529;
                                                                                                        v506 = v498;
                                                                                                        v510 = v535;
                                                                                                        v507 = v542;
                                                                                                        v511 = v536;
                                                                                                        // branch -> 0x8f630568
                                                                                                        goto lab_0x8f630568_4;
                                                                                                    }
                                                                                                    // 0x8f63015c
                                                                                                    v71 = 1;
                                                                                                    v37 = set_mem;
                                                                                                    v181 = v177;
                                                                                                    v76 = v77;
                                                                                                    v145 = v137;
                                                                                                    v132 = v124;
                                                                                                    v32 = v24;
                                                                                                    v20 = v12;
                                                                                                    v98 = v99;
                                                                                                    v182 = v178;
                                                                                                    v106 = v107;
                                                                                                    v49 = v50;
                                                                                                    v183 = v179;
                                                                                                    v118 = v119;
                                                                                                    v184 = v180;
                                                                                                    // branch -> 0x8f630160
                                                                                                    goto lab_0x8f630160_2;
                                                                                                }
                                                                                            } else {
                                                                                                // after_if_8f62fdd8_0
                                                                                                if (v547 >= v549) {
                                                                                                    goto lab_0x8f62fdfc;
                                                                                                }
                                                                                                // 0x8f62fde4
                                                                                                v523 = v545;
                                                                                                v526 = v545;
                                                                                                v522 = v548;
                                                                                                v527 = 1;
                                                                                                v524 = v547;
                                                                                                v528 = v547;
                                                                                                v521 = v549;
                                                                                                v525 = (int32_t)"Not enough image size for validation: [0x%llx, 0x%llx]\n";
                                                                                                // branch -> 0x8f62fdf4
                                                                                                goto lab_0x8f62fdf4_2;
                                                                                            }
                                                                                            // 0x8f62fde4
                                                                                            v523 = v545;
                                                                                            v526 = v545;
                                                                                            v522 = v548;
                                                                                            v527 = 1;
                                                                                            v524 = v547;
                                                                                            v528 = v547;
                                                                                            v521 = v549;
                                                                                            v525 = (int32_t)"Not enough image size for validation: [0x%llx, 0x%llx]\n";
                                                                                            // branch -> 0x8f62fdf4
                                                                                            goto lab_0x8f62fdf4_2;
                                                                                        } else {
                                                                                          lab_after_if_8f62fdb8_0_thread238:
                                                                                            // after_if_8f62fdb8_0.thread238
                                                                                            v278 = 0;
                                                                                            v532 = 0;
                                                                                            v534 = v462;
                                                                                            v531 = v447;
                                                                                            v530 = v446;
                                                                                            v535 = v460;
                                                                                            v542 = v455;
                                                                                            v536 = v459;
                                                                                            v541 = 0;
                                                                                            // branch -> 0x8f62fe18
                                                                                            goto lab_0x8f62fe18;
                                                                                        }
                                                                                        int32_t v606 = g47; // 0x8f62fe18
                                                                                        int32_t v607 = g56; // 0x8f62fe1c
                                                                                        v540 = g57;
                                                                                        g50 = v540;
                                                                                        v537 = (int32_t)v534;
                                                                                        v538 = (int32_t)v536;
                                                                                        v539 = (int32_t)v535;
                                                                                        v533 = validate_sparse_data(v607, v606, v540, v532, v537, v538, v542, v539, v42, 0, v498, v500, 0, v454, v530, v531, 0);
                                                                                        g46 = v533;
                                                                                        if (v533 == 0) {
                                                                                            goto lab_0x8f62fe30;
                                                                                        }
                                                                                        v505 = v541;
                                                                                        v504 = v531;
                                                                                        v503 = v530;
                                                                                        v509 = v529;
                                                                                        v506 = v498;
                                                                                        v510 = v535;
                                                                                        v507 = v542;
                                                                                        v511 = v536;
                                                                                        goto lab_0x8f630568_4;
                                                                                    }
                                                                                    // 0x8f62fda8
                                                                                    if (v455 == v456) {
                                                                                        goto lab_0x8f62fdc4;
                                                                                    }
                                                                                    goto lab_after_if_8f62fdb8_0_thread238;
                                                                                }
                                                                                // 0x8f62fd6c
                                                                                v497 = get_validated_piv_size(g45, g46, g50, g51);
                                                                                v501 = g46;
                                                                                g53 = v501;
                                                                                v498 = g31;
                                                                                v499 = g32;
                                                                                v500 = (int32_t)v499;
                                                                                if (v500 == v501) {
                                                                                    goto lab_if_8f62fd84_0_true;
                                                                                }
                                                                                goto lab_after_if_8f62fd84_0;
                                                                            }
                                                                          lab_0x8f630598_3:
                                                                            // 0x8f630598
                                                                            print_log(0, (int32_t)"Failed to validate sparse image\n", g50, g51, (int32_t)v482, (int32_t)v485, v481, (int32_t)v484, v477, 0, v480, (int32_t)v483, 0);
                                                                            v193 = v482;
                                                                            v110 = v480;
                                                                            v41 = v477;
                                                                            v195 = v484;
                                                                            v122 = v481;
                                                                            v196 = v485;
                                                                            // branch -> 0x8f6305ac
                                                                            goto lab_0x8f6305ac;
                                                                        }
                                                                    } else {
                                                                        // after_if_8f62fc90_0
                                                                        if (v447 >= v463) {
                                                                            goto lab_0x8f62fc98;
                                                                        }
                                                                        // 0x8f62fcfc
                                                                        g56 = v446;
                                                                        g57 = v447;
                                                                        g50 = (int32_t)"validate_sparse_image";
                                                                        print_log(0, (int32_t)"%s: bogus sparse image: head_offset (0x%llx) is greater than prev_offset (0x%llx)\n", (int32_t)"validate_sparse_image", v463, v446, v447, v461, v463, v42, 0, v108, v457, 0);
                                                                        v482 = v458;
                                                                        v478 = v78;
                                                                        v476 = v447;
                                                                        v475 = v446;
                                                                        v479 = v88;
                                                                        v483 = v174;
                                                                        v480 = v108;
                                                                        v477 = v42;
                                                                        v484 = (char *)v463;
                                                                        v481 = v461;
                                                                        v485 = v459;
                                                                        // branch -> 0x8f630598
                                                                        goto lab_0x8f630598_3;
                                                                    }
                                                                    // 0x8f62fcfc
                                                                    g56 = v446;
                                                                    g57 = v447;
                                                                    g50 = (int32_t)"validate_sparse_image";
                                                                    print_log(0, (int32_t)"%s: bogus sparse image: head_offset (0x%llx) is greater than prev_offset (0x%llx)\n", (int32_t)"validate_sparse_image", v463, v446, v447, v461, v463, v42, 0, v108, v457, 0);
                                                                    v482 = v458;
                                                                    v478 = v78;
                                                                    v476 = v447;
                                                                    v475 = v446;
                                                                    v479 = v88;
                                                                    v483 = v174;
                                                                    v480 = v108;
                                                                    v477 = v42;
                                                                    v484 = (char *)v463;
                                                                    v481 = v461;
                                                                    v485 = v459;
                                                                    // branch -> 0x8f630598
                                                                    goto lab_0x8f630598_3;
                                                                }
                                                              lab_0x8f62fd1c_2:
                                                                // 0x8f62fd1c
                                                                v472 = g47;
                                                                v474 = *(int32_t *)(v472 + 24);
                                                                g51 = v474;
                                                                g45 = v472;
                                                                v473 = g55;
                                                                g46 = v473;
                                                                g54 = v473;
                                                                g44 = -0x709d02d0;
                                                                ((int32_t (*)(int32_t, int32_t, int32_t))v474)(v472, v473, v474);
                                                                v471 = g55;
                                                                g52 = v471;
                                                                if (v471 == g57) {
                                                                    goto lab_0x8f62fd1c;
                                                                }
                                                                goto lab_0x8f62fd3c;
                                                            }
                                                            // 0x8f62fc44
                                                            v464 = *(int32_t *)(v443 + 16);
                                                            v466 = *(int32_t *)(v443 + 20);
                                                            v467 = *(int32_t *)(v443 + 12);
                                                            v465 = *(int32_t *)(v443 + 8) + v464;
                                                            v457 = (int32_t)v174;
                                                            v455 = v465;
                                                            v456 = v467 + v466 + (int32_t)(v465 < v464);
                                                            // branch -> 0x8f62fc58
                                                            goto lab_0x8f62fc58;
                                                        }
                                                        // 0x8f62fc58
                                                        g54 = &g28;
                                                        v458 = (char *)v446;
                                                        v459 = (char *)v447;
                                                        g52 = v455;
                                                        v460 = (char *)v456;
                                                        print_log(2, (int32_t)"currently: prev_offset = 0x%llx, head_offset = 0x%llx, tail_offset = 0x%llx\n", g28, g29, v446, v447, v455, v456, v42, 0, v108, v457, 0);
                                                        v461 = g28;
                                                        g50 = v461;
                                                        v463 = g29;
                                                        g51 = v463;
                                                        g53 = v463 | v461;
                                                        if (v461 == v463) {
                                                            v462 = v458;
                                                            v454 = v88;
                                                            goto lab_0x8f62fd1c_2;
                                                        }
                                                        goto lab_0x8f62fc88;
                                                    }
                                                    // 0x8f62fbe4
                                                    v449 = *(int32_t *)(v439 + 8);
                                                    g52 = v449;
                                                    v450 = *(int32_t *)(v439 + 12);
                                                    g53 = v450;
                                                    v447 = v450;
                                                    v446 = v449;
                                                    // branch -> 0x8f62fbec
                                                    goto lab_0x8f62fbec_2;
                                                } else {
                                                    // 0x8f62fba8
                                                    g46 = &g28;
                                                    g50 = 0;
                                                    g28 = 0;
                                                    g29 = 0;
                                                    v447 = 0;
                                                    v446 = 0;
                                                    // branch -> 0x8f62fbec
                                                    goto lab_0x8f62fbec_2;
                                                }
                                                // 0x8f62fbec
                                                v442 = g47;
                                                v444 = *(int32_t *)(v442 + 20);
                                                g51 = v444;
                                                g45 = v442;
                                                g44 = -0x709d0408;
                                                ((int32_t (*)(int32_t, int32_t))v444)(v442, v444);
                                                v443 = g45;
                                                v441 = (char *)v443;
                                                v445 = *v441;
                                                v448 = v445;
                                                g57 = v443;
                                                if (v445 == 0) {
                                                    goto lab_0x8f62fc08;
                                                }
                                                goto lab_0x8f62fc24;
                                            }
                                          lab_0x8f6305ac_3:
                                            // 0x8f6305ac
                                            fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                            v185 = v193;
                                            v74 = v82;
                                            v144 = v143;
                                            v131 = v130;
                                            v31 = v30;
                                            v19 = v18;
                                            v96 = v92;
                                            v186 = v194;
                                            v105 = v110;
                                            v48 = v41;
                                            v187 = v195;
                                            v117 = v122;
                                            v188 = v196;
                                            // branch -> 0x8f630498
                                            goto lab_0x8f630498_7;
                                        } else {
                                            // 0x8f62faac
                                            print_log(5, (int32_t)"Image is too large", v313, v311, (int32_t)v173, (int32_t)v176, v120, (int32_t)v175, v42, 0, v108, (int32_t)v174, 0);
                                            v185 = v173;
                                            v74 = v78;
                                            v144 = v138;
                                            v131 = v125;
                                            v31 = v25;
                                            v19 = v13;
                                            v96 = v88;
                                            v186 = v174;
                                            v105 = v108;
                                            v48 = v42;
                                            v187 = v175;
                                            v117 = v120;
                                            v188 = v176;
                                            // branch -> 0x8f630498
                                            goto lab_0x8f630498_7;
                                        }
                                      lab_0x8f630498_8:
                                        // 0x8f630498
                                        *(char *)&g33 = 0;
                                        v263 = *(char *)&g30;
                                        if (v263 == 0) {
                                            goto lab_0x8f6304bc_21;
                                        }
                                        goto lab_0x8f6304b4_21;
                                    }
                                } else {
                                    // 0x8f630544
                                    v302 = v304;
                                    v301 = (int32_t)"Mismatched sign type for partition %s";
                                    // branch -> 0x8f63054c
                                    goto lab_0x8f63054c;
                                }
                                // 0x8f630554
                                g50 = str;
                                print_log(5, (int32_t)"Invalid PIV signed %s image", str, g51, v294, v295, v116, v296, v47, 0, v104, (int32_t)v190, 0);
                                // branch -> 0x8f62f890
                              lab_0x8f62f890:
                                // 0x8f62f890
                                v193 = v189;
                                v194 = v190;
                                v110 = v104;
                                v41 = v47;
                                v195 = v191;
                                v122 = v116;
                                v196 = v192;
                                v39 = (int32_t)"Invalid signed image";
                                // branch -> 0x8f6305ac
                                goto lab_0x8f6305ac_3;
                            }
                            // 0x8f630554
                            g50 = str;
                            print_log(5, (int32_t)"Invalid PIV signed %s image", str, g51, v294, v295, v116, v296, v47, 0, v104, (int32_t)v190, 0);
                            // branch -> 0x8f62f890
                            goto lab_0x8f62f890;
                        } else {
                            v164 = v189;
                            v165 = v190;
                            v101 = v104;
                            v45 = v47;
                            v166 = v191;
                            v113 = v116;
                            v167 = v192;
                            // 0x8f62f858
                            print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v298, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                            v193 = v164;
                            v194 = v165;
                            v110 = v101;
                            v41 = v45;
                            v195 = v166;
                            v122 = v113;
                            v196 = v167;
                            v39 = (int32_t)"Not supported signed sparse image";
                            // branch -> 0x8f6305ac
                            goto lab_0x8f6305ac_3;
                        }
                        int32_t v608 = g50; // 0x8f6305ac
                        int32_t v609 = g51; // 0x8f6305ac
                        fboot_info((int32_t)"INFO", v39, v608, v609, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                        v185 = v193;
                        v74 = v75;
                        v144 = v141;
                        v131 = v128;
                        v31 = v28;
                        v19 = v16;
                        v96 = v97;
                        v186 = v194;
                        v105 = v110;
                        v48 = v41;
                        v187 = v195;
                        v117 = v122;
                        v188 = v196;
                        // branch -> 0x8f630498
                        goto lab_0x8f630498_8;
                    }
                }
                // 0x8f62f7f8
                g46 = (int32_t)"skip validating PIV image\n";
                v160 = v189;
                v161 = v190;
                v109 = v104;
                v43 = v47;
                v162 = v191;
                v121 = v116;
                v163 = v192;
                // branch -> 0x8f62f800
                // 0x8f62f800
                v63 = print_log(1, (int32_t)"skip validating PIV image\n", g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                v35 = v63;
                v173 = v160;
                v78 = v82;
                v138 = v143;
                v125 = v130;
                v25 = v30;
                v13 = v18;
                v88 = v92;
                v174 = v161;
                v108 = v109;
                v42 = v43;
                v175 = v162;
                v120 = v121;
                v176 = v163;
                // branch -> 0x8f62f9f0
                goto lab_0x8f62f9f0_2;
            }
            // 0x8f62f1ec
            str3 = (char *)str;
            char * v610;
            char * v611;
            if (strcmp(str3, "system") != 0) {
                // 0x8f62f200
                if (strcmp(str3, "oem") != 0) {
                    // 0x8f62f220
                    if (strcmp(str3, "partition") == 0) {
                        // 0x8f62f234
                        v223 = g52;
                        g46 = v223;
                        v56 = validate_gpt_image(g48, v223, g50, g51, v1, v3, v112, v5, v111, 0);
                        // branch -> 0x8f630154
                        // 0x8f630154
                        if (v56 != 0) {
                            v185 = v2;
                            v74 = v73;
                            v144 = v83;
                            v131 = v84;
                            v31 = v85;
                            v19 = v86;
                            v96 = v87;
                            v186 = v8;
                            v105 = v100;
                            v48 = v111;
                            v187 = v6;
                            v117 = v112;
                            v188 = v4;
                          lab_0x8f630498_14:
                            // 0x8f630498
                            *(char *)&g33 = 0;
                            v263 = *(char *)&g30;
                            if (v263 == 0) {
                                goto lab_0x8f6304bc_21;
                            }
                            goto lab_0x8f6304b4_21;
                        }
                    } else {
                        // 0x8f62f244
                        strcmp_rc2 = strcmp(str3, "motoboot");
                        g53 = strcmp_rc2;
                        if (strcmp_rc2 == 0) {
                            // 0x8f62f258
                            g46 = (int32_t)"start motoboot image validation\n";
                            v57 = print_log(1, (int32_t)"start motoboot image validation\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                            g47 = &g43;
                            v199 = g48;
                            v205 = v199 + 1024;
                            g55 = v205;
                            v224 = g53;
                            g54 = v224;
                            v231 = *(int32_t *)v199;
                            g51 = v231;
                            if (v224 >= v231) {
                                int32_t v612 = v205; // 0x8f62f280
                                int32_t v613 = v224; // 0x8f62f280
                                int32_t v614 = v224; // 0x8f62f27c
                                int32_t v615 = v199; // 0x8f62f27c
                                v21 = v86;
                                v33 = v85;
                                v133 = v84;
                                v146 = v83;
                                while (true) {
                                    // 0x8f62f27c
                                    v264 = 32 * v614 + v615;
                                    g55 = v613 + v612;
                                    v206 = v264 + 4;
                                    g57 = v206;
                                    v232 = *(int32_t *)(g43 + 8);
                                    g51 = v232;
                                    g53 = v232 * (*(int32_t *)(v264 + 32) + 1 - *(int32_t *)(v264 + 28));
                                    print_log(1, (int32_t)"Validating motoboot image: %s...\n", v206, v232, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                    len = strlen("partition");
                                    g50 = len;
                                    strncmp_rc = strncmp((char *)g57, "partition", len);
                                    v71 = strncmp_rc;
                                    int32_t v616; // 0x8f63043c124
                                    int32_t v617; // 0x8f63043c147
                                    int32_t v618;
                                    int32_t v619;
                                    int32_t v620;
                                    if (strncmp_rc == 0) {
                                      lab_0x8f62f2d4_4:;
                                        int32_t v621 = g53; // 0x8f62f2d8
                                        g46 = v621;
                                        if (validate_gpt_image(g55, v621, g50, g51, v1, v3, v112, v5, v111, 0) == 0) {
                                            v620 = v146;
                                            v619 = v133;
                                            v617 = v33;
                                            v616 = v21;
                                          lab_0x8f62f414:;
                                            int32_t v622 = (g54 + 1) % 256; // 0x8f62f418
                                            g54 = v622;
                                            int32_t v623 = g48; // 0x8f62f270
                                            uint32_t v624 = *(int32_t *)v623; // 0x8f62f270
                                            g51 = v624;
                                            if (v622 < v624) {
                                                // 0x8f63015c
                                                v71 = 1;
                                                v181 = v2;
                                                v76 = v73;
                                                v145 = v620;
                                                v132 = v619;
                                                v32 = v617;
                                                v20 = v616;
                                                v98 = v87;
                                                v182 = v8;
                                                v106 = v100;
                                                v49 = v111;
                                                v183 = v6;
                                                v118 = v112;
                                                v184 = v4;
                                                // branch -> 0x8f630160
                                                goto lab_0x8f630160_2;
                                            } else {
                                                // 0x8f62f414
                                                v612 = g55;
                                                v613 = g53;
                                                v614 = v622;
                                                v615 = v623;
                                                v21 = v616;
                                                v33 = v617;
                                                v133 = v619;
                                                v146 = v620;
                                                // branch -> 0x8f62f27c
                                                continue;
                                            }
                                        } else {
                                            v618 = (int32_t)"Motoboot: invalid GPT";
                                        }
                                    } else {
                                      lab_0x8f62f2f4_4:;
                                        char * v625 = get_partition_by_name(g57, (int32_t)"partition", g50, g51, v1, v3, v112, v5, v111, 0, v100); // 0x8f62f2f8
                                        int32_t v626 = (int32_t)v625; // 0x8f62f2f8_12
                                        v71 = v626;
                                        if (v625 != NULL) {
                                            char v627 = *(char *)(v626 + 41); // 0x8f62f314
                                            char v628 = *(char *)(v626 + 40); // 0x8f62f318
                                            char v629 = *(char *)(v626 + 42); // 0x8f62f320
                                            char v630 = *(char *)(v626 + 43); // 0x8f62f328
                                            int32_t v631 = 0x1000000 * (int32_t)v630 | 0x10000 * (int32_t)v629 | (int32_t)v628 | 256 * (int32_t)v627; // 0x8f62f32c
                                            char v632 = *(char *)(v626 + 45); // 0x8f62f330
                                            char v633 = *(char *)(v626 + 44); // 0x8f62f334
                                            uint32_t v634 = v631 + 1; // 0x8f62f338
                                            char v635 = *(char *)(v626 + 46); // 0x8f62f340
                                            char v636 = *(char *)(v626 + 47); // 0x8f62f348
                                            char v637 = *(char *)(v626 + 33); // 0x8f62f350
                                            char v638 = *(char *)(v626 + 32); // 0x8f62f354
                                            char v639 = *(char *)(v626 + 34); // 0x8f62f360
                                            char v640 = *(char *)(v626 + 35); // 0x8f62f368
                                            int32_t v641 = 0x1000000 * (int32_t)v640 | 0x10000 * (int32_t)v639 | (int32_t)v638 | 256 * (int32_t)v637; // 0x8f62f36c
                                            char v642 = *(char *)(v626 + 37); // 0x8f62f374
                                            char v643 = *(char *)(v626 + 36); // 0x8f62f378
                                            int32_t v644 = v71; // 0x8f62f380
                                            char v645 = *(char *)(v644 + 38); // 0x8f62f380
                                            int32_t v646 = 0x10000 * (int32_t)v645 | (int32_t)v643 | 256 * (int32_t)v642; // 0x8f62f384
                                            int32_t v647 = 0x1000000 * (int32_t)*(char *)(v644 + 39) | v646; // 0x8f62f38c
                                            g49 = v647;
                                            uint32_t v648 = v634 - v641; // 0x8f62f398
                                            int32_t v649 = 512 * v648; // 0x8f62f3a4
                                            int32_t v650 = 512 * ((int32_t)(v634 < v641) + (0x1000000 * (int32_t)v636 | 0x10000 * (int32_t)v635 | (int32_t)v633 | 256 * (int32_t)v632) + (int32_t)(v631 == -1) - v646) | v648 / 0x800000; // 0x8f62f3a8
                                            int32_t v651 = g53; // 0x8f62f3b4
                                            g50 = v651;
                                            g56 = v649;
                                            g57 = v650;
                                            g51 = 0;
                                            int32_t v652;
                                            int32_t v653; // 0x8f62f3a8824
                                            if (v651 > v649 && v650 == 0) {
                                                // 0x8f62f3cc
                                                g46 = (int32_t)"Image size exeeded partition limits";
                                                v653 = 0;
                                                v652 = fboot_info((int32_t)"INFO", (int32_t)"Image size exeeded partition limits", v651, 0, v1, v3, v112, v5, v111, 0, v100);
                                                // branch -> 0x8f62f40c
                                            } else {
                                                int32_t v654 = g55; // 0x8f62f3dc
                                                g46 = v654;
                                                g50 = v651;
                                                g51 = 0;
                                                if (validate_partition(v626, v654, v651, 0, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v649, v650, 0, str, v641, v647) == 0) {
                                                    v620 = v647;
                                                    v619 = v641;
                                                    v617 = v650;
                                                    v616 = v649;
                                                    goto lab_0x8f62f414;
                                                }
                                                int32_t v655 = get_entry_name(v71, g46, g50, g51, v1, v3, v112, v5); // 0x8f62f3f8
                                                g46 = (int32_t)"Motoboot: Preflash validation for %s";
                                                g50 = v655;
                                                v653 = v650;
                                                v652 = fboot_info((int32_t)"INFO", (int32_t)"Motoboot: Preflash validation for %s", v655, g51, v1, v3, v112, v5, v111, 0, v100);
                                                // branch -> 0x8f62f40c
                                            }
                                            // 0x8f62f40c
                                            v71 = 0;
                                            v181 = v2;
                                            v76 = v73;
                                            v145 = v647;
                                            v132 = v641;
                                            v32 = v653;
                                            v20 = v649;
                                            v98 = v87;
                                            v182 = v8;
                                            v106 = v100;
                                            v49 = v111;
                                            v183 = v6;
                                            v118 = v112;
                                            v184 = v4;
                                            // branch -> 0x8f630160
                                            // 0x8f630160
                                            if (is_validation_enabled((char *)v652, g46, g50, g51) == 0) {
                                                goto lab_0x8f63016c_2;
                                            }
                                            v279 = v181;
                                            goto lab_0x8f63048c_6;
                                        } else {
                                            v618 = (int32_t)"Motoboot: Unknown partition name";
                                        }
                                    }
                                    // 0x8f62f30c
                                    g46 = v618;
                                    v37 = fboot_info((int32_t)"INFO", v618, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                    v181 = v2;
                                    v76 = v73;
                                    v145 = v146;
                                    v132 = v133;
                                    v32 = v33;
                                    v20 = v21;
                                    v98 = v87;
                                    v182 = v8;
                                    v106 = v100;
                                    v49 = v111;
                                    v183 = v6;
                                    v118 = v112;
                                    v184 = v4;
                                    // branch -> 0x8f630160
                                  lab_0x8f630160_23:
                                    // 0x8f630160
                                    if (is_validation_enabled((char *)v37, g46, g50, g51) == 0) {
                                        goto lab_0x8f63016c_2;
                                    }
                                    v279 = v181;
                                    goto lab_0x8f63048c_6;
                                }
                            } else {
                                set_mem = v57;
                            }
                        } else {
                            // 0x8f62f420
                            g46 = (int32_t)"cid_prov";
                            if (strcmp(str3, "cid_prov") != 0) {
                                // 0x8f62f434
                                v58 = get_partition_by_name(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                v51 = (int32_t)v58;
                                g56 = v51;
                                if (v58 == NULL) {
                                    // if_8f62f440_0_true
                                    v193 = v2;
                                    v110 = v100;
                                    v41 = v111;
                                    v195 = v6;
                                    v122 = v112;
                                    v196 = v4;
                                    // branch -> 0x8f6305ac
                                } else {
                                    // 0x8f62f44c
                                    v233 = *(char *)(v51 + 41);
                                    v234 = *(char *)(v51 + 40);
                                    v235 = *(char *)(v51 + 33);
                                    v236 = *(char *)(v51 + 42);
                                    v237 = *(char *)(v51 + 32);
                                    v238 = *(char *)(v51 + 43);
                                    v239 = *(char *)(v51 + 34);
                                    v265 = 0x1000000 * (int32_t)v238 | 0x10000 * (int32_t)v236 | (int32_t)v234 | 256 * (int32_t)v233;
                                    v240 = *(char *)(v51 + 45);
                                    v241 = *(char *)(v51 + 44);
                                    v242 = *(char *)(v51 + 35);
                                    v207 = v265 + 1;
                                    v243 = *(char *)(v51 + 46);
                                    v244 = *(char *)(v51 + 47);
                                    v266 = 0x1000000 * (int32_t)v242 | 0x10000 * (int32_t)v239 | (int32_t)v237 | 256 * (int32_t)v235;
                                    v245 = *(char *)(v51 + 37);
                                    v246 = *(char *)(v51 + 36);
                                    v247 = *(char *)(v51 + 38);
                                    v267 = 0x10000 * (int32_t)v247 | (int32_t)v246 | 256 * (int32_t)v245;
                                    g49 = v267;
                                    v268 = v207 - v266;
                                    v230 = 512 * v268;
                                    g50 = v230;
                                    v274 = 512 * ((0x1000000 * (int32_t)v244 | 0x10000 * (int32_t)v243 | (int32_t)v241 | 256 * (int32_t)v240) + (int32_t)(v265 == -1) + (int32_t)(v207 < v266) - v267) | v268 / 0x800000;
                                    g51 = v274;
                                    g46 = 0;
                                    if (g52 > v230 && v274 == 0) {
                                        // after_if_8f62f4ec_0.thread
                                        v193 = v2;
                                        v110 = v100;
                                        v41 = v111;
                                        v195 = v6;
                                        v122 = v112;
                                        v196 = v4;
                                        // branch -> 0x8f6305ac
                                    } else {
                                        // 0x8f62f4f4
                                        if (is_sparse_image(g48, 0, v230, v274) == 0) {
                                            // 0x8f62ff8c
                                            v67 = is_skip_validation(0, g46, g50);
                                            v36 = 0;
                                            if (v67 != 0) {
                                                // 0x8f62ffa8
                                                v68 = is_bootloader_partition(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                                if (v68 == 0) {
                                                    // 0x8f63015c
                                                    v71 = 1;
                                                    v37 = 0;
                                                    v181 = v2;
                                                    v76 = v73;
                                                    v145 = v83;
                                                    v132 = v84;
                                                    v32 = v85;
                                                    v20 = v86;
                                                    v98 = v87;
                                                    v182 = v8;
                                                    v106 = v100;
                                                    v49 = v111;
                                                    v183 = v6;
                                                    v118 = v112;
                                                    v184 = v4;
                                                    // branch -> 0x8f630160
                                                    goto lab_0x8f630160_23;
                                                } else {
                                                    v36 = v68;
                                                }
                                            }
                                            // 0x8f62ff98
                                            if (is_verified_boot_flow(v36, g46) != 0) {
                                                // 0x8f630108
                                                if (strcmp(str3, "logo") == 0) {
                                                    // 0x8f63011c
                                                    v227 = g56;
                                                    g56 = &v72;
                                                    memcpy((char *)&v72, (char *)v227, 128);
                                                    // branch -> 0x8f630140
                                                }
                                            }
                                            // 0x8f630140
                                            v228 = g48;
                                            g46 = v228;
                                            v229 = g52;
                                            g50 = v229;
                                            g51 = 0;
                                            v69 = validate_partition(g56, v228, v229, 0, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str, v84, v83);
                                            // branch -> 0x8f630154
                                            // 0x8f630154
                                            if (v69 == 0) {
                                                // 0x8f63015c
                                                v71 = 1;
                                                v37 = 0;
                                                v181 = v2;
                                                v76 = v73;
                                                v145 = v83;
                                                v132 = v84;
                                                v32 = v85;
                                                v20 = v86;
                                                v98 = v87;
                                                v182 = v8;
                                                v106 = v100;
                                                v49 = v111;
                                                v183 = v6;
                                                v118 = v112;
                                                v184 = v4;
                                                // branch -> 0x8f630160
                                                goto lab_0x8f630160_23;
                                            } else {
                                                v185 = v2;
                                                v74 = v73;
                                                v144 = v83;
                                                v131 = v84;
                                                v31 = v85;
                                                v19 = v86;
                                                v96 = v87;
                                                v186 = v8;
                                                v105 = v100;
                                                v48 = v111;
                                                v187 = v6;
                                                v117 = v112;
                                                v188 = v4;
                                            }
                                        } else {
                                            // 0x8f62f504
                                            v59 = parse_sparse_image(g48, g52, g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str);
                                            g54 = (int32_t)&g27;
                                            *(int32_t *)&g27 = v59;
                                            if (v59 == 0) {
                                                // if_8f62f51c_0_true
                                                v193 = v2;
                                                v110 = v100;
                                                v41 = v111;
                                                v195 = v6;
                                                v122 = v112;
                                                v196 = v4;
                                                // branch -> 0x8f6305ac
                                            } else {
                                                // 0x8f62f528
                                                v248 = *(int32_t *)(v59 + 8);
                                                g51 = v248;
                                                v147 = unknown_69732061(v248);
                                                g52 = v147;
                                                if (v147 == 0) {
                                                    // if_8f62f534_0_true
                                                    v610 = v2;
                                                    v611 = v4;
                                                    // branch -> 0x8f62f968
                                                    // 0x8f62f968
                                                    print_log(3, (int32_t)"Invalid parsed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                    v193 = v610;
                                                    v128 = v84;
                                                    v16 = v86;
                                                    v97 = v87;
                                                    v110 = v100;
                                                    v41 = v111;
                                                    v195 = v6;
                                                    v122 = v112;
                                                    v196 = v611;
                                                    v39 = (int32_t)"Malformed sparse image";
                                                    // branch -> 0x8f6305ac
                                                  lab_0x8f6305ac_5:
                                                    // 0x8f6305ac
                                                    fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                    v185 = v193;
                                                    v74 = v73;
                                                    v144 = v83;
                                                    v131 = v128;
                                                    v31 = v85;
                                                    v19 = v16;
                                                    v96 = v97;
                                                    v186 = v8;
                                                    v105 = v110;
                                                    v48 = v41;
                                                    v187 = v195;
                                                    v117 = v122;
                                                    v188 = v196;
                                                    // branch -> 0x8f630498
                                                    goto lab_0x8f630498_14;
                                                } else {
                                                    // 0x8f62f540
                                                    v249 = *(char *)v147;
                                                    v269 = v249;
                                                    g46 = v269;
                                                    if (v249 == 0) {
                                                        // 0x8f62f54c
                                                        g50 = 0x20000;
                                                        memset((char *)&g30, v269, 0x20000);
                                                        v217 = g52;
                                                        v250 = *(int32_t *)(v217 + 16);
                                                        g46 = v250;
                                                        if (is_piv_magic(*(int32_t *)(v217 + 28), v250, g50, g51) == 0) {
                                                            // 0x8f62f56c
                                                            v70 = (int32_t)"Non-signed image detected\n";
                                                            v60 = print_log(1, (int32_t)"Non-signed image detected\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                            v270 = (int32_t)*(char *)(g56 + 49);
                                                            g51 = v270;
                                                            if (v270 % 16 != 0) {
                                                                // 0x8f62f590
                                                                if (is_skip_validation(v60, v70, g50) == 0) {
                                                                    // 0x8f62f59c
                                                                    v61 = is_skip_sparse_preflash_validation(g56, v70, g50, g51, v1, v3, v112, v5);
                                                                    if (v61 == 0) {
                                                                        // if_8f62f5a8_0_true
                                                                        // branch -> 0x8f62f88c
                                                                        // 0x8f62f88c
                                                                        print_log(3, (int32_t)"Invalid signed image", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                        // branch -> 0x8f62f890
                                                                        // 0x8f62f890
                                                                        v193 = v2;
                                                                        v128 = v84;
                                                                        v16 = v86;
                                                                        v97 = v87;
                                                                        v110 = v100;
                                                                        v41 = v111;
                                                                        v195 = v6;
                                                                        v122 = v112;
                                                                        v196 = v4;
                                                                        v39 = (int32_t)"Invalid signed image";
                                                                        // branch -> 0x8f6305ac
                                                                        goto lab_0x8f6305ac_5;
                                                                    }
                                                                }
                                                            }
                                                            // 0x8f62f584
                                                            g46 = (int32_t)"bypass piv validation\n";
                                                            v160 = v2;
                                                            v79 = v73;
                                                            v139 = v83;
                                                            v126 = v84;
                                                            v26 = v85;
                                                            v14 = v86;
                                                            v89 = v87;
                                                            v161 = v8;
                                                            v109 = v100;
                                                            v43 = v111;
                                                            v162 = v6;
                                                            v121 = v112;
                                                            v163 = v4;
                                                            v38 = (int32_t)"bypass piv validation\n";
                                                            // branch -> 0x8f62f800
                                                          lab_0x8f62f800_2:
                                                            // 0x8f62f800
                                                            v63 = print_log(1, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                            v35 = v63;
                                                            v173 = v160;
                                                            v78 = v79;
                                                            v138 = v139;
                                                            v125 = v126;
                                                            v25 = v26;
                                                            v13 = v14;
                                                            v88 = v89;
                                                            v174 = v161;
                                                            v108 = v109;
                                                            v42 = v43;
                                                            v175 = v162;
                                                            v120 = v121;
                                                            v176 = v163;
                                                            // branch -> 0x8f62f9f0
                                                            goto lab_0x8f62f9f0_2;
                                                        } else {
                                                            // 0x8f62f5b8
                                                            v148 = (int32_t)g27;
                                                            g52 = v148;
                                                            g57 = 0;
                                                            g53 = 0x20000;
                                                            v251 = *(int32_t *)(v148 + 8);
                                                            g51 = v251;
                                                            g45 = v148;
                                                            g44 = -0x709d0a30;
                                                            ((int32_t (*)(int32_t, int32_t))v251)(v148, v251);
                                                            g57 = (int32_t)&g30;
                                                            v123 = g45;
                                                            g47 = v123;
                                                            v200 = g53;
                                                            if (v200 == 0) {
                                                                v201 = v123;
                                                                // 0x8f62f774
                                                                v208 = v201 < 2 ? 1 - v201 : 0;
                                                                g51 = v208;
                                                                v209 = v208;
                                                                v93 = v87;
                                                                v22 = v86;
                                                                v134 = 0;
                                                                // branch -> after_if_8f62f784_0
                                                                // after_if_8f62f784_0
                                                                g53 = v209;
                                                                if (v209 == 0) {
                                                                    v219 = v201;
                                                                    v52 = (int32_t *)(v219 + 8);
                                                                    v253 = *v52;
                                                                    v53 = (int32_t *)(v219 + 12);
                                                                    v254 = *(int32_t *)(v219 + 16);
                                                                    v275 = *(int32_t *)(v219 + 20);
                                                                    v210 = v253 - 0x20000;
                                                                    v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                                    *v52 = v210;
                                                                    *v53 = v70;
                                                                    v225 = g47;
                                                                    g50 = v225;
                                                                    v255 = v210;
                                                                    v276 = v70;
                                                                    g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                                    print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                                    v220 = g52;
                                                                    v256 = *(int32_t *)(v220 + 12);
                                                                    g51 = v256;
                                                                    g45 = v220;
                                                                    g44 = -0x709d0834;
                                                                    ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                                    v202 = g45;
                                                                    g47 = v202;
                                                                    while (v202 != 0) {
                                                                        // 0x8f62f794
                                                                        v219 = v202;
                                                                        v52 = (int32_t *)(v219 + 8);
                                                                        v253 = *v52;
                                                                        v53 = (int32_t *)(v219 + 12);
                                                                        v254 = *(int32_t *)(v219 + 16);
                                                                        v275 = *(int32_t *)(v219 + 20);
                                                                        v210 = v253 - 0x20000;
                                                                        v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                                        *v52 = v210;
                                                                        *v53 = v70;
                                                                        v225 = g47;
                                                                        g50 = v225;
                                                                        v255 = v210;
                                                                        v276 = v70;
                                                                        g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                                        print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                                        v220 = g52;
                                                                        v256 = *(int32_t *)(v220 + 12);
                                                                        g51 = v256;
                                                                        g45 = v220;
                                                                        g44 = -0x709d0834;
                                                                        ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                                        v202 = g45;
                                                                        g47 = v202;
                                                                        // continue -> 0x8f62f794
                                                                    }
                                                                    // 0x8f62f7d4
                                                                    v153 = (char *)v254;
                                                                    v154 = (char *)v275;
                                                                    v155 = (char *)v276;
                                                                    g46 = 0x20000;
                                                                    g50 = str;
                                                                    v62 = piv_init((int32_t)&g30, 0x20000, str, g51, v254, v275, v255, v276, v111, 0, v100, v7, 0, v93, v22, v85, 0);
                                                                    if (v62 == 0) {
                                                                        // 0x8f62f7ec
                                                                        v271 = (int32_t)*(char *)(g56 + 49);
                                                                        g51 = v271;
                                                                        if (v271 % 16 == 0) {
                                                                            v156 = v153;
                                                                            v80 = v73;
                                                                            v140 = v83;
                                                                            v127 = v134;
                                                                            v27 = v85;
                                                                            v15 = v22;
                                                                            v90 = v93;
                                                                            v157 = v8;
                                                                            v102 = v100;
                                                                            v44 = v111;
                                                                            v158 = v155;
                                                                            v114 = v255;
                                                                            v159 = v154;
                                                                          lab_0x8f62f7f8:
                                                                            // 0x8f62f7f8
                                                                            g46 = (int32_t)"skip validating PIV image\n";
                                                                            v160 = v156;
                                                                            v79 = v80;
                                                                            v139 = v140;
                                                                            v126 = v127;
                                                                            v26 = v27;
                                                                            v14 = v15;
                                                                            v89 = v90;
                                                                            v161 = v157;
                                                                            v109 = v102;
                                                                            v43 = v44;
                                                                            v162 = v158;
                                                                            v121 = v114;
                                                                            v163 = v159;
                                                                            v38 = (int32_t)"skip validating PIV image\n";
                                                                            // branch -> 0x8f62f800
                                                                            goto lab_0x8f62f800_2;
                                                                        } else {
                                                                            v189 = v153;
                                                                            v82 = v73;
                                                                            v143 = v83;
                                                                            v130 = v134;
                                                                            v30 = v85;
                                                                            v18 = v22;
                                                                            v92 = v93;
                                                                            v190 = v8;
                                                                            v104 = v100;
                                                                            v47 = v111;
                                                                            v191 = v155;
                                                                            v116 = v255;
                                                                            v192 = v154;
                                                                        }
                                                                    } else {
                                                                        // 0x8f62f890
                                                                        v193 = v153;
                                                                        v128 = v134;
                                                                        v16 = v22;
                                                                        v97 = v93;
                                                                        v110 = v100;
                                                                        v41 = v111;
                                                                        v195 = v155;
                                                                        v122 = v255;
                                                                        v196 = v154;
                                                                        v39 = (int32_t)"Invalid signed image";
                                                                        // branch -> 0x8f6305ac
                                                                        goto lab_0x8f6305ac_5;
                                                                    }
                                                                    // 0x8f6304e4
                                                                    if (is_skip_validation(0, g46, g50) == 0) {
                                                                        goto lab_0x8f6304f0_6;
                                                                    }
                                                                    v156 = v189;
                                                                    v80 = v82;
                                                                    v140 = v143;
                                                                    v127 = v130;
                                                                    v27 = v30;
                                                                    v15 = v18;
                                                                    v90 = v92;
                                                                    v157 = v190;
                                                                    v102 = v104;
                                                                    v44 = v47;
                                                                    v158 = v191;
                                                                    v114 = v116;
                                                                    v159 = v192;
                                                                    goto lab_0x8f62f7f8;
                                                                }
                                                            } else {
                                                                v252 = v200;
                                                                v218 = v123;
                                                                v149 = v4;
                                                                v95 = v87;
                                                                int32_t v656 = v86; // 0x8f63043c128330
                                                                v136 = 0;
                                                                v150 = v2;
                                                                while (true) {
                                                                    // after_if_8f62f5e0_0
                                                                    if (v218 == 0) {
                                                                        // 0x8f62f774
                                                                        g51 = 1;
                                                                        // branch -> after_if_8f62f784_0.thread
                                                                        // after_if_8f62f784_0.thread
                                                                        g53 = 1;
                                                                        // branch -> 0x8f62f8c4
                                                                        // 0x8f62f8c4
                                                                        v610 = v150;
                                                                        v611 = v149;
                                                                        // branch -> 0x8f62f968
                                                                        // 0x8f62f968
                                                                        print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                        v193 = v610;
                                                                        v110 = v100;
                                                                        v41 = v111;
                                                                        v195 = v6;
                                                                        v122 = v112;
                                                                        v196 = v611;
                                                                        // branch -> 0x8f6305ac
                                                                        // 0x8f6305ac
                                                                        fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                        v185 = v193;
                                                                        v74 = v73;
                                                                        v144 = v83;
                                                                        v131 = v136;
                                                                        v31 = v85;
                                                                        v19 = v656;
                                                                        v96 = v95;
                                                                        v186 = v8;
                                                                        v105 = v110;
                                                                        v48 = v41;
                                                                        v187 = v195;
                                                                        v117 = v122;
                                                                        v188 = v196;
                                                                        // branch -> 0x8f630498
                                                                        goto lab_0x8f630498_14;
                                                                    } else {
                                                                      lab_0x8f62f5e8_4:;
                                                                        int32_t v657 = *(int32_t *)(v218 + 16); // 0x8f62f5e8
                                                                        g54 = v252;
                                                                        g55 = 0;
                                                                        char v658; // 0x8f62f600491
                                                                        int32_t v659; // 0x8f62f600492
                                                                        if (v252 > v657 & *(int32_t *)(v218 + 20) == 0) {
                                                                            // if_8f62f604_0_true
                                                                            g55 = 0;
                                                                            v658 = *(char *)v218;
                                                                            v659 = v658;
                                                                            v278 = v659;
                                                                            g54 = v657;
                                                                            // branch -> after_if_8f62f604_0
                                                                        } else {
                                                                            char v660 = *(char *)v218; // 0x8f62f600484
                                                                            int32_t v661 = v660; // 0x8f62f600485
                                                                            v278 = v661;
                                                                            v659 = v661;
                                                                            v658 = v660;
                                                                            v657 = v252;
                                                                            // branch -> after_if_8f62f604_0
                                                                        }
                                                                        // after_if_8f62f604_0
                                                                        int32_t v662; // 0x8f62f688
                                                                        int32_t v663;
                                                                        int32_t v664;
                                                                        int32_t v665; // 0x8f62f6a8
                                                                        int32_t v666; // 0x8f62f6ac
                                                                        int32_t v667; // 0x8f62f698
                                                                        int32_t v668; // 0x8f62f6b0
                                                                        switch (v659) {
                                                                            default: {
                                                                                // 0x8f62f618
                                                                                v668 = 0;
                                                                                v666 = v657;
                                                                                v665 = v218;
                                                                                v667 = v252;
                                                                                v663 = v95;
                                                                                if (v658 == 2) {
                                                                                    // 0x8f62f620
                                                                                    memset((char *)(g57 + v136), 0, v657);
                                                                                    v278 = 2;
                                                                                    v664 = 2;
                                                                                    v662 = (int32_t)"fetch %d from SKIP data\n";
                                                                                    // branch -> 0x8f62f684
                                                                                  lab_0x8f62f684_2:
                                                                                    // 0x8f62f684
                                                                                    print_log(2, v662, g54, v278, (int32_t)v150, (int32_t)v149, v112, v5, v111, 0, v100, v7, 0);
                                                                                    v668 = g55;
                                                                                    v666 = g54;
                                                                                    v665 = g47;
                                                                                    v667 = g53;
                                                                                    v663 = v664;
                                                                                    // branch -> 0x8f62f68c
                                                                                }
                                                                              lab_0x8f62f68c:;
                                                                                int32_t v669 = v667 - v657; // 0x8f62f698
                                                                                g53 = v669;
                                                                                int32_t v670 = v657 + v136; // 0x8f62f6a0
                                                                                uint32_t v671 = *(int32_t *)(v665 + 16); // 0x8f62f6a8
                                                                                int32_t v672 = *(int32_t *)(v665 + 20); // 0x8f62f6a8
                                                                                int32_t v673 = v671 - v666; // 0x8f62f6ac
                                                                                int32_t v674 = v672 - v668 + (int32_t)(v671 < v666); // 0x8f62f6b0
                                                                                char * v675 = (char *)v673;
                                                                                char * v676 = (char *)v674;
                                                                                print_log(2, (int32_t)"got %d from chunk for PIV block, left piv len is %d, left chunk len is 0xx%llx\n", v657, v669, v673, v674, v112, v5, v111, 0, v100, v7, 0);
                                                                                int32_t v677 = g47; // 0x8f62f6c4
                                                                                int32_t v678 = *(int32_t *)(v677 + 20); // 0x8f62f6c4
                                                                                char * v679;
                                                                                char * v680;
                                                                                int32_t v681; // 0x8f62f770
                                                                                if (v678 == g55 & *(int32_t *)(v677 + 16) == g54) {
                                                                                    // 0x8f62f6d4
                                                                                    g50 = v677;
                                                                                    print_log(1, (int32_t)"remove the chunk(%p) containing PIV block\n", v677, v678, v673, v674, v112, v5, v111, 0, v100, v7, 0);
                                                                                    int32_t v682 = g47; // 0x8f62f6e4
                                                                                    g46 = v682;
                                                                                    int32_t v683 = g52; // 0x8f62f6e8
                                                                                    int32_t v684 = *(int32_t *)(v683 + 28); // 0x8f62f6e8
                                                                                    g51 = v684;
                                                                                    g45 = v683;
                                                                                    g44 = -0x709d090c;
                                                                                    ((int32_t (*)(int32_t, int32_t, int32_t))v684)(v683, v682, v684);
                                                                                    int32_t v685 = g52; // 0x8f62f6f4
                                                                                    int32_t v686 = *(int32_t *)(v685 + 8); // 0x8f62f6f4
                                                                                    g51 = v686;
                                                                                    g45 = v685;
                                                                                    g44 = -0x709d0900;
                                                                                    ((int32_t (*)(int32_t, int32_t))v686)(v685, v686);
                                                                                    int32_t v687 = g45;
                                                                                    g47 = v687;
                                                                                    int32_t v688 = g53; // 0x8f62f5dc
                                                                                    if (v688 == 0) {
                                                                                        v201 = v687;
                                                                                        v151 = v675;
                                                                                        v135 = v670;
                                                                                        v23 = v657;
                                                                                        v94 = v663;
                                                                                        v152 = v676;
                                                                                        // break (via goto) -> 0x8f62f774
                                                                                        goto lab_0x8f62f774;
                                                                                    }
                                                                                    v252 = v688;
                                                                                    v218 = v687;
                                                                                    v149 = v676;
                                                                                    v95 = v663;
                                                                                    v656 = v657;
                                                                                    v136 = v670;
                                                                                    v150 = v675;
                                                                                    // continue -> after_if_8f62f5e0_0
                                                                                    continue;
                                                                                } else {
                                                                                    // 0x8f62f708
                                                                                    print_log(2, (int32_t)"remove %d bytes from sparse data(%p)\n", v657, v677, v673, v674, v112, v5, v111, 0, v100, v7, 0);
                                                                                    int32_t v689 = g47; // 0x8f62f71c
                                                                                    int32_t * v690 = (int32_t *)(v689 + 16); // 0x8f62f720_0
                                                                                    uint32_t v691 = *v690; // 0x8f62f720
                                                                                    int32_t * v692 = (int32_t *)(v689 + 20); // 0x8f62f720_1
                                                                                    uint32_t v693 = g54; // 0x8f62f728
                                                                                    int32_t v694 = v691 - v693; // 0x8f62f728
                                                                                    int32_t v695 = *v692 - g55 + (int32_t)(v691 < v693); // 0x8f62f72c
                                                                                    *v690 = v694;
                                                                                    *v692 = v695;
                                                                                    if (*(char *)v689 == 0) {
                                                                                        int32_t * v696 = (int32_t *)(g47 + 28); // 0x8f62f738_1
                                                                                        g57 = v657;
                                                                                        int32_t v697 = *v696 + v657; // 0x8f62f740
                                                                                        g55 = v697;
                                                                                        *v696 = v697;
                                                                                        // branch -> 0x8f62f774
                                                                                    }
                                                                                    int32_t v698 = g47; // 0x8f62f74c
                                                                                    *(int32_t *)(v698 + 8) = 0;
                                                                                    *(int32_t *)(v698 + 12) = 0;
                                                                                    v679 = (char *)v694;
                                                                                    v680 = (char *)v695;
                                                                                    int32_t v699 = g47; // 0x8f62f758
                                                                                    g50 = v699;
                                                                                    g46 = (int32_t)"update chunk(%p) containing PIV block: size=0x%llx\n";
                                                                                    print_log(1, (int32_t)"update chunk(%p) containing PIV block: size=0x%llx\n", v699, v695, v694, v695, v112, v5, v111, 0, v100, v7, 0);
                                                                                    int32_t v700 = g52; // 0x8f62f764
                                                                                    int32_t v701 = *(int32_t *)(v700 + 12); // 0x8f62f764
                                                                                    g51 = v701;
                                                                                    g45 = v700;
                                                                                    g44 = -0x709d0890;
                                                                                    ((int32_t (*)(int32_t, int32_t))v701)(v700, v701);
                                                                                    v681 = g45;
                                                                                    g47 = v681;
                                                                                    int32_t v702 = v681 < 2 ? 1 - v681 : 0;
                                                                                    g51 = v702;
                                                                                    if (g53 != 0) {
                                                                                        // after_if_8f62f784_0.thread
                                                                                        g53 = v702 | 1;
                                                                                        // branch -> 0x8f62f8c4
                                                                                        // 0x8f62f8c4
                                                                                        v610 = v679;
                                                                                        v611 = v680;
                                                                                        // branch -> 0x8f62f968
                                                                                        // 0x8f62f968
                                                                                        print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                                        v193 = v610;
                                                                                        v110 = v100;
                                                                                        v41 = v111;
                                                                                        v195 = v6;
                                                                                        v122 = v112;
                                                                                        v196 = v611;
                                                                                        // branch -> 0x8f6305ac
                                                                                      lab_0x8f6305ac_6:
                                                                                        // 0x8f6305ac
                                                                                        fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                                        v185 = v193;
                                                                                        v74 = v73;
                                                                                        v144 = v83;
                                                                                        v131 = v670;
                                                                                        v31 = v85;
                                                                                        v19 = v657;
                                                                                        v96 = v663;
                                                                                        v186 = v8;
                                                                                        v105 = v110;
                                                                                        v48 = v41;
                                                                                        v187 = v195;
                                                                                        v117 = v122;
                                                                                        v188 = v196;
                                                                                        // branch -> 0x8f630498
                                                                                        goto lab_0x8f630498_14;
                                                                                    } else {
                                                                                        v209 = v702;
                                                                                        v93 = v663;
                                                                                        v22 = v657;
                                                                                        v134 = v670;
                                                                                    }
                                                                                }
                                                                                // after_if_8f62f784_0
                                                                                g53 = v209;
                                                                                if (v209 == 0) {
                                                                                    v219 = v681;
                                                                                    while (true) {
                                                                                        // 0x8f62f794
                                                                                        v52 = (int32_t *)(v219 + 8);
                                                                                        v253 = *v52;
                                                                                        v53 = (int32_t *)(v219 + 12);
                                                                                        v254 = *(int32_t *)(v219 + 16);
                                                                                        v275 = *(int32_t *)(v219 + 20);
                                                                                        v210 = v253 - 0x20000;
                                                                                        v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                                                        *v52 = v210;
                                                                                        *v53 = v70;
                                                                                        v225 = g47;
                                                                                        g50 = v225;
                                                                                        v255 = v210;
                                                                                        v276 = v70;
                                                                                        g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                                                        print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                                                        v220 = g52;
                                                                                        v256 = *(int32_t *)(v220 + 12);
                                                                                        g51 = v256;
                                                                                        g45 = v220;
                                                                                        g44 = -0x709d0834;
                                                                                        ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                                                        v202 = g45;
                                                                                        g47 = v202;
                                                                                        if (v202 == 0) {
                                                                                            // break (via goto) -> 0x8f62f7d4
                                                                                            goto lab_0x8f62f7d4;
                                                                                        }
                                                                                        v219 = v202;
                                                                                        // continue -> 0x8f62f794
                                                                                    }
                                                                                    // 0x8f62f7d4
                                                                                    v153 = (char *)v254;
                                                                                    v154 = (char *)v275;
                                                                                    v155 = (char *)v276;
                                                                                    g46 = 0x20000;
                                                                                    g50 = str;
                                                                                    int32_t v703 = g51; // 0x8f62f7e0
                                                                                    v62 = piv_init((int32_t)&g30, 0x20000, str, v703, v254, v275, v255, v276, v111, 0, v100, v7, 0, v93, v22, v85, 0);
                                                                                    int32_t v704; // 0x8f6304e4
                                                                                    if (v62 == 0) {
                                                                                        int32_t v705 = g56; // 0x8f62f7ec
                                                                                        char v706 = *(char *)(v705 + 49); // 0x8f62f7ec
                                                                                        v271 = v706;
                                                                                        g51 = v271;
                                                                                        if (v271 % 16 == 0) {
                                                                                            v156 = v153;
                                                                                            v80 = v73;
                                                                                            v140 = v83;
                                                                                            v127 = v134;
                                                                                            v27 = v85;
                                                                                            v15 = v22;
                                                                                            v90 = v93;
                                                                                            v157 = v8;
                                                                                            v102 = v100;
                                                                                            v44 = v111;
                                                                                            v158 = v155;
                                                                                            v114 = v255;
                                                                                            v159 = v154;
                                                                                          lab_0x8f62f7f8_2:
                                                                                            // 0x8f62f7f8
                                                                                            g46 = (int32_t)"skip validating PIV image\n";
                                                                                            v160 = v156;
                                                                                            v79 = v80;
                                                                                            v139 = v140;
                                                                                            v126 = v127;
                                                                                            v26 = v27;
                                                                                            v14 = v15;
                                                                                            v89 = v90;
                                                                                            v161 = v157;
                                                                                            v109 = v102;
                                                                                            v43 = v44;
                                                                                            v162 = v158;
                                                                                            v121 = v114;
                                                                                            v163 = v159;
                                                                                            v38 = (int32_t)"skip validating PIV image\n";
                                                                                            v34 = 1;
                                                                                            // branch -> 0x8f62f800
                                                                                            goto lab_0x8f62f800_2;
                                                                                        } else {
                                                                                            v704 = 0;
                                                                                            v189 = v153;
                                                                                            v82 = v73;
                                                                                            v143 = v83;
                                                                                            v130 = v134;
                                                                                            v30 = v85;
                                                                                            v18 = v22;
                                                                                            v92 = v93;
                                                                                            v190 = v8;
                                                                                            v104 = v100;
                                                                                            v47 = v111;
                                                                                            v191 = v155;
                                                                                            v116 = v255;
                                                                                            v192 = v154;
                                                                                        }
                                                                                    } else {
                                                                                        v168 = v153;
                                                                                        v81 = v73;
                                                                                        v142 = v83;
                                                                                        v129 = v134;
                                                                                        v29 = v85;
                                                                                        v17 = v22;
                                                                                        v91 = v93;
                                                                                        v169 = v8;
                                                                                        v103 = v100;
                                                                                        v46 = v111;
                                                                                        v170 = v155;
                                                                                        v115 = v255;
                                                                                        v171 = v154;
                                                                                        // 0x8f62f890
                                                                                        v193 = v168;
                                                                                        v75 = v81;
                                                                                        v141 = v142;
                                                                                        v128 = v129;
                                                                                        v28 = v29;
                                                                                        v16 = v17;
                                                                                        v97 = v91;
                                                                                        v194 = v169;
                                                                                        v110 = v103;
                                                                                        v41 = v46;
                                                                                        v195 = v170;
                                                                                        v122 = v115;
                                                                                        v196 = v171;
                                                                                        v39 = (int32_t)"Invalid signed image";
                                                                                        // branch -> 0x8f6305ac
                                                                                        goto lab_0x8f6305ac_6;
                                                                                    }
                                                                                    int32_t v707 = g46; // 0x8f6304e4
                                                                                    int32_t v708 = g50; // 0x8f6304e4
                                                                                    if (is_skip_validation(v704, v707, v708) == 0) {
                                                                                        goto lab_0x8f6304f0_6;
                                                                                    }
                                                                                    v156 = v189;
                                                                                    v80 = v82;
                                                                                    v140 = v143;
                                                                                    v127 = v130;
                                                                                    v27 = v30;
                                                                                    v15 = v18;
                                                                                    v90 = v92;
                                                                                    v157 = v190;
                                                                                    v102 = v104;
                                                                                    v44 = v47;
                                                                                    v158 = v191;
                                                                                    v114 = v116;
                                                                                    v159 = v192;
                                                                                    goto lab_0x8f62f7f8_2;
                                                                                } else {
                                                                                    // 0x8f62f8c4
                                                                                    v610 = v679;
                                                                                    v611 = v680;
                                                                                    // branch -> 0x8f62f968
                                                                                    // 0x8f62f968
                                                                                    print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                                    v193 = v610;
                                                                                    v110 = v100;
                                                                                    v41 = v111;
                                                                                    v195 = v6;
                                                                                    v122 = v112;
                                                                                    v196 = v611;
                                                                                    // branch -> 0x8f6305ac
                                                                                }
                                                                                // 0x8f6305ac
                                                                                fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                                v185 = v193;
                                                                                v74 = v73;
                                                                                v144 = v83;
                                                                                v131 = v134;
                                                                                v31 = v85;
                                                                                v19 = v22;
                                                                                v96 = v93;
                                                                                v186 = v8;
                                                                                v105 = v110;
                                                                                v48 = v41;
                                                                                v187 = v195;
                                                                                v117 = v122;
                                                                                v188 = v196;
                                                                                // branch -> 0x8f630498
                                                                                goto lab_0x8f630498_14;
                                                                                break;
                                                                            }
                                                                            case 1: {
                                                                                // 0x8f62f668
                                                                                memset((char *)(g57 + v136), *(int32_t *)(v218 + 28), v657);
                                                                                v664 = v95;
                                                                                v662 = (int32_t)"fetch %d from FILL data\n";
                                                                                // branch -> 0x8f62f684
                                                                                goto lab_0x8f62f684_2;
                                                                                break;
                                                                            }
                                                                            case 0: {
                                                                                int32_t v709 = *(int32_t *)(v218 + 28); // 0x8f62f654
                                                                                memcpy((char *)(g57 + v136), (char *)v709, v657);
                                                                                v664 = v95;
                                                                                v662 = (int32_t)"fetch %d from RAW data\n";
                                                                                // branch -> 0x8f62f684
                                                                                goto lab_0x8f62f684_2;
                                                                                break;
                                                                            }
                                                                        }
                                                                        int32_t v710 = g54; // 0x8f62f684
                                                                        int32_t v711 = v278; // 0x8f62f688
                                                                        print_log(2, v662, v710, v711, (int32_t)v150, (int32_t)v149, v112, v5, v111, 0, v100, v7, 0);
                                                                        int32_t v712 = g53;
                                                                        int32_t v713 = g47;
                                                                        int32_t v714 = g54;
                                                                        int32_t v715 = g55;
                                                                        v668 = v715;
                                                                        v666 = v714;
                                                                        v665 = v713;
                                                                        v667 = v712;
                                                                        v663 = v664;
                                                                        // branch -> 0x8f62f68c
                                                                        goto lab_0x8f62f68c;
                                                                    }
                                                                }
                                                            }
                                                            // 0x8f62f8c4
                                                            v610 = v2;
                                                            v611 = v4;
                                                            // branch -> 0x8f62f968
                                                            // 0x8f62f968
                                                            print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                            v193 = v610;
                                                            v110 = v100;
                                                            v41 = v111;
                                                            v195 = v6;
                                                            v122 = v112;
                                                            v196 = v611;
                                                            // branch -> 0x8f6305ac
                                                          lab_0x8f6305ac_7:
                                                            // 0x8f6305ac
                                                            fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                            v185 = v193;
                                                            v74 = v73;
                                                            v144 = v83;
                                                            v131 = v134;
                                                            v31 = v85;
                                                            v19 = v22;
                                                            v96 = v93;
                                                            v186 = v8;
                                                            v105 = v110;
                                                            v48 = v41;
                                                            v187 = v195;
                                                            v117 = v122;
                                                            v188 = v196;
                                                            // branch -> 0x8f630498
                                                            goto lab_0x8f630498_14;
                                                        }
                                                    } else {
                                                        // 0x8f62f808
                                                        v272 = (int32_t)*(char *)(g56 + 49);
                                                        g51 = v272;
                                                        if (v249 == 2) {
                                                            // 0x8f62f814
                                                            if (v272 % 16 != 0) {
                                                                // 0x8f62f82c
                                                                if (is_skip_validation(v147, 2, g50) == 0) {
                                                                    // 0x8f62f838
                                                                    v65 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                                    if (v65 == 0) {
                                                                        // 0x8f62f848
                                                                        v197 = *(char *)(g56 + 49) % 16;
                                                                        v211 = v197;
                                                                        g51 = v211;
                                                                        if (v197 == 6) {
                                                                            // 0x8f62f870
                                                                            g51 = (int32_t)&g33;
                                                                            v257 = *(char *)&g33;
                                                                            v273 = v257;
                                                                            g50 = v273;
                                                                            if (v257 == 1) {
                                                                                // 0x8f62f89c
                                                                                v35 = 0;
                                                                                v173 = v2;
                                                                                v78 = v73;
                                                                                v138 = v83;
                                                                                v125 = v84;
                                                                                v25 = v85;
                                                                                v13 = v86;
                                                                                v88 = v87;
                                                                                v174 = v8;
                                                                                v108 = v100;
                                                                                v42 = v111;
                                                                                v175 = v6;
                                                                                v120 = v112;
                                                                                v176 = v4;
                                                                                if (*(char *)&g30 != 0) {
                                                                                    // 0x8f62f8ac
                                                                                    v172 = (int32_t)g27;
                                                                                    g45 = v172;
                                                                                    v258 = *(int32_t *)(v172 + 8);
                                                                                    g51 = v258;
                                                                                    g44 = -0x709d0748;
                                                                                    ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                                                    v203 = g45;
                                                                                    g55 = v203;
                                                                                    if (v203 == 0) {
                                                                                        // 0x8f62f8c4
                                                                                        v610 = v2;
                                                                                        v611 = v4;
                                                                                        // branch -> 0x8f62f968
                                                                                        // 0x8f62f968
                                                                                        print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                                        v193 = v610;
                                                                                        v110 = v100;
                                                                                        v41 = v111;
                                                                                        v195 = v6;
                                                                                        v122 = v112;
                                                                                        v196 = v611;
                                                                                        v39 = (int32_t)"Malformed sparse image";
                                                                                        // branch -> 0x8f6305ac
                                                                                      lab_0x8f6305ac_8:
                                                                                        // 0x8f6305ac
                                                                                        fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                                        v185 = v193;
                                                                                        v74 = v73;
                                                                                        v144 = v83;
                                                                                        v131 = v84;
                                                                                        v31 = v85;
                                                                                        v19 = v86;
                                                                                        v96 = v87;
                                                                                        v186 = v8;
                                                                                        v105 = v110;
                                                                                        v48 = v41;
                                                                                        v187 = v195;
                                                                                        v117 = v122;
                                                                                        v188 = v196;
                                                                                        // branch -> 0x8f630498
                                                                                        goto lab_0x8f630498_14;
                                                                                    } else {
                                                                                        v226 = v203;
                                                                                        v259 = *(int32_t *)(v226 + 8);
                                                                                        v277 = *(int32_t *)(v226 + 12);
                                                                                        g50 = v226;
                                                                                        g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                        v212 = v259 - 0x20000;
                                                                                        v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                        print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                        v221 = g55;
                                                                                        v54 = (int32_t *)(v221 + 8);
                                                                                        v260 = *v54;
                                                                                        v55 = (int32_t *)(v221 + 12);
                                                                                        g45 = (int32_t)g27;
                                                                                        v213 = v260 - 0x20000;
                                                                                        g52 = v213;
                                                                                        v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                        g53 = v216;
                                                                                        *v54 = v213;
                                                                                        *v55 = v216;
                                                                                        v222 = g45;
                                                                                        v261 = *(int32_t *)(v222 + 12);
                                                                                        g51 = v261;
                                                                                        g44 = -0x709d06f4;
                                                                                        ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                        v204 = g45;
                                                                                        g55 = v204;
                                                                                        while (v204 != 0) {
                                                                                            // 0x8f62f8cc
                                                                                            v226 = v204;
                                                                                            v259 = *(int32_t *)(v226 + 8);
                                                                                            v277 = *(int32_t *)(v226 + 12);
                                                                                            g50 = v226;
                                                                                            g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                            v212 = v259 - 0x20000;
                                                                                            v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                            print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                            v221 = g55;
                                                                                            v54 = (int32_t *)(v221 + 8);
                                                                                            v260 = *v54;
                                                                                            v55 = (int32_t *)(v221 + 12);
                                                                                            g45 = (int32_t)g27;
                                                                                            v213 = v260 - 0x20000;
                                                                                            g52 = v213;
                                                                                            v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                            g53 = v216;
                                                                                            *v54 = v213;
                                                                                            *v55 = v216;
                                                                                            v222 = g45;
                                                                                            v261 = *(int32_t *)(v222 + 12);
                                                                                            g51 = v261;
                                                                                            g44 = -0x709d06f4;
                                                                                            ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                            v204 = g45;
                                                                                            g55 = v204;
                                                                                            // continue -> 0x8f62f8cc
                                                                                        }
                                                                                        // 0x8f62f9f0
                                                                                        v35 = 0;
                                                                                        v173 = (char *)v259;
                                                                                        v78 = v73;
                                                                                        v138 = v83;
                                                                                        v125 = v84;
                                                                                        v25 = v85;
                                                                                        v13 = v86;
                                                                                        v88 = v87;
                                                                                        v174 = v8;
                                                                                        v108 = v100;
                                                                                        v42 = v111;
                                                                                        v175 = (char *)v215;
                                                                                        v120 = v212;
                                                                                        v176 = (char *)v277;
                                                                                        // branch -> 0x8f62f9f0
                                                                                        // 0x8f62f9f0
                                                                                        v262 = *(char *)&g30;
                                                                                        if (v262 == 0) {
                                                                                            goto lab_0x8f62fabc_20;
                                                                                        }
                                                                                        goto lab_0x8f62fa00_20;
                                                                                    }
                                                                                  lab_0x8f630498_17:
                                                                                    // 0x8f630498
                                                                                    *(char *)&g33 = 0;
                                                                                    v263 = *(char *)&g30;
                                                                                    if (v263 == 0) {
                                                                                        goto lab_0x8f6304bc_21;
                                                                                    }
                                                                                    goto lab_0x8f6304b4_21;
                                                                                }
                                                                                // 0x8f62f9f0
                                                                                v262 = *(char *)&g30;
                                                                                if (v262 == 0) {
                                                                                    goto lab_0x8f62fabc_20;
                                                                                }
                                                                                goto lab_0x8f62fa00_20;
                                                                            } else {
                                                                                // 0x8f62f880
                                                                                *(char *)&g33 = 0;
                                                                                v40 = (int32_t)&g33;
                                                                                // branch -> 0x8f62f88c
                                                                                // 0x8f62f88c
                                                                                print_log(1, (int32_t)"Invalid validating status\n", v273, v40, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                                // branch -> 0x8f62f890
                                                                                // 0x8f62f890
                                                                                v193 = v2;
                                                                                v110 = v100;
                                                                                v41 = v111;
                                                                                v195 = v6;
                                                                                v122 = v112;
                                                                                v196 = v4;
                                                                                v39 = (int32_t)"Invalid signed image";
                                                                                // branch -> 0x8f6305ac
                                                                                goto lab_0x8f6305ac_8;
                                                                            }
                                                                          lab_0x8f6305ac_9:
                                                                            // 0x8f6305ac
                                                                            fboot_info((int32_t)"INFO", (int32_t)"Not supported signed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                            v185 = v193;
                                                                            v74 = v73;
                                                                            v144 = v83;
                                                                            v131 = v84;
                                                                            v31 = v85;
                                                                            v19 = v86;
                                                                            v96 = v87;
                                                                            v186 = v165;
                                                                            v105 = v110;
                                                                            v48 = v41;
                                                                            v187 = v195;
                                                                            v117 = v122;
                                                                            v188 = v196;
                                                                            // branch -> 0x8f630498
                                                                            goto lab_0x8f630498_17;
                                                                        } else {
                                                                            v164 = v2;
                                                                            v165 = v8;
                                                                            v101 = v100;
                                                                            v45 = v111;
                                                                            v166 = v6;
                                                                            v113 = v112;
                                                                            v167 = v4;
                                                                            // 0x8f62f858
                                                                            print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v211, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                            v193 = v164;
                                                                            v110 = v101;
                                                                            v41 = v45;
                                                                            v195 = v166;
                                                                            v122 = v113;
                                                                            v196 = v167;
                                                                            // branch -> 0x8f6305ac
                                                                            goto lab_0x8f6305ac_9;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            // 0x8f62f81c
                                                            g46 = (int32_t)"bypass validation for SKIP_DATA type\n";
                                                            v64 = print_log(2, (int32_t)"bypass validation for SKIP_DATA type\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                            // branch -> 0x8f62f89c
                                                            // 0x8f62f89c
                                                            if (*(char *)&g30 != 0) {
                                                                // 0x8f62f8ac
                                                                v172 = (int32_t)g27;
                                                                g45 = v172;
                                                                v258 = *(int32_t *)(v172 + 8);
                                                                g51 = v258;
                                                                g44 = -0x709d0748;
                                                                ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                                v203 = g45;
                                                                g55 = v203;
                                                                if (v203 == 0) {
                                                                    // 0x8f62f8c4
                                                                    v610 = v2;
                                                                    v611 = v4;
                                                                    // branch -> 0x8f62f968
                                                                    // 0x8f62f968
                                                                    print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                    v193 = v610;
                                                                    v194 = v8;
                                                                    v110 = v100;
                                                                    v41 = v111;
                                                                    v195 = v6;
                                                                    v122 = v112;
                                                                    v196 = v611;
                                                                    v39 = (int32_t)"Malformed sparse image";
                                                                    // branch -> 0x8f6305ac
                                                                  lab_0x8f6305ac_10:
                                                                    // 0x8f6305ac
                                                                    fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                    v185 = v193;
                                                                    v74 = v73;
                                                                    v144 = v83;
                                                                    v131 = v84;
                                                                    v31 = v85;
                                                                    v19 = v86;
                                                                    v96 = v87;
                                                                    v186 = v194;
                                                                    v105 = v110;
                                                                    v48 = v41;
                                                                    v187 = v195;
                                                                    v117 = v122;
                                                                    v188 = v196;
                                                                    // branch -> 0x8f630498
                                                                    goto lab_0x8f630498_17;
                                                                } else {
                                                                    v226 = v203;
                                                                    v259 = *(int32_t *)(v226 + 8);
                                                                    v277 = *(int32_t *)(v226 + 12);
                                                                    g50 = v226;
                                                                    g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                    v212 = v259 - 0x20000;
                                                                    v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                    print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                    v221 = g55;
                                                                    v54 = (int32_t *)(v221 + 8);
                                                                    v260 = *v54;
                                                                    v55 = (int32_t *)(v221 + 12);
                                                                    g45 = (int32_t)g27;
                                                                    v213 = v260 - 0x20000;
                                                                    g52 = v213;
                                                                    v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                    g53 = v216;
                                                                    *v54 = v213;
                                                                    *v55 = v216;
                                                                    v222 = g45;
                                                                    v261 = *(int32_t *)(v222 + 12);
                                                                    g51 = v261;
                                                                    g44 = -0x709d06f4;
                                                                    ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                    v204 = g45;
                                                                    g55 = v204;
                                                                    while (v204 != 0) {
                                                                        // 0x8f62f8cc
                                                                        v226 = v204;
                                                                        v259 = *(int32_t *)(v226 + 8);
                                                                        v277 = *(int32_t *)(v226 + 12);
                                                                        g50 = v226;
                                                                        g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                        v212 = v259 - 0x20000;
                                                                        v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                        print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                        v221 = g55;
                                                                        v54 = (int32_t *)(v221 + 8);
                                                                        v260 = *v54;
                                                                        v55 = (int32_t *)(v221 + 12);
                                                                        g45 = (int32_t)g27;
                                                                        v213 = v260 - 0x20000;
                                                                        g52 = v213;
                                                                        v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                        g53 = v216;
                                                                        *v54 = v213;
                                                                        *v55 = v216;
                                                                        v222 = g45;
                                                                        v261 = *(int32_t *)(v222 + 12);
                                                                        g51 = v261;
                                                                        g44 = -0x709d06f4;
                                                                        ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                        v204 = g45;
                                                                        g55 = v204;
                                                                        // continue -> 0x8f62f8cc
                                                                    }
                                                                    // 0x8f62f9f0
                                                                    v35 = 0;
                                                                    v173 = (char *)v259;
                                                                    v78 = v73;
                                                                    v138 = v83;
                                                                    v125 = v84;
                                                                    v25 = v85;
                                                                    v13 = v86;
                                                                    v88 = v87;
                                                                    v174 = v8;
                                                                    v108 = v100;
                                                                    v42 = v111;
                                                                    v175 = (char *)v215;
                                                                    v120 = v212;
                                                                    v176 = (char *)v277;
                                                                    // branch -> 0x8f62f9f0
                                                                  lab_0x8f62f9f0_3:
                                                                    // 0x8f62f9f0
                                                                    v262 = *(char *)&g30;
                                                                    if (v262 == 0) {
                                                                        goto lab_0x8f62fabc_20;
                                                                    }
                                                                    goto lab_0x8f62fa00_20;
                                                                }
                                                              lab_0x8f630498_19:
                                                                // 0x8f630498
                                                                *(char *)&g33 = 0;
                                                                v263 = *(char *)&g30;
                                                                if (v263 == 0) {
                                                                    goto lab_0x8f6304bc_21;
                                                                }
                                                                goto lab_0x8f6304b4_21;
                                                            } else {
                                                                v35 = v64;
                                                                v173 = v2;
                                                                v78 = v73;
                                                                v138 = v83;
                                                                v125 = v84;
                                                                v25 = v85;
                                                                v13 = v86;
                                                                v88 = v87;
                                                                v174 = v8;
                                                                v108 = v100;
                                                                v42 = v111;
                                                                v175 = v6;
                                                                v120 = v112;
                                                                v176 = v4;
                                                            }
                                                        } else {
                                                            // 0x8f62f918
                                                            if (v272 % 16 != 0) {
                                                                // 0x8f62f92c
                                                                if (is_skip_validation(v147, v269, g50) == 0) {
                                                                    // 0x8f62f938
                                                                    v66 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                                    if ((char)v66 == 0) {
                                                                        // 0x8f62f948
                                                                        v198 = *(char *)(g56 + 49) % 16;
                                                                        v214 = v198;
                                                                        g51 = v214;
                                                                        if (v198 == 6) {
                                                                            // 0x8f62f958
                                                                            g51 = (int32_t)&g33;
                                                                            *(char *)&g33 = 0;
                                                                            v610 = v2;
                                                                            v611 = v4;
                                                                            // branch -> 0x8f62f968
                                                                            // 0x8f62f968
                                                                            print_log(3, (int32_t)"Unexpected FILL chunk for sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                            v193 = v610;
                                                                            v110 = v100;
                                                                            v41 = v111;
                                                                            v195 = v6;
                                                                            v122 = v112;
                                                                            v196 = v611;
                                                                            // branch -> 0x8f6305ac
                                                                        } else {
                                                                            v164 = v2;
                                                                            v165 = v8;
                                                                            v101 = v100;
                                                                            v45 = v111;
                                                                            v166 = v6;
                                                                            v113 = v112;
                                                                            v167 = v4;
                                                                            // 0x8f62f858
                                                                            print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v214, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                            v193 = v164;
                                                                            v194 = v165;
                                                                            v110 = v101;
                                                                            v41 = v45;
                                                                            v195 = v166;
                                                                            v122 = v113;
                                                                            v196 = v167;
                                                                            v39 = (int32_t)"Not supported signed sparse image";
                                                                            // branch -> 0x8f6305ac
                                                                            goto lab_0x8f6305ac_10;
                                                                        }
                                                                        // 0x8f6305ac
                                                                        fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                        v185 = v193;
                                                                        v74 = v73;
                                                                        v144 = v83;
                                                                        v131 = v84;
                                                                        v31 = v85;
                                                                        v19 = v86;
                                                                        v96 = v87;
                                                                        v186 = v8;
                                                                        v105 = v110;
                                                                        v48 = v41;
                                                                        v187 = v195;
                                                                        v117 = v122;
                                                                        v188 = v196;
                                                                        // branch -> 0x8f630498
                                                                        goto lab_0x8f630498_19;
                                                                    }
                                                                }
                                                            }
                                                            // 0x8f62f920
                                                            g46 = (int32_t)"bypass validation for FILL_DATA type\n";
                                                            v160 = v2;
                                                            v161 = v8;
                                                            v109 = v100;
                                                            v43 = v111;
                                                            v162 = v6;
                                                            v121 = v112;
                                                            v163 = v4;
                                                            // branch -> 0x8f62f800
                                                            // 0x8f62f800
                                                            v63 = print_log(2, (int32_t)"bypass validation for FILL_DATA type\n", g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                            v35 = v63;
                                                            v173 = v160;
                                                            v78 = v73;
                                                            v138 = v83;
                                                            v125 = v84;
                                                            v25 = v85;
                                                            v13 = v86;
                                                            v88 = v87;
                                                            v174 = v161;
                                                            v108 = v109;
                                                            v42 = v43;
                                                            v175 = v162;
                                                            v120 = v121;
                                                            v176 = v163;
                                                            // branch -> 0x8f62f9f0
                                                            goto lab_0x8f62f9f0_3;
                                                        }
                                                      lab_0x8f62f9f0_6:
                                                        // 0x8f62f9f0
                                                        v262 = *(char *)&g30;
                                                        if (v262 == 0) {
                                                            goto lab_0x8f62fabc_20;
                                                        }
                                                        goto lab_0x8f62fa00_20;
                                                    }
                                                }
                                            }
                                            // 0x8f6305ac
                                            fboot_info((int32_t)"INFO", (int32_t)"Invalid sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                            v185 = v193;
                                            v74 = v73;
                                            v144 = v83;
                                            v131 = v84;
                                            v31 = v85;
                                            v19 = v86;
                                            v96 = v87;
                                            v186 = v8;
                                            v105 = v110;
                                            v48 = v41;
                                            v187 = v195;
                                            v117 = v122;
                                            v188 = v196;
                                            // branch -> 0x8f630498
                                            goto lab_0x8f630498_19;
                                        }
                                      lab_0x8f630498_21:
                                        // 0x8f630498
                                        *(char *)&g33 = 0;
                                        v263 = *(char *)&g30;
                                        if (v263 == 0) {
                                            goto lab_0x8f6304bc_21;
                                        }
                                        goto lab_0x8f6304b4_21;
                                    }
                                    // 0x8f6305ac
                                    fboot_info((int32_t)"INFO", (int32_t)"Image size exeeded partition limits", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                    v185 = v193;
                                    v74 = v73;
                                    v144 = v83;
                                    v131 = v84;
                                    v31 = v85;
                                    v19 = v86;
                                    v96 = v87;
                                    v186 = v8;
                                    v105 = v110;
                                    v48 = v41;
                                    v187 = v195;
                                    v117 = v122;
                                    v188 = v196;
                                    // branch -> 0x8f630498
                                    goto lab_0x8f630498_21;
                                }
                                // 0x8f6305ac
                                fboot_info((int32_t)"INFO", (int32_t)"Unknown partition name", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                v185 = v193;
                                v74 = v73;
                                v144 = v83;
                                v131 = v84;
                                v31 = v85;
                                v19 = v86;
                                v96 = v87;
                                v186 = v8;
                                v105 = v110;
                                v48 = v41;
                                v187 = v195;
                                v117 = v122;
                                v188 = v196;
                                // branch -> 0x8f630498
                                goto lab_0x8f630498_21;
                            } else {
                                set_mem = 0;
                            }
                        }
                        // 0x8f63015c
                        v71 = 1;
                        v37 = set_mem;
                        v181 = v2;
                        v76 = v73;
                        v145 = v83;
                        v132 = v84;
                        v32 = v85;
                        v20 = v86;
                        v98 = v87;
                        v182 = v8;
                        v106 = v100;
                        v49 = v111;
                        v183 = v6;
                        v118 = v112;
                        v184 = v4;
                        // branch -> 0x8f630160
                        goto lab_0x8f630160_23;
                    }
                    // 0x8f63015c
                    v71 = 1;
                    v37 = 0;
                    v181 = v2;
                    v76 = v73;
                    v145 = v83;
                    v132 = v84;
                    v32 = v85;
                    v20 = v86;
                    v98 = v87;
                    v182 = v8;
                    v106 = v100;
                    v49 = v111;
                    v183 = v6;
                    v118 = v112;
                    v184 = v4;
                    // branch -> 0x8f630160
                    goto lab_0x8f630160_23;
                }
            }
            // 0x8f62f214
            is_write_protect_supported(str, 1);
            // branch -> 0x8f62f220
            // 0x8f62f220
            if (strcmp(str3, "partition") == 0) {
                // 0x8f62f234
                v223 = g52;
                g46 = v223;
                v56 = validate_gpt_image(g48, v223, g50, g51, v1, v3, v112, v5, v111, 0);
                // branch -> 0x8f630154
                // 0x8f630154
                if (v56 != 0) {
                    v185 = v2;
                    v74 = v73;
                    v144 = v83;
                    v131 = v84;
                    v31 = v85;
                    v19 = v86;
                    v96 = v87;
                    v186 = v8;
                    v105 = v100;
                    v48 = v111;
                    v187 = v6;
                    v117 = v112;
                    v188 = v4;
                  lab_0x8f630498_24:
                    // 0x8f630498
                    *(char *)&g33 = 0;
                    v263 = *(char *)&g30;
                    if (v263 == 0) {
                        goto lab_0x8f6304bc_21;
                    }
                    goto lab_0x8f6304b4_21;
                }
            } else {
                // 0x8f62f244
                strcmp_rc2 = strcmp(str3, "motoboot");
                g53 = strcmp_rc2;
                if (strcmp_rc2 == 0) {
                    // 0x8f62f258
                    g46 = (int32_t)"start motoboot image validation\n";
                    v57 = print_log(1, (int32_t)"start motoboot image validation\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                    g47 = &g43;
                    v199 = g48;
                    v205 = v199 + 1024;
                    g55 = v205;
                    v224 = g53;
                    g54 = v224;
                    v231 = *(int32_t *)v199;
                    g51 = v231;
                    if (v224 >= v231) {
                        v21 = v86;
                        v33 = v85;
                        v133 = v84;
                        v146 = v83;
                        while (true) {
                            // 0x8f62f27c
                            v264 = 32 * v224 + v199;
                            g55 = v224 + v205;
                            v206 = v264 + 4;
                            g57 = v206;
                            v232 = *(int32_t *)(g43 + 8);
                            g51 = v232;
                            g53 = v232 * (*(int32_t *)(v264 + 32) + 1 - *(int32_t *)(v264 + 28));
                            print_log(1, (int32_t)"Validating motoboot image: %s...\n", v206, v232, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                            len = strlen("partition");
                            g50 = len;
                            strncmp_rc = strncmp((char *)g57, "partition", len);
                            v71 = strncmp_rc;
                            if (strncmp_rc == 0) {
                                goto lab_0x8f62f2d4_4;
                            }
                            goto lab_0x8f62f2f4_4;
                        }
                    } else {
                        set_mem = v57;
                        v177 = v2;
                        v77 = v73;
                        v137 = v83;
                        v124 = v84;
                        v24 = v85;
                        v12 = v86;
                        v99 = v87;
                        v178 = v8;
                        v107 = v100;
                        v50 = v111;
                        v179 = v6;
                        v119 = v112;
                        v180 = v4;
                    }
                } else {
                    // 0x8f62f420
                    g46 = (int32_t)"cid_prov";
                    if (strcmp(str3, "cid_prov") != 0) {
                        // 0x8f62f434
                        v58 = get_partition_by_name(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                        v51 = (int32_t)v58;
                        g56 = v51;
                        if (v58 == NULL) {
                            // if_8f62f440_0_true
                            // branch -> 0x8f6305ac
                        } else {
                            // 0x8f62f44c
                            v233 = *(char *)(v51 + 41);
                            v234 = *(char *)(v51 + 40);
                            v235 = *(char *)(v51 + 33);
                            v236 = *(char *)(v51 + 42);
                            v237 = *(char *)(v51 + 32);
                            v238 = *(char *)(v51 + 43);
                            v239 = *(char *)(v51 + 34);
                            v265 = 0x1000000 * (int32_t)v238 | 0x10000 * (int32_t)v236 | (int32_t)v234 | 256 * (int32_t)v233;
                            v240 = *(char *)(v51 + 45);
                            v241 = *(char *)(v51 + 44);
                            v242 = *(char *)(v51 + 35);
                            v207 = v265 + 1;
                            v243 = *(char *)(v51 + 46);
                            v244 = *(char *)(v51 + 47);
                            v266 = 0x1000000 * (int32_t)v242 | 0x10000 * (int32_t)v239 | (int32_t)v237 | 256 * (int32_t)v235;
                            v245 = *(char *)(v51 + 37);
                            v246 = *(char *)(v51 + 36);
                            v247 = *(char *)(v51 + 38);
                            v267 = 0x10000 * (int32_t)v247 | (int32_t)v246 | 256 * (int32_t)v245;
                            g49 = v267;
                            v268 = v207 - v266;
                            v230 = 512 * v268;
                            g50 = v230;
                            v274 = 512 * ((0x1000000 * (int32_t)v244 | 0x10000 * (int32_t)v243 | (int32_t)v241 | 256 * (int32_t)v240) + (int32_t)(v265 == -1) + (int32_t)(v207 < v266) - v267) | v268 / 0x800000;
                            g51 = v274;
                            g46 = 0;
                            if (g52 > v230 && v274 == 0) {
                                // after_if_8f62f4ec_0.thread
                                v193 = v2;
                                v75 = v73;
                                v141 = v83;
                                v128 = v84;
                                v28 = v85;
                                v16 = v86;
                                v97 = v87;
                                v194 = v8;
                                v110 = v100;
                                v41 = v111;
                                v195 = v6;
                                v122 = v112;
                                v196 = v4;
                                v39 = (int32_t)"Image size exeeded partition limits";
                                // branch -> 0x8f6305ac
                            } else {
                                // 0x8f62f4f4
                                if (is_sparse_image(g48, 0, v230, v274) == 0) {
                                    // 0x8f62ff8c
                                    v67 = is_skip_validation(0, g46, g50);
                                    v36 = 0;
                                    if (v67 != 0) {
                                        // 0x8f62ffa8
                                        v68 = is_bootloader_partition(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                        if (v68 == 0) {
                                            // 0x8f63015c
                                            v71 = 1;
                                            v37 = 0;
                                            v181 = v2;
                                            v76 = v73;
                                            v145 = v83;
                                            v132 = v84;
                                            v32 = v85;
                                            v20 = v86;
                                            v98 = v87;
                                            v182 = v8;
                                            v106 = v100;
                                            v49 = v111;
                                            v183 = v6;
                                            v118 = v112;
                                            v184 = v4;
                                            // branch -> 0x8f630160
                                            goto lab_0x8f630160_23;
                                        } else {
                                            v36 = v68;
                                        }
                                    }
                                    // 0x8f62ff98
                                    if (is_verified_boot_flow(v36, g46) != 0) {
                                        // 0x8f630108
                                        if (strcmp(str3, "logo") == 0) {
                                            // 0x8f63011c
                                            v227 = g56;
                                            g56 = &v72;
                                            memcpy((char *)&v72, (char *)v227, 128);
                                            // branch -> 0x8f630140
                                        }
                                    }
                                    // 0x8f630140
                                    v228 = g48;
                                    g46 = v228;
                                    v229 = g52;
                                    g50 = v229;
                                    g51 = 0;
                                    v69 = validate_partition(g56, v228, v229, 0, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str, v84, v83);
                                    // branch -> 0x8f630154
                                    // 0x8f630154
                                    if (v69 == 0) {
                                        // 0x8f63015c
                                        v71 = 1;
                                        v37 = 0;
                                        v181 = v2;
                                        v76 = v73;
                                        v145 = v83;
                                        v132 = v84;
                                        v32 = v85;
                                        v20 = v86;
                                        v98 = v87;
                                        v182 = v8;
                                        v106 = v100;
                                        v49 = v111;
                                        v183 = v6;
                                        v118 = v112;
                                        v184 = v4;
                                        // branch -> 0x8f630160
                                        goto lab_0x8f630160_23;
                                    } else {
                                        v185 = v2;
                                        v74 = v73;
                                        v144 = v83;
                                        v131 = v84;
                                        v31 = v85;
                                        v19 = v86;
                                        v96 = v87;
                                        v186 = v8;
                                        v105 = v100;
                                        v48 = v111;
                                        v187 = v6;
                                        v117 = v112;
                                        v188 = v4;
                                    }
                                } else {
                                    // 0x8f62f504
                                    v59 = parse_sparse_image(g48, g52, g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str);
                                    g54 = (int32_t)&g27;
                                    *(int32_t *)&g27 = v59;
                                    if (v59 == 0) {
                                        // if_8f62f51c_0_true
                                        v193 = v2;
                                        v110 = v100;
                                        v41 = v111;
                                        v195 = v6;
                                        v122 = v112;
                                        v196 = v4;
                                        // branch -> 0x8f6305ac
                                    } else {
                                        // 0x8f62f528
                                        v248 = *(int32_t *)(v59 + 8);
                                        g51 = v248;
                                        v147 = unknown_69732061(v248);
                                        g52 = v147;
                                        if (v147 == 0) {
                                            // if_8f62f534_0_true
                                            v610 = v2;
                                            v611 = v4;
                                            // branch -> 0x8f62f968
                                            // 0x8f62f968
                                            print_log(3, (int32_t)"Invalid parsed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                            v193 = v610;
                                            v128 = v84;
                                            v16 = v86;
                                            v97 = v87;
                                            v110 = v100;
                                            v41 = v111;
                                            v195 = v6;
                                            v122 = v112;
                                            v196 = v611;
                                            v39 = (int32_t)"Malformed sparse image";
                                            // branch -> 0x8f6305ac
                                          lab_0x8f6305ac_12:
                                            // 0x8f6305ac
                                            fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                            v185 = v193;
                                            v74 = v73;
                                            v144 = v83;
                                            v131 = v128;
                                            v31 = v85;
                                            v19 = v16;
                                            v96 = v97;
                                            v186 = v8;
                                            v105 = v110;
                                            v48 = v41;
                                            v187 = v195;
                                            v117 = v122;
                                            v188 = v196;
                                            // branch -> 0x8f630498
                                            goto lab_0x8f630498_24;
                                        } else {
                                            // 0x8f62f540
                                            v249 = *(char *)v147;
                                            v269 = v249;
                                            g46 = v269;
                                            if (v249 == 0) {
                                                // 0x8f62f54c
                                                g50 = 0x20000;
                                                memset((char *)&g30, v269, 0x20000);
                                                v217 = g52;
                                                v250 = *(int32_t *)(v217 + 16);
                                                g46 = v250;
                                                if (is_piv_magic(*(int32_t *)(v217 + 28), v250, g50, g51) == 0) {
                                                    // 0x8f62f56c
                                                    v70 = (int32_t)"Non-signed image detected\n";
                                                    v60 = print_log(1, (int32_t)"Non-signed image detected\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                    v270 = (int32_t)*(char *)(g56 + 49);
                                                    g51 = v270;
                                                    if (v270 % 16 != 0) {
                                                        // 0x8f62f590
                                                        if (is_skip_validation(v60, v70, g50) == 0) {
                                                            // 0x8f62f59c
                                                            v61 = is_skip_sparse_preflash_validation(g56, v70, g50, g51, v1, v3, v112, v5);
                                                            if (v61 == 0) {
                                                                // if_8f62f5a8_0_true
                                                                // branch -> 0x8f62f88c
                                                                // 0x8f62f88c
                                                                print_log(3, (int32_t)"Invalid signed image", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                // branch -> 0x8f62f890
                                                                // 0x8f62f890
                                                                v193 = v2;
                                                                v128 = v84;
                                                                v16 = v86;
                                                                v97 = v87;
                                                                v110 = v100;
                                                                v41 = v111;
                                                                v195 = v6;
                                                                v122 = v112;
                                                                v196 = v4;
                                                                v39 = (int32_t)"Invalid signed image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_12;
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62f584
                                                    g46 = (int32_t)"bypass piv validation\n";
                                                    v160 = v2;
                                                    v79 = v73;
                                                    v139 = v83;
                                                    v126 = v84;
                                                    v26 = v85;
                                                    v14 = v86;
                                                    v89 = v87;
                                                    v161 = v8;
                                                    v109 = v100;
                                                    v43 = v111;
                                                    v162 = v6;
                                                    v121 = v112;
                                                    v163 = v4;
                                                    v38 = (int32_t)"bypass piv validation\n";
                                                    // branch -> 0x8f62f800
                                                  lab_0x8f62f800_3:
                                                    // 0x8f62f800
                                                    v63 = print_log(1, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                    v35 = v63;
                                                    v173 = v160;
                                                    v78 = v79;
                                                    v138 = v139;
                                                    v125 = v126;
                                                    v25 = v26;
                                                    v13 = v14;
                                                    v88 = v89;
                                                    v174 = v161;
                                                    v108 = v109;
                                                    v42 = v43;
                                                    v175 = v162;
                                                    v120 = v121;
                                                    v176 = v163;
                                                    // branch -> 0x8f62f9f0
                                                    goto lab_0x8f62f9f0_6;
                                                } else {
                                                    // 0x8f62f5b8
                                                    v148 = (int32_t)g27;
                                                    g52 = v148;
                                                    g57 = 0;
                                                    g53 = 0x20000;
                                                    v251 = *(int32_t *)(v148 + 8);
                                                    g51 = v251;
                                                    g45 = v148;
                                                    g44 = -0x709d0a30;
                                                    ((int32_t (*)(int32_t, int32_t))v251)(v148, v251);
                                                    g57 = (int32_t)&g30;
                                                    v123 = g45;
                                                    g47 = v123;
                                                    v200 = g53;
                                                    if (v200 == 0) {
                                                        v201 = v123;
                                                        // 0x8f62f774
                                                        v208 = v201 < 2 ? 1 - v201 : 0;
                                                        g51 = v208;
                                                        v209 = v208;
                                                        v93 = v87;
                                                        v22 = v86;
                                                        v134 = 0;
                                                        // branch -> after_if_8f62f784_0
                                                        // after_if_8f62f784_0
                                                        g53 = v209;
                                                        if (v209 == 0) {
                                                            v219 = v201;
                                                            v52 = (int32_t *)(v219 + 8);
                                                            v253 = *v52;
                                                            v53 = (int32_t *)(v219 + 12);
                                                            v254 = *(int32_t *)(v219 + 16);
                                                            v275 = *(int32_t *)(v219 + 20);
                                                            v210 = v253 - 0x20000;
                                                            v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                            *v52 = v210;
                                                            *v53 = v70;
                                                            v225 = g47;
                                                            g50 = v225;
                                                            v255 = v210;
                                                            v276 = v70;
                                                            g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                            print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                            v220 = g52;
                                                            v256 = *(int32_t *)(v220 + 12);
                                                            g51 = v256;
                                                            g45 = v220;
                                                            g44 = -0x709d0834;
                                                            ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                            v202 = g45;
                                                            g47 = v202;
                                                            while (v202 != 0) {
                                                                // 0x8f62f794
                                                                v219 = v202;
                                                                v52 = (int32_t *)(v219 + 8);
                                                                v253 = *v52;
                                                                v53 = (int32_t *)(v219 + 12);
                                                                v254 = *(int32_t *)(v219 + 16);
                                                                v275 = *(int32_t *)(v219 + 20);
                                                                v210 = v253 - 0x20000;
                                                                v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                                *v52 = v210;
                                                                *v53 = v70;
                                                                v225 = g47;
                                                                g50 = v225;
                                                                v255 = v210;
                                                                v276 = v70;
                                                                g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                                print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                                v220 = g52;
                                                                v256 = *(int32_t *)(v220 + 12);
                                                                g51 = v256;
                                                                g45 = v220;
                                                                g44 = -0x709d0834;
                                                                ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                                v202 = g45;
                                                                g47 = v202;
                                                                // continue -> 0x8f62f794
                                                            }
                                                            // 0x8f62f7d4
                                                            v153 = (char *)v254;
                                                            v154 = (char *)v275;
                                                            v155 = (char *)v276;
                                                            g46 = 0x20000;
                                                            g50 = str;
                                                            v62 = piv_init((int32_t)&g30, 0x20000, str, g51, v254, v275, v255, v276, v111, 0, v100, v7, 0, v93, v22, v85, 0);
                                                            if (v62 == 0) {
                                                                // 0x8f62f7ec
                                                                v271 = (int32_t)*(char *)(g56 + 49);
                                                                g51 = v271;
                                                                if (v271 % 16 == 0) {
                                                                    v156 = v153;
                                                                    v80 = v73;
                                                                    v140 = v83;
                                                                    v127 = v134;
                                                                    v27 = v85;
                                                                    v15 = v22;
                                                                    v90 = v93;
                                                                    v157 = v8;
                                                                    v102 = v100;
                                                                    v44 = v111;
                                                                    v158 = v155;
                                                                    v114 = v255;
                                                                    v159 = v154;
                                                                  lab_0x8f62f7f8_3:
                                                                    // 0x8f62f7f8
                                                                    g46 = (int32_t)"skip validating PIV image\n";
                                                                    v160 = v156;
                                                                    v79 = v80;
                                                                    v139 = v140;
                                                                    v126 = v127;
                                                                    v26 = v27;
                                                                    v14 = v15;
                                                                    v89 = v90;
                                                                    v161 = v157;
                                                                    v109 = v102;
                                                                    v43 = v44;
                                                                    v162 = v158;
                                                                    v121 = v114;
                                                                    v163 = v159;
                                                                    v38 = (int32_t)"skip validating PIV image\n";
                                                                    // branch -> 0x8f62f800
                                                                    goto lab_0x8f62f800_3;
                                                                } else {
                                                                    v189 = v153;
                                                                    v82 = v73;
                                                                    v143 = v83;
                                                                    v130 = v134;
                                                                    v30 = v85;
                                                                    v18 = v22;
                                                                    v92 = v93;
                                                                    v190 = v8;
                                                                    v104 = v100;
                                                                    v47 = v111;
                                                                    v191 = v155;
                                                                    v116 = v255;
                                                                    v192 = v154;
                                                                }
                                                            } else {
                                                                // 0x8f62f890
                                                                v193 = v153;
                                                                v128 = v134;
                                                                v16 = v22;
                                                                v97 = v93;
                                                                v110 = v100;
                                                                v41 = v111;
                                                                v195 = v155;
                                                                v122 = v255;
                                                                v196 = v154;
                                                                v39 = (int32_t)"Invalid signed image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_12;
                                                            }
                                                            // 0x8f6304e4
                                                            if (is_skip_validation(0, g46, g50) == 0) {
                                                                goto lab_0x8f6304f0_6;
                                                            }
                                                            v156 = v189;
                                                            v80 = v82;
                                                            v140 = v143;
                                                            v127 = v130;
                                                            v27 = v30;
                                                            v15 = v18;
                                                            v90 = v92;
                                                            v157 = v190;
                                                            v102 = v104;
                                                            v44 = v47;
                                                            v158 = v191;
                                                            v114 = v116;
                                                            v159 = v192;
                                                            goto lab_0x8f62f7f8_3;
                                                        }
                                                    } else {
                                                        v252 = v200;
                                                        v218 = v123;
                                                        v149 = v4;
                                                        v95 = v87;
                                                        v136 = 0;
                                                        v150 = v2;
                                                        while (true) {
                                                            // after_if_8f62f5e0_0
                                                            if (v218 != 0) {
                                                                goto lab_0x8f62f5e8_4;
                                                            }
                                                            // 0x8f62f774
                                                            g51 = 1;
                                                            // branch -> after_if_8f62f784_0.thread
                                                            // after_if_8f62f784_0.thread
                                                            g53 = 1;
                                                            // branch -> 0x8f62f8c4
                                                        }
                                                    }
                                                    // 0x8f62f8c4
                                                    v610 = v2;
                                                    v611 = v4;
                                                    // branch -> 0x8f62f968
                                                    // 0x8f62f968
                                                    print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                    v193 = v610;
                                                    v110 = v100;
                                                    v41 = v111;
                                                    v195 = v6;
                                                    v122 = v112;
                                                    v196 = v611;
                                                    // branch -> 0x8f6305ac
                                                  lab_0x8f6305ac_13:
                                                    // 0x8f6305ac
                                                    fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                    v185 = v193;
                                                    v74 = v73;
                                                    v144 = v83;
                                                    v131 = v134;
                                                    v31 = v85;
                                                    v19 = v22;
                                                    v96 = v93;
                                                    v186 = v8;
                                                    v105 = v110;
                                                    v48 = v41;
                                                    v187 = v195;
                                                    v117 = v122;
                                                    v188 = v196;
                                                    // branch -> 0x8f630498
                                                    goto lab_0x8f630498_24;
                                                }
                                            } else {
                                                // 0x8f62f808
                                                v272 = (int32_t)*(char *)(g56 + 49);
                                                g51 = v272;
                                                if (v249 == 2) {
                                                    // 0x8f62f814
                                                    if (v272 % 16 != 0) {
                                                        // 0x8f62f82c
                                                        if (is_skip_validation(v147, 2, g50) == 0) {
                                                            // 0x8f62f838
                                                            v65 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                            if (v65 == 0) {
                                                                // 0x8f62f848
                                                                v197 = *(char *)(g56 + 49) % 16;
                                                                v211 = v197;
                                                                g51 = v211;
                                                                if (v197 == 6) {
                                                                    // 0x8f62f870
                                                                    g51 = (int32_t)&g33;
                                                                    v257 = *(char *)&g33;
                                                                    v273 = v257;
                                                                    g50 = v273;
                                                                    if (v257 == 1) {
                                                                        // 0x8f62f89c
                                                                        v35 = 0;
                                                                        v173 = v2;
                                                                        v78 = v73;
                                                                        v138 = v83;
                                                                        v125 = v84;
                                                                        v25 = v85;
                                                                        v13 = v86;
                                                                        v88 = v87;
                                                                        v174 = v8;
                                                                        v108 = v100;
                                                                        v42 = v111;
                                                                        v175 = v6;
                                                                        v120 = v112;
                                                                        v176 = v4;
                                                                        if (*(char *)&g30 != 0) {
                                                                            // 0x8f62f8ac
                                                                            v172 = (int32_t)g27;
                                                                            g45 = v172;
                                                                            v258 = *(int32_t *)(v172 + 8);
                                                                            g51 = v258;
                                                                            g44 = -0x709d0748;
                                                                            ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                                            v203 = g45;
                                                                            g55 = v203;
                                                                            if (v203 == 0) {
                                                                                // 0x8f62f8c4
                                                                                v610 = v2;
                                                                                v611 = v4;
                                                                                // branch -> 0x8f62f968
                                                                                // 0x8f62f968
                                                                                print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                                v193 = v610;
                                                                                v110 = v100;
                                                                                v41 = v111;
                                                                                v195 = v6;
                                                                                v122 = v112;
                                                                                v196 = v611;
                                                                                v39 = (int32_t)"Malformed sparse image";
                                                                                // branch -> 0x8f6305ac
                                                                              lab_0x8f6305ac_14:
                                                                                // 0x8f6305ac
                                                                                fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                                v185 = v193;
                                                                                v74 = v73;
                                                                                v144 = v83;
                                                                                v131 = v84;
                                                                                v31 = v85;
                                                                                v19 = v86;
                                                                                v96 = v87;
                                                                                v186 = v8;
                                                                                v105 = v110;
                                                                                v48 = v41;
                                                                                v187 = v195;
                                                                                v117 = v122;
                                                                                v188 = v196;
                                                                                // branch -> 0x8f630498
                                                                                goto lab_0x8f630498_24;
                                                                            } else {
                                                                                v226 = v203;
                                                                                v259 = *(int32_t *)(v226 + 8);
                                                                                v277 = *(int32_t *)(v226 + 12);
                                                                                g50 = v226;
                                                                                g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                v212 = v259 - 0x20000;
                                                                                v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                v221 = g55;
                                                                                v54 = (int32_t *)(v221 + 8);
                                                                                v260 = *v54;
                                                                                v55 = (int32_t *)(v221 + 12);
                                                                                g45 = (int32_t)g27;
                                                                                v213 = v260 - 0x20000;
                                                                                g52 = v213;
                                                                                v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                g53 = v216;
                                                                                *v54 = v213;
                                                                                *v55 = v216;
                                                                                v222 = g45;
                                                                                v261 = *(int32_t *)(v222 + 12);
                                                                                g51 = v261;
                                                                                g44 = -0x709d06f4;
                                                                                ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                v204 = g45;
                                                                                g55 = v204;
                                                                                while (v204 != 0) {
                                                                                    // 0x8f62f8cc
                                                                                    v226 = v204;
                                                                                    v259 = *(int32_t *)(v226 + 8);
                                                                                    v277 = *(int32_t *)(v226 + 12);
                                                                                    g50 = v226;
                                                                                    g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                    v212 = v259 - 0x20000;
                                                                                    v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                    print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                    v221 = g55;
                                                                                    v54 = (int32_t *)(v221 + 8);
                                                                                    v260 = *v54;
                                                                                    v55 = (int32_t *)(v221 + 12);
                                                                                    g45 = (int32_t)g27;
                                                                                    v213 = v260 - 0x20000;
                                                                                    g52 = v213;
                                                                                    v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                    g53 = v216;
                                                                                    *v54 = v213;
                                                                                    *v55 = v216;
                                                                                    v222 = g45;
                                                                                    v261 = *(int32_t *)(v222 + 12);
                                                                                    g51 = v261;
                                                                                    g44 = -0x709d06f4;
                                                                                    ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                    v204 = g45;
                                                                                    g55 = v204;
                                                                                    // continue -> 0x8f62f8cc
                                                                                }
                                                                                // 0x8f62f9f0
                                                                                v35 = 0;
                                                                                v173 = (char *)v259;
                                                                                v78 = v73;
                                                                                v138 = v83;
                                                                                v125 = v84;
                                                                                v25 = v85;
                                                                                v13 = v86;
                                                                                v88 = v87;
                                                                                v174 = v8;
                                                                                v108 = v100;
                                                                                v42 = v111;
                                                                                v175 = (char *)v215;
                                                                                v120 = v212;
                                                                                v176 = (char *)v277;
                                                                                // branch -> 0x8f62f9f0
                                                                                // 0x8f62f9f0
                                                                                v262 = *(char *)&g30;
                                                                                if (v262 == 0) {
                                                                                    goto lab_0x8f62fabc_20;
                                                                                }
                                                                                goto lab_0x8f62fa00_20;
                                                                            }
                                                                          lab_0x8f630498_27:
                                                                            // 0x8f630498
                                                                            *(char *)&g33 = 0;
                                                                            v263 = *(char *)&g30;
                                                                            if (v263 == 0) {
                                                                                goto lab_0x8f6304bc_21;
                                                                            }
                                                                            goto lab_0x8f6304b4_21;
                                                                        }
                                                                        // 0x8f62f9f0
                                                                        v262 = *(char *)&g30;
                                                                        if (v262 == 0) {
                                                                            goto lab_0x8f62fabc_20;
                                                                        }
                                                                        goto lab_0x8f62fa00_20;
                                                                    } else {
                                                                        // 0x8f62f880
                                                                        *(char *)&g33 = 0;
                                                                        v40 = (int32_t)&g33;
                                                                        // branch -> 0x8f62f88c
                                                                        // 0x8f62f88c
                                                                        print_log(1, (int32_t)"Invalid validating status\n", v273, v40, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                        // branch -> 0x8f62f890
                                                                        // 0x8f62f890
                                                                        v193 = v2;
                                                                        v110 = v100;
                                                                        v41 = v111;
                                                                        v195 = v6;
                                                                        v122 = v112;
                                                                        v196 = v4;
                                                                        v39 = (int32_t)"Invalid signed image";
                                                                        // branch -> 0x8f6305ac
                                                                        goto lab_0x8f6305ac_14;
                                                                    }
                                                                  lab_0x8f6305ac_15:
                                                                    // 0x8f6305ac
                                                                    fboot_info((int32_t)"INFO", (int32_t)"Not supported signed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                    v185 = v193;
                                                                    v74 = v73;
                                                                    v144 = v83;
                                                                    v131 = v84;
                                                                    v31 = v85;
                                                                    v19 = v86;
                                                                    v96 = v87;
                                                                    v186 = v165;
                                                                    v105 = v110;
                                                                    v48 = v41;
                                                                    v187 = v195;
                                                                    v117 = v122;
                                                                    v188 = v196;
                                                                    // branch -> 0x8f630498
                                                                    goto lab_0x8f630498_27;
                                                                } else {
                                                                    v164 = v2;
                                                                    v165 = v8;
                                                                    v101 = v100;
                                                                    v45 = v111;
                                                                    v166 = v6;
                                                                    v113 = v112;
                                                                    v167 = v4;
                                                                    // 0x8f62f858
                                                                    print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v211, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                    v193 = v164;
                                                                    v110 = v101;
                                                                    v41 = v45;
                                                                    v195 = v166;
                                                                    v122 = v113;
                                                                    v196 = v167;
                                                                    // branch -> 0x8f6305ac
                                                                    goto lab_0x8f6305ac_15;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62f81c
                                                    g46 = (int32_t)"bypass validation for SKIP_DATA type\n";
                                                    v64 = print_log(2, (int32_t)"bypass validation for SKIP_DATA type\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                    // branch -> 0x8f62f89c
                                                    // 0x8f62f89c
                                                    if (*(char *)&g30 != 0) {
                                                        // 0x8f62f8ac
                                                        v172 = (int32_t)g27;
                                                        g45 = v172;
                                                        v258 = *(int32_t *)(v172 + 8);
                                                        g51 = v258;
                                                        g44 = -0x709d0748;
                                                        ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                        v203 = g45;
                                                        g55 = v203;
                                                        if (v203 == 0) {
                                                            // 0x8f62f8c4
                                                            v610 = v2;
                                                            v611 = v4;
                                                            // branch -> 0x8f62f968
                                                            // 0x8f62f968
                                                            print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                            v193 = v610;
                                                            v194 = v8;
                                                            v110 = v100;
                                                            v41 = v111;
                                                            v195 = v6;
                                                            v122 = v112;
                                                            v196 = v611;
                                                            v39 = (int32_t)"Malformed sparse image";
                                                            // branch -> 0x8f6305ac
                                                          lab_0x8f6305ac_16:
                                                            // 0x8f6305ac
                                                            fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                            v185 = v193;
                                                            v74 = v73;
                                                            v144 = v83;
                                                            v131 = v84;
                                                            v31 = v85;
                                                            v19 = v86;
                                                            v96 = v87;
                                                            v186 = v194;
                                                            v105 = v110;
                                                            v48 = v41;
                                                            v187 = v195;
                                                            v117 = v122;
                                                            v188 = v196;
                                                            // branch -> 0x8f630498
                                                            goto lab_0x8f630498_27;
                                                        } else {
                                                            v226 = v203;
                                                            v259 = *(int32_t *)(v226 + 8);
                                                            v277 = *(int32_t *)(v226 + 12);
                                                            g50 = v226;
                                                            g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                            v212 = v259 - 0x20000;
                                                            v215 = v277 - (int32_t)(v259 < 0x20000);
                                                            print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                            v221 = g55;
                                                            v54 = (int32_t *)(v221 + 8);
                                                            v260 = *v54;
                                                            v55 = (int32_t *)(v221 + 12);
                                                            g45 = (int32_t)g27;
                                                            v213 = v260 - 0x20000;
                                                            g52 = v213;
                                                            v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                            g53 = v216;
                                                            *v54 = v213;
                                                            *v55 = v216;
                                                            v222 = g45;
                                                            v261 = *(int32_t *)(v222 + 12);
                                                            g51 = v261;
                                                            g44 = -0x709d06f4;
                                                            ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                            v204 = g45;
                                                            g55 = v204;
                                                            while (v204 != 0) {
                                                                // 0x8f62f8cc
                                                                v226 = v204;
                                                                v259 = *(int32_t *)(v226 + 8);
                                                                v277 = *(int32_t *)(v226 + 12);
                                                                g50 = v226;
                                                                g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                v212 = v259 - 0x20000;
                                                                v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                v221 = g55;
                                                                v54 = (int32_t *)(v221 + 8);
                                                                v260 = *v54;
                                                                v55 = (int32_t *)(v221 + 12);
                                                                g45 = (int32_t)g27;
                                                                v213 = v260 - 0x20000;
                                                                g52 = v213;
                                                                v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                g53 = v216;
                                                                *v54 = v213;
                                                                *v55 = v216;
                                                                v222 = g45;
                                                                v261 = *(int32_t *)(v222 + 12);
                                                                g51 = v261;
                                                                g44 = -0x709d06f4;
                                                                ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                v204 = g45;
                                                                g55 = v204;
                                                                // continue -> 0x8f62f8cc
                                                            }
                                                            // 0x8f62f9f0
                                                            v35 = 0;
                                                            v173 = (char *)v259;
                                                            v78 = v73;
                                                            v138 = v83;
                                                            v125 = v84;
                                                            v25 = v85;
                                                            v13 = v86;
                                                            v88 = v87;
                                                            v174 = v8;
                                                            v108 = v100;
                                                            v42 = v111;
                                                            v175 = (char *)v215;
                                                            v120 = v212;
                                                            v176 = (char *)v277;
                                                            // branch -> 0x8f62f9f0
                                                          lab_0x8f62f9f0_7:
                                                            // 0x8f62f9f0
                                                            v262 = *(char *)&g30;
                                                            if (v262 == 0) {
                                                                goto lab_0x8f62fabc_20;
                                                            }
                                                            goto lab_0x8f62fa00_20;
                                                        }
                                                      lab_0x8f630498_29:
                                                        // 0x8f630498
                                                        *(char *)&g33 = 0;
                                                        v263 = *(char *)&g30;
                                                        if (v263 == 0) {
                                                            goto lab_0x8f6304bc_21;
                                                        }
                                                        goto lab_0x8f6304b4_21;
                                                    } else {
                                                        v35 = v64;
                                                        v173 = v2;
                                                        v78 = v73;
                                                        v138 = v83;
                                                        v125 = v84;
                                                        v25 = v85;
                                                        v13 = v86;
                                                        v88 = v87;
                                                        v174 = v8;
                                                        v108 = v100;
                                                        v42 = v111;
                                                        v175 = v6;
                                                        v120 = v112;
                                                        v176 = v4;
                                                    }
                                                } else {
                                                    // 0x8f62f918
                                                    if (v272 % 16 != 0) {
                                                        // 0x8f62f92c
                                                        if (is_skip_validation(v147, v269, g50) == 0) {
                                                            // 0x8f62f938
                                                            v66 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                            if ((char)v66 == 0) {
                                                                // 0x8f62f948
                                                                v198 = *(char *)(g56 + 49) % 16;
                                                                v214 = v198;
                                                                g51 = v214;
                                                                if (v198 == 6) {
                                                                    // 0x8f62f958
                                                                    g51 = (int32_t)&g33;
                                                                    *(char *)&g33 = 0;
                                                                    v610 = v2;
                                                                    v611 = v4;
                                                                    // branch -> 0x8f62f968
                                                                    // 0x8f62f968
                                                                    print_log(3, (int32_t)"Unexpected FILL chunk for sparse image", g50, g51, (int32_t)v610, (int32_t)v611, v112, v5, v111, 0, v100, v7, 0);
                                                                    v193 = v610;
                                                                    v110 = v100;
                                                                    v41 = v111;
                                                                    v195 = v6;
                                                                    v122 = v112;
                                                                    v196 = v611;
                                                                    // branch -> 0x8f6305ac
                                                                } else {
                                                                    v164 = v2;
                                                                    v165 = v8;
                                                                    v101 = v100;
                                                                    v45 = v111;
                                                                    v166 = v6;
                                                                    v113 = v112;
                                                                    v167 = v4;
                                                                    // 0x8f62f858
                                                                    print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v214, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                    v193 = v164;
                                                                    v194 = v165;
                                                                    v110 = v101;
                                                                    v41 = v45;
                                                                    v195 = v166;
                                                                    v122 = v113;
                                                                    v196 = v167;
                                                                    v39 = (int32_t)"Not supported signed sparse image";
                                                                    // branch -> 0x8f6305ac
                                                                    goto lab_0x8f6305ac_16;
                                                                }
                                                                // 0x8f6305ac
                                                                fboot_info((int32_t)"INFO", (int32_t)"Malformed sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                                                v185 = v193;
                                                                v74 = v73;
                                                                v144 = v83;
                                                                v131 = v84;
                                                                v31 = v85;
                                                                v19 = v86;
                                                                v96 = v87;
                                                                v186 = v8;
                                                                v105 = v110;
                                                                v48 = v41;
                                                                v187 = v195;
                                                                v117 = v122;
                                                                v188 = v196;
                                                                // branch -> 0x8f630498
                                                                goto lab_0x8f630498_29;
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62f920
                                                    g46 = (int32_t)"bypass validation for FILL_DATA type\n";
                                                    v160 = v2;
                                                    v161 = v8;
                                                    v109 = v100;
                                                    v43 = v111;
                                                    v162 = v6;
                                                    v121 = v112;
                                                    v163 = v4;
                                                    // branch -> 0x8f62f800
                                                    // 0x8f62f800
                                                    v63 = print_log(2, (int32_t)"bypass validation for FILL_DATA type\n", g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                    v35 = v63;
                                                    v173 = v160;
                                                    v78 = v73;
                                                    v138 = v83;
                                                    v125 = v84;
                                                    v25 = v85;
                                                    v13 = v86;
                                                    v88 = v87;
                                                    v174 = v161;
                                                    v108 = v109;
                                                    v42 = v43;
                                                    v175 = v162;
                                                    v120 = v121;
                                                    v176 = v163;
                                                    // branch -> 0x8f62f9f0
                                                    goto lab_0x8f62f9f0_7;
                                                }
                                              lab_0x8f62f9f0_10:
                                                // 0x8f62f9f0
                                                v262 = *(char *)&g30;
                                                if (v262 == 0) {
                                                    goto lab_0x8f62fabc_20;
                                                }
                                                goto lab_0x8f62fa00_20;
                                            }
                                        }
                                    }
                                    // 0x8f6305ac
                                    fboot_info((int32_t)"INFO", (int32_t)"Invalid sparse image", g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                                    v185 = v193;
                                    v74 = v73;
                                    v144 = v83;
                                    v131 = v84;
                                    v31 = v85;
                                    v19 = v86;
                                    v96 = v87;
                                    v186 = v8;
                                    v105 = v110;
                                    v48 = v41;
                                    v187 = v195;
                                    v117 = v122;
                                    v188 = v196;
                                    // branch -> 0x8f630498
                                    goto lab_0x8f630498_29;
                                }
                              lab_0x8f630498_30:
                                // 0x8f630498
                                *(char *)&g33 = 0;
                                v263 = *(char *)&g30;
                                if (v263 == 0) {
                                    goto lab_0x8f6304bc_21;
                                }
                                goto lab_0x8f6304b4_21;
                            }
                          lab_0x8f6305ac_34:
                            // 0x8f6305ac
                            fboot_info((int32_t)"INFO", v39, g50, g51, (int32_t)v193, (int32_t)v196, v122, (int32_t)v195, v41, 0, v110);
                            v185 = v193;
                            v74 = v75;
                            v144 = v141;
                            v131 = v128;
                            v31 = v28;
                            v19 = v16;
                            v96 = v97;
                            v186 = v194;
                            v105 = v110;
                            v48 = v41;
                            v187 = v195;
                            v117 = v122;
                            v188 = v196;
                            // branch -> 0x8f630498
                            goto lab_0x8f630498_30;
                        }
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    } else {
                        set_mem = 0;
                        v177 = v2;
                        v77 = v73;
                        v137 = v83;
                        v124 = v84;
                        v24 = v85;
                        v12 = v86;
                        v99 = v87;
                        v178 = v8;
                        v107 = v100;
                        v50 = v111;
                        v179 = v6;
                        v119 = v112;
                        v180 = v4;
                    }
                }
                // 0x8f63015c
                v71 = 1;
                v37 = set_mem;
                v181 = v177;
                v76 = v77;
                v145 = v137;
                v132 = v124;
                v32 = v24;
                v20 = v12;
                v98 = v99;
                v182 = v178;
                v106 = v107;
                v49 = v50;
                v183 = v179;
                v118 = v119;
                v184 = v180;
                // branch -> 0x8f630160
                goto lab_0x8f630160_23;
            }
            // 0x8f63015c
            v71 = 1;
            v37 = 0;
            v181 = v2;
            v76 = v73;
            v145 = v83;
            v132 = v84;
            v32 = v85;
            v20 = v86;
            v98 = v87;
            v182 = v8;
            v106 = v100;
            v49 = v111;
            v183 = v6;
            v118 = v112;
            v184 = v4;
            // branch -> 0x8f630160
            goto lab_0x8f630160_23;
        }
    }
    // 0x8f62f1ec
    str3 = (char *)str;
    if (strcmp(str3, "system") != 0) {
        // 0x8f62f200
        if (strcmp(str3, "oem") != 0) {
            // 0x8f62f220
            if (strcmp(str3, "partition") == 0) {
                // 0x8f62f234
                v223 = g52;
                g46 = v223;
                v56 = validate_gpt_image(g48, v223, g50, g51, v1, v3, v112, v5, v111, 0);
                // branch -> 0x8f630154
                // 0x8f630154
                if (v56 != 0) {
                    v185 = v2;
                    v74 = v73;
                    v144 = v83;
                    v131 = v84;
                    v31 = v85;
                    v19 = v86;
                    v96 = v87;
                    v186 = v8;
                    v105 = v100;
                    v48 = v111;
                    v187 = v6;
                    v117 = v112;
                    v188 = v4;
                    // 0x8f630498
                    *(char *)&g33 = 0;
                    v263 = *(char *)&g30;
                    if (v263 == 0) {
                        goto lab_0x8f6304bc_21;
                    }
                    goto lab_0x8f6304b4_21;
                }
            } else {
                // 0x8f62f244
                strcmp_rc2 = strcmp(str3, "motoboot");
                g53 = strcmp_rc2;
                if (strcmp_rc2 == 0) {
                    // 0x8f62f258
                    g46 = (int32_t)"start motoboot image validation\n";
                    v57 = print_log(1, (int32_t)"start motoboot image validation\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                    g47 = &g43;
                    v199 = g48;
                    v205 = v199 + 1024;
                    g55 = v205;
                    v224 = g53;
                    g54 = v224;
                    v231 = *(int32_t *)v199;
                    g51 = v231;
                    if (v224 >= v231) {
                        v21 = v86;
                        v33 = v85;
                        v133 = v84;
                        v146 = v83;
                        while (true) {
                            // 0x8f62f27c
                            v264 = 32 * v224 + v199;
                            g55 = v224 + v205;
                            v206 = v264 + 4;
                            g57 = v206;
                            v232 = *(int32_t *)(g43 + 8);
                            g51 = v232;
                            g53 = v232 * (*(int32_t *)(v264 + 32) + 1 - *(int32_t *)(v264 + 28));
                            print_log(1, (int32_t)"Validating motoboot image: %s...\n", v206, v232, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                            len = strlen("partition");
                            g50 = len;
                            strncmp_rc = strncmp((char *)g57, "partition", len);
                            v71 = strncmp_rc;
                            if (strncmp_rc == 0) {
                                goto lab_0x8f62f2d4_4;
                            }
                            goto lab_0x8f62f2f4_4;
                        }
                    } else {
                        set_mem = v57;
                        v177 = v2;
                        v77 = v73;
                        v137 = v83;
                        v124 = v84;
                        v24 = v85;
                        v12 = v86;
                        v99 = v87;
                        v178 = v8;
                        v107 = v100;
                        v50 = v111;
                        v179 = v6;
                        v119 = v112;
                        v180 = v4;
                    }
                } else {
                    // 0x8f62f420
                    g46 = (int32_t)"cid_prov";
                    if (strcmp(str3, "cid_prov") != 0) {
                        // 0x8f62f434
                        v58 = get_partition_by_name(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                        v51 = (int32_t)v58;
                        g56 = v51;
                        if (v58 == NULL) {
                            // if_8f62f440_0_true
                            // branch -> 0x8f6305ac
                        } else {
                            // 0x8f62f44c
                            v233 = *(char *)(v51 + 41);
                            v234 = *(char *)(v51 + 40);
                            v235 = *(char *)(v51 + 33);
                            v236 = *(char *)(v51 + 42);
                            v237 = *(char *)(v51 + 32);
                            v238 = *(char *)(v51 + 43);
                            v239 = *(char *)(v51 + 34);
                            v265 = 0x1000000 * (int32_t)v238 | 0x10000 * (int32_t)v236 | (int32_t)v234 | 256 * (int32_t)v233;
                            v240 = *(char *)(v51 + 45);
                            v241 = *(char *)(v51 + 44);
                            v242 = *(char *)(v51 + 35);
                            v207 = v265 + 1;
                            v243 = *(char *)(v51 + 46);
                            v244 = *(char *)(v51 + 47);
                            v266 = 0x1000000 * (int32_t)v242 | 0x10000 * (int32_t)v239 | (int32_t)v237 | 256 * (int32_t)v235;
                            v245 = *(char *)(v51 + 37);
                            v246 = *(char *)(v51 + 36);
                            v247 = *(char *)(v51 + 38);
                            v267 = 0x10000 * (int32_t)v247 | (int32_t)v246 | 256 * (int32_t)v245;
                            g49 = v267;
                            v268 = v207 - v266;
                            v230 = 512 * v268;
                            g50 = v230;
                            v274 = 512 * ((0x1000000 * (int32_t)v244 | 0x10000 * (int32_t)v243 | (int32_t)v241 | 256 * (int32_t)v240) + (int32_t)(v265 == -1) + (int32_t)(v207 < v266) - v267) | v268 / 0x800000;
                            g51 = v274;
                            g46 = 0;
                            if (g52 > v230 && v274 == 0) {
                                // after_if_8f62f4ec_0.thread
                                // branch -> 0x8f6305ac
                            } else {
                                // 0x8f62f4f4
                                if (is_sparse_image(g48, 0, v230, v274) == 0) {
                                    // 0x8f62ff8c
                                    v67 = is_skip_validation(0, g46, g50);
                                    v36 = 0;
                                    if (v67 != 0) {
                                        // 0x8f62ffa8
                                        v68 = is_bootloader_partition(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                        if (v68 == 0) {
                                            // 0x8f63015c
                                            v71 = 1;
                                            v37 = 0;
                                            v181 = v2;
                                            v76 = v73;
                                            v145 = v83;
                                            v132 = v84;
                                            v32 = v85;
                                            v20 = v86;
                                            v98 = v87;
                                            v182 = v8;
                                            v106 = v100;
                                            v49 = v111;
                                            v183 = v6;
                                            v118 = v112;
                                            v184 = v4;
                                            // branch -> 0x8f630160
                                            goto lab_0x8f630160_23;
                                        } else {
                                            v36 = v68;
                                        }
                                    }
                                    // 0x8f62ff98
                                    if (is_verified_boot_flow(v36, g46) != 0) {
                                        // 0x8f630108
                                        if (strcmp(str3, "logo") == 0) {
                                            // 0x8f63011c
                                            v227 = g56;
                                            g56 = &v72;
                                            memcpy((char *)&v72, (char *)v227, 128);
                                            // branch -> 0x8f630140
                                        }
                                    }
                                    // 0x8f630140
                                    v228 = g48;
                                    g46 = v228;
                                    v229 = g52;
                                    g50 = v229;
                                    g51 = 0;
                                    v69 = validate_partition(g56, v228, v229, 0, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str, v84, v83);
                                    // branch -> 0x8f630154
                                    // 0x8f630154
                                    if (v69 == 0) {
                                        // 0x8f63015c
                                        v71 = 1;
                                        v37 = 0;
                                        v181 = v2;
                                        v76 = v73;
                                        v145 = v83;
                                        v132 = v84;
                                        v32 = v85;
                                        v20 = v86;
                                        v98 = v87;
                                        v182 = v8;
                                        v106 = v100;
                                        v49 = v111;
                                        v183 = v6;
                                        v118 = v112;
                                        v184 = v4;
                                        // branch -> 0x8f630160
                                        goto lab_0x8f630160_23;
                                    } else {
                                        v185 = v2;
                                        v74 = v73;
                                        v144 = v83;
                                        v131 = v84;
                                        v31 = v85;
                                        v19 = v86;
                                        v96 = v87;
                                        v186 = v8;
                                        v105 = v100;
                                        v48 = v111;
                                        v187 = v6;
                                        v117 = v112;
                                        v188 = v4;
                                    }
                                } else {
                                    // 0x8f62f504
                                    v59 = parse_sparse_image(g48, g52, g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str);
                                    g54 = (int32_t)&g27;
                                    *(int32_t *)&g27 = v59;
                                    if (v59 == 0) {
                                        // if_8f62f51c_0_true
                                        // branch -> 0x8f6305ac
                                    } else {
                                        // 0x8f62f528
                                        v248 = *(int32_t *)(v59 + 8);
                                        g51 = v248;
                                        v147 = unknown_69732061(v248);
                                        g52 = v147;
                                        if (v147 == 0) {
                                            // if_8f62f534_0_true
                                            // branch -> 0x8f62f968
                                            // 0x8f62f968
                                            print_log(3, (int32_t)"Invalid parsed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                            // branch -> 0x8f6305ac
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        } else {
                                            // 0x8f62f540
                                            v249 = *(char *)v147;
                                            v269 = v249;
                                            g46 = v269;
                                            if (v249 == 0) {
                                                // 0x8f62f54c
                                                g50 = 0x20000;
                                                memset((char *)&g30, v269, 0x20000);
                                                v217 = g52;
                                                v250 = *(int32_t *)(v217 + 16);
                                                g46 = v250;
                                                if (is_piv_magic(*(int32_t *)(v217 + 28), v250, g50, g51) == 0) {
                                                    // 0x8f62f56c
                                                    v70 = (int32_t)"Non-signed image detected\n";
                                                    v60 = print_log(1, (int32_t)"Non-signed image detected\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                    v270 = (int32_t)*(char *)(g56 + 49);
                                                    g51 = v270;
                                                    if (v270 % 16 != 0) {
                                                        // 0x8f62f590
                                                        if (is_skip_validation(v60, v70, g50) == 0) {
                                                            // 0x8f62f59c
                                                            v61 = is_skip_sparse_preflash_validation(g56, v70, g50, g51, v1, v3, v112, v5);
                                                            if (v61 == 0) {
                                                                // if_8f62f5a8_0_true
                                                                // branch -> 0x8f62f88c
                                                                // 0x8f62f88c
                                                                print_log(3, (int32_t)"Invalid signed image", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                // branch -> 0x8f62f890
                                                                // 0x8f62f890
                                                                v193 = v2;
                                                                v75 = v73;
                                                                v141 = v83;
                                                                v128 = v84;
                                                                v28 = v85;
                                                                v16 = v86;
                                                                v97 = v87;
                                                                v194 = v8;
                                                                v110 = v100;
                                                                v41 = v111;
                                                                v195 = v6;
                                                                v122 = v112;
                                                                v196 = v4;
                                                                v39 = (int32_t)"Invalid signed image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_34;
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62f584
                                                    g46 = (int32_t)"bypass piv validation\n";
                                                    v160 = v2;
                                                    v79 = v73;
                                                    v139 = v83;
                                                    v126 = v84;
                                                    v26 = v85;
                                                    v14 = v86;
                                                    v89 = v87;
                                                    v161 = v8;
                                                    v109 = v100;
                                                    v43 = v111;
                                                    v162 = v6;
                                                    v121 = v112;
                                                    v163 = v4;
                                                    v38 = (int32_t)"bypass piv validation\n";
                                                    // branch -> 0x8f62f800
                                                  lab_0x8f62f800_4:
                                                    // 0x8f62f800
                                                    v63 = print_log(1, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                    v35 = v63;
                                                    v173 = v160;
                                                    v78 = v79;
                                                    v138 = v139;
                                                    v125 = v126;
                                                    v25 = v26;
                                                    v13 = v14;
                                                    v88 = v89;
                                                    v174 = v161;
                                                    v108 = v109;
                                                    v42 = v43;
                                                    v175 = v162;
                                                    v120 = v121;
                                                    v176 = v163;
                                                    // branch -> 0x8f62f9f0
                                                    goto lab_0x8f62f9f0_10;
                                                } else {
                                                    // 0x8f62f5b8
                                                    v148 = (int32_t)g27;
                                                    g52 = v148;
                                                    g57 = 0;
                                                    g53 = 0x20000;
                                                    v251 = *(int32_t *)(v148 + 8);
                                                    g51 = v251;
                                                    g45 = v148;
                                                    g44 = -0x709d0a30;
                                                    ((int32_t (*)(int32_t, int32_t))v251)(v148, v251);
                                                    g57 = (int32_t)&g30;
                                                    v123 = g45;
                                                    g47 = v123;
                                                    v200 = g53;
                                                    if (v200 == 0) {
                                                        v201 = v123;
                                                        // 0x8f62f774
                                                        v208 = v201 < 2 ? 1 - v201 : 0;
                                                        g51 = v208;
                                                        v209 = v208;
                                                        v93 = v87;
                                                        v22 = v86;
                                                        v134 = 0;
                                                        // branch -> after_if_8f62f784_0
                                                        // after_if_8f62f784_0
                                                        g53 = v209;
                                                        if (v209 == 0) {
                                                            v219 = v201;
                                                            v52 = (int32_t *)(v219 + 8);
                                                            v253 = *v52;
                                                            v53 = (int32_t *)(v219 + 12);
                                                            v254 = *(int32_t *)(v219 + 16);
                                                            v275 = *(int32_t *)(v219 + 20);
                                                            v210 = v253 - 0x20000;
                                                            v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                            *v52 = v210;
                                                            *v53 = v70;
                                                            v225 = g47;
                                                            g50 = v225;
                                                            v255 = v210;
                                                            v276 = v70;
                                                            g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                            print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                            v220 = g52;
                                                            v256 = *(int32_t *)(v220 + 12);
                                                            g51 = v256;
                                                            g45 = v220;
                                                            g44 = -0x709d0834;
                                                            ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                            v202 = g45;
                                                            g47 = v202;
                                                            while (v202 != 0) {
                                                                // 0x8f62f794
                                                                v219 = v202;
                                                                v52 = (int32_t *)(v219 + 8);
                                                                v253 = *v52;
                                                                v53 = (int32_t *)(v219 + 12);
                                                                v254 = *(int32_t *)(v219 + 16);
                                                                v275 = *(int32_t *)(v219 + 20);
                                                                v210 = v253 - 0x20000;
                                                                v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                                *v52 = v210;
                                                                *v53 = v70;
                                                                v225 = g47;
                                                                g50 = v225;
                                                                v255 = v210;
                                                                v276 = v70;
                                                                g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                                print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                                v220 = g52;
                                                                v256 = *(int32_t *)(v220 + 12);
                                                                g51 = v256;
                                                                g45 = v220;
                                                                g44 = -0x709d0834;
                                                                ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                                v202 = g45;
                                                                g47 = v202;
                                                                // continue -> 0x8f62f794
                                                            }
                                                            // 0x8f62f7d4
                                                            v153 = (char *)v254;
                                                            v154 = (char *)v275;
                                                            v155 = (char *)v276;
                                                            g46 = 0x20000;
                                                            g50 = str;
                                                            v62 = piv_init((int32_t)&g30, 0x20000, str, g51, v254, v275, v255, v276, v111, 0, v100, v7, 0, v93, v22, v85, 0);
                                                            if (v62 == 0) {
                                                                // 0x8f62f7ec
                                                                v271 = (int32_t)*(char *)(g56 + 49);
                                                                g51 = v271;
                                                                if (v271 % 16 == 0) {
                                                                    v156 = v153;
                                                                    v80 = v73;
                                                                    v140 = v83;
                                                                    v127 = v134;
                                                                    v27 = v85;
                                                                    v15 = v22;
                                                                    v90 = v93;
                                                                    v157 = v8;
                                                                    v102 = v100;
                                                                    v44 = v111;
                                                                    v158 = v155;
                                                                    v114 = v255;
                                                                    v159 = v154;
                                                                  lab_0x8f62f7f8_4:
                                                                    // 0x8f62f7f8
                                                                    g46 = (int32_t)"skip validating PIV image\n";
                                                                    v160 = v156;
                                                                    v79 = v80;
                                                                    v139 = v140;
                                                                    v126 = v127;
                                                                    v26 = v27;
                                                                    v14 = v15;
                                                                    v89 = v90;
                                                                    v161 = v157;
                                                                    v109 = v102;
                                                                    v43 = v44;
                                                                    v162 = v158;
                                                                    v121 = v114;
                                                                    v163 = v159;
                                                                    v38 = (int32_t)"skip validating PIV image\n";
                                                                    // branch -> 0x8f62f800
                                                                    goto lab_0x8f62f800_4;
                                                                } else {
                                                                    v189 = v153;
                                                                    v82 = v73;
                                                                    v143 = v83;
                                                                    v130 = v134;
                                                                    v30 = v85;
                                                                    v18 = v22;
                                                                    v92 = v93;
                                                                    v190 = v8;
                                                                    v104 = v100;
                                                                    v47 = v111;
                                                                    v191 = v155;
                                                                    v116 = v255;
                                                                    v192 = v154;
                                                                }
                                                            } else {
                                                                // 0x8f62f890
                                                                v193 = v153;
                                                                v75 = v73;
                                                                v141 = v83;
                                                                v128 = v134;
                                                                v28 = v85;
                                                                v16 = v22;
                                                                v97 = v93;
                                                                v194 = v8;
                                                                v110 = v100;
                                                                v41 = v111;
                                                                v195 = v155;
                                                                v122 = v255;
                                                                v196 = v154;
                                                                v39 = (int32_t)"Invalid signed image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_34;
                                                            }
                                                            // 0x8f6304e4
                                                            if (is_skip_validation(0, g46, g50) == 0) {
                                                                goto lab_0x8f6304f0_6;
                                                            }
                                                            v156 = v189;
                                                            v80 = v82;
                                                            v140 = v143;
                                                            v127 = v130;
                                                            v27 = v30;
                                                            v15 = v18;
                                                            v90 = v92;
                                                            v157 = v190;
                                                            v102 = v104;
                                                            v44 = v47;
                                                            v158 = v191;
                                                            v114 = v116;
                                                            v159 = v192;
                                                            goto lab_0x8f62f7f8_4;
                                                        }
                                                    } else {
                                                        v252 = v200;
                                                        v218 = v123;
                                                        v149 = v4;
                                                        v95 = v87;
                                                        v136 = 0;
                                                        v150 = v2;
                                                        while (true) {
                                                            // after_if_8f62f5e0_0
                                                            if (v218 != 0) {
                                                                goto lab_0x8f62f5e8_4;
                                                            }
                                                            // 0x8f62f774
                                                            g51 = 1;
                                                            // branch -> after_if_8f62f784_0.thread
                                                            // after_if_8f62f784_0.thread
                                                            g53 = 1;
                                                            // branch -> 0x8f62f8c4
                                                        }
                                                    }
                                                    // 0x8f62f8c4
                                                    // branch -> 0x8f62f968
                                                    // 0x8f62f968
                                                    print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                    // branch -> 0x8f6305ac
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                }
                                                // 0x8f62f890
                                                v193 = v168;
                                                v75 = v81;
                                                v141 = v142;
                                                v128 = v129;
                                                v28 = v29;
                                                v16 = v17;
                                                v97 = v91;
                                                v194 = v169;
                                                v110 = v103;
                                                v41 = v46;
                                                v195 = v170;
                                                v122 = v115;
                                                v196 = v171;
                                                v39 = (int32_t)"Invalid signed image";
                                                // branch -> 0x8f6305ac
                                                goto lab_0x8f6305ac_34;
                                            } else {
                                                // 0x8f62f808
                                                v272 = (int32_t)*(char *)(g56 + 49);
                                                g51 = v272;
                                                if (v249 == 2) {
                                                    // 0x8f62f814
                                                    if (v272 % 16 != 0) {
                                                        // 0x8f62f82c
                                                        if (is_skip_validation(v147, 2, g50) == 0) {
                                                            // 0x8f62f838
                                                            v65 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                            if (v65 == 0) {
                                                                // 0x8f62f848
                                                                v197 = *(char *)(g56 + 49) % 16;
                                                                v211 = v197;
                                                                g51 = v211;
                                                                if (v197 == 6) {
                                                                    // 0x8f62f870
                                                                    g51 = (int32_t)&g33;
                                                                    v257 = *(char *)&g33;
                                                                    v273 = v257;
                                                                    g50 = v273;
                                                                    if (v257 == 1) {
                                                                        // 0x8f62f89c
                                                                        v35 = 0;
                                                                        v173 = v2;
                                                                        v78 = v73;
                                                                        v138 = v83;
                                                                        v125 = v84;
                                                                        v25 = v85;
                                                                        v13 = v86;
                                                                        v88 = v87;
                                                                        v174 = v8;
                                                                        v108 = v100;
                                                                        v42 = v111;
                                                                        v175 = v6;
                                                                        v120 = v112;
                                                                        v176 = v4;
                                                                        if (*(char *)&g30 != 0) {
                                                                            // 0x8f62f8ac
                                                                            v172 = (int32_t)g27;
                                                                            g45 = v172;
                                                                            v258 = *(int32_t *)(v172 + 8);
                                                                            g51 = v258;
                                                                            g44 = -0x709d0748;
                                                                            ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                                            v203 = g45;
                                                                            g55 = v203;
                                                                            if (v203 == 0) {
                                                                                // 0x8f62f8c4
                                                                                // branch -> 0x8f62f968
                                                                                // 0x8f62f968
                                                                                print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                                                // branch -> 0x8f6305ac
                                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                                            } else {
                                                                                v226 = v203;
                                                                                v259 = *(int32_t *)(v226 + 8);
                                                                                v277 = *(int32_t *)(v226 + 12);
                                                                                g50 = v226;
                                                                                g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                v212 = v259 - 0x20000;
                                                                                v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                v221 = g55;
                                                                                v54 = (int32_t *)(v221 + 8);
                                                                                v260 = *v54;
                                                                                v55 = (int32_t *)(v221 + 12);
                                                                                g45 = (int32_t)g27;
                                                                                v213 = v260 - 0x20000;
                                                                                g52 = v213;
                                                                                v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                g53 = v216;
                                                                                *v54 = v213;
                                                                                *v55 = v216;
                                                                                v222 = g45;
                                                                                v261 = *(int32_t *)(v222 + 12);
                                                                                g51 = v261;
                                                                                g44 = -0x709d06f4;
                                                                                ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                v204 = g45;
                                                                                g55 = v204;
                                                                                while (v204 != 0) {
                                                                                    // 0x8f62f8cc
                                                                                    v226 = v204;
                                                                                    v259 = *(int32_t *)(v226 + 8);
                                                                                    v277 = *(int32_t *)(v226 + 12);
                                                                                    g50 = v226;
                                                                                    g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                    v212 = v259 - 0x20000;
                                                                                    v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                    print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                    v221 = g55;
                                                                                    v54 = (int32_t *)(v221 + 8);
                                                                                    v260 = *v54;
                                                                                    v55 = (int32_t *)(v221 + 12);
                                                                                    g45 = (int32_t)g27;
                                                                                    v213 = v260 - 0x20000;
                                                                                    g52 = v213;
                                                                                    v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                    g53 = v216;
                                                                                    *v54 = v213;
                                                                                    *v55 = v216;
                                                                                    v222 = g45;
                                                                                    v261 = *(int32_t *)(v222 + 12);
                                                                                    g51 = v261;
                                                                                    g44 = -0x709d06f4;
                                                                                    ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                    v204 = g45;
                                                                                    g55 = v204;
                                                                                    // continue -> 0x8f62f8cc
                                                                                }
                                                                                // 0x8f62f9f0
                                                                                v35 = 0;
                                                                                v173 = (char *)v259;
                                                                                v78 = v73;
                                                                                v138 = v83;
                                                                                v125 = v84;
                                                                                v25 = v85;
                                                                                v13 = v86;
                                                                                v88 = v87;
                                                                                v174 = v8;
                                                                                v108 = v100;
                                                                                v42 = v111;
                                                                                v175 = (char *)v215;
                                                                                v120 = v212;
                                                                                v176 = (char *)v277;
                                                                                // branch -> 0x8f62f9f0
                                                                                // 0x8f62f9f0
                                                                                v262 = *(char *)&g30;
                                                                                if (v262 == 0) {
                                                                                    goto lab_0x8f62fabc_20;
                                                                                }
                                                                                goto lab_0x8f62fa00_20;
                                                                            }
                                                                            // 0x8f630498
                                                                            *(char *)&g33 = 0;
                                                                            v263 = *(char *)&g30;
                                                                            if (v263 == 0) {
                                                                                goto lab_0x8f6304bc_21;
                                                                            }
                                                                            goto lab_0x8f6304b4_21;
                                                                        }
                                                                        // 0x8f62f9f0
                                                                        v262 = *(char *)&g30;
                                                                        if (v262 == 0) {
                                                                            goto lab_0x8f62fabc_20;
                                                                        }
                                                                        goto lab_0x8f62fa00_20;
                                                                    } else {
                                                                        // 0x8f62f880
                                                                        *(char *)&g33 = 0;
                                                                        v40 = (int32_t)&g33;
                                                                        // branch -> 0x8f62f88c
                                                                        // 0x8f62f88c
                                                                        print_log(1, (int32_t)"Invalid validating status\n", v273, v40, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                        // branch -> 0x8f62f890
                                                                        // 0x8f62f890
                                                                        v193 = v2;
                                                                        v75 = v73;
                                                                        v141 = v83;
                                                                        v128 = v84;
                                                                        v28 = v85;
                                                                        v16 = v86;
                                                                        v97 = v87;
                                                                        v194 = v8;
                                                                        v110 = v100;
                                                                        v41 = v111;
                                                                        v195 = v6;
                                                                        v122 = v112;
                                                                        v196 = v4;
                                                                        v39 = (int32_t)"Invalid signed image";
                                                                        // branch -> 0x8f6305ac
                                                                        goto lab_0x8f6305ac_34;
                                                                    }
                                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                                } else {
                                                                    v164 = v2;
                                                                    v165 = v8;
                                                                    v101 = v100;
                                                                    v45 = v111;
                                                                    v166 = v6;
                                                                    v113 = v112;
                                                                    v167 = v4;
                                                                    // 0x8f62f858
                                                                    print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v211, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                    v193 = v164;
                                                                    v75 = v73;
                                                                    v141 = v83;
                                                                    v128 = v84;
                                                                    v28 = v85;
                                                                    v16 = v86;
                                                                    v97 = v87;
                                                                    v194 = v165;
                                                                    v110 = v101;
                                                                    v41 = v45;
                                                                    v195 = v166;
                                                                    v122 = v113;
                                                                    v196 = v167;
                                                                    v39 = (int32_t)"Not supported signed sparse image";
                                                                    // branch -> 0x8f6305ac
                                                                    goto lab_0x8f6305ac_34;
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62f81c
                                                    g46 = (int32_t)"bypass validation for SKIP_DATA type\n";
                                                    v64 = print_log(2, (int32_t)"bypass validation for SKIP_DATA type\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                    // branch -> 0x8f62f89c
                                                    // 0x8f62f89c
                                                    if (*(char *)&g30 != 0) {
                                                        // 0x8f62f8ac
                                                        v172 = (int32_t)g27;
                                                        g45 = v172;
                                                        v258 = *(int32_t *)(v172 + 8);
                                                        g51 = v258;
                                                        g44 = -0x709d0748;
                                                        ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                        v203 = g45;
                                                        g55 = v203;
                                                        if (v203 == 0) {
                                                            // 0x8f62f8c4
                                                            // branch -> 0x8f62f968
                                                            // 0x8f62f968
                                                            print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                            // branch -> 0x8f6305ac
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        } else {
                                                            v226 = v203;
                                                            v259 = *(int32_t *)(v226 + 8);
                                                            v277 = *(int32_t *)(v226 + 12);
                                                            g50 = v226;
                                                            g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                            v212 = v259 - 0x20000;
                                                            v215 = v277 - (int32_t)(v259 < 0x20000);
                                                            print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                            v221 = g55;
                                                            v54 = (int32_t *)(v221 + 8);
                                                            v260 = *v54;
                                                            v55 = (int32_t *)(v221 + 12);
                                                            g45 = (int32_t)g27;
                                                            v213 = v260 - 0x20000;
                                                            g52 = v213;
                                                            v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                            g53 = v216;
                                                            *v54 = v213;
                                                            *v55 = v216;
                                                            v222 = g45;
                                                            v261 = *(int32_t *)(v222 + 12);
                                                            g51 = v261;
                                                            g44 = -0x709d06f4;
                                                            ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                            v204 = g45;
                                                            g55 = v204;
                                                            while (v204 != 0) {
                                                                // 0x8f62f8cc
                                                                v226 = v204;
                                                                v259 = *(int32_t *)(v226 + 8);
                                                                v277 = *(int32_t *)(v226 + 12);
                                                                g50 = v226;
                                                                g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                v212 = v259 - 0x20000;
                                                                v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                v221 = g55;
                                                                v54 = (int32_t *)(v221 + 8);
                                                                v260 = *v54;
                                                                v55 = (int32_t *)(v221 + 12);
                                                                g45 = (int32_t)g27;
                                                                v213 = v260 - 0x20000;
                                                                g52 = v213;
                                                                v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                g53 = v216;
                                                                *v54 = v213;
                                                                *v55 = v216;
                                                                v222 = g45;
                                                                v261 = *(int32_t *)(v222 + 12);
                                                                g51 = v261;
                                                                g44 = -0x709d06f4;
                                                                ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                v204 = g45;
                                                                g55 = v204;
                                                                // continue -> 0x8f62f8cc
                                                            }
                                                            // 0x8f62f9f0
                                                            v35 = 0;
                                                            v173 = (char *)v259;
                                                            v78 = v73;
                                                            v138 = v83;
                                                            v125 = v84;
                                                            v25 = v85;
                                                            v13 = v86;
                                                            v88 = v87;
                                                            v174 = v8;
                                                            v108 = v100;
                                                            v42 = v111;
                                                            v175 = (char *)v215;
                                                            v120 = v212;
                                                            v176 = (char *)v277;
                                                            // branch -> 0x8f62f9f0
                                                          lab_0x8f62f9f0_11:
                                                            // 0x8f62f9f0
                                                            v262 = *(char *)&g30;
                                                            if (v262 == 0) {
                                                                goto lab_0x8f62fabc_20;
                                                            }
                                                            goto lab_0x8f62fa00_20;
                                                        }
                                                        // 0x8f630498
                                                        *(char *)&g33 = 0;
                                                        v263 = *(char *)&g30;
                                                        if (v263 == 0) {
                                                            goto lab_0x8f6304bc_21;
                                                        }
                                                        goto lab_0x8f6304b4_21;
                                                    } else {
                                                        v35 = v64;
                                                        v173 = v2;
                                                        v78 = v73;
                                                        v138 = v83;
                                                        v125 = v84;
                                                        v25 = v85;
                                                        v13 = v86;
                                                        v88 = v87;
                                                        v174 = v8;
                                                        v108 = v100;
                                                        v42 = v111;
                                                        v175 = v6;
                                                        v120 = v112;
                                                        v176 = v4;
                                                    }
                                                } else {
                                                    // 0x8f62f918
                                                    if (v272 % 16 != 0) {
                                                        // 0x8f62f92c
                                                        if (is_skip_validation(v147, v269, g50) == 0) {
                                                            // 0x8f62f938
                                                            v66 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                            if ((char)v66 == 0) {
                                                                // 0x8f62f948
                                                                v198 = *(char *)(g56 + 49) % 16;
                                                                v214 = v198;
                                                                g51 = v214;
                                                                if (v198 == 6) {
                                                                    // 0x8f62f958
                                                                    g51 = (int32_t)&g33;
                                                                    *(char *)&g33 = 0;
                                                                    // branch -> 0x8f62f968
                                                                    // 0x8f62f968
                                                                    print_log(3, (int32_t)"Unexpected FILL chunk for sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                                    // branch -> 0x8f6305ac
                                                                } else {
                                                                    v164 = v2;
                                                                    v165 = v8;
                                                                    v101 = v100;
                                                                    v45 = v111;
                                                                    v166 = v6;
                                                                    v113 = v112;
                                                                    v167 = v4;
                                                                    // 0x8f62f858
                                                                    print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v214, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                    v193 = v164;
                                                                    v75 = v73;
                                                                    v141 = v83;
                                                                    v128 = v84;
                                                                    v28 = v85;
                                                                    v16 = v86;
                                                                    v97 = v87;
                                                                    v194 = v165;
                                                                    v110 = v101;
                                                                    v41 = v45;
                                                                    v195 = v166;
                                                                    v122 = v113;
                                                                    v196 = v167;
                                                                    v39 = (int32_t)"Not supported signed sparse image";
                                                                    // branch -> 0x8f6305ac
                                                                    goto lab_0x8f6305ac_34;
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            }
                                                        }
                                                    }
                                                    // 0x8f62f920
                                                    g46 = (int32_t)"bypass validation for FILL_DATA type\n";
                                                    v160 = v2;
                                                    v161 = v8;
                                                    v109 = v100;
                                                    v43 = v111;
                                                    v162 = v6;
                                                    v121 = v112;
                                                    v163 = v4;
                                                    // branch -> 0x8f62f800
                                                    // 0x8f62f800
                                                    v63 = print_log(2, (int32_t)"bypass validation for FILL_DATA type\n", g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                    v35 = v63;
                                                    v173 = v160;
                                                    v78 = v73;
                                                    v138 = v83;
                                                    v125 = v84;
                                                    v25 = v85;
                                                    v13 = v86;
                                                    v88 = v87;
                                                    v174 = v161;
                                                    v108 = v109;
                                                    v42 = v43;
                                                    v175 = v162;
                                                    v120 = v121;
                                                    v176 = v163;
                                                    // branch -> 0x8f62f9f0
                                                    goto lab_0x8f62f9f0_11;
                                                }
                                              lab_0x8f62f9f0_14:
                                                // 0x8f62f9f0
                                                v262 = *(char *)&g30;
                                                if (v262 == 0) {
                                                    goto lab_0x8f62fabc_20;
                                                }
                                                goto lab_0x8f62fa00_20;
                                            }
                                        }
                                        // 0x8f62f800
                                        v63 = print_log(v34, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                        v35 = v63;
                                        v173 = v160;
                                        v78 = v79;
                                        v138 = v139;
                                        v125 = v126;
                                        v25 = v26;
                                        v13 = v14;
                                        v88 = v89;
                                        v174 = v161;
                                        v108 = v109;
                                        v42 = v43;
                                        v175 = v162;
                                        v120 = v121;
                                        v176 = v163;
                                        // branch -> 0x8f62f9f0
                                        goto lab_0x8f62f9f0_14;
                                    }
                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                }
                                // 0x8f630498
                                *(char *)&g33 = 0;
                                v263 = *(char *)&g30;
                                if (v263 == 0) {
                                    goto lab_0x8f6304bc_21;
                                }
                                goto lab_0x8f6304b4_21;
                            }
                            // Detected a possible infinite recursion (goto support failed); quitting...
                        }
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    } else {
                        set_mem = 0;
                        v177 = v2;
                        v77 = v73;
                        v137 = v83;
                        v124 = v84;
                        v24 = v85;
                        v12 = v86;
                        v99 = v87;
                        v178 = v8;
                        v107 = v100;
                        v50 = v111;
                        v179 = v6;
                        v119 = v112;
                        v180 = v4;
                    }
                }
                // 0x8f63015c
                v71 = 1;
                v37 = set_mem;
                v181 = v177;
                v76 = v77;
                v145 = v137;
                v132 = v124;
                v32 = v24;
                v20 = v12;
                v98 = v99;
                v182 = v178;
                v106 = v107;
                v49 = v50;
                v183 = v179;
                v118 = v119;
                v184 = v180;
                // branch -> 0x8f630160
                goto lab_0x8f630160_23;
            }
            // 0x8f63015c
            v71 = 1;
            v37 = 0;
            v181 = v2;
            v76 = v73;
            v145 = v83;
            v132 = v84;
            v32 = v85;
            v20 = v86;
            v98 = v87;
            v182 = v8;
            v106 = v100;
            v49 = v111;
            v183 = v6;
            v118 = v112;
            v184 = v4;
            // branch -> 0x8f630160
            goto lab_0x8f630160_23;
        }
        // 0x8f62f214
        is_write_protect_supported(str, 1);
        // branch -> 0x8f62f220
        // 0x8f62f220
        if (strcmp(str3, "partition") == 0) {
            // 0x8f62f234
            v223 = g52;
            g46 = v223;
            v56 = validate_gpt_image(g48, v223, g50, g51, v1, v3, v112, v5, v111, 0);
            // branch -> 0x8f630154
            // 0x8f630154
            if (v56 != 0) {
                v185 = v2;
                v74 = v73;
                v144 = v83;
                v131 = v84;
                v31 = v85;
                v19 = v86;
                v96 = v87;
                v186 = v8;
                v105 = v100;
                v48 = v111;
                v187 = v6;
                v117 = v112;
                v188 = v4;
                // 0x8f630498
                *(char *)&g33 = 0;
                v263 = *(char *)&g30;
                if (v263 == 0) {
                    goto lab_0x8f6304bc_21;
                }
                goto lab_0x8f6304b4_21;
            }
        } else {
            // 0x8f62f244
            strcmp_rc2 = strcmp(str3, "motoboot");
            g53 = strcmp_rc2;
            if (strcmp_rc2 == 0) {
                // 0x8f62f258
                g46 = (int32_t)"start motoboot image validation\n";
                v57 = print_log(1, (int32_t)"start motoboot image validation\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                g47 = &g43;
                v199 = g48;
                v205 = v199 + 1024;
                g55 = v205;
                v224 = g53;
                g54 = v224;
                v231 = *(int32_t *)v199;
                g51 = v231;
                if (v224 >= v231) {
                    v21 = v86;
                    v33 = v85;
                    v133 = v84;
                    v146 = v83;
                    while (true) {
                        // 0x8f62f27c
                        v264 = 32 * v224 + v199;
                        g55 = v224 + v205;
                        v206 = v264 + 4;
                        g57 = v206;
                        v232 = *(int32_t *)(g43 + 8);
                        g51 = v232;
                        g53 = v232 * (*(int32_t *)(v264 + 32) + 1 - *(int32_t *)(v264 + 28));
                        print_log(1, (int32_t)"Validating motoboot image: %s...\n", v206, v232, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                        len = strlen("partition");
                        g50 = len;
                        strncmp_rc = strncmp((char *)g57, "partition", len);
                        v71 = strncmp_rc;
                        if (strncmp_rc == 0) {
                            goto lab_0x8f62f2d4_4;
                        }
                        goto lab_0x8f62f2f4_4;
                    }
                } else {
                    set_mem = v57;
                    v177 = v2;
                    v77 = v73;
                    v137 = v83;
                    v124 = v84;
                    v24 = v85;
                    v12 = v86;
                    v99 = v87;
                    v178 = v8;
                    v107 = v100;
                    v50 = v111;
                    v179 = v6;
                    v119 = v112;
                    v180 = v4;
                }
            } else {
                // 0x8f62f420
                g46 = (int32_t)"cid_prov";
                if (strcmp(str3, "cid_prov") != 0) {
                    // 0x8f62f434
                    v58 = get_partition_by_name(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                    v51 = (int32_t)v58;
                    g56 = v51;
                    if (v58 == NULL) {
                        // if_8f62f440_0_true
                        // branch -> 0x8f6305ac
                    } else {
                        // 0x8f62f44c
                        v233 = *(char *)(v51 + 41);
                        v234 = *(char *)(v51 + 40);
                        v235 = *(char *)(v51 + 33);
                        v236 = *(char *)(v51 + 42);
                        v237 = *(char *)(v51 + 32);
                        v238 = *(char *)(v51 + 43);
                        v239 = *(char *)(v51 + 34);
                        v265 = 0x1000000 * (int32_t)v238 | 0x10000 * (int32_t)v236 | (int32_t)v234 | 256 * (int32_t)v233;
                        v240 = *(char *)(v51 + 45);
                        v241 = *(char *)(v51 + 44);
                        v242 = *(char *)(v51 + 35);
                        v207 = v265 + 1;
                        v243 = *(char *)(v51 + 46);
                        v244 = *(char *)(v51 + 47);
                        v266 = 0x1000000 * (int32_t)v242 | 0x10000 * (int32_t)v239 | (int32_t)v237 | 256 * (int32_t)v235;
                        v245 = *(char *)(v51 + 37);
                        v246 = *(char *)(v51 + 36);
                        v247 = *(char *)(v51 + 38);
                        v267 = 0x10000 * (int32_t)v247 | (int32_t)v246 | 256 * (int32_t)v245;
                        g49 = v267;
                        v268 = v207 - v266;
                        v230 = 512 * v268;
                        g50 = v230;
                        v274 = 512 * ((0x1000000 * (int32_t)v244 | 0x10000 * (int32_t)v243 | (int32_t)v241 | 256 * (int32_t)v240) + (int32_t)(v265 == -1) + (int32_t)(v207 < v266) - v267) | v268 / 0x800000;
                        g51 = v274;
                        g46 = 0;
                        if (g52 > v230 && v274 == 0) {
                            // after_if_8f62f4ec_0.thread
                            // branch -> 0x8f6305ac
                        } else {
                            // 0x8f62f4f4
                            if (is_sparse_image(g48, 0, v230, v274) == 0) {
                                // 0x8f62ff8c
                                v67 = is_skip_validation(0, g46, g50);
                                v36 = 0;
                                if (v67 != 0) {
                                    // 0x8f62ffa8
                                    v68 = is_bootloader_partition(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                    if (v68 == 0) {
                                        // 0x8f63015c
                                        v71 = 1;
                                        v37 = 0;
                                        v181 = v2;
                                        v76 = v73;
                                        v145 = v83;
                                        v132 = v84;
                                        v32 = v85;
                                        v20 = v86;
                                        v98 = v87;
                                        v182 = v8;
                                        v106 = v100;
                                        v49 = v111;
                                        v183 = v6;
                                        v118 = v112;
                                        v184 = v4;
                                        // branch -> 0x8f630160
                                        goto lab_0x8f630160_23;
                                    } else {
                                        v36 = v68;
                                    }
                                }
                                // 0x8f62ff98
                                if (is_verified_boot_flow(v36, g46) != 0) {
                                    // 0x8f630108
                                    if (strcmp(str3, "logo") == 0) {
                                        // 0x8f63011c
                                        v227 = g56;
                                        g56 = &v72;
                                        memcpy((char *)&v72, (char *)v227, 128);
                                        // branch -> 0x8f630140
                                    }
                                }
                                // 0x8f630140
                                v228 = g48;
                                g46 = v228;
                                v229 = g52;
                                g50 = v229;
                                g51 = 0;
                                v69 = validate_partition(g56, v228, v229, 0, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str, v84, v83);
                                // branch -> 0x8f630154
                                // 0x8f630154
                                if (v69 == 0) {
                                    // 0x8f63015c
                                    v71 = 1;
                                    v37 = 0;
                                    v181 = v2;
                                    v76 = v73;
                                    v145 = v83;
                                    v132 = v84;
                                    v32 = v85;
                                    v20 = v86;
                                    v98 = v87;
                                    v182 = v8;
                                    v106 = v100;
                                    v49 = v111;
                                    v183 = v6;
                                    v118 = v112;
                                    v184 = v4;
                                    // branch -> 0x8f630160
                                    goto lab_0x8f630160_23;
                                } else {
                                    v185 = v2;
                                    v74 = v73;
                                    v144 = v83;
                                    v131 = v84;
                                    v31 = v85;
                                    v19 = v86;
                                    v96 = v87;
                                    v186 = v8;
                                    v105 = v100;
                                    v48 = v111;
                                    v187 = v6;
                                    v117 = v112;
                                    v188 = v4;
                                }
                            } else {
                                // 0x8f62f504
                                v59 = parse_sparse_image(g48, g52, g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str);
                                g54 = (int32_t)&g27;
                                *(int32_t *)&g27 = v59;
                                if (v59 == 0) {
                                    // if_8f62f51c_0_true
                                    // branch -> 0x8f6305ac
                                } else {
                                    // 0x8f62f528
                                    v248 = *(int32_t *)(v59 + 8);
                                    g51 = v248;
                                    v147 = unknown_69732061(v248);
                                    g52 = v147;
                                    if (v147 == 0) {
                                        // if_8f62f534_0_true
                                        // branch -> 0x8f62f968
                                        // 0x8f62f968
                                        print_log(3, (int32_t)"Invalid parsed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                        // branch -> 0x8f6305ac
                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                    } else {
                                        // 0x8f62f540
                                        v249 = *(char *)v147;
                                        v269 = v249;
                                        g46 = v269;
                                        if (v249 == 0) {
                                            // 0x8f62f54c
                                            g50 = 0x20000;
                                            memset((char *)&g30, v269, 0x20000);
                                            v217 = g52;
                                            v250 = *(int32_t *)(v217 + 16);
                                            g46 = v250;
                                            if (is_piv_magic(*(int32_t *)(v217 + 28), v250, g50, g51) == 0) {
                                                // 0x8f62f56c
                                                v70 = (int32_t)"Non-signed image detected\n";
                                                v60 = print_log(1, (int32_t)"Non-signed image detected\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                v270 = (int32_t)*(char *)(g56 + 49);
                                                g51 = v270;
                                                if (v270 % 16 != 0) {
                                                    // 0x8f62f590
                                                    if (is_skip_validation(v60, v70, g50) == 0) {
                                                        // 0x8f62f59c
                                                        v61 = is_skip_sparse_preflash_validation(g56, v70, g50, g51, v1, v3, v112, v5);
                                                        if (v61 == 0) {
                                                            // if_8f62f5a8_0_true
                                                            // branch -> 0x8f62f88c
                                                            // 0x8f62f88c
                                                            print_log(3, (int32_t)"Invalid signed image", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                            // branch -> 0x8f62f890
                                                            // 0x8f62f890
                                                            v193 = v2;
                                                            v75 = v73;
                                                            v141 = v83;
                                                            v128 = v84;
                                                            v28 = v85;
                                                            v16 = v86;
                                                            v97 = v87;
                                                            v194 = v8;
                                                            v110 = v100;
                                                            v41 = v111;
                                                            v195 = v6;
                                                            v122 = v112;
                                                            v196 = v4;
                                                            v39 = (int32_t)"Invalid signed image";
                                                            // branch -> 0x8f6305ac
                                                            goto lab_0x8f6305ac_34;
                                                        }
                                                    }
                                                }
                                                // 0x8f62f584
                                                g46 = (int32_t)"bypass piv validation\n";
                                                v160 = v2;
                                                v79 = v73;
                                                v139 = v83;
                                                v126 = v84;
                                                v26 = v85;
                                                v14 = v86;
                                                v89 = v87;
                                                v161 = v8;
                                                v109 = v100;
                                                v43 = v111;
                                                v162 = v6;
                                                v121 = v112;
                                                v163 = v4;
                                                v38 = (int32_t)"bypass piv validation\n";
                                                // branch -> 0x8f62f800
                                              lab_0x8f62f800_5:
                                                // 0x8f62f800
                                                v63 = print_log(1, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                v35 = v63;
                                                v173 = v160;
                                                v78 = v79;
                                                v138 = v139;
                                                v125 = v126;
                                                v25 = v26;
                                                v13 = v14;
                                                v88 = v89;
                                                v174 = v161;
                                                v108 = v109;
                                                v42 = v43;
                                                v175 = v162;
                                                v120 = v121;
                                                v176 = v163;
                                                // branch -> 0x8f62f9f0
                                                goto lab_0x8f62f9f0_14;
                                            } else {
                                                // 0x8f62f5b8
                                                v148 = (int32_t)g27;
                                                g52 = v148;
                                                g57 = 0;
                                                g53 = 0x20000;
                                                v251 = *(int32_t *)(v148 + 8);
                                                g51 = v251;
                                                g45 = v148;
                                                g44 = -0x709d0a30;
                                                ((int32_t (*)(int32_t, int32_t))v251)(v148, v251);
                                                g57 = (int32_t)&g30;
                                                v123 = g45;
                                                g47 = v123;
                                                v200 = g53;
                                                if (v200 == 0) {
                                                    v201 = v123;
                                                    // 0x8f62f774
                                                    v208 = v201 < 2 ? 1 - v201 : 0;
                                                    g51 = v208;
                                                    v209 = v208;
                                                    v93 = v87;
                                                    v22 = v86;
                                                    v134 = 0;
                                                    // branch -> after_if_8f62f784_0
                                                    // after_if_8f62f784_0
                                                    g53 = v209;
                                                    if (v209 == 0) {
                                                        v219 = v201;
                                                        v52 = (int32_t *)(v219 + 8);
                                                        v253 = *v52;
                                                        v53 = (int32_t *)(v219 + 12);
                                                        v254 = *(int32_t *)(v219 + 16);
                                                        v275 = *(int32_t *)(v219 + 20);
                                                        v210 = v253 - 0x20000;
                                                        v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                        *v52 = v210;
                                                        *v53 = v70;
                                                        v225 = g47;
                                                        g50 = v225;
                                                        v255 = v210;
                                                        v276 = v70;
                                                        g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                        print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                        v220 = g52;
                                                        v256 = *(int32_t *)(v220 + 12);
                                                        g51 = v256;
                                                        g45 = v220;
                                                        g44 = -0x709d0834;
                                                        ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                        v202 = g45;
                                                        g47 = v202;
                                                        while (v202 != 0) {
                                                            // 0x8f62f794
                                                            v219 = v202;
                                                            v52 = (int32_t *)(v219 + 8);
                                                            v253 = *v52;
                                                            v53 = (int32_t *)(v219 + 12);
                                                            v254 = *(int32_t *)(v219 + 16);
                                                            v275 = *(int32_t *)(v219 + 20);
                                                            v210 = v253 - 0x20000;
                                                            v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                            *v52 = v210;
                                                            *v53 = v70;
                                                            v225 = g47;
                                                            g50 = v225;
                                                            v255 = v210;
                                                            v276 = v70;
                                                            g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                            print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                            v220 = g52;
                                                            v256 = *(int32_t *)(v220 + 12);
                                                            g51 = v256;
                                                            g45 = v220;
                                                            g44 = -0x709d0834;
                                                            ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                            v202 = g45;
                                                            g47 = v202;
                                                            // continue -> 0x8f62f794
                                                        }
                                                        // 0x8f62f7d4
                                                        v153 = (char *)v254;
                                                        v154 = (char *)v275;
                                                        v155 = (char *)v276;
                                                        g46 = 0x20000;
                                                        g50 = str;
                                                        v62 = piv_init((int32_t)&g30, 0x20000, str, g51, v254, v275, v255, v276, v111, 0, v100, v7, 0, v93, v22, v85, 0);
                                                        if (v62 == 0) {
                                                            // 0x8f62f7ec
                                                            v271 = (int32_t)*(char *)(g56 + 49);
                                                            g51 = v271;
                                                            if (v271 % 16 == 0) {
                                                                v156 = v153;
                                                                v80 = v73;
                                                                v140 = v83;
                                                                v127 = v134;
                                                                v27 = v85;
                                                                v15 = v22;
                                                                v90 = v93;
                                                                v157 = v8;
                                                                v102 = v100;
                                                                v44 = v111;
                                                                v158 = v155;
                                                                v114 = v255;
                                                                v159 = v154;
                                                              lab_0x8f62f7f8_5:
                                                                // 0x8f62f7f8
                                                                g46 = (int32_t)"skip validating PIV image\n";
                                                                v160 = v156;
                                                                v79 = v80;
                                                                v139 = v140;
                                                                v126 = v127;
                                                                v26 = v27;
                                                                v14 = v15;
                                                                v89 = v90;
                                                                v161 = v157;
                                                                v109 = v102;
                                                                v43 = v44;
                                                                v162 = v158;
                                                                v121 = v114;
                                                                v163 = v159;
                                                                v38 = (int32_t)"skip validating PIV image\n";
                                                                // branch -> 0x8f62f800
                                                                goto lab_0x8f62f800_5;
                                                            } else {
                                                                v189 = v153;
                                                                v82 = v73;
                                                                v143 = v83;
                                                                v130 = v134;
                                                                v30 = v85;
                                                                v18 = v22;
                                                                v92 = v93;
                                                                v190 = v8;
                                                                v104 = v100;
                                                                v47 = v111;
                                                                v191 = v155;
                                                                v116 = v255;
                                                                v192 = v154;
                                                            }
                                                        } else {
                                                            // 0x8f62f890
                                                            v193 = v153;
                                                            v75 = v73;
                                                            v141 = v83;
                                                            v128 = v134;
                                                            v28 = v85;
                                                            v16 = v22;
                                                            v97 = v93;
                                                            v194 = v8;
                                                            v110 = v100;
                                                            v41 = v111;
                                                            v195 = v155;
                                                            v122 = v255;
                                                            v196 = v154;
                                                            v39 = (int32_t)"Invalid signed image";
                                                            // branch -> 0x8f6305ac
                                                            goto lab_0x8f6305ac_34;
                                                        }
                                                        // 0x8f6304e4
                                                        if (is_skip_validation(0, g46, g50) == 0) {
                                                            goto lab_0x8f6304f0_6;
                                                        }
                                                        v156 = v189;
                                                        v80 = v82;
                                                        v140 = v143;
                                                        v127 = v130;
                                                        v27 = v30;
                                                        v15 = v18;
                                                        v90 = v92;
                                                        v157 = v190;
                                                        v102 = v104;
                                                        v44 = v47;
                                                        v158 = v191;
                                                        v114 = v116;
                                                        v159 = v192;
                                                        goto lab_0x8f62f7f8_5;
                                                    }
                                                } else {
                                                    v252 = v200;
                                                    v218 = v123;
                                                    v149 = v4;
                                                    v95 = v87;
                                                    v136 = 0;
                                                    v150 = v2;
                                                    while (true) {
                                                        // after_if_8f62f5e0_0
                                                        if (v218 != 0) {
                                                            goto lab_0x8f62f5e8_4;
                                                        }
                                                        // 0x8f62f774
                                                        g51 = 1;
                                                        // branch -> after_if_8f62f784_0.thread
                                                        // after_if_8f62f784_0.thread
                                                        g53 = 1;
                                                        // branch -> 0x8f62f8c4
                                                    }
                                                }
                                                // 0x8f62f8c4
                                                // branch -> 0x8f62f968
                                                // 0x8f62f968
                                                print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                // branch -> 0x8f6305ac
                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                            }
                                            // 0x8f62f890
                                            v193 = v168;
                                            v75 = v81;
                                            v141 = v142;
                                            v128 = v129;
                                            v28 = v29;
                                            v16 = v17;
                                            v97 = v91;
                                            v194 = v169;
                                            v110 = v103;
                                            v41 = v46;
                                            v195 = v170;
                                            v122 = v115;
                                            v196 = v171;
                                            v39 = (int32_t)"Invalid signed image";
                                            // branch -> 0x8f6305ac
                                            goto lab_0x8f6305ac_34;
                                        } else {
                                            // 0x8f62f808
                                            v272 = (int32_t)*(char *)(g56 + 49);
                                            g51 = v272;
                                            if (v249 == 2) {
                                                // 0x8f62f814
                                                if (v272 % 16 != 0) {
                                                    // 0x8f62f82c
                                                    if (is_skip_validation(v147, 2, g50) == 0) {
                                                        // 0x8f62f838
                                                        v65 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                        if (v65 == 0) {
                                                            // 0x8f62f848
                                                            v197 = *(char *)(g56 + 49) % 16;
                                                            v211 = v197;
                                                            g51 = v211;
                                                            if (v197 == 6) {
                                                                // 0x8f62f870
                                                                g51 = (int32_t)&g33;
                                                                v257 = *(char *)&g33;
                                                                v273 = v257;
                                                                g50 = v273;
                                                                if (v257 == 1) {
                                                                    // 0x8f62f89c
                                                                    v35 = 0;
                                                                    v173 = v2;
                                                                    v78 = v73;
                                                                    v138 = v83;
                                                                    v125 = v84;
                                                                    v25 = v85;
                                                                    v13 = v86;
                                                                    v88 = v87;
                                                                    v174 = v8;
                                                                    v108 = v100;
                                                                    v42 = v111;
                                                                    v175 = v6;
                                                                    v120 = v112;
                                                                    v176 = v4;
                                                                    if (*(char *)&g30 != 0) {
                                                                        // 0x8f62f8ac
                                                                        v172 = (int32_t)g27;
                                                                        g45 = v172;
                                                                        v258 = *(int32_t *)(v172 + 8);
                                                                        g51 = v258;
                                                                        g44 = -0x709d0748;
                                                                        ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                                        v203 = g45;
                                                                        g55 = v203;
                                                                        if (v203 == 0) {
                                                                            // 0x8f62f8c4
                                                                            // branch -> 0x8f62f968
                                                                            // 0x8f62f968
                                                                            print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                                            // branch -> 0x8f6305ac
                                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                                        } else {
                                                                            v226 = v203;
                                                                            v259 = *(int32_t *)(v226 + 8);
                                                                            v277 = *(int32_t *)(v226 + 12);
                                                                            g50 = v226;
                                                                            g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                            v212 = v259 - 0x20000;
                                                                            v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                            print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                            v221 = g55;
                                                                            v54 = (int32_t *)(v221 + 8);
                                                                            v260 = *v54;
                                                                            v55 = (int32_t *)(v221 + 12);
                                                                            g45 = (int32_t)g27;
                                                                            v213 = v260 - 0x20000;
                                                                            g52 = v213;
                                                                            v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                            g53 = v216;
                                                                            *v54 = v213;
                                                                            *v55 = v216;
                                                                            v222 = g45;
                                                                            v261 = *(int32_t *)(v222 + 12);
                                                                            g51 = v261;
                                                                            g44 = -0x709d06f4;
                                                                            ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                            v204 = g45;
                                                                            g55 = v204;
                                                                            while (v204 != 0) {
                                                                                // 0x8f62f8cc
                                                                                v226 = v204;
                                                                                v259 = *(int32_t *)(v226 + 8);
                                                                                v277 = *(int32_t *)(v226 + 12);
                                                                                g50 = v226;
                                                                                g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                                v212 = v259 - 0x20000;
                                                                                v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                                print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                                v221 = g55;
                                                                                v54 = (int32_t *)(v221 + 8);
                                                                                v260 = *v54;
                                                                                v55 = (int32_t *)(v221 + 12);
                                                                                g45 = (int32_t)g27;
                                                                                v213 = v260 - 0x20000;
                                                                                g52 = v213;
                                                                                v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                                g53 = v216;
                                                                                *v54 = v213;
                                                                                *v55 = v216;
                                                                                v222 = g45;
                                                                                v261 = *(int32_t *)(v222 + 12);
                                                                                g51 = v261;
                                                                                g44 = -0x709d06f4;
                                                                                ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                                v204 = g45;
                                                                                g55 = v204;
                                                                                // continue -> 0x8f62f8cc
                                                                            }
                                                                            // 0x8f62f9f0
                                                                            v35 = 0;
                                                                            v173 = (char *)v259;
                                                                            v78 = v73;
                                                                            v138 = v83;
                                                                            v125 = v84;
                                                                            v25 = v85;
                                                                            v13 = v86;
                                                                            v88 = v87;
                                                                            v174 = v8;
                                                                            v108 = v100;
                                                                            v42 = v111;
                                                                            v175 = (char *)v215;
                                                                            v120 = v212;
                                                                            v176 = (char *)v277;
                                                                            // branch -> 0x8f62f9f0
                                                                            // 0x8f62f9f0
                                                                            v262 = *(char *)&g30;
                                                                            if (v262 == 0) {
                                                                                goto lab_0x8f62fabc_20;
                                                                            }
                                                                            goto lab_0x8f62fa00_20;
                                                                        }
                                                                        // 0x8f630498
                                                                        *(char *)&g33 = 0;
                                                                        v263 = *(char *)&g30;
                                                                        if (v263 == 0) {
                                                                            goto lab_0x8f6304bc_21;
                                                                        }
                                                                        goto lab_0x8f6304b4_21;
                                                                    }
                                                                    // 0x8f62f9f0
                                                                    v262 = *(char *)&g30;
                                                                    if (v262 == 0) {
                                                                        goto lab_0x8f62fabc_20;
                                                                    }
                                                                    goto lab_0x8f62fa00_20;
                                                                } else {
                                                                    // 0x8f62f880
                                                                    *(char *)&g33 = 0;
                                                                    v40 = (int32_t)&g33;
                                                                    // branch -> 0x8f62f88c
                                                                    // 0x8f62f88c
                                                                    print_log(1, (int32_t)"Invalid validating status\n", v273, v40, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                    // branch -> 0x8f62f890
                                                                    // 0x8f62f890
                                                                    v193 = v2;
                                                                    v75 = v73;
                                                                    v141 = v83;
                                                                    v128 = v84;
                                                                    v28 = v85;
                                                                    v16 = v86;
                                                                    v97 = v87;
                                                                    v194 = v8;
                                                                    v110 = v100;
                                                                    v41 = v111;
                                                                    v195 = v6;
                                                                    v122 = v112;
                                                                    v196 = v4;
                                                                    v39 = (int32_t)"Invalid signed image";
                                                                    // branch -> 0x8f6305ac
                                                                    goto lab_0x8f6305ac_34;
                                                                }
                                                                // Detected a possible infinite recursion (goto support failed); quitting...
                                                            } else {
                                                                v164 = v2;
                                                                v165 = v8;
                                                                v101 = v100;
                                                                v45 = v111;
                                                                v166 = v6;
                                                                v113 = v112;
                                                                v167 = v4;
                                                                // 0x8f62f858
                                                                print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v211, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                v193 = v164;
                                                                v75 = v73;
                                                                v141 = v83;
                                                                v128 = v84;
                                                                v28 = v85;
                                                                v16 = v86;
                                                                v97 = v87;
                                                                v194 = v165;
                                                                v110 = v101;
                                                                v41 = v45;
                                                                v195 = v166;
                                                                v122 = v113;
                                                                v196 = v167;
                                                                v39 = (int32_t)"Not supported signed sparse image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_34;
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                    }
                                                }
                                                // 0x8f62f81c
                                                g46 = (int32_t)"bypass validation for SKIP_DATA type\n";
                                                v64 = print_log(2, (int32_t)"bypass validation for SKIP_DATA type\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                // branch -> 0x8f62f89c
                                                // 0x8f62f89c
                                                if (*(char *)&g30 != 0) {
                                                    // 0x8f62f8ac
                                                    v172 = (int32_t)g27;
                                                    g45 = v172;
                                                    v258 = *(int32_t *)(v172 + 8);
                                                    g51 = v258;
                                                    g44 = -0x709d0748;
                                                    ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                    v203 = g45;
                                                    g55 = v203;
                                                    if (v203 == 0) {
                                                        // 0x8f62f8c4
                                                        // branch -> 0x8f62f968
                                                        // 0x8f62f968
                                                        print_log(5, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                        // branch -> 0x8f6305ac
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    } else {
                                                        v226 = v203;
                                                        v259 = *(int32_t *)(v226 + 8);
                                                        v277 = *(int32_t *)(v226 + 12);
                                                        g50 = v226;
                                                        g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                        v212 = v259 - 0x20000;
                                                        v215 = v277 - (int32_t)(v259 < 0x20000);
                                                        print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                        v221 = g55;
                                                        v54 = (int32_t *)(v221 + 8);
                                                        v260 = *v54;
                                                        v55 = (int32_t *)(v221 + 12);
                                                        g45 = (int32_t)g27;
                                                        v213 = v260 - 0x20000;
                                                        g52 = v213;
                                                        v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                        g53 = v216;
                                                        *v54 = v213;
                                                        *v55 = v216;
                                                        v222 = g45;
                                                        v261 = *(int32_t *)(v222 + 12);
                                                        g51 = v261;
                                                        g44 = -0x709d06f4;
                                                        ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                        v204 = g45;
                                                        g55 = v204;
                                                        while (v204 != 0) {
                                                            // 0x8f62f8cc
                                                            v226 = v204;
                                                            v259 = *(int32_t *)(v226 + 8);
                                                            v277 = *(int32_t *)(v226 + 12);
                                                            g50 = v226;
                                                            g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                            v212 = v259 - 0x20000;
                                                            v215 = v277 - (int32_t)(v259 < 0x20000);
                                                            print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                            v221 = g55;
                                                            v54 = (int32_t *)(v221 + 8);
                                                            v260 = *v54;
                                                            v55 = (int32_t *)(v221 + 12);
                                                            g45 = (int32_t)g27;
                                                            v213 = v260 - 0x20000;
                                                            g52 = v213;
                                                            v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                            g53 = v216;
                                                            *v54 = v213;
                                                            *v55 = v216;
                                                            v222 = g45;
                                                            v261 = *(int32_t *)(v222 + 12);
                                                            g51 = v261;
                                                            g44 = -0x709d06f4;
                                                            ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                            v204 = g45;
                                                            g55 = v204;
                                                            // continue -> 0x8f62f8cc
                                                        }
                                                        // 0x8f62f9f0
                                                        v35 = 0;
                                                        v173 = (char *)v259;
                                                        v78 = v73;
                                                        v138 = v83;
                                                        v125 = v84;
                                                        v25 = v85;
                                                        v13 = v86;
                                                        v88 = v87;
                                                        v174 = v8;
                                                        v108 = v100;
                                                        v42 = v111;
                                                        v175 = (char *)v215;
                                                        v120 = v212;
                                                        v176 = (char *)v277;
                                                        // branch -> 0x8f62f9f0
                                                      lab_0x8f62f9f0_15:
                                                        // 0x8f62f9f0
                                                        v262 = *(char *)&g30;
                                                        if (v262 == 0) {
                                                            goto lab_0x8f62fabc_20;
                                                        }
                                                        goto lab_0x8f62fa00_20;
                                                    }
                                                    // 0x8f630498
                                                    *(char *)&g33 = 0;
                                                    v263 = *(char *)&g30;
                                                    if (v263 == 0) {
                                                        goto lab_0x8f6304bc_21;
                                                    }
                                                    goto lab_0x8f6304b4_21;
                                                } else {
                                                    v35 = v64;
                                                    v173 = v2;
                                                    v78 = v73;
                                                    v138 = v83;
                                                    v125 = v84;
                                                    v25 = v85;
                                                    v13 = v86;
                                                    v88 = v87;
                                                    v174 = v8;
                                                    v108 = v100;
                                                    v42 = v111;
                                                    v175 = v6;
                                                    v120 = v112;
                                                    v176 = v4;
                                                }
                                            } else {
                                                // 0x8f62f918
                                                if (v272 % 16 != 0) {
                                                    // 0x8f62f92c
                                                    if (is_skip_validation(v147, v269, g50) == 0) {
                                                        // 0x8f62f938
                                                        v66 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                        if ((char)v66 == 0) {
                                                            // 0x8f62f948
                                                            v198 = *(char *)(g56 + 49) % 16;
                                                            v214 = v198;
                                                            g51 = v214;
                                                            if (v198 == 6) {
                                                                // 0x8f62f958
                                                                g51 = (int32_t)&g33;
                                                                *(char *)&g33 = 0;
                                                                // branch -> 0x8f62f968
                                                                // 0x8f62f968
                                                                print_log(3, (int32_t)"Unexpected FILL chunk for sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                                                // branch -> 0x8f6305ac
                                                            } else {
                                                                v164 = v2;
                                                                v165 = v8;
                                                                v101 = v100;
                                                                v45 = v111;
                                                                v166 = v6;
                                                                v113 = v112;
                                                                v167 = v4;
                                                                // 0x8f62f858
                                                                print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v214, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                                v193 = v164;
                                                                v75 = v73;
                                                                v141 = v83;
                                                                v128 = v84;
                                                                v28 = v85;
                                                                v16 = v86;
                                                                v97 = v87;
                                                                v194 = v165;
                                                                v110 = v101;
                                                                v41 = v45;
                                                                v195 = v166;
                                                                v122 = v113;
                                                                v196 = v167;
                                                                v39 = (int32_t)"Not supported signed sparse image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_34;
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        }
                                                    }
                                                }
                                                // 0x8f62f920
                                                g46 = (int32_t)"bypass validation for FILL_DATA type\n";
                                                v160 = v2;
                                                v161 = v8;
                                                v109 = v100;
                                                v43 = v111;
                                                v162 = v6;
                                                v121 = v112;
                                                v163 = v4;
                                                // branch -> 0x8f62f800
                                                // 0x8f62f800
                                                v63 = print_log(2, (int32_t)"bypass validation for FILL_DATA type\n", g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                                v35 = v63;
                                                v173 = v160;
                                                v78 = v73;
                                                v138 = v83;
                                                v125 = v84;
                                                v25 = v85;
                                                v13 = v86;
                                                v88 = v87;
                                                v174 = v161;
                                                v108 = v109;
                                                v42 = v43;
                                                v175 = v162;
                                                v120 = v121;
                                                v176 = v163;
                                                // branch -> 0x8f62f9f0
                                                goto lab_0x8f62f9f0_15;
                                            }
                                          lab_0x8f62f9f0_18:
                                            // 0x8f62f9f0
                                            v262 = *(char *)&g30;
                                            if (v262 == 0) {
                                                goto lab_0x8f62fabc_20;
                                            }
                                            goto lab_0x8f62fa00_20;
                                        }
                                    }
                                    // 0x8f62f800
                                    v63 = print_log(v34, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                    v35 = v63;
                                    v173 = v160;
                                    v78 = v79;
                                    v138 = v139;
                                    v125 = v126;
                                    v25 = v26;
                                    v13 = v14;
                                    v88 = v89;
                                    v174 = v161;
                                    v108 = v109;
                                    v42 = v43;
                                    v175 = v162;
                                    v120 = v121;
                                    v176 = v163;
                                    // branch -> 0x8f62f9f0
                                    goto lab_0x8f62f9f0_18;
                                }
                                // Detected a possible infinite recursion (goto support failed); quitting...
                            }
                            // 0x8f630498
                            *(char *)&g33 = 0;
                            v263 = *(char *)&g30;
                            if (v263 == 0) {
                                goto lab_0x8f6304bc_21;
                            }
                            goto lab_0x8f6304b4_21;
                        }
                        // Detected a possible infinite recursion (goto support failed); quitting...
                    }
                    // Detected a possible infinite recursion (goto support failed); quitting...
                } else {
                    set_mem = 0;
                    v177 = v2;
                    v77 = v73;
                    v137 = v83;
                    v124 = v84;
                    v24 = v85;
                    v12 = v86;
                    v99 = v87;
                    v178 = v8;
                    v107 = v100;
                    v50 = v111;
                    v179 = v6;
                    v119 = v112;
                    v180 = v4;
                }
            }
            // 0x8f63015c
            v71 = 1;
            v37 = set_mem;
            v181 = v177;
            v76 = v77;
            v145 = v137;
            v132 = v124;
            v32 = v24;
            v20 = v12;
            v98 = v99;
            v182 = v178;
            v106 = v107;
            v49 = v50;
            v183 = v179;
            v118 = v119;
            v184 = v180;
            // branch -> 0x8f630160
            goto lab_0x8f630160_23;
        }
        // 0x8f63015c
        v71 = 1;
        v37 = 0;
        v181 = v2;
        v76 = v73;
        v145 = v83;
        v132 = v84;
        v32 = v85;
        v20 = v86;
        v98 = v87;
        v182 = v8;
        v106 = v100;
        v49 = v111;
        v183 = v6;
        v118 = v112;
        v184 = v4;
        // branch -> 0x8f630160
        goto lab_0x8f630160_23;
    }
    // 0x8f62f214
    is_write_protect_supported(str, 1);
    // branch -> 0x8f62f220
    // 0x8f62f220
    if (strcmp(str3, "partition") == 0) {
        // 0x8f62f234
        v223 = g52;
        g46 = v223;
        v56 = validate_gpt_image(g48, v223, g50, g51, v1, v3, v112, v5, v111, 0);
        // branch -> 0x8f630154
        // 0x8f630154
        if (v56 != 0) {
            v185 = v2;
            v74 = v73;
            v144 = v83;
            v131 = v84;
            v31 = v85;
            v19 = v86;
            v96 = v87;
            v186 = v8;
            v105 = v100;
            v48 = v111;
            v187 = v6;
            v117 = v112;
            v188 = v4;
            // 0x8f630498
            *(char *)&g33 = 0;
            v263 = *(char *)&g30;
            if (v263 == 0) {
                goto lab_0x8f6304bc_21;
            }
            goto lab_0x8f6304b4_21;
        }
        // 0x8f63015c
        v71 = 1;
        v37 = 0;
        v181 = v2;
        v76 = v73;
        v145 = v83;
        v132 = v84;
        v32 = v85;
        v20 = v86;
        v98 = v87;
        v182 = v8;
        v106 = v100;
        v49 = v111;
        v183 = v6;
        v118 = v112;
        v184 = v4;
        // branch -> 0x8f630160
        goto lab_0x8f630160_23;
    } else {
        // 0x8f62f244
        strcmp_rc2 = strcmp(str3, "motoboot");
        g53 = strcmp_rc2;
        if (strcmp_rc2 == 0) {
            // 0x8f62f258
            g46 = (int32_t)"start motoboot image validation\n";
            v57 = print_log(1, (int32_t)"start motoboot image validation\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
            g47 = &g43;
            v199 = g48;
            v205 = v199 + 1024;
            g55 = v205;
            v224 = g53;
            g54 = v224;
            v231 = *(int32_t *)v199;
            g51 = v231;
            if (v224 >= v231) {
                v21 = v86;
                v33 = v85;
                v133 = v84;
                v146 = v83;
                while (true) {
                    // 0x8f62f27c
                    v264 = 32 * v224 + v199;
                    g55 = v224 + v205;
                    v206 = v264 + 4;
                    g57 = v206;
                    v232 = *(int32_t *)(g43 + 8);
                    g51 = v232;
                    g53 = v232 * (*(int32_t *)(v264 + 32) + 1 - *(int32_t *)(v264 + 28));
                    print_log(1, (int32_t)"Validating motoboot image: %s...\n", v206, v232, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                    len = strlen("partition");
                    g50 = len;
                    strncmp_rc = strncmp((char *)g57, "partition", len);
                    v71 = strncmp_rc;
                    if (strncmp_rc == 0) {
                        goto lab_0x8f62f2d4_4;
                    }
                    goto lab_0x8f62f2f4_4;
                }
            } else {
                set_mem = v57;
                v177 = v2;
                v77 = v73;
                v137 = v83;
                v124 = v84;
                v24 = v85;
                v12 = v86;
                v99 = v87;
                v178 = v8;
                v107 = v100;
                v50 = v111;
                v179 = v6;
                v119 = v112;
                v180 = v4;
            }
        } else {
            // 0x8f62f420
            g46 = (int32_t)"cid_prov";
            if (strcmp(str3, "cid_prov") != 0) {
                // 0x8f62f434
                v58 = get_partition_by_name(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                v51 = (int32_t)v58;
                g56 = v51;
                if (v58 == NULL) {
                    // if_8f62f440_0_true
                    // branch -> 0x8f6305ac
                } else {
                    // 0x8f62f44c
                    v233 = *(char *)(v51 + 41);
                    v234 = *(char *)(v51 + 40);
                    v235 = *(char *)(v51 + 33);
                    v236 = *(char *)(v51 + 42);
                    v237 = *(char *)(v51 + 32);
                    v238 = *(char *)(v51 + 43);
                    v239 = *(char *)(v51 + 34);
                    v265 = 0x1000000 * (int32_t)v238 | 0x10000 * (int32_t)v236 | (int32_t)v234 | 256 * (int32_t)v233;
                    v240 = *(char *)(v51 + 45);
                    v241 = *(char *)(v51 + 44);
                    v242 = *(char *)(v51 + 35);
                    v207 = v265 + 1;
                    v243 = *(char *)(v51 + 46);
                    v244 = *(char *)(v51 + 47);
                    v266 = 0x1000000 * (int32_t)v242 | 0x10000 * (int32_t)v239 | (int32_t)v237 | 256 * (int32_t)v235;
                    v245 = *(char *)(v51 + 37);
                    v246 = *(char *)(v51 + 36);
                    v247 = *(char *)(v51 + 38);
                    v267 = 0x10000 * (int32_t)v247 | (int32_t)v246 | 256 * (int32_t)v245;
                    g49 = v267;
                    v268 = v207 - v266;
                    v230 = 512 * v268;
                    g50 = v230;
                    v274 = 512 * ((0x1000000 * (int32_t)v244 | 0x10000 * (int32_t)v243 | (int32_t)v241 | 256 * (int32_t)v240) + (int32_t)(v265 == -1) + (int32_t)(v207 < v266) - v267) | v268 / 0x800000;
                    g51 = v274;
                    g46 = 0;
                    if (g52 > v230 && v274 == 0) {
                        // after_if_8f62f4ec_0.thread
                        // branch -> 0x8f6305ac
                    } else {
                        // 0x8f62f4f4
                        if (is_sparse_image(g48, 0, v230, v274) == 0) {
                            // 0x8f62ff8c
                            v67 = is_skip_validation(0, g46, g50);
                            v36 = 0;
                            if (v67 != 0) {
                                // 0x8f62ffa8
                                v68 = is_bootloader_partition(str, g46, g50, g51, v1, v3, v112, v5, v111, 0, v100);
                                if (v68 == 0) {
                                    // 0x8f63015c
                                    v71 = 1;
                                    v37 = 0;
                                    v181 = v2;
                                    v76 = v73;
                                    v145 = v83;
                                    v132 = v84;
                                    v32 = v85;
                                    v20 = v86;
                                    v98 = v87;
                                    v182 = v8;
                                    v106 = v100;
                                    v49 = v111;
                                    v183 = v6;
                                    v118 = v112;
                                    v184 = v4;
                                    // branch -> 0x8f630160
                                    goto lab_0x8f630160_23;
                                } else {
                                    v36 = v68;
                                }
                            }
                            // 0x8f62ff98
                            if (is_verified_boot_flow(v36, g46) != 0) {
                                // 0x8f630108
                                if (strcmp(str3, "logo") == 0) {
                                    // 0x8f63011c
                                    v227 = g56;
                                    g56 = &v72;
                                    memcpy((char *)&v72, (char *)v227, 128);
                                    // branch -> 0x8f630140
                                }
                            }
                            // 0x8f630140
                            v228 = g48;
                            g46 = v228;
                            v229 = g52;
                            g50 = v229;
                            g51 = 0;
                            v69 = validate_partition(g56, v228, v229, 0, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str, v84, v83);
                            // branch -> 0x8f630154
                            // 0x8f630154
                            if (v69 == 0) {
                                // 0x8f63015c
                                v71 = 1;
                                v37 = 0;
                                v181 = v2;
                                v76 = v73;
                                v145 = v83;
                                v132 = v84;
                                v32 = v85;
                                v20 = v86;
                                v98 = v87;
                                v182 = v8;
                                v106 = v100;
                                v49 = v111;
                                v183 = v6;
                                v118 = v112;
                                v184 = v4;
                                // branch -> 0x8f630160
                                goto lab_0x8f630160_23;
                            } else {
                                v185 = v2;
                                v74 = v73;
                                v144 = v83;
                                v131 = v84;
                                v31 = v85;
                                v19 = v86;
                                v96 = v87;
                                v186 = v8;
                                v105 = v100;
                                v48 = v111;
                                v187 = v6;
                                v117 = v112;
                                v188 = v4;
                            }
                        } else {
                            // 0x8f62f504
                            v59 = parse_sparse_image(g48, g52, g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0, v87, v86, v85, 0, str);
                            g54 = (int32_t)&g27;
                            *(int32_t *)&g27 = v59;
                            if (v59 == 0) {
                                // if_8f62f51c_0_true
                                // branch -> 0x8f6305ac
                            } else {
                                // 0x8f62f528
                                v248 = *(int32_t *)(v59 + 8);
                                g51 = v248;
                                v147 = unknown_69732061(v248);
                                g52 = v147;
                                if (v147 == 0) {
                                    // if_8f62f534_0_true
                                    // branch -> 0x8f62f968
                                    // 0x8f62f968
                                    print_log(3, (int32_t)"Invalid parsed sparse image", g50, g51, (int32_t)v2, (int32_t)v4, v112, v5, v111, 0, v100, v7, 0);
                                    // branch -> 0x8f6305ac
                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                } else {
                                    // 0x8f62f540
                                    v249 = *(char *)v147;
                                    v269 = v249;
                                    g46 = v269;
                                    if (v249 == 0) {
                                        // 0x8f62f54c
                                        g50 = 0x20000;
                                        memset((char *)&g30, v269, 0x20000);
                                        v217 = g52;
                                        v250 = *(int32_t *)(v217 + 16);
                                        g46 = v250;
                                        if (is_piv_magic(*(int32_t *)(v217 + 28), v250, g50, g51) == 0) {
                                            // 0x8f62f56c
                                            v70 = (int32_t)"Non-signed image detected\n";
                                            v60 = print_log(1, (int32_t)"Non-signed image detected\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                            v270 = (int32_t)*(char *)(g56 + 49);
                                            g51 = v270;
                                            if (v270 % 16 != 0) {
                                                // 0x8f62f590
                                                if (is_skip_validation(v60, v70, g50) == 0) {
                                                    // 0x8f62f59c
                                                    v61 = is_skip_sparse_preflash_validation(g56, v70, g50, g51, v1, v3, v112, v5);
                                                    if (v61 == 0) {
                                                        // if_8f62f5a8_0_true
                                                        // branch -> 0x8f62f88c
                                                        // 0x8f62f88c
                                                        print_log(3, (int32_t)"Invalid signed image", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                        // branch -> 0x8f62f890
                                                        // 0x8f62f890
                                                        v193 = v2;
                                                        v75 = v73;
                                                        v141 = v83;
                                                        v128 = v84;
                                                        v28 = v85;
                                                        v16 = v86;
                                                        v97 = v87;
                                                        v194 = v8;
                                                        v110 = v100;
                                                        v41 = v111;
                                                        v195 = v6;
                                                        v122 = v112;
                                                        v196 = v4;
                                                        v39 = (int32_t)"Invalid signed image";
                                                        // branch -> 0x8f6305ac
                                                        goto lab_0x8f6305ac_34;
                                                    }
                                                }
                                            }
                                            // 0x8f62f584
                                            g46 = (int32_t)"bypass piv validation\n";
                                            v160 = v2;
                                            v79 = v73;
                                            v139 = v83;
                                            v126 = v84;
                                            v26 = v85;
                                            v14 = v86;
                                            v89 = v87;
                                            v161 = v8;
                                            v109 = v100;
                                            v43 = v111;
                                            v162 = v6;
                                            v121 = v112;
                                            v163 = v4;
                                            v38 = (int32_t)"bypass piv validation\n";
                                            // branch -> 0x8f62f800
                                          lab_0x8f62f800_6:
                                            // 0x8f62f800
                                            v63 = print_log(1, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                            v35 = v63;
                                            v173 = v160;
                                            v78 = v79;
                                            v138 = v139;
                                            v125 = v126;
                                            v25 = v26;
                                            v13 = v14;
                                            v88 = v89;
                                            v174 = v161;
                                            v108 = v109;
                                            v42 = v43;
                                            v175 = v162;
                                            v120 = v121;
                                            v176 = v163;
                                            // branch -> 0x8f62f9f0
                                            goto lab_0x8f62f9f0_18;
                                        } else {
                                            // 0x8f62f5b8
                                            v148 = (int32_t)g27;
                                            g52 = v148;
                                            g57 = 0;
                                            g53 = 0x20000;
                                            v251 = *(int32_t *)(v148 + 8);
                                            g51 = v251;
                                            g45 = v148;
                                            g44 = -0x709d0a30;
                                            ((int32_t (*)(int32_t, int32_t))v251)(v148, v251);
                                            g57 = (int32_t)&g30;
                                            v123 = g45;
                                            g47 = v123;
                                            v200 = g53;
                                            if (v200 == 0) {
                                                v201 = v123;
                                                v151 = v2;
                                                v135 = 0;
                                                v23 = v86;
                                                v94 = v87;
                                                v152 = v4;
                                              lab_0x8f62f774:
                                                // 0x8f62f774
                                                v208 = v201 < 2 ? 1 - v201 : 0;
                                                g51 = v208;
                                                v209 = v208;
                                                v93 = v94;
                                                v22 = v23;
                                                v134 = v135;
                                                // branch -> after_if_8f62f784_0
                                                // after_if_8f62f784_0
                                                g53 = v209;
                                                if (v209 == 0) {
                                                    v219 = v201;
                                                    v52 = (int32_t *)(v219 + 8);
                                                    v253 = *v52;
                                                    v53 = (int32_t *)(v219 + 12);
                                                    v254 = *(int32_t *)(v219 + 16);
                                                    v275 = *(int32_t *)(v219 + 20);
                                                    v210 = v253 - 0x20000;
                                                    v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                    *v52 = v210;
                                                    *v53 = v70;
                                                    v225 = g47;
                                                    g50 = v225;
                                                    v255 = v210;
                                                    v276 = v70;
                                                    g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                    print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                    v220 = g52;
                                                    v256 = *(int32_t *)(v220 + 12);
                                                    g51 = v256;
                                                    g45 = v220;
                                                    g44 = -0x709d0834;
                                                    ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                    v202 = g45;
                                                    g47 = v202;
                                                    while (v202 != 0) {
                                                        // 0x8f62f794
                                                        v219 = v202;
                                                        v52 = (int32_t *)(v219 + 8);
                                                        v253 = *v52;
                                                        v53 = (int32_t *)(v219 + 12);
                                                        v254 = *(int32_t *)(v219 + 16);
                                                        v275 = *(int32_t *)(v219 + 20);
                                                        v210 = v253 - 0x20000;
                                                        v70 = *v53 - (int32_t)(v253 < 0x20000);
                                                        *v52 = v210;
                                                        *v53 = v70;
                                                        v225 = g47;
                                                        g50 = v225;
                                                        v255 = v210;
                                                        v276 = v70;
                                                        g46 = (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n";
                                                        print_log(2, (int32_t)"update chunk(%p) offset after extracting PIV:size=0x%llx, offset=0x%llx\n", v225, v275, v254, v275, v255, v276, v111, 0, v100, v7, 0);
                                                        v220 = g52;
                                                        v256 = *(int32_t *)(v220 + 12);
                                                        g51 = v256;
                                                        g45 = v220;
                                                        g44 = -0x709d0834;
                                                        ((int32_t (*)(int32_t, int32_t))v256)(v220, v256);
                                                        v202 = g45;
                                                        g47 = v202;
                                                        // continue -> 0x8f62f794
                                                    }
                                                  lab_0x8f62f7d4:
                                                    // 0x8f62f7d4
                                                    v153 = (char *)v254;
                                                    v154 = (char *)v275;
                                                    v155 = (char *)v276;
                                                    g46 = 0x20000;
                                                    g50 = str;
                                                    v62 = piv_init((int32_t)&g30, 0x20000, str, g51, v254, v275, v255, v276, v111, 0, v100, v7, 0, v93, v22, v85, 0);
                                                    if (v62 == 0) {
                                                        // 0x8f62f7ec
                                                        v271 = (int32_t)*(char *)(g56 + 49);
                                                        g51 = v271;
                                                        if (v271 % 16 == 0) {
                                                            v156 = v153;
                                                            v80 = v73;
                                                            v140 = v83;
                                                            v127 = v134;
                                                            v27 = v85;
                                                            v15 = v22;
                                                            v90 = v93;
                                                            v157 = v8;
                                                            v102 = v100;
                                                            v44 = v111;
                                                            v158 = v155;
                                                            v114 = v255;
                                                            v159 = v154;
                                                          lab_0x8f62f7f8_6:
                                                            // 0x8f62f7f8
                                                            g46 = (int32_t)"skip validating PIV image\n";
                                                            v160 = v156;
                                                            v79 = v80;
                                                            v139 = v140;
                                                            v126 = v127;
                                                            v26 = v27;
                                                            v14 = v15;
                                                            v89 = v90;
                                                            v161 = v157;
                                                            v109 = v102;
                                                            v43 = v44;
                                                            v162 = v158;
                                                            v121 = v114;
                                                            v163 = v159;
                                                            v38 = (int32_t)"skip validating PIV image\n";
                                                            // branch -> 0x8f62f800
                                                            goto lab_0x8f62f800_6;
                                                        } else {
                                                            v189 = v153;
                                                            v82 = v73;
                                                            v143 = v83;
                                                            v130 = v134;
                                                            v30 = v85;
                                                            v18 = v22;
                                                            v92 = v93;
                                                            v190 = v8;
                                                            v104 = v100;
                                                            v47 = v111;
                                                            v191 = v155;
                                                            v116 = v255;
                                                            v192 = v154;
                                                        }
                                                    } else {
                                                        // 0x8f62f890
                                                        v193 = v153;
                                                        v75 = v73;
                                                        v141 = v83;
                                                        v128 = v134;
                                                        v28 = v85;
                                                        v16 = v22;
                                                        v97 = v93;
                                                        v194 = v8;
                                                        v110 = v100;
                                                        v41 = v111;
                                                        v195 = v155;
                                                        v122 = v255;
                                                        v196 = v154;
                                                        v39 = (int32_t)"Invalid signed image";
                                                        // branch -> 0x8f6305ac
                                                        goto lab_0x8f6305ac_34;
                                                    }
                                                    // 0x8f6304e4
                                                    if (is_skip_validation(0, g46, g50) == 0) {
                                                        goto lab_0x8f6304f0_6;
                                                    }
                                                    v156 = v189;
                                                    v80 = v82;
                                                    v140 = v143;
                                                    v127 = v130;
                                                    v27 = v30;
                                                    v15 = v18;
                                                    v90 = v92;
                                                    v157 = v190;
                                                    v102 = v104;
                                                    v44 = v47;
                                                    v158 = v191;
                                                    v114 = v116;
                                                    v159 = v192;
                                                    goto lab_0x8f62f7f8_6;
                                                }
                                            } else {
                                                v252 = v200;
                                                v218 = v123;
                                                v149 = v4;
                                                v95 = v87;
                                                v136 = 0;
                                                v150 = v2;
                                                while (true) {
                                                    // after_if_8f62f5e0_0
                                                    if (v218 != 0) {
                                                        goto lab_0x8f62f5e8_4;
                                                    }
                                                    // 0x8f62f774
                                                    g51 = 1;
                                                    // branch -> after_if_8f62f784_0.thread
                                                    // after_if_8f62f784_0.thread
                                                    g53 = 1;
                                                    // branch -> 0x8f62f8c4
                                                }
                                            }
                                            // 0x8f62f8c4
                                            // branch -> 0x8f62f968
                                            // 0x8f62f968
                                            print_log(3, (int32_t)"Malformed sparse image", g50, g51, (int32_t)v151, (int32_t)v152, v112, v5, v111, 0, v100, v7, 0);
                                            // branch -> 0x8f6305ac
                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                        }
                                        // 0x8f62f890
                                        v193 = v168;
                                        v75 = v81;
                                        v141 = v142;
                                        v128 = v129;
                                        v28 = v29;
                                        v16 = v17;
                                        v97 = v91;
                                        v194 = v169;
                                        v110 = v103;
                                        v41 = v46;
                                        v195 = v170;
                                        v122 = v115;
                                        v196 = v171;
                                        v39 = (int32_t)"Invalid signed image";
                                        // branch -> 0x8f6305ac
                                        goto lab_0x8f6305ac_34;
                                    } else {
                                        // 0x8f62f808
                                        v272 = (int32_t)*(char *)(g56 + 49);
                                        g51 = v272;
                                        if (v249 == 2) {
                                            // 0x8f62f814
                                            if (v272 % 16 != 0) {
                                                // 0x8f62f82c
                                                if (is_skip_validation(v147, 2, g50) == 0) {
                                                    // 0x8f62f838
                                                    v65 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                    if (v65 == 0) {
                                                        // 0x8f62f848
                                                        v197 = *(char *)(g56 + 49) % 16;
                                                        v211 = v197;
                                                        g51 = v211;
                                                        if (v197 == 6) {
                                                            // 0x8f62f870
                                                            g51 = (int32_t)&g33;
                                                            v257 = *(char *)&g33;
                                                            v273 = v257;
                                                            g50 = v273;
                                                            if (v257 == 1) {
                                                                // 0x8f62f89c
                                                                v35 = 0;
                                                                v173 = v2;
                                                                v78 = v73;
                                                                v138 = v83;
                                                                v125 = v84;
                                                                v25 = v85;
                                                                v13 = v86;
                                                                v88 = v87;
                                                                v174 = v8;
                                                                v108 = v100;
                                                                v42 = v111;
                                                                v175 = v6;
                                                                v120 = v112;
                                                                v176 = v4;
                                                                if (*(char *)&g30 != 0) {
                                                                    // 0x8f62f8ac
                                                                    v172 = (int32_t)g27;
                                                                    g45 = v172;
                                                                    v258 = *(int32_t *)(v172 + 8);
                                                                    g51 = v258;
                                                                    g44 = -0x709d0748;
                                                                    ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                                    v203 = g45;
                                                                    g55 = v203;
                                                                    if (v203 == 0) {
                                                                        // 0x8f62f8c4
                                                                        // branch -> 0x8f62f968
                                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                                    } else {
                                                                        v226 = v203;
                                                                        v259 = *(int32_t *)(v226 + 8);
                                                                        v277 = *(int32_t *)(v226 + 12);
                                                                        g50 = v226;
                                                                        g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                        v212 = v259 - 0x20000;
                                                                        v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                        print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                        v221 = g55;
                                                                        v54 = (int32_t *)(v221 + 8);
                                                                        v260 = *v54;
                                                                        v55 = (int32_t *)(v221 + 12);
                                                                        g45 = (int32_t)g27;
                                                                        v213 = v260 - 0x20000;
                                                                        g52 = v213;
                                                                        v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                        g53 = v216;
                                                                        *v54 = v213;
                                                                        *v55 = v216;
                                                                        v222 = g45;
                                                                        v261 = *(int32_t *)(v222 + 12);
                                                                        g51 = v261;
                                                                        g44 = -0x709d06f4;
                                                                        ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                        v204 = g45;
                                                                        g55 = v204;
                                                                        while (v204 != 0) {
                                                                            // 0x8f62f8cc
                                                                            v226 = v204;
                                                                            v259 = *(int32_t *)(v226 + 8);
                                                                            v277 = *(int32_t *)(v226 + 12);
                                                                            g50 = v226;
                                                                            g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                                            v212 = v259 - 0x20000;
                                                                            v215 = v277 - (int32_t)(v259 < 0x20000);
                                                                            print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                                            v221 = g55;
                                                                            v54 = (int32_t *)(v221 + 8);
                                                                            v260 = *v54;
                                                                            v55 = (int32_t *)(v221 + 12);
                                                                            g45 = (int32_t)g27;
                                                                            v213 = v260 - 0x20000;
                                                                            g52 = v213;
                                                                            v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                                            g53 = v216;
                                                                            *v54 = v213;
                                                                            *v55 = v216;
                                                                            v222 = g45;
                                                                            v261 = *(int32_t *)(v222 + 12);
                                                                            g51 = v261;
                                                                            g44 = -0x709d06f4;
                                                                            ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                                            v204 = g45;
                                                                            g55 = v204;
                                                                            // continue -> 0x8f62f8cc
                                                                        }
                                                                        // 0x8f62f9f0
                                                                        v35 = 0;
                                                                        v173 = (char *)v259;
                                                                        v78 = v73;
                                                                        v138 = v83;
                                                                        v125 = v84;
                                                                        v25 = v85;
                                                                        v13 = v86;
                                                                        v88 = v87;
                                                                        v174 = v8;
                                                                        v108 = v100;
                                                                        v42 = v111;
                                                                        v175 = (char *)v215;
                                                                        v120 = v212;
                                                                        v176 = (char *)v277;
                                                                        // branch -> 0x8f62f9f0
                                                                        // 0x8f62f9f0
                                                                        v262 = *(char *)&g30;
                                                                        if (v262 == 0) {
                                                                            goto lab_0x8f62fabc_20;
                                                                        }
                                                                        goto lab_0x8f62fa00_20;
                                                                    }
                                                                    // 0x8f630498
                                                                    *(char *)&g33 = 0;
                                                                    v263 = *(char *)&g30;
                                                                    if (v263 == 0) {
                                                                        goto lab_0x8f6304bc_21;
                                                                    }
                                                                    goto lab_0x8f6304b4_21;
                                                                }
                                                                // 0x8f62f9f0
                                                                v262 = *(char *)&g30;
                                                                if (v262 == 0) {
                                                                    goto lab_0x8f62fabc_20;
                                                                }
                                                                goto lab_0x8f62fa00_20;
                                                            } else {
                                                                // 0x8f62f880
                                                                *(char *)&g33 = 0;
                                                                v40 = (int32_t)&g33;
                                                                // branch -> 0x8f62f88c
                                                                // 0x8f62f88c
                                                                print_log(1, (int32_t)"Invalid validating status\n", v273, v40, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                                                // branch -> 0x8f62f890
                                                                // 0x8f62f890
                                                                v193 = v2;
                                                                v75 = v73;
                                                                v141 = v83;
                                                                v128 = v84;
                                                                v28 = v85;
                                                                v16 = v86;
                                                                v97 = v87;
                                                                v194 = v8;
                                                                v110 = v100;
                                                                v41 = v111;
                                                                v195 = v6;
                                                                v122 = v112;
                                                                v196 = v4;
                                                                v39 = (int32_t)"Invalid signed image";
                                                                // branch -> 0x8f6305ac
                                                                goto lab_0x8f6305ac_34;
                                                            }
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        } else {
                                                            v164 = v2;
                                                            v165 = v8;
                                                            v101 = v100;
                                                            v45 = v111;
                                                            v166 = v6;
                                                            v113 = v112;
                                                            v167 = v4;
                                                            // 0x8f62f858
                                                            print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v211, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                            v193 = v164;
                                                            v75 = v73;
                                                            v141 = v83;
                                                            v128 = v84;
                                                            v28 = v85;
                                                            v16 = v86;
                                                            v97 = v87;
                                                            v194 = v165;
                                                            v110 = v101;
                                                            v41 = v45;
                                                            v195 = v166;
                                                            v122 = v113;
                                                            v196 = v167;
                                                            v39 = (int32_t)"Not supported signed sparse image";
                                                            // branch -> 0x8f6305ac
                                                            goto lab_0x8f6305ac_34;
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                }
                                            }
                                            // 0x8f62f81c
                                            g46 = (int32_t)"bypass validation for SKIP_DATA type\n";
                                            v64 = print_log(2, (int32_t)"bypass validation for SKIP_DATA type\n", g50, g51, v1, v3, v112, v5, v111, 0, v100, v7, 0);
                                            // branch -> 0x8f62f89c
                                            // 0x8f62f89c
                                            if (*(char *)&g30 != 0) {
                                                // 0x8f62f8ac
                                                v172 = (int32_t)g27;
                                                g45 = v172;
                                                v258 = *(int32_t *)(v172 + 8);
                                                g51 = v258;
                                                g44 = -0x709d0748;
                                                ((int32_t (*)(int32_t, int32_t))v258)(v172, v258);
                                                v203 = g45;
                                                g55 = v203;
                                                if (v203 == 0) {
                                                    // 0x8f62f8c4
                                                    // branch -> 0x8f62f968
                                                    // Detected a possible infinite recursion (goto support failed); quitting...
                                                } else {
                                                    v226 = v203;
                                                    v259 = *(int32_t *)(v226 + 8);
                                                    v277 = *(int32_t *)(v226 + 12);
                                                    g50 = v226;
                                                    g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                    v212 = v259 - 0x20000;
                                                    v215 = v277 - (int32_t)(v259 < 0x20000);
                                                    print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                    v221 = g55;
                                                    v54 = (int32_t *)(v221 + 8);
                                                    v260 = *v54;
                                                    v55 = (int32_t *)(v221 + 12);
                                                    g45 = (int32_t)g27;
                                                    v213 = v260 - 0x20000;
                                                    g52 = v213;
                                                    v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                    g53 = v216;
                                                    *v54 = v213;
                                                    *v55 = v216;
                                                    v222 = g45;
                                                    v261 = *(int32_t *)(v222 + 12);
                                                    g51 = v261;
                                                    g44 = -0x709d06f4;
                                                    ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                    v204 = g45;
                                                    g55 = v204;
                                                    while (v204 != 0) {
                                                        // 0x8f62f8cc
                                                        v226 = v204;
                                                        v259 = *(int32_t *)(v226 + 8);
                                                        v277 = *(int32_t *)(v226 + 12);
                                                        g50 = v226;
                                                        g46 = (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n";
                                                        v212 = v259 - 0x20000;
                                                        v215 = v277 - (int32_t)(v259 < 0x20000);
                                                        print_log(2, (int32_t)"update chunk(%p) offset for consequent sparse from 0x%llx to 0x%llx\n", v226, g51, v259, v277, v212, v215, v111, 0, v100, v7, 0);
                                                        v221 = g55;
                                                        v54 = (int32_t *)(v221 + 8);
                                                        v260 = *v54;
                                                        v55 = (int32_t *)(v221 + 12);
                                                        g45 = (int32_t)g27;
                                                        v213 = v260 - 0x20000;
                                                        g52 = v213;
                                                        v216 = *v55 - (int32_t)(v260 < 0x20000);
                                                        g53 = v216;
                                                        *v54 = v213;
                                                        *v55 = v216;
                                                        v222 = g45;
                                                        v261 = *(int32_t *)(v222 + 12);
                                                        g51 = v261;
                                                        g44 = -0x709d06f4;
                                                        ((int32_t (*)(int32_t, int32_t))v261)(v222, v261);
                                                        v204 = g45;
                                                        g55 = v204;
                                                        // continue -> 0x8f62f8cc
                                                    }
                                                    // 0x8f62f9f0
                                                    v35 = 0;
                                                    v173 = (char *)v259;
                                                    v78 = v73;
                                                    v138 = v83;
                                                    v125 = v84;
                                                    v25 = v85;
                                                    v13 = v86;
                                                    v88 = v87;
                                                    v174 = v8;
                                                    v108 = v100;
                                                    v42 = v111;
                                                    v175 = (char *)v215;
                                                    v120 = v212;
                                                    v176 = (char *)v277;
                                                    // branch -> 0x8f62f9f0
                                                  lab_0x8f62f9f0_19:
                                                    // 0x8f62f9f0
                                                    v262 = *(char *)&g30;
                                                    if (v262 == 0) {
                                                        goto lab_0x8f62fabc_20;
                                                    }
                                                    goto lab_0x8f62fa00_20;
                                                }
                                                // 0x8f630498
                                                *(char *)&g33 = 0;
                                                v263 = *(char *)&g30;
                                                if (v263 == 0) {
                                                    goto lab_0x8f6304bc_21;
                                                }
                                                goto lab_0x8f6304b4_21;
                                            } else {
                                                v35 = v64;
                                                v173 = v2;
                                                v78 = v73;
                                                v138 = v83;
                                                v125 = v84;
                                                v25 = v85;
                                                v13 = v86;
                                                v88 = v87;
                                                v174 = v8;
                                                v108 = v100;
                                                v42 = v111;
                                                v175 = v6;
                                                v120 = v112;
                                                v176 = v4;
                                            }
                                        } else {
                                            // 0x8f62f918
                                            if (v272 % 16 != 0) {
                                                // 0x8f62f92c
                                                if (is_skip_validation(v147, v269, g50) == 0) {
                                                    // 0x8f62f938
                                                    v66 = is_skip_sparse_preflash_validation(g56, g46, g50, g51, v1, v3, v112, v5);
                                                    if ((char)v66 == 0) {
                                                        // 0x8f62f948
                                                        v198 = *(char *)(g56 + 49) % 16;
                                                        v214 = v198;
                                                        g51 = v214;
                                                        if (v198 == 6) {
                                                            // 0x8f62f958
                                                            g51 = (int32_t)&g33;
                                                            *(char *)&g33 = 0;
                                                            // branch -> 0x8f62f968
                                                            // Detected a possible infinite recursion (goto support failed); quitting...
                                                        } else {
                                                            v164 = v2;
                                                            v165 = v8;
                                                            v101 = v100;
                                                            v45 = v111;
                                                            v166 = v6;
                                                            v113 = v112;
                                                            v167 = v4;
                                                            // 0x8f62f858
                                                            print_log(5, (int32_t)"Not supported signed sparse image\n", g50, v214, (int32_t)v164, (int32_t)v167, v113, (int32_t)v166, v45, 0, v101, (int32_t)v165, 0);
                                                            v193 = v164;
                                                            v75 = v73;
                                                            v141 = v83;
                                                            v128 = v84;
                                                            v28 = v85;
                                                            v16 = v86;
                                                            v97 = v87;
                                                            v194 = v165;
                                                            v110 = v101;
                                                            v41 = v45;
                                                            v195 = v166;
                                                            v122 = v113;
                                                            v196 = v167;
                                                            v39 = (int32_t)"Not supported signed sparse image";
                                                            // branch -> 0x8f6305ac
                                                            goto lab_0x8f6305ac_34;
                                                        }
                                                        // Detected a possible infinite recursion (goto support failed); quitting...
                                                    }
                                                }
                                            }
                                            // 0x8f62f920
                                            g46 = (int32_t)"bypass validation for FILL_DATA type\n";
                                            v160 = v2;
                                            v161 = v8;
                                            v109 = v100;
                                            v43 = v111;
                                            v162 = v6;
                                            v121 = v112;
                                            v163 = v4;
                                            // branch -> 0x8f62f800
                                            // 0x8f62f800
                                            v63 = print_log(2, (int32_t)"bypass validation for FILL_DATA type\n", g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                            v35 = v63;
                                            v173 = v160;
                                            v78 = v73;
                                            v138 = v83;
                                            v125 = v84;
                                            v25 = v85;
                                            v13 = v86;
                                            v88 = v87;
                                            v174 = v161;
                                            v108 = v109;
                                            v42 = v43;
                                            v175 = v162;
                                            v120 = v121;
                                            v176 = v163;
                                            // branch -> 0x8f62f9f0
                                            goto lab_0x8f62f9f0_19;
                                        }
                                      lab_0x8f62f9f0_21:
                                        // 0x8f62f9f0
                                        v262 = *(char *)&g30;
                                        if (v262 == 0) {
                                            goto lab_0x8f62fabc_20;
                                        }
                                        goto lab_0x8f62fa00_20;
                                    }
                                }
                                // 0x8f62f800
                                v63 = print_log(v34, v38, g50, g51, (int32_t)v160, (int32_t)v163, v121, (int32_t)v162, v43, 0, v109, (int32_t)v161, 0);
                                v35 = v63;
                                v173 = v160;
                                v78 = v79;
                                v138 = v139;
                                v125 = v126;
                                v25 = v26;
                                v13 = v14;
                                v88 = v89;
                                v174 = v161;
                                v108 = v109;
                                v42 = v43;
                                v175 = v162;
                                v120 = v121;
                                v176 = v163;
                                // branch -> 0x8f62f9f0
                                goto lab_0x8f62f9f0_21;
                            }
                            // Detected a possible infinite recursion (goto support failed); quitting...
                        }
                        // 0x8f630498
                        *(char *)&g33 = 0;
                        v263 = *(char *)&g30;
                        if (v263 == 0) {
                            goto lab_0x8f6304bc_21;
                        }
                        goto lab_0x8f6304b4_21;
                    }
                    // Detected a possible infinite recursion (goto support failed); quitting...
                }
                // Detected a possible infinite recursion (goto support failed); quitting...
            } else {
                set_mem = 0;
                v177 = v2;
                v77 = v73;
                v137 = v83;
                v124 = v84;
                v24 = v85;
                v12 = v86;
                v99 = v87;
                v178 = v8;
                v107 = v100;
                v50 = v111;
                v179 = v6;
                v119 = v112;
                v180 = v4;
            }
        }
        // 0x8f63015c
        v71 = 1;
        v37 = set_mem;
        v181 = v177;
        v76 = v77;
        v145 = v137;
        v132 = v124;
        v32 = v24;
        v20 = v12;
        v98 = v99;
        v182 = v178;
        v106 = v107;
        v49 = v50;
        v183 = v179;
        v118 = v119;
        v184 = v180;
        // branch -> 0x8f630160
        goto lab_0x8f630160_23;
    }
}

// --------------- Statically Linked Functions ----------------

// ulldiv_t __aeabi_uldivmod(unsigned long long a, unsigned long long b);
// void __stack_chk_fail(void);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 29
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:00:04

//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t backlight_on(int32_t a1, int32_t a2);
int32_t backlight_set_default_brightness(int32_t a1);
int32_t display_barcode_in_code128_51(int32_t result, char * str);
int32_t get_brightness(int32_t a1, int32_t a2, int32_t a3);
int32_t get_max_brightness(int32_t a1, int32_t a2, int32_t a3);
int32_t lm3697_backlight_off(int32_t a1, int32_t a2, int32_t a3);
int32_t lm3697_backlight_on(int32_t a1, int32_t a2, int32_t a3);
int32_t lm3697_init(void);
int32_t ondraw_52(void);
int32_t screen_init_53(int32_t a1, int32_t a2, int32_t a3);
int32_t screen_ondraw_56(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t screen_onkey_58(int32_t a1, int32_t a2, int32_t a3);
int32_t screen_start_57(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t screen_stop_54(int32_t a1, int32_t a2, int32_t a3);
int32_t set_brightness(uint32_t a1);
int32_t set_content_to_show_55(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t set_default_brightness(uint32_t a1, int32_t a2, int32_t a3);

// --------------------- Global Variables ---------------------

int32_t g22 = 0; // LR
int32_t g23 = 0; // R1
int32_t g24 = 0; // R2
int32_t g25 = 0; // R3
int32_t g26 = 0; // R4
int32_t g27 = 0; // R5
int32_t g28 = 0; // R6
int32_t g29 = 0; // R7
int32_t g30 = 0; // R8
int32_t g31 = 0; // R9
int32_t g1 = -0x16d2bfc9; // 0x8f638578
int32_t g2 = -0x16d2bfc9; // 0x8f6387c0
int32_t g3 = -0x16d2bc09; // 0x8f638ab0
int32_t g4 = 100; // 0x8f6aca78
int32_t g5 = 255; // 0x8f6aca7c
int32_t g6 = 255; // 0x8f6aca80
int32_t g7 = 0; // 0x8f6b179c
char * g8; // 0x8f6e0a64
char * g9; // 0x8f6e0a65
int32_t g10 = 0; // 0x8f6e0a68
int32_t g11 = 0; // 0x8f6e0a84
int32_t g12 = 0; // 0x8f6e0a88
int32_t g13 = 0; // 0x8f6e0a8c
char * g14; // 0x8f6e0a90
int32_t g15 = 0; // 0x8f7112f4
int32_t g16 = 0; // 0x8f711514
char * g17; // 0x8f711530
int32_t g18 = 0; // 0x8f7125a8
int32_t g19 = 0; // 0x8f7125ac
int32_t g20 = 0; // 0x8f7125b0
int32_t g21 = 0; // 0x8f7125b4

// ------------------------ Functions -------------------------

// Address range: 0x8f63fb08 - 0x8f63fdc3
int32_t lm3697_init(void) {
    int32_t v1;
    int32_t v2 = v1; // bp-36
    int32_t v3;
    int32_t v4 = v3; // bp-32
    int32_t v5 = g27; // 0x8f63fb08
    int32_t v6 = g28; // 0x8f63fb08
    int32_t v7 = g15;
    int32_t v8;
    int32_t v9;
    int32_t v10;
    int32_t result2 = print_log(2, (int32_t)"%s\n", (int32_t)"lm3697_init", v7, v10, v9, v8, v1, v3, v7, g26, v5, v6); // R0
    char v11 = *(char *)&g14; // 0x8f63fb34
    int32_t v12 = (int32_t)&g14; // R8
    if (v11 == 0) {
        int32_t v13 = g13;
        int32_t v14 = v10; // 0x8f63fd406
        int32_t v15 = v9; // 0x8f63fd404
        int32_t v16; // 0x8f63fd48
        int32_t v17; // R1
        int32_t v18; // 0x8f63fd28
        uint32_t v19;
        uint32_t v20;
        uint32_t v21;
        uint32_t v22;
        uint32_t v23;
        if (v13 == 0) {
            int32_t v24 = *(int32_t *)(g12 + 44); // 0x8f63fb68
            int32_t v25 = get_int_prop((int32_t)"blsp", v24, (int32_t)&v8, g12, v10, v9, v8); // 0x8f63fb6c
            int32_t result; // 0x8f63fc10
            if (v25 == 0) {
                int32_t v26 = *(int32_t *)(g12 + 44); // 0x8f63fb84
                int32_t v27 = get_int_prop((int32_t)"qup", v26, (int32_t)&v2, g12, v10, v9, v8); // 0x8f63fb88
                if (v27 == 0) {
                    int32_t v28 = v8; // 0x8f63fba0_0
                    int32_t v29 = v2; // 0x8f63fba4_0
                    int32_t v30;
                    int32_t v31 = qup_blsp_i2c_init(0x1000000 * v28 / 0x1000000, 0x1000000 * v29 / 0x1000000, 0x186a0, 0x124f800, v10, v9, v28, v29, v3, v7, g26, v5, v6, g29, g30, g22, v30); // 0x8f63fbb0
                    *(int32_t *)(int32_t)&g13 = v31;
                    if (v31 == 0) {
                        // if_8f63fbbc_0_true
                        // branch -> 0x8f63fc10
                        // 0x8f63fc10
                        result = print_log(-1, (int32_t)"%s: qup_i2c_init fail\n", (int32_t)"lm3697_init", 0x124f800, v10, v9, v8, v2, v4, v7, g26, v5, v6);
                        // branch -> 0x8f63fd54
                        // 0x8f63fd54
                        if (v7 != g15) {
                            // 0x8f63fd64
                            __stack_chk_fail();
                            // branch -> 0x8f63fd68
                        }
                        // 0x8f63fd68
                        g27 = v5;
                        g28 = v6;
                        return result;
                    }
                    int32_t v32 = v2; // 0x8f63fbcc
                    int32_t v33 = v8; // 0x8f63fbe0
                    print_log(2, (int32_t)"%s, qup_blsp_i2c_init(BLSP_ID_%d, QUP_ID_%d, 100000, 19200000)\n", (int32_t)"lm3697_init", v33, v32, v9, v33, v32, v4, v7, g26, v5, v6);
                    int32_t v34 = *(int32_t *)(g12 + 44); // 0x8f63fbf4
                    int32_t v35 = get_int_prop((int32_t)"reset", v34, (int32_t)&v4, g12, v32, v9, v8); // 0x8f63fbf8
                    if (v35 == 0) {
                        int32_t v36 = 1; // R4
                        int32_t v37 = 1; // R2
                        int32_t v38 = 1; // R3
                        gpio_tlmm_config(v4, 0, 1, 1, 0, 1, v8);
                        gpio_set_dir(v4, 2, v37, v38);
                        gpio_set_value(v4, v36, v37, v38);
                        v14 = 0;
                        v15 = 1;
                        // branch -> 0x8f63fc4c
                        // 0x8f63fc4c
                        mdelay(5, v36, v37, v38);
                        print_log(2, (int32_t)"%s, LM3697_I2C_ADDRESS = 0x%x\n", (int32_t)"lm3697_init", 54, v14, v15, v8, v2, v4, v7, g26, v5, v6);
                        v19 = g13;
                        qup_i2c_write_byte(v19, 54, 26, 4, v14, v15, v8, v2, v4, v7, g26);
                        if (v19 <= 0xffffffff) {
                            // 0x8f63fc84
                            print_log(-1, (int32_t)"%s: fail to write REG_BOOST_CONTROL\n", (int32_t)"lm3697_init", 4, v14, v15, v8, v2, v4, v7, g26, v5, v6);
                            // branch -> 0x8f63fc94
                        }
                        // 0x8f63fc94
                        v20 = g13;
                        qup_i2c_write_byte(v20, 54, 22, 1, v14, v15, v8, v2, v4, v7, g26);
                        if (v20 <= 0xffffffff) {
                            // 0x8f63fcb0
                            print_log(-1, (int32_t)"%s: fail to write REG_BRIGHTNESS_CONFIG\n", (int32_t)"lm3697_init", 1, v14, v15, v8, v2, v4, v7, g26, v5, v6);
                            // branch -> 0x8f63fcc0
                        }
                        // 0x8f63fcc0
                        v21 = g13;
                        qup_i2c_write_byte(v21, 54, 20, 5, v14, v15, v8, v2, v4, v7, g26);
                        if (v21 <= 0xffffffff) {
                            // 0x8f63fcdc
                            print_log(-1, (int32_t)"%s: fail to write REG_CONTROL_RT_RAMP\n", (int32_t)"lm3697_init", 5, v14, v15, v8, v2, v4, v7, g26, v5, v6);
                            // branch -> 0x8f63fcec
                        }
                        // 0x8f63fcec
                        v22 = g13;
                        qup_i2c_write_byte(v22, 54, 16, 0, v14, v15, v8, v2, v4, v7, g26);
                        if (v22 <= 0xffffffff) {
                            // 0x8f63fd08
                            print_log(-1, (int32_t)"%s: fail to write REG_CURRENT_SINK_OUTPUT\n", (int32_t)"lm3697_init", 0, v14, v15, v8, v2, v4, v7, g26, v5, v6);
                            // branch -> 0x8f63fd18
                        }
                        // 0x8f63fd18
                        v23 = g13;
                        v17 = 54;
                        v18 = qup_i2c_write_byte(v23, 54, 23, 24, v14, v15, v8, v2, v4, v7, g26);
                        v16 = v18;
                        if (v23 <= 0xffffffff) {
                            // 0x8f63fd34
                            v17 = (int32_t)"%s: fail to write REG_A_FULL_SCALE_CURRENT\n";
                            print_log(-1, (int32_t)"%s: fail to write REG_A_FULL_SCALE_CURRENT\n", (int32_t)"lm3697_init", 24, v14, v15, v8, v2, v4, v7, g26, v5, v6);
                            v16 = (int32_t)"lm3697_init";
                            // branch -> 0x8f63fd44
                        }
                        // 0x8f63fd44
                        result2 = mdelay(2, v17, v16, 24);
                        *(char *)v12 = 1;
                        // branch -> 0x8f63fd54
                    } else {
                        // 0x8f63fc04
                        // branch -> 0x8f63fc0c
                        // 0x8f63fc0c
                        // branch -> 0x8f63fc10
                        // 0x8f63fc10
                        result = print_log(-1, (int32_t)"Property \"reset\" is not defined in dev tree for backlight device %s!", g12, g12, v32, v9, v8, v2, v4, v7, g26, v5, v6);
                        result2 = result;
                        // branch -> 0x8f63fd54
                    }
                    // 0x8f63fd54
                    if (v7 != g15) {
                        // 0x8f63fd64
                        __stack_chk_fail();
                        // branch -> 0x8f63fd68
                    }
                    // 0x8f63fd68
                    g27 = v5;
                    g28 = v6;
                    return result2;
                }
            }
            // 0x8f63fb94
            // branch -> 0x8f63fc0c
            // 0x8f63fc0c
            // branch -> 0x8f63fc10
            // 0x8f63fc10
            result = print_log(-1, (int32_t)"Property \"blsp\" is not defined in dev tree for backlight device %s!", g12, g12, v10, v9, v8, v2, v4, v7, g26, v5, v6);
            // branch -> 0x8f63fd54
            // 0x8f63fd54
            if (v7 != g15) {
                // 0x8f63fd64
                __stack_chk_fail();
                // branch -> 0x8f63fd68
            }
            // 0x8f63fd68
            g27 = v5;
            g28 = v6;
            return result;
        }
        // 0x8f63fc4c
        mdelay(5, (int32_t)"%s\n", (int32_t)v11, v13);
        print_log(2, (int32_t)"%s, LM3697_I2C_ADDRESS = 0x%x\n", (int32_t)"lm3697_init", 54, v14, v15, v8, v2, v4, v7, g26, v5, v6);
        v19 = g13;
        qup_i2c_write_byte(v19, 54, 26, 4, v14, v15, v8, v2, v4, v7, g26);
        if (v19 <= 0xffffffff) {
            // 0x8f63fc84
            print_log(-1, (int32_t)"%s: fail to write REG_BOOST_CONTROL\n", (int32_t)"lm3697_init", 4, v14, v15, v8, v2, v4, v7, g26, v5, v6);
            // branch -> 0x8f63fc94
        }
        // 0x8f63fc94
        v20 = g13;
        qup_i2c_write_byte(v20, 54, 22, 1, v14, v15, v8, v2, v4, v7, g26);
        if (v20 <= 0xffffffff) {
            // 0x8f63fcb0
            print_log(-1, (int32_t)"%s: fail to write REG_BRIGHTNESS_CONFIG\n", (int32_t)"lm3697_init", 1, v14, v15, v8, v2, v4, v7, g26, v5, v6);
            // branch -> 0x8f63fcc0
        }
        // 0x8f63fcc0
        v21 = g13;
        qup_i2c_write_byte(v21, 54, 20, 5, v14, v15, v8, v2, v4, v7, g26);
        if (v21 <= 0xffffffff) {
            // 0x8f63fcdc
            print_log(-1, (int32_t)"%s: fail to write REG_CONTROL_RT_RAMP\n", (int32_t)"lm3697_init", 5, v14, v15, v8, v2, v4, v7, g26, v5, v6);
            // branch -> 0x8f63fcec
        }
        // 0x8f63fcec
        v22 = g13;
        qup_i2c_write_byte(v22, 54, 16, 0, v14, v15, v8, v2, v4, v7, g26);
        if (v22 <= 0xffffffff) {
            // 0x8f63fd08
            print_log(-1, (int32_t)"%s: fail to write REG_CURRENT_SINK_OUTPUT\n", (int32_t)"lm3697_init", 0, v14, v15, v8, v2, v4, v7, g26, v5, v6);
            // branch -> 0x8f63fd18
        }
        // 0x8f63fd18
        v23 = g13;
        v17 = 54;
        v18 = qup_i2c_write_byte(v23, 54, 23, 24, v14, v15, v8, v2, v4, v7, g26);
        v16 = v18;
        if (v23 <= 0xffffffff) {
            // 0x8f63fd34
            v17 = (int32_t)"%s: fail to write REG_A_FULL_SCALE_CURRENT\n";
            print_log(-1, (int32_t)"%s: fail to write REG_A_FULL_SCALE_CURRENT\n", (int32_t)"lm3697_init", 24, v14, v15, v8, v2, v4, v7, g26, v5, v6);
            v16 = (int32_t)"lm3697_init";
            // branch -> 0x8f63fd44
        }
        // 0x8f63fd44
        result2 = mdelay(2, v17, v16, 24);
        *(char *)v12 = 1;
        // branch -> 0x8f63fd54
    }
    // 0x8f63fd54
    if (v7 != g15) {
        // 0x8f63fd64
        __stack_chk_fail();
        // branch -> 0x8f63fd68
    }
    // 0x8f63fd68
    g27 = v5;
    g28 = v6;
    return result2;
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// void * memset(void * s, int c, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// size_t strlen(const char * s);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 17
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:44:44

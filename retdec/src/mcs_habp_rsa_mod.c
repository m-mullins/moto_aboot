//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t can_write_partition(int32_t a1, uint32_t a2, int32_t a3);
int32_t display_auto_detect(int32_t a1, int32_t a2, int32_t a3);
int32_t display_init(int32_t a1);
int32_t fdt_subnode_offset(char * a1, int32_t a2, char * str, int32_t a4, int32_t a5);
int32_t fdt_subnode_offset_namelen(int32_t a1, int32_t a2, char * a3, int32_t n);
int32_t generic_mmc_do_write_protect(int32_t a1, int32_t a2, int32_t a3);
int32_t get_bar_length(int32_t a1, char * str);
int32_t get_charger_offset_by_type(int32_t a1, int32_t a2, int32_t a3);
int32_t is_battery_max17050(void);
int32_t is_battery_max17058(void);
int32_t lcm(int32_t a1, int32_t a2, int32_t a3);
int32_t led_blink(int32_t a1, int32_t a2);
int32_t led_blink_stop(int32_t a1, int32_t a2, int32_t a3);
int32_t longlong_to_string_constprop_0(int32_t a1, int32_t a2, int64_t a3, int32_t a4);
int32_t mcs_habp_rsa_crt(int32_t a1, uint32_t a2, int32_t a3, int32_t a4);
int32_t mcs_habp_rsa_mod(int32_t a1, int32_t a2, int32_t * a3, int32_t a4);
int32_t platform_led_off(int32_t a1, int32_t a2, int32_t a3);
int32_t platform_led_on(int32_t a1, int32_t a2, int32_t a3);
int32_t pmic_arb_read_cmd(char * a1);
int32_t pmic_arb_write_cmd(char * a1);
int32_t qtimer_init(void);
int32_t qtimer_tick_rate(void);
int32_t SecHABTest(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t SecTest(int32_t a1, int32_t a2);
int32_t SecWriteFuse(int32_t a1, uint32_t a2);
int32_t setup_tx(char * a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7);
int32_t test_HAB(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t type_itoa_12(char * a1, int32_t a2, int32_t a3);
int32_t udc_request_queue(int32_t a1, int32_t * a2);
int32_t write_protect_partition(int32_t a1, int32_t a2);

// --------------------- Global Variables ---------------------

int32_t g42 = 0; // LR
int32_t g43 = 0; // R0
int32_t g44 = 0; // R1
int32_t g45 = 0; // R2
int32_t g46 = 0; // R3
int32_t g47 = 0; // R4
int32_t g48 = 0; // R5
int32_t g49 = 0; // R6
int32_t g50 = 0; // R7
int32_t g51 = 0; // R8
int32_t g1 = -0x1a60cfa4; // 0x8f6055d0
int32_t g2 = -0x1a60df94; // 0x8f6502a8
int32_t (*g3)() = (int32_t (*)())-0x16d2bff0; // 0x8f665d64
int32_t g4 = -0x16d2bff0; // 0x8f665ddc
int32_t g5 = 1; // 0x8f6ac0f0
int32_t g6 = 0xffffff; // 0x8f6afe08
int32_t g7 = 2; // 0x8f6afe0c
int32_t g8 = 2; // 0x8f6afe14
int32_t g9 = 3; // 0x8f6afe18
int32_t g10 = 0; // 0x8f6b7938
int32_t g11 = 0; // 0x8f6b7940
int32_t g12 = 0; // 0x8f6b8ab0
uint32_t g13 = 0; // 0x8f6b8ab4
int32_t g14 = 0; // 0x8f6b8ab8
int32_t g15 = 0; // 0x8f6b8afc
int32_t g16 = 0; // 0x8f6b8b04
int32_t g17 = 0; // 0x8f6b8b08
char * g18; // 0x8f6e0699
char * g19; // 0x8f6e069a
char * g20; // 0x8f6e069b
char * g21; // 0x8f6e06a9
int32_t g22 = 0; // 0x8f6e0bfc
int32_t g23 = 0; // 0x8f6e0c10
char g24 = 0; // 0x8f6e0c14
int32_t g25 = 0; // 0x8f6e0c18
int32_t g26 = 0; // 0x8f6e0c1c
int32_t g27 = 0; // 0x8f6e0c20
int32_t g28 = 0; // 0x8f6e0c24
int32_t g29 = 0; // 0x8f6e0c28
int32_t g30 = 0; // 0x8f6e0c2c
int32_t g31 = 0; // 0x8f6e0c30
int32_t g32 = 0; // 0x8f6e0c34
int32_t g33 = 0; // 0x8f6e0c38
int32_t g34 = 0; // 0x8f6e0c3c
int32_t g35 = 0; // 0x8f6e0c44
char * g36; // 0x8f6e0c48
int32_t g37 = 0; // 0x8f6e0c49
int32_t g38 = 0; // 0x8f6e0c4c
int32_t g39 = 0; // 0x8f70f724
char * g40; // 0x8f7112f4
int32_t g41 = 0; // 0x8f7125ec

// ------------------------ Functions -------------------------

// Address range: 0x8f665554 - 0x8f665833
int32_t mcs_habp_rsa_mod(int32_t a1, int32_t a2, int32_t * a3, int32_t a4) {
    int32_t v1 = (int32_t)a3;
    char * v2 = g40;
    int32_t v3 = 4 * a2; // 0x8f66558c
    int32_t v4 = 16 * a4 - mcs_multi_bit_length(v1, a4, v1); // R5
    int32_t v5;
    int32_t result = &v5; // 0x8f6655a0_0
    int32_t v6 = result; // R0
    mcs_memcpy(result, a1, v3, v3);
    int32_t v7; // 0x8f6657ec227
    int32_t v8;
    int32_t v9;
    int32_t v10; // 0x8f66560c_0
    int32_t v11; // 0x8f6657fc
    int32_t v12; // R3
    int32_t v13; // R4
    int32_t v14; // R8
    int32_t v15;
    int32_t v16;
    int32_t v17;
    int32_t v18;
    uint32_t v19; // 0x8f6657c4
    int32_t v20; // 0x8f665644
    int32_t v21; // 0x8f665600
    int32_t v22; // 0x8f66565c
    int32_t v23; // 0x8f66570c42
    int32_t v24; // 0x8f66561c
    int32_t v25; // 0x8f665630
    int32_t v26; // 0x8f665610
    int32_t v27; // 0x8f66561c
    int32_t v28; // 0x8f665600
    uint32_t v29; // 0x8f665608
    int32_t v30; // 0x8f66565c
    int32_t v31; // 0x8f665660
    int32_t v32; // 0x8f665620
    int32_t v33; // 0x8f665624
    int32_t v34; // 0x8f665638
    if (v4 == 0) {
        // if_8f6655ac_0_true
        // branch -> 0x8f665600
        // 0x8f665600
        v21 = v1;
        v28 = *(int32_t *)(v21 + 4);
        v29 = *(int32_t *)v21;
        v10 = &v15;
        v14 = v10;
        v26 = 4 * a2;
        v24 = a4;
        v27 = 4 * v24;
        v32 = v27 + result;
        v13 = v32;
        v33 = v27 + v21;
        v25 = -4 * v24;
        v34 = v26 + result;
        v15 = v34;
        v20 = v24 - 1;
        v12 = v20;
        v8 = v17;
        v9 = v16;
        if (v32 != v34) {
            // 0x8f665658
            v23 = v32;
            v22 = v10;
            v7 = v17;
            // branch -> 0x8f665658
            while (true) {
                // 0x8f665658
                v30 = *(int32_t *)(v22 + 4);
                v31 = *(int32_t *)(v22 + 8);
                if (v30 == v29) {
                    goto lab_if_8f665668_0_true;
                }
                goto lab_0x8f665674;
            }
        }
        // 0x8f6657c4
        v19 = v4;
        if (v19 != 0) {
            // 0x8f6657cc
            mcs_multi_shift_left(result, a2 + 1, 16 - v19 % 16, v12, v18, v8, 0, v9, v29, 0, v3);
            mcs_multi_shift_right(v1, a4, v4, v12, v18, v8, 0, v9, v29, 0, v3);
            // branch -> 0x8f6657f0
        }
        // 0x8f6657f0
        v11 = mcs_memcpy(a1, result, v3, v12);
        mcs_memclear(result, v26, v11, v12);
        if (v2 != g40) {
            // 0x8f665820
            __stack_chk_fail();
            // branch -> 0x8f665824
        }
        // 0x8f665824
        return result;
    }
    // 0x8f6655b4
    int32_t v35;
    mcs_multi_shift_left(v1, a4, v4, v3, v18, v17, 0, v16, v35, 0, v3);
    uint32_t v36 = (v4 + 15) / 16; // 0x8f6655c8
    int32_t v37 = v3 + result; // 0x8f6655dc
    v6 = v37;
    mcs_memset(v37, 0, 4 * v36, v3);
    uint32_t v38 = v4 % 16; // 0x8f6655e8
    if (v38 != 0) {
        // 0x8f6655f0
        v6 = result;
        mcs_multi_shift_right(result, a2 + 1, 16 - v38, v3, v18, v17, 0, v16, v35, 0, v3);
        // branch -> 0x8f665600
    }
    // 0x8f665600
    v21 = v1;
    v28 = *(int32_t *)(v21 + 4);
    v29 = *(int32_t *)v21;
    v10 = &v15;
    v14 = v10;
    v26 = 4 * (a2 + v36);
    v24 = a4;
    v27 = 4 * v24;
    v32 = v27 + result;
    v13 = v32;
    v33 = v27 + v21;
    v25 = -4 * v24;
    v34 = v26 + result;
    v15 = v34;
    v20 = v24 - 1;
    v12 = v20;
    v8 = v17;
    v9 = v16;
    if (v32 != v34) {
        // 0x8f665658
        v23 = v32;
        v22 = v10;
        v7 = v17;
        // branch -> 0x8f665658
        while (true) {
          lab_0x8f665658:
            // 0x8f665658
            v30 = *(int32_t *)(v22 + 4);
            v31 = *(int32_t *)(v22 + 8);
            int32_t v39; // 0x8f6656986
            int32_t v40; // 0x8f66566c
            if (v30 == v29) {
              lab_if_8f665668_0_true:
                // if_8f665668_0_true
                v40 = v6 | 0xffff;
                v6 = v40;
                v39 = v31 + v29;
                // branch -> 0x8f66568c
            } else {
              lab_0x8f665674:;
                uint32_t v41 = v31 + 0x10000 * v30; // 0x8f665674
                int32_t v42 = v41 / v29;
                v6 = v42;
                v39 = v41 - v42 * v29;
                v40 = v42;
                // branch -> 0x8f66568c
            }
            int32_t v43 = v40 * v28; // 0x8f665694
            int32_t v44 = v40; // 0x8f6656fc40
            int32_t v45;
            int32_t v46; // 0x8f6657ec412
            int32_t v47;
            int32_t v48; // R2
            int32_t v49; // 0x8f6656f4
            int32_t v50; // 0x8f6656fc
            int32_t v51; // 0x8f665728
            uint32_t v52; // 0x8f66575c
            int32_t v53; // 0x8f665714
            int32_t v54; // 0x8f665728
            if (v39 < 0x10000) {
                int32_t v55 = v40; // 0x8f6656dc
                int32_t v56 = v39; // 0x8f6656e0
                int32_t v57 = 0; // 0x8f6656d0
                // branch -> 0x8f6656bc
                while (true) {
                    // 0x8f6656bc
                    if (v57 + v43 > *(int32_t *)(v22 + 12) + 0x10000 * v56) {
                        int32_t v58 = v55 - 1; // 0x8f6656dc
                        v6 = v58;
                        int32_t v59 = v56 + v29; // 0x8f6656e0
                        if (v59 >= 0x10000) {
                            v44 = v58;
                            // break -> 0x8f6656a0
                            break;
                        }
                        v55 = v58;
                        v56 = v59;
                        v57 -= v28;
                        // continue -> 0x8f6656bc
                        continue;
                    } else {
                        v44 = v55;
                    }
                }
                // 0x8f6656a0
                v48 = 0;
                v12 = 0;
                v52 = 0;
                v45 = v7;
                v47 = v33;
                int32_t * v60; // 0x8f665744_0
                int32_t v61; // 0x8f665744
                uint32_t v62; // 0x8f665750
                int32_t v63; // 0x8f665754
                if (v20 >= 0) {
                    v53 = 0;
                    v54 = 0;
                    v51 = v23;
                    v50 = v44;
                    v49 = v20;
                    v46 = v33;
                  lab_0x8f6656f0:
                    while (true) {
                        int32_t v64 = v46 - 4; // 0x8f6656f8
                        uint32_t v65 = *(int32_t *)v64 * v50; // 0x8f6656fc
                        int32_t * v66 = (int32_t *)(v51 + v54); // 0x8f66570c_0
                        int32_t v67 = 0x20000 - v53 % 0x10000 + *v66 - v65 % 0x10000; // 0x8f665720
                        *v66 = v67 % 0x10000;
                        int32_t v68 = v48 - 4; // 0x8f665730
                        v48 = v68;
                        int32_t v69 = v12 / 0x10000 + v65 / 0x10000 + 2 - v67 / 0x10000; // 0x8f66573c
                        int32_t v70 = v49 - 1;
                        v12 = v69;
                        if (v70 < 0) {
                            // 0x8f6656e8
                            v52 = v69;
                            v45 = v65;
                            v47 = v64;
                            // branch -> 0x8f665744
                            // 0x8f665744
                            v61 = v14 + 4;
                            v60 = (int32_t *)v61;
                            v62 = 0x10000 - v52 % 0x10000 + *v60;
                            v63 = v62 % 0x10000;
                            v6 = v63;
                            v12 = v52 / 0x10000 - v62 / 0x10000;
                            v14 = v61;
                            *v60 = v63;
                            int32_t v71; // 0x8f6657bc
                            if (v12 != -1) {
                              lab_0x8f66576c:
                                // 0x8f66576c
                                v6 = v33;
                                v12 = 0;
                                int32_t v72 = v20; // 0x8f66577814
                                int32_t * v73; // 0x8f6657ac_0
                                int32_t v74; // 0x8f6657ac
                                if (v72 >= 0) {
                                    int32_t v75 = 0; // 0x8f66579c
                                    int32_t v76 = 0; // 0x8f665788
                                    int32_t v77 = v33; // 0x8f665780
                                    while (true) {
                                        int32_t v78 = v77 - 4; // 0x8f665780
                                        v6 = v78;
                                        int32_t * v79 = (int32_t *)(v13 + v75); // 0x8f66578c_0
                                        uint32_t v80 = *v79 + *(int32_t *)v78 + v76; // 0x8f665790
                                        v48 = v80 / 0x10000;
                                        *v79 = v80 % 0x10000;
                                        int32_t v81 = v12 - 4; // 0x8f6657a0
                                        v12 = v81;
                                        int32_t v82 = v72 - 1; // 0x8f665778
                                        if (v82 < 0) {
                                            // 0x8f665778
                                            // branch -> 0x8f6657a8
                                            // 0x8f6657a8
                                            v73 = (int32_t *)(v13 + v25);
                                            v74 = *v73;
                                            v12 = v74;
                                            *v73 = (v74 + v48) % 0x10000;
                                            // branch -> 0x8f6657bc
                                          lab_0x8f6657bc:
                                            // 0x8f6657bc
                                            v71 = v13 + 4;
                                            v13 = v71;
                                            if (v71 != v15) {
                                              lab_0x8f6657bc_2:
                                                // 0x8f6657bc
                                                v23 = v71;
                                                v22 = v14;
                                                v7 = v45;
                                                // branch -> 0x8f665658
                                                goto lab_0x8f665658;
                                            }
                                            // 0x8f66564c
                                            v8 = v45;
                                            v9 = v47;
                                            // branch -> 0x8f6657c4
                                            // 0x8f6657c4
                                            v19 = v4;
                                            if (v19 != 0) {
                                                // 0x8f6657cc
                                                mcs_multi_shift_left(result, a2 + 1, 16 - v19 % 16, v12, v18, v8, 0, v9, v29, 0, v3);
                                                mcs_multi_shift_right(v1, a4, v4, v12, v18, v8, 0, v9, v29, 0, v3);
                                                // branch -> 0x8f6657f0
                                            }
                                            // 0x8f6657f0
                                            v11 = mcs_memcpy(a1, result, v3, v12);
                                            mcs_memclear(result, v26, v11, v12);
                                            if (v2 != g40) {
                                                // 0x8f665820
                                                __stack_chk_fail();
                                                // branch -> 0x8f665824
                                            }
                                            // 0x8f665824
                                            return result;
                                        }
                                        // 0x8f665780
                                        v75 = v81;
                                        v76 = v48;
                                        v72 = v82;
                                        v77 = v6;
                                        // branch -> 0x8f665780
                                    }
                                }
                                // 0x8f6657a8
                                v73 = (int32_t *)(v13 + v25);
                                v74 = *v73;
                                v12 = v74;
                                *v73 = v74 % 0x10000;
                                // branch -> 0x8f6657bc
                                goto lab_0x8f6657bc;
                            }
                          lab_0x8f6657bc_3:
                            // 0x8f6657bc
                            v71 = v13 + 4;
                            v13 = v71;
                            if (v71 != v15) {
                                goto lab_0x8f6657bc_2;
                            }
                            // 0x8f66564c
                            v8 = v45;
                            v9 = v47;
                            // branch -> 0x8f6657c4
                            // 0x8f6657c4
                            v19 = v4;
                            if (v19 != 0) {
                                // 0x8f6657cc
                                mcs_multi_shift_left(result, a2 + 1, 16 - v19 % 16, v12, v18, v8, 0, v9, v29, 0, v3);
                                mcs_multi_shift_right(v1, a4, v4, v12, v18, v8, 0, v9, v29, 0, v3);
                                // branch -> 0x8f6657f0
                            }
                            // 0x8f6657f0
                            v11 = mcs_memcpy(a1, result, v3, v12);
                            mcs_memclear(result, v26, v11, v12);
                            if (v2 != g40) {
                                // 0x8f665820
                                __stack_chk_fail();
                                // branch -> 0x8f665824
                            }
                            // 0x8f665824
                            return result;
                        }
                        // 0x8f6656f0
                        v53 = v69;
                        v54 = v68;
                        v51 = v13;
                        v50 = v6;
                        v49 = v70;
                        v46 = v64;
                        // branch -> 0x8f6656f0
                    }
                }
              lab_0x8f665744:
                // 0x8f665744
                v61 = v22 + 4;
                v60 = (int32_t *)v61;
                v62 = 0x10000 - v52 % 0x10000 + *v60;
                v63 = v62 % 0x10000;
                v6 = v63;
                v12 = v52 / 0x10000 - v62 / 0x10000;
                v14 = v61;
                *v60 = v63;
                if (v12 == -1) {
                    goto lab_0x8f6657bc_3;
                }
                goto lab_0x8f66576c;
            }
            // 0x8f6656a0
            v48 = 0;
            v12 = 0;
            if (v20 < 0) {
                v52 = 0;
                v45 = v7;
                v47 = v33;
                goto lab_0x8f665744;
            }
            v53 = 0;
            v54 = 0;
            v51 = v23;
            v50 = v44;
            v49 = v20;
            v46 = v33;
            goto lab_0x8f6656f0;
        }
    }
    // 0x8f6657c4
    v19 = v4;
    if (v19 != 0) {
        // 0x8f6657cc
        mcs_multi_shift_left(result, a2 + 1, 16 - v19 % 16, v12, v18, v8, 0, v9, v29, 0, v3);
        mcs_multi_shift_right(v1, a4, v4, v12, v18, v8, 0, v9, v29, 0, v3);
        // branch -> 0x8f6657f0
    }
    // 0x8f6657f0
    v11 = mcs_memcpy(a1, result, v3, v12);
    mcs_memclear(result, v26, v11, v12);
    if (v2 != g40) {
        // 0x8f665820
        __stack_chk_fail();
        // branch -> 0x8f665824
    }
    // 0x8f665824
    return result;
}

// --------------- Statically Linked Functions ----------------

// ulldiv_t __aeabi_uldivmod(unsigned long long a, unsigned long long b);
// void __stack_chk_fail(void);
// void free(void * ptr);
// void * memalign(size_t alignment, size_t size);
// void * memchr(void * s, int c, size_t n);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// int sprintf(char * restrict s, const char * restrict format, ...);
// size_t strlen(const char * s);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 30
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:12:14

//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <ctype.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t arch_early_init(void);
int32_t boot_handler(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t boot_linux(int32_t (*a1)(int32_t, int32_t, int32_t), int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t disable_charger_gone_irq(int32_t a1, int32_t a2, int32_t a3);
int32_t enable_charger_gone_irq(int32_t a1, int32_t a2);
void function_8f64b730(void);
void function_8f64b7f0(char * str, char * delim, int32_t a3);
int32_t hab_policy_init(void);
int32_t init_barcodes(int32_t a1, int32_t a2, int32_t a3);
int32_t init_panels(void);
int32_t is_like_hab_signature(char * a1, int32_t a2, int32_t a3);
int32_t is_warranty_void(int32_t a1);
int32_t load_and_validate_logo(void);
int32_t LZ4_decompress_safe(char * a1, char * a2, int32_t a3, int32_t a4, int32_t a5);
int32_t LZ4_decompress_safe_withPrefix64k(char * a1, char * a2, int32_t a3, int32_t a4, int32_t a5);
int32_t mcs_habp_rsa_crt_core(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7);
int32_t mcs_habp_rsa_crt_med(int32_t a1, int32_t a2, int32_t a3);
int32_t mipi_mot_get_manufacture_id(int32_t * a1, int32_t a2, int32_t a3);
int32_t mipi_mot_get_supplier_id(int32_t * a1, int32_t a2, int32_t a3);
char * mmc_sd_set_bus_width(char * a1, int32_t * a2, int32_t a3);
char * mmc_sd_set_hs(char * a1);
int32_t move_to_verified(int32_t a1, int32_t a2, int32_t a3);
int32_t qup_i2c_sec_init(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t qup_i2c_xfer(int32_t a1);
int32_t radio_from_utag(int32_t a1, int32_t a2, int32_t a3);
char * restore_secure_cfg(int32_t a1, int32_t a2);
int32_t scm_init(int32_t a1);
int32_t screen_manager_init(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t show(char * a1, int32_t a2, int32_t a3);
int32_t target_hwrev(void);

// --------------------- Global Variables ---------------------

int32_t g45 = 0; // LR
int32_t g46 = 0; // R0
int32_t g47 = 0; // R1
int32_t g48 = 0; // R11
int32_t g49 = 0; // R12
int32_t g50 = 0; // R2
int32_t g51 = 0; // R3
int32_t g52 = 0; // R4
int32_t g53 = 0; // R5
int32_t g54 = 0; // R6
int32_t g55 = 0; // R7
int32_t g56 = 0; // R8
int32_t g57 = 0; // R9
int32_t g1 = -0x15fffffa; // 0x8f600000
int32_t g2 = -0x1a60cef8; // 0x8f612228
int32_t g3 = -0x1a60ceec; // 0x8f6383f0
int32_t g4 = -0x16d2bfc9; // 0x8f6387c0
int32_t g5 = -0x16d2bc09; // 0x8f638ab0
int32_t g6 = -0x1a60ff98; // 0x8f638b94
int32_t g7 = -0x16d2bfc9; // 0x8f64587c
char * g8 = "\xff\xff\xff\xff\x6c\x6f\x61\x64\x5f\x61\x6e\x64\x5f\x76\x61\x6c\x69\x64\x61\x74\x65\x5f\x6b\x65\x72\x6e\x65\x6c\x5f\x69\x6d\x61\x67\x65"; // 0x8f6826be
int32_t g9 = 0x65440030; // 0x8f69c66f
int32_t g10 = 0; // 0x8f6a3f38
int32_t g11 = 1; // 0x8f6ac0f0
int32_t g12 = -0x709c73f8; // 0x8f6ac374
int32_t g13 = 0xffff; // 0x8f6acae4
int32_t g14 = 4; // 0x8f6acaf4
int32_t g15 = 0xffff; // 0x8f6acb2c
int32_t g16 = 4; // 0x8f6acb84
int32_t g17 = 0; // 0x8f6b0048
int32_t g18 = 0; // 0x8f6b004c
int32_t g19 = 0; // 0x8f6b0074
int32_t g20 = 0; // 0x8f6b0078
int32_t g21 = 0; // 0x8f6b015c
int32_t g22 = 0; // 0x8f6b1608
int32_t g23 = 0; // 0x8f6b7cc0
int32_t g24 = 0; // 0x8f6c0000
int32_t g25 = 0; // 0x8f6c02aa
int32_t g26 = 0; // 0x8f6c02ba
int32_t g27 = 0; // 0x8f6c02ca
int32_t g28 = 0; // 0x8f6c02e0
int32_t g29 = 0; // 0x8f6e082c
char * g30; // 0x8f6e0849
int32_t g31 = 0; // 0x8f6e0854
int32_t g32 = 0; // 0x8f6e0858
int32_t g33 = 0; // 0x8f6e085c
int32_t g34 = 0; // 0x8f6e0878
int32_t g35 = 0; // 0x8f6e0894
int32_t g36 = 0; // 0x8f6e08b0
int32_t g37 = 0; // 0x8f6e08b4
char ** g38 = NULL; // 0x8f6e0bf8
int32_t g39 = 0; // 0x8f710c30
int32_t g40 = 0; // 0x8f710c34
int16_t * g41 = NULL; // 0x8f7112f4
int32_t g42 = 0; // 0x8f7114b8
int32_t g43 = 0; // 0x8f71302c
int32_t g44 = 0; // 0x8f713044

// ------------------------ Functions -------------------------

// Address range: 0x8f6659a8 - 0x8f665d63
int32_t mcs_habp_rsa_crt_core(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7) {
    int32_t v1 = g52; // 0x8f6659a8
    int32_t v2 = g54; // 0x8f6659a8
    int32_t v3 = g55; // 0x8f6659a8
    int16_t * v4 = g41;
    int32_t result = (int32_t)v4;
    int32_t v5 = (a2 + 1) / 2; // 0x8f6659cc
    g52 = v5;
    int32_t v6;
    g54 = v6;
    int32_t v7 = mcs_array_unpadded_length(a3, v5, a3); // R9
    uint32_t v8 = mcs_array_unpadded_length(a4, g52, a3); // 0x8f665a24
    int32_t v9 = (v7 + 1) / 2; // R5
    uint32_t v10 = mcs_array_unpadded_length(a5, g52, a3); // 0x8f665a3c
    uint32_t v11 = mcs_array_unpadded_length(a6, g52, a3); // 0x8f665a4c
    int32_t v12 = mcs_array_unpadded_length(a7, g52, a3); // 0x8f665a5c
    int32_t v13 = g52; // 0x8f665a68
    int32_t v14 = v7; // 0x8f665a68
    int32_t v15 = v13 - v14 + a3; // 0x8f665a74
    g55 = (v8 + 1) / 2;
    int32_t v16;
    int32_t v17;
    int32_t v18;
    int32_t v19;
    int32_t v20;
    int32_t v21;
    int32_t v22;
    mcs_multi_convert_to_multi_digit_byte_len(v15, v16, v14, v15, v22, v21, 0, a3, v8, a2, v17, v18, v20, v19);
    int32_t v23 = a4 + v13 - v8; // 0x8f665a98
    mcs_multi_convert_to_multi_digit_byte_len(v23, v17, v8, v15, v22, v21, 0, a3, v8, a2, v17, v18, v20, v19);
    int32_t v24;
    mcs_multi_multiply(v16, v9, v17, g55, g54, v21, 0, a3, v8, a2, v17, v18, v20, v19, v12, v24, a1, v10, v11, v15, v23);
    int32_t v25 = 4 * (v9 + g55 - g52); // 0x8f665ad4
    mcs_multi_convert_from_multi_digit_byte_len(v25 + g54, v18, a2, v25, g54, v21, 0, a3, v8, a2, v17, v18, v20, v19);
    int32_t v26 = 57;
    if (mcs_memcmp(a1, v18, a2, v25, g54, v21, 0) <= 0xffffffff) {
        int32_t v27 = g54 + 4; // 0x8f665b04
        a4 = v27;
        int32_t v28 = g52 + 1; // R11
        int32_t v29 = 4 * v9; // 0x8f665b00
        int32_t v30 = v29 + 4 + g54; // 0x8f665b18
        int32_t v31 = v16 + v29; // 0x8f665b2c
        int32_t v32 = 4 * g55 + v17; // 0x8f665b30
        mcs_multi_convert_to_multi_digit_byte_len(a1, v27, a2, v31, g54, v21, 0, a3, v8, a2, v17, v18, v30, v31);
        *(int32_t *)g54 = 0;
        int32_t v33 = v9; // 0x8f665b50
        int32_t v34;
        mcs_habp_rsa_mod(g54, v28, v16, v33, g54, v21, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23, v25, a5, a6, a7, v34);
        mcs_multi_convert_from_multi_digit_byte_len(g54 + 4 * (v28 - v9), a4, v7, v33, g54, v21, 0, a3, v8, a2, v17, v18, v30, v31);
        uint32_t v35 = v10 % 0x10000; // 0x8f665b80
        int32_t v36 = g52 - v10 + a5; // 0x8f665b98
        mcs_habp_rsa(a4, v15, v7 % 0x10000, v36, v35, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15);
        mcs_multi_convert_to_multi_digit_byte_len(v30, v31, v7, v36, v35, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        mcs_multi_convert_to_multi_digit_byte_len(a1, a4, a2, v36, v35, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        int32_t v37 = g55; // 0x8f665bc0
        mcs_habp_rsa_mod(g54, v28, v17, v37, v35, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23, v25, a5, a6, a7, v34);
        mcs_multi_convert_from_multi_digit_byte_len(g54 + 4 * (v28 - g55), a4, v8, v37, v35, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        uint32_t v38 = v11 % 0x10000; // 0x8f665bf8
        int32_t v39 = g52 - v11 + a6; // 0x8f665c14
        mcs_habp_rsa(a4, v23, v8 % 0x10000, v39, v38, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15);
        mcs_multi_convert_to_multi_digit_byte_len(v30, v32, v8, v39, v38, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        int32_t v40 = g55; // 0x8f665c38
        int32_t v41; // 0x8f665cbc
        int32_t v42; // 0x8f665c7c
        int32_t v43; // 0x8f665c84
        int32_t v44; // 0x8f665cb0
        int32_t v45; // 0x8f665cc4
        if (mcs_multi_sub(v31, v9, v32, v40, v38, v30, 0, a3, v8, a2, v17, v18, v30, v31) != 0) {
            int32_t v46 = v9; // 0x8f665d24
            while (mcs_multi_add(v31, v46, v16, v46, v38, v30, 0, a3, v8, a2, v17, v18, v30, v31) == 0) {
                // 0x8f665d20
                v46 = v9;
                // continue -> 0x8f665d20
            }
            // 0x8f665c48
            v7 = (v12 + 1) / 2;
            mcs_multi_convert_to_multi_digit_byte_len(g52 - v12 + a7, v18, v12, v46, v38, v30, 0, a3, v8, a2, v17, v18, v30, v31);
            v42 = a4;
            mcs_multi_multiply(v31, v9, v18, v7, v42, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23);
            v43 = v9;
            mcs_habp_rsa_mod(g54, v7 + 1 + v43, v16, v43, v42, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23, v25, a5, a6, a7, v34);
            v44 = v16;
            mcs_multi_multiply(4 * v7 + 4 + g54, v9, v17, g55, v44, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23);
            v41 = g55;
            v45 = v16 + v25;
            mcs_multi_add(v45, g52, v32, v41, v44, v30, 0, a3, v8, a2, v17, v18, v30, v31);
            v9 = 4 * g52;
            mcs_multi_convert_from_multi_digit_byte_len(v45, v34, a2, v41, v44, v30, 0, a3, v8, a2, v17, v18, v30, v31);
            mcs_memclear(v16, v9, a2, v41);
            mcs_memclear(v17, v9, a2, v41);
            mcs_memclear(v18, 2 * g52, a2, v41);
            mcs_memclear(g54, v9 + 4, a2, v41);
            // branch -> 0x8f665d40
            // 0x8f665d40
            g46 = 240;
            if (v4 != g41) {
                // 0x8f665d54
                __stack_chk_fail();
                // branch -> 0x8f665d58
            }
            // 0x8f665d58
            g52 = v1;
            g54 = v2;
            g55 = v3;
            return result;
        }
        // 0x8f665c48
        v7 = (v12 + 1) / 2;
        mcs_multi_convert_to_multi_digit_byte_len(g52 - v12 + a7, v18, v12, v40, v38, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        v42 = a4;
        mcs_multi_multiply(v31, v9, v18, v7, v42, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23);
        v43 = v9;
        mcs_habp_rsa_mod(g54, v7 + 1 + v43, v16, v43, v42, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23, v25, a5, a6, a7, v34);
        v44 = v16;
        mcs_multi_multiply(4 * v7 + 4 + g54, v9, v17, g55, v44, v30, 0, a3, v8, a2, v17, v18, v30, v31, v12, v32, a1, v10, v11, v15, v23);
        v41 = g55;
        v45 = v16 + v25;
        mcs_multi_add(v45, g52, v32, v41, v44, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        v9 = 4 * g52;
        mcs_multi_convert_from_multi_digit_byte_len(v45, v34, a2, v41, v44, v30, 0, a3, v8, a2, v17, v18, v30, v31);
        mcs_memclear(v16, v9, a2, v41);
        mcs_memclear(v17, v9, a2, v41);
        mcs_memclear(v18, 2 * g52, a2, v41);
        mcs_memclear(g54, v9 + 4, a2, v41);
        v26 = 240;
        // branch -> 0x8f665d40
    }
    // 0x8f665d40
    g46 = v26;
    if (v4 != g41) {
        // 0x8f665d54
        __stack_chk_fail();
        // branch -> 0x8f665d58
    }
    // 0x8f665d58
    g52 = v1;
    g54 = v2;
    g55 = v3;
    return result;
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// long int atol(const char * nptr);
// void free(void * ptr);
// int isdigit(int c);
// int isxdigit(int c);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strtok_r(char * restrict s, const char * restrict delim, char ** restrict save_ptr);
// int tolower(int c);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 30
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:19:08

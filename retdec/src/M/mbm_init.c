//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

// ------------------------ Structures ------------------------

struct tm {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    char * e10;
};

// ------------------- Function Prototypes --------------------

int32_t __utag_gets_constprop_3_6(char * a1, int32_t a2);
int32_t __utag_gets_constprop_5(char * a1, int32_t a2, int32_t a3);
int32_t boot_handler(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t check_wififlash_mode(char * a1, int32_t a2);
int32_t fastboot_reason(int32_t a1);
int32_t fboot_ack(char * str, char * format, int32_t a3);
int32_t get_sku(char * a1, int32_t a2);
int32_t init_boot_event(int32_t a1, int32_t a2);
int32_t load_and_validate_kernel_image(int32_t a1);
char * mbm_entry(void);
char * mbm_init(void);
int32_t select_device_tree(int32_t a1, int32_t a2);
int32_t set_boot_item(int32_t result, int32_t a2, int32_t a3);
int32_t sparse_fill_value_in_blocks(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t type_atoi_5(char * str, int32_t a2, int32_t a3);
int32_t type_atoi_7(char * str, int32_t a2, int32_t a3);
int32_t update_console_token(char * a1, char * str, char * a3);

// --------------------- Global Variables ---------------------

int32_t g24 = 0; // LR
int32_t g25 = 0; // R0
int32_t g26 = 0; // R1
int32_t g27 = 0; // R10
int32_t g28 = 0; // R11
int32_t g29 = 0; // R2
int32_t g30 = 0; // R3
int32_t g31 = 0; // R4
int32_t g32 = 0; // R5
int32_t g33 = 0; // R6
int32_t g34 = 0; // R7
int32_t g35 = 0; // R8
int32_t g36 = 0; // R9
int32_t g1 = -0x16d2bf90; // 0x8f61db1c
int32_t g2 = -0x16d2bf81; // 0x8f61dca0
int32_t g3 = -0x16d2bfc9; // 0x8f6387c0
int32_t g4 = -0x16d2bc09; // 0x8f638ab0
int32_t g5 = 0x2020003a; // 0x8f686ac4
char g6[2] = " "; // 0x8f6a4f1e
int32_t g7 = 1; // 0x8f6ac0f0
char * g10 = "\xd4\xc7\x61\x8f\x90\x15\x60\x8f"; // 0x8f6ac19c
char * g11[2] = {
    "ttyHSL0,115200,n8",
    "ttyHSL0,115200,n8"
}; // 0x8f6ac1a8
int32_t g12 = -0x709c73f8; // 0x8f6ac374
char * g13; // 0x8f6c0298
int32_t g14 = 0; // 0x8f6c02e0
int32_t g15 = 0; // 0x8f6c02ec
char * g16; // 0x8f6c0334
int32_t g17 = 0; // 0x8f7112f4
char * g18; // 0x8f7114b0
int32_t g19 = 0; // 0x8f7114b4
int32_t g20 = 0; // 0x8f7114b8
int32_t g21 = 0; // 0x8f7114d4
char * g22; // 0x8f7114f0
int32_t g23 = 0; // 0x8f7125ec
char * g8[4] = {
    "null",
    "fastboot",
    (char *)&g1,
    (char *)&g2
}; // 0x8f6ac108
char * g9[3] = {
    "fastboot",
    (char *)&g1,
    (char *)&g2
}; // 0x8f6ac10c

// ------------------------ Functions -------------------------

// Address range: 0x8f61cfe4 - 0x8f61d347
char * mbm_init(void) {
    int32_t v1 = g31; // 0x8f61cfe4
    int32_t v2 = g33; // 0x8f61cfe4
    int32_t v3 = 0; // R1
    int32_t v4 = 33; // R2
    int32_t v5;
    int32_t v6 = &v5; // 0x8f61cff8_0
    int32_t v7 = g17;
    int32_t v8 = v7; // R3
    char * set_mem = memset((char *)&v5, 0, 33); // 0x8f61d008
    int32_t str;
    int32_t timep;
    int32_t v9;
    int32_t v10;
    int32_t v11 = get_powerup_reason(set_mem, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0, 0, 0, 0); // 0x8f61d00c
    g31 = v11;
    int32_t v12 = validate_hw_type((char *)v11, v3, v4, v8); // 0x8f61d014
    int32_t v13 = fboot_oem_early_init(utags_early_init((char *)v12, v3, v4, v8, v10, v9, timep), v3, v4, v8, v10, v9); // 0x8f61d01c
    check_reboot_mode((char *)speedo_early_init((char *)v13, v3, v4, v8), v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0);
    int32_t v14; // 0x8f61d114
    int32_t v15; // 0x8f61d158
    int32_t v16; // 0x8f61d1a8
    int32_t v17; // 0x8f61d274
    int32_t v18; // 0x8f61d27427
    int32_t v19; // 0x8f61d2b0
    char * v20; // 0x8f61d2cc
    int32_t v21; // 0x8f61d158
    int32_t v22; // 0x8f61d2cc7
    int32_t v23; // 0x8f61d2cc6
    int32_t time_str; // 0x8f61d144_3
    int32_t v24; // 0x8f61d170_0
    int32_t v25; // 0x8f61d098
    int32_t v26; // 0x8f61d0a4
    int32_t v27; // 0x8f61d0bc
    int32_t v28; // 0x8f61d0d8
    int32_t v29; // 0x8f61d0ec
    int32_t v30; // 0x8f61d0f8
    int32_t v31; // 0x8f61d10c
    int32_t v32; // 0x8f61d110
    int32_t time_val; // 0x8f61d11c
    struct tm * time_info; // 0x8f61d12c
    int32_t v33; // 0x8f61d154
    int32_t v34; // 0x8f61d158
    int32_t v35; // 0x8f61d15c
    int32_t v36; // 0x8f61d160
    int32_t v37; // 0x8f61d178
    int32_t strcmp_rc; // 0x8f61d18c
    int32_t v38; // 0x8f61d1a0
    int32_t v39; // 0x8f61d1b8
    int32_t v40; // 0x8f61d1c4
    int32_t v41; // 0x8f61d1cc
    int32_t v42; // 0x8f61d1d8
    int32_t v43; // 0x8f61d1f0
    char * v44; // 0x8f61d1f8
    char * v45; // 0x8f61d210
    int32_t v46; // 0x8f61d224
    char * v47; // 0x8f61d270
    int32_t v48; // 0x8f61d274
    int32_t v49; // 0x8f61d288
    int32_t v50; // 0x8f61d28c
    int32_t v51; // 0x8f61d294
    int32_t v52; // 0x8f61d2a8
    int32_t v53; // 0x8f61d2ac
    int32_t v54; // 0x8f61d2b0
    int32_t v55; // 0x8f61d2b4
    int32_t v56; // 0x8f61d2c8
    int32_t v57; // 0x8f61d2cc
    int32_t v58; // 0x8f61d0e8
    int32_t v59; // 0x8f61d0b0
    int32_t v60; // 0x8f61d264
    int32_t v61; // 0x8f61d26c
    int32_t v62; // R5
    int32_t v63; // R7
    char * v64;
    int32_t v65; // 0x8f61d0b4
    int32_t v66; // 0x8f61d250
    int32_t v67; // 0x8f61d22c
    int32_t v68; // 0x8f61d0ac
    int32_t v69; // 0x8f61d228
    int32_t v70; // 0x8f61d25c
    int32_t v71; // 0x8f61d130
    uint32_t v72; // 0x8f61d268
    int32_t v73; // 0x8f61d244
    int32_t v74; // 0x8f61d244
    switch (g31) {
        default: {
            // 0x8f61d044
            v3 = (int32_t)"Forcing modem shutdown\n";
            int32_t v75 = shutdown_modem((char *)print_log(1, (int32_t)"Forcing modem shutdown\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5), v3, v4, v8); // 0x8f61d040
            v4 = v75;
            if (g31 == 0) {
                // 0x8f61d04c
                v3 = (int32_t)"powerup reason INVALID_TURN_ON: power down.\n";
                int32_t v76 = print_log(1, (int32_t)"powerup reason INVALID_TURN_ON: power down.\n", v75, v8, v10, v9, timep, str, 0, 0, 0, 0, v5); // 0x8f61d054
                v4 = &g7;
                int32_t v77 = g7;
                int32_t v78 = v77 + 1; // 0x8f61d060
                v8 = v78;
                g7 = v78;
                int32_t v79 = &g7; // 0x8f61d074
                int32_t v80 = v76; // 0x8f61d074
                if (v77 == 0) {
                    // 0x8f61d070
                    v78 = v8;
                    v79 = v4;
                    v80 = function_8f619448(v76);
                    // branch -> 0x8f61d074
                }
                // 0x8f61d074
                shutdown_device(platform_uninit((char *)v80, v3, v79, v78), v3, v4, v8, v10);
                // branch -> 0x8f61d07c
            }
            // 0x8f61d07c
            if (is_always_on("security_test_cert", v3, v4, v8) != 0) {
                // if_8f61d088_0_true
                v3 = (int32_t)"SRK.CA614.wtls.crt";
                g31 = (int32_t)"SRK.CA614.wtls.crt";
                v68 = (int32_t)"SRK.CA614.wtls.crt";
                // branch -> 0x8f61d0ac
                // 0x8f61d0ac
                v59 = security_policy_init((char *)v68, (int32_t)"SRK.CA614.wtls.crt", v4, v8);
                v65 = v68;
                if (v65 != 0) {
                    // 0x8f61d0bc
                    v27 = is_validation_enabled((char *)v65, v3, v59, v8);
                    if (v27 != 0) {
                        // 0x8f61d0c8
                        set_blankflash_magic((char *)v27, v3, v59, v8);
                        reboot_device("\x01\x55\x66\x77\x9c\xc1\x6a\x8f\x66\x21\x68\x8f\x86\x21\x68\x8f\x95\x21\x68\x8f\x54\x27\x68\x8f\x9e\x21\x68\x8f\xb9\x4a\x68\x8f\xc9\x21\x68\x8f\xe2\x21\x68\x8f\xfe\x21\x68\x8f\x22\x22\x68\x8f\x57\x22\x68\x8f\x79\x22\x68\x8f\x97\x22\x68\x8f\x28\x30\x9f\xe5\x07\x40\x2d\xe9", v3, v59, v8, v10, v9, timep, str, 0, 0);
                        // branch -> 0x8f61d0d4
                        while (true) {
                            // 0x8f61d0d4
                            // branch -> 0x8f61d0d4
                        }
                    }
                }
                // 0x8f61d0d8
                v28 = generic_mmc_init(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0);
                v14 = v28;
                if (v28 >= 0) {
                    // 0x8f61d0e4
                    v58 = set_gpt_opts((char *)&g10, v3, v59, v8);
                    v3 = v58;
                    v29 = init_gpt((int32_t)&g10, v58, v59, v8, v10, v9, timep, str, 0, 0, 0);
                    if (v29 == 0) {
                        // 0x8f61d0f8
                        v30 = validate_gpt_partition(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                        if (v30 != 0) {
                            // 0x8f61d104
                            v3 = (int32_t)"Invalid GPT, please re-flash it";
                            v31 = print_log(4, (int32_t)"Invalid GPT, please re-flash it", v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v32 = uninit_gpt((char *)v31, v3, v59, v8, v10, v9, timep, str, 0, 0);
                            v14 = v32;
                            // branch -> 0x8f61d114
                        } else {
                            v14 = 0;
                        }
                    } else {
                        v14 = v29;
                    }
                }
                // 0x8f61d114
                logger_init((char *)v14, v3, v59, v8, v10, v9, timep);
                time_val = time(NULL);
                v8 = &timep;
                timep = time_val;
                time_info = gmtime(&timep);
                v71 = timep;
                v4 = v71;
                v21 = -1;
                v15 = (int32_t)time_info;
                if (v71 != -1) {
                    // 0x8f61d13c
                    if (time_info != NULL) {
                        // 0x8f61d144
                        time_str = (int32_t)asctime(time_info);
                        v3 = (int32_t)"Time is: \"%s\"\n";
                        v4 = time_str;
                        v33 = print_log(1, (int32_t)"Time is: \"%s\"\n", time_str, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v21 = v4;
                        v15 = v33;
                        // branch -> 0x8f61d158
                    } else {
                        v21 = v71;
                        v15 = 0;
                    }
                }
                // 0x8f61d158
                v34 = fboot_oem_init(v15, v3, v21, v8, v10, v9);
                v35 = hlos_iface_init(v34, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v36 = factory_kill_is_supported((char *)v35, v3, v4, v8, v10, v9, timep);
                v16 = v36;
                if (v36 == 0) {
                    // 0x8f61d16c
                    v24 = &str;
                    v3 = v24;
                    v4 = 17;
                    v37 = __utag_gets_constprop_4_4("bootmode", v24, 17, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                    if (v37 != 0) {
                        // 0x8f61d184
                        v3 = (int32_t)"factory";
                        strcmp_rc = strcmp((char *)&str, "factory");
                        if (strcmp_rc == 0) {
                            // 0x8f61d198
                            v3 = (int32_t)"Configuring device power for factory mode\n";
                            v38 = print_log(1, (int32_t)"Configuring device power for factory mode\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v16 = target_fact_cbl_setup((char *)v38, v3, v4, v8);
                            // branch -> 0x8f61d1a8
                        } else {
                            v16 = strcmp_rc;
                        }
                    } else {
                        v16 = 0;
                    }
                }
                // 0x8f61d1a8
                target_get_reset_status((char *)v16, v3, v4, v8);
                v3 = v6;
                v4 = 33;
                v39 = __utag_gets_constprop_4_4("device", v6, 33, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                v22 = v10;
                v23 = v9;
                if (v39 == 0) {
                    // 0x8f61d274
                    if (is_validation_enabled((char *)0, v3, v4, v8) == 0) {
                        // 0x8f61d294
                        v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                        if (v51 == 0) {
                            // 0x8f61d2a0
                            v3 = (int32_t)"Enabling RAM dump by default\n";
                            v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                            v19 = v53;
                            // branch -> 0x8f61d2b0
                        } else {
                            v19 = v51;
                        }
                    } else {
                        // 0x8f61d280
                        v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                        v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                        v19 = v50;
                        // branch -> 0x8f61d2b0
                    }
                    // 0x8f61d2b0
                    v54 = sod_update((char *)v19, v3, v4, v8);
                    v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                    v20 = NULL;
                    if (v55 != 0) {
                        // 0x8f61d2c0
                        v3 = (int32_t)"RAM dump is enabled\n";
                        v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v20 = (char *)v56;
                        // branch -> 0x8f61d2cc
                    }
                    // 0x8f61d2cc
                    v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                    if (v7 != g17) {
                        // 0x8f61d2e0
                        __stack_chk_fail();
                        // branch -> 0x8f61d2e4
                    }
                    // 0x8f61d2e4
                    g31 = v1;
                    g33 = v2;
                    return (char *)v57;
                }
                // 0x8f61d1c4
                v40 = target_mot_prod_id((char *)v39, v3, v4, v8);
                v63 = v40;
                v41 = target_mot_hw_id((char *)v40, v3, v4, v8, v10, v9, timep);
                g33 = v41;
                v42 = get_product_id_by_name((char *)&v5, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                v62 = v6;
                if (v42 > -1) {
                    // 0x8f61d1f8
                    v44 = hwrev_from_utag(v42, v3, v4, v8, v10, v9);
                    v3 = v6;
                    if (v44 != NULL) {
                        // 0x8f61d20c
                        v45 = get_hw_id_by_rev((char *)&v5, v6, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        g31 = v6;
                        if (v45 > (char *)-1) {
                            // 0x8f61d20c
                            v18 = (int32_t)v45;
                            v73 = v6;
                            v74 = g33;
                            // branch -> 0x8f61d22c
                        } else {
                            // 0x8f61d21c
                            v3 = (int32_t)"Mismatched product and hw revision\n";
                            // branch -> 0x8f61d224
                            // 0x8f61d224
                            v46 = print_log(-1, (int32_t)"Mismatched product and hw revision\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v69 = g33;
                            g31 = v69;
                            v18 = v46;
                            v73 = v69;
                            v74 = v69;
                            // branch -> 0x8f61d22c
                        }
                        // 0x8f61d22c
                        v67 = v63;
                        v17 = v18;
                        v22 = v10;
                        v23 = v9;
                        if (v73 != v74 || v62 != v67) {
                            // 0x8f61d238
                            v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                            v8 = v67;
                            print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                            v66 = v62;
                            v70 = v66;
                            if (v66 == 0) {
                                // if_8f61d254_0_true
                                v70 = v63;
                                // branch -> after_if_8f61d254_0
                            }
                            // after_if_8f61d254_0
                            v64 = (char *)(v70 % 256);
                            if (g31 == 0) {
                                // if_8f61d260_0_true
                                g31 = g33;
                                // branch -> after_if_8f61d260_0
                            }
                            // after_if_8f61d260_0
                            v60 = target_set_prod_id(v64, v3, v6, v8);
                            v72 = g31 % 256;
                            v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                            v4 = v61;
                            v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                            v17 = (int32_t)v47;
                            v22 = v73;
                            v23 = v74;
                            // branch -> 0x8f61d274
                        }
                        // 0x8f61d274
                        v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                        if (v48 == 0) {
                            // 0x8f61d294
                            v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                            if (v51 == 0) {
                                // 0x8f61d2a0
                                v3 = (int32_t)"Enabling RAM dump by default\n";
                                v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                                v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                                v19 = v53;
                                // branch -> 0x8f61d2b0
                            } else {
                                v19 = v51;
                            }
                        } else {
                            // 0x8f61d280
                            v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                            v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                            v19 = v50;
                            // branch -> 0x8f61d2b0
                        }
                        // 0x8f61d2b0
                        v54 = sod_update((char *)v19, v3, v4, v8);
                        v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                        v20 = NULL;
                        if (v55 != 0) {
                            // 0x8f61d2c0
                            v3 = (int32_t)"RAM dump is enabled\n";
                            v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v20 = (char *)v56;
                            // branch -> 0x8f61d2cc
                        }
                        // 0x8f61d2cc
                        v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                        if (v7 != g17) {
                            // 0x8f61d2e0
                            __stack_chk_fail();
                            // branch -> 0x8f61d2e4
                        }
                        // 0x8f61d2e4
                        g31 = v1;
                        g33 = v2;
                        return (char *)v57;
                    }
                    // if_8f61d200_0_true
                    v3 = (int32_t)"No HW REV defined in utags\n";
                    // branch -> 0x8f61d224
                    // 0x8f61d224
                    v46 = print_log(2, (int32_t)"No HW REV defined in utags\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v69 = g33;
                    g31 = v69;
                    v73 = v69;
                    v74 = v69;
                    // branch -> 0x8f61d22c
                    // 0x8f61d22c
                    v67 = v63;
                    if (v73 != v74 || v62 != v67) {
                        // 0x8f61d238
                        v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                        v8 = v67;
                        print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                        v66 = v62;
                        v70 = v66;
                        if (v66 == 0) {
                            // if_8f61d254_0_true
                            v70 = v63;
                            // branch -> after_if_8f61d254_0
                        }
                        // after_if_8f61d254_0
                        v64 = (char *)(v70 % 256);
                        if (g31 == 0) {
                            // if_8f61d260_0_true
                            g31 = g33;
                            // branch -> after_if_8f61d260_0
                        }
                        // after_if_8f61d260_0
                        v60 = target_set_prod_id(v64, v3, v6, v8);
                        v72 = g31 % 256;
                        v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                        v4 = v61;
                        v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                        v17 = (int32_t)v47;
                        v22 = v73;
                        v23 = v74;
                        // branch -> 0x8f61d274
                    } else {
                        v17 = v46;
                        v22 = v10;
                        v23 = v9;
                    }
                } else {
                    // 0x8f61d1e4
                    v3 = (int32_t)"Invalid product name %s\n";
                    v4 = v6;
                    v43 = print_log(-1, (int32_t)"Invalid product name %s\n", v6, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v17 = v43;
                    v22 = v10;
                    v23 = v9;
                    // branch -> 0x8f61d274
                }
                // 0x8f61d274
                v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                if (v48 == 0) {
                    // 0x8f61d294
                    v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                    if (v51 == 0) {
                        // 0x8f61d2a0
                        v3 = (int32_t)"Enabling RAM dump by default\n";
                        v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                        v19 = v53;
                        // branch -> 0x8f61d2b0
                    } else {
                        v19 = v51;
                    }
                } else {
                    // 0x8f61d280
                    v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                    v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                    v19 = v50;
                    // branch -> 0x8f61d2b0
                }
                // 0x8f61d2b0
                v54 = sod_update((char *)v19, v3, v4, v8);
                v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                v20 = NULL;
                if (v55 != 0) {
                    // 0x8f61d2c0
                    v3 = (int32_t)"RAM dump is enabled\n";
                    v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v20 = (char *)v56;
                    // branch -> 0x8f61d2cc
                }
                // 0x8f61d2cc
                v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                if (v7 != g17) {
                    // 0x8f61d2e0
                    __stack_chk_fail();
                    // branch -> 0x8f61d2e4
                }
                // 0x8f61d2e4
                g31 = v1;
                g33 = v2;
                return (char *)v57;
            }
            // 0x8f61d094
            v25 = get_srk_name("boot_srk", v3, v4, v8, v10, v9, timep);
            g31 = v25;
            v26 = get_srk_name("ap_srk", v3, v4, v8, v10, v9, timep);
            v3 = v26;
            v68 = g31;
            // branch -> 0x8f61d0ac
            // 0x8f61d0ac
            v59 = security_policy_init((char *)v68, v26, v4, v8);
            v65 = v68;
            if (v65 != 0) {
                // 0x8f61d0bc
                v27 = is_validation_enabled((char *)v65, v3, v59, v8);
                if (v27 != 0) {
                    // 0x8f61d0c8
                    set_blankflash_magic((char *)v27, v3, v59, v8);
                    reboot_device("\x01\x55\x66\x77\x9c\xc1\x6a\x8f\x66\x21\x68\x8f\x86\x21\x68\x8f\x95\x21\x68\x8f\x54\x27\x68\x8f\x9e\x21\x68\x8f\xb9\x4a\x68\x8f\xc9\x21\x68\x8f\xe2\x21\x68\x8f\xfe\x21\x68\x8f\x22\x22\x68\x8f\x57\x22\x68\x8f\x79\x22\x68\x8f\x97\x22\x68\x8f\x28\x30\x9f\xe5\x07\x40\x2d\xe9", v3, v59, v8, v10, v9, timep, str, 0, 0);
                    // branch -> 0x8f61d0d4
                    while (true) {
                        // 0x8f61d0d4
                        // branch -> 0x8f61d0d4
                    }
                }
            }
            // 0x8f61d0d8
            v28 = generic_mmc_init(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0);
            v14 = v28;
            if (v28 >= 0) {
                // 0x8f61d0e4
                v58 = set_gpt_opts((char *)&g10, v3, v59, v8);
                v3 = v58;
                v29 = init_gpt((int32_t)&g10, v58, v59, v8, v10, v9, timep, str, 0, 0, 0);
                if (v29 == 0) {
                    // 0x8f61d0f8
                    v30 = validate_gpt_partition(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                    if (v30 != 0) {
                        // 0x8f61d104
                        v3 = (int32_t)"Invalid GPT, please re-flash it";
                        v31 = print_log(4, (int32_t)"Invalid GPT, please re-flash it", v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v32 = uninit_gpt((char *)v31, v3, v59, v8, v10, v9, timep, str, 0, 0);
                        v14 = v32;
                        // branch -> 0x8f61d114
                    } else {
                        v14 = 0;
                    }
                } else {
                    v14 = v29;
                }
            }
            // 0x8f61d114
            logger_init((char *)v14, v3, v59, v8, v10, v9, timep);
            time_val = time(NULL);
            v8 = &timep;
            timep = time_val;
            time_info = gmtime(&timep);
            v71 = timep;
            v4 = v71;
            v21 = -1;
            v15 = (int32_t)time_info;
            if (v71 != -1) {
                // 0x8f61d13c
                if (time_info != NULL) {
                    // 0x8f61d144
                    time_str = (int32_t)asctime(time_info);
                    v3 = (int32_t)"Time is: \"%s\"\n";
                    v4 = time_str;
                    v33 = print_log(1, (int32_t)"Time is: \"%s\"\n", time_str, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v21 = v4;
                    v15 = v33;
                    // branch -> 0x8f61d158
                } else {
                    v21 = v71;
                    v15 = 0;
                }
            }
            // 0x8f61d158
            v34 = fboot_oem_init(v15, v3, v21, v8, v10, v9);
            v35 = hlos_iface_init(v34, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
            v36 = factory_kill_is_supported((char *)v35, v3, v4, v8, v10, v9, timep);
            v16 = v36;
            if (v36 == 0) {
                // 0x8f61d16c
                v24 = &str;
                v3 = v24;
                v4 = 17;
                v37 = __utag_gets_constprop_4_4("bootmode", v24, 17, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                if (v37 != 0) {
                    // 0x8f61d184
                    v3 = (int32_t)"factory";
                    strcmp_rc = strcmp((char *)&str, "factory");
                    if (strcmp_rc == 0) {
                        // 0x8f61d198
                        v3 = (int32_t)"Configuring device power for factory mode\n";
                        v38 = print_log(1, (int32_t)"Configuring device power for factory mode\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v16 = target_fact_cbl_setup((char *)v38, v3, v4, v8);
                        // branch -> 0x8f61d1a8
                    } else {
                        v16 = strcmp_rc;
                    }
                } else {
                    v16 = 0;
                }
            }
            // 0x8f61d1a8
            target_get_reset_status((char *)v16, v3, v4, v8);
            v3 = v6;
            v4 = 33;
            v39 = __utag_gets_constprop_4_4("device", v6, 33, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
            v22 = v10;
            v23 = v9;
            if (v39 == 0) {
                // 0x8f61d274
                if (is_validation_enabled((char *)0, v3, v4, v8) == 0) {
                    // 0x8f61d294
                    v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                    if (v51 == 0) {
                        // 0x8f61d2a0
                        v3 = (int32_t)"Enabling RAM dump by default\n";
                        v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                        v19 = v53;
                        // branch -> 0x8f61d2b0
                    } else {
                        v19 = v51;
                    }
                } else {
                    // 0x8f61d280
                    v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                    v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                    v19 = v50;
                    // branch -> 0x8f61d2b0
                }
                // 0x8f61d2b0
                v54 = sod_update((char *)v19, v3, v4, v8);
                v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                v20 = NULL;
                if (v55 != 0) {
                    // 0x8f61d2c0
                    v3 = (int32_t)"RAM dump is enabled\n";
                    v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v20 = (char *)v56;
                    // branch -> 0x8f61d2cc
                }
                // 0x8f61d2cc
                v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                if (v7 != g17) {
                    // 0x8f61d2e0
                    __stack_chk_fail();
                    // branch -> 0x8f61d2e4
                }
                // 0x8f61d2e4
                g31 = v1;
                g33 = v2;
                return (char *)v57;
            }
            // 0x8f61d1c4
            v40 = target_mot_prod_id((char *)v39, v3, v4, v8);
            v63 = v40;
            v41 = target_mot_hw_id((char *)v40, v3, v4, v8, v10, v9, timep);
            g33 = v41;
            v42 = get_product_id_by_name((char *)&v5, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
            v62 = v6;
            if (v42 > -1) {
                // 0x8f61d1f8
                v44 = hwrev_from_utag(v42, v3, v4, v8, v10, v9);
                v3 = v6;
                if (v44 != NULL) {
                    // 0x8f61d20c
                    v45 = get_hw_id_by_rev((char *)&v5, v6, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    g31 = v6;
                    if (v45 > (char *)-1) {
                        // 0x8f61d20c
                        v18 = (int32_t)v45;
                        v73 = v6;
                        v74 = g33;
                        // branch -> 0x8f61d22c
                    } else {
                        // 0x8f61d21c
                        v3 = (int32_t)"Mismatched product and hw revision\n";
                        // branch -> 0x8f61d224
                        // 0x8f61d224
                        v46 = print_log(-1, (int32_t)"Mismatched product and hw revision\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v69 = g33;
                        g31 = v69;
                        v18 = v46;
                        v73 = v69;
                        v74 = v69;
                        // branch -> 0x8f61d22c
                    }
                    // 0x8f61d22c
                    v67 = v63;
                    v17 = v18;
                    v22 = v10;
                    v23 = v9;
                    if (v73 != v74 || v62 != v67) {
                        // 0x8f61d238
                        v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                        v8 = v67;
                        print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                        v66 = v62;
                        v70 = v66;
                        if (v66 == 0) {
                            // if_8f61d254_0_true
                            v70 = v63;
                            // branch -> after_if_8f61d254_0
                        }
                        // after_if_8f61d254_0
                        v64 = (char *)(v70 % 256);
                        if (g31 == 0) {
                            // if_8f61d260_0_true
                            g31 = g33;
                            // branch -> after_if_8f61d260_0
                        }
                        // after_if_8f61d260_0
                        v60 = target_set_prod_id(v64, v3, v6, v8);
                        v72 = g31 % 256;
                        v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                        v4 = v61;
                        v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                        v17 = (int32_t)v47;
                        v22 = v73;
                        v23 = v74;
                        // branch -> 0x8f61d274
                    }
                    // 0x8f61d274
                    v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                    if (v48 == 0) {
                        // 0x8f61d294
                        v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                        if (v51 == 0) {
                            // 0x8f61d2a0
                            v3 = (int32_t)"Enabling RAM dump by default\n";
                            v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                            v19 = v53;
                            // branch -> 0x8f61d2b0
                        } else {
                            v19 = v51;
                        }
                    } else {
                        // 0x8f61d280
                        v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                        v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                        v19 = v50;
                        // branch -> 0x8f61d2b0
                    }
                    // 0x8f61d2b0
                    v54 = sod_update((char *)v19, v3, v4, v8);
                    v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                    v20 = NULL;
                    if (v55 != 0) {
                        // 0x8f61d2c0
                        v3 = (int32_t)"RAM dump is enabled\n";
                        v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v20 = (char *)v56;
                        // branch -> 0x8f61d2cc
                    }
                    // 0x8f61d2cc
                    v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                    if (v7 != g17) {
                        // 0x8f61d2e0
                        __stack_chk_fail();
                        // branch -> 0x8f61d2e4
                    }
                    // 0x8f61d2e4
                    g31 = v1;
                    g33 = v2;
                    return (char *)v57;
                }
                // if_8f61d200_0_true
                v3 = (int32_t)"No HW REV defined in utags\n";
                // branch -> 0x8f61d224
                // 0x8f61d224
                v46 = print_log(2, (int32_t)"No HW REV defined in utags\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v69 = g33;
                g31 = v69;
                v73 = v69;
                v74 = v69;
                // branch -> 0x8f61d22c
                // 0x8f61d22c
                v67 = v63;
                if (v73 != v74 || v62 != v67) {
                    // 0x8f61d238
                    v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                    v8 = v67;
                    print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                    v66 = v62;
                    v70 = v66;
                    if (v66 == 0) {
                        // if_8f61d254_0_true
                        v70 = v63;
                        // branch -> after_if_8f61d254_0
                    }
                    // after_if_8f61d254_0
                    v64 = (char *)(v70 % 256);
                    if (g31 == 0) {
                        // if_8f61d260_0_true
                        g31 = g33;
                        // branch -> after_if_8f61d260_0
                    }
                    // after_if_8f61d260_0
                    v60 = target_set_prod_id(v64, v3, v6, v8);
                    v72 = g31 % 256;
                    v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                    v4 = v61;
                    v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                    v17 = (int32_t)v47;
                    v22 = v73;
                    v23 = v74;
                    // branch -> 0x8f61d274
                } else {
                    v17 = v46;
                    v22 = v10;
                    v23 = v9;
                }
            } else {
                // 0x8f61d1e4
                v3 = (int32_t)"Invalid product name %s\n";
                v4 = v6;
                v43 = print_log(-1, (int32_t)"Invalid product name %s\n", v6, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v17 = v43;
                v22 = v10;
                v23 = v9;
                // branch -> 0x8f61d274
            }
            // 0x8f61d274
            v48 = is_validation_enabled((char *)v17, v3, v4, v8);
            if (v48 == 0) {
                // 0x8f61d294
                v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                if (v51 == 0) {
                    // 0x8f61d2a0
                    v3 = (int32_t)"Enabling RAM dump by default\n";
                    v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                    v19 = v53;
                    // branch -> 0x8f61d2b0
                } else {
                    v19 = v51;
                }
            } else {
                // 0x8f61d280
                v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                v19 = v50;
                // branch -> 0x8f61d2b0
            }
            // 0x8f61d2b0
            v54 = sod_update((char *)v19, v3, v4, v8);
            v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
            v20 = NULL;
            if (v55 != 0) {
                // 0x8f61d2c0
                v3 = (int32_t)"RAM dump is enabled\n";
                v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                v20 = (char *)v56;
                // branch -> 0x8f61d2cc
            }
            // 0x8f61d2cc
            v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
            if (v7 != g17) {
                // 0x8f61d2e0
                __stack_chk_fail();
                // branch -> 0x8f61d2e4
            }
            // 0x8f61d2e4
            g31 = v1;
            g33 = v2;
            return (char *)v57;
        }
        case 0x20000: {
            // 0x8f61d07c
            if (is_always_on("security_test_cert", v3, v4, v8) != 0) {
                // if_8f61d088_0_true
                v3 = (int32_t)"SRK.CA614.wtls.crt";
                g31 = (int32_t)"SRK.CA614.wtls.crt";
                v68 = (int32_t)"SRK.CA614.wtls.crt";
                // branch -> 0x8f61d0ac
                // 0x8f61d0ac
                v59 = security_policy_init((char *)v68, (int32_t)"SRK.CA614.wtls.crt", v4, v8);
                v65 = v68;
                if (v65 != 0) {
                    // 0x8f61d0bc
                    v27 = is_validation_enabled((char *)v65, v3, v59, v8);
                    if (v27 != 0) {
                        // 0x8f61d0c8
                        set_blankflash_magic((char *)v27, v3, v59, v8);
                        reboot_device("\x01\x55\x66\x77\x9c\xc1\x6a\x8f\x66\x21\x68\x8f\x86\x21\x68\x8f\x95\x21\x68\x8f\x54\x27\x68\x8f\x9e\x21\x68\x8f\xb9\x4a\x68\x8f\xc9\x21\x68\x8f\xe2\x21\x68\x8f\xfe\x21\x68\x8f\x22\x22\x68\x8f\x57\x22\x68\x8f\x79\x22\x68\x8f\x97\x22\x68\x8f\x28\x30\x9f\xe5\x07\x40\x2d\xe9", v3, v59, v8, v10, v9, timep, str, 0, 0);
                        // branch -> 0x8f61d0d4
                        while (true) {
                            // 0x8f61d0d4
                            // branch -> 0x8f61d0d4
                        }
                    }
                }
                // 0x8f61d0d8
                v28 = generic_mmc_init(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0);
                v14 = v28;
                if (v28 >= 0) {
                    // 0x8f61d0e4
                    v58 = set_gpt_opts((char *)&g10, v3, v59, v8);
                    v3 = v58;
                    v29 = init_gpt((int32_t)&g10, v58, v59, v8, v10, v9, timep, str, 0, 0, 0);
                    if (v29 == 0) {
                        // 0x8f61d0f8
                        v30 = validate_gpt_partition(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                        if (v30 != 0) {
                            // 0x8f61d104
                            v3 = (int32_t)"Invalid GPT, please re-flash it";
                            v31 = print_log(4, (int32_t)"Invalid GPT, please re-flash it", v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v32 = uninit_gpt((char *)v31, v3, v59, v8, v10, v9, timep, str, 0, 0);
                            v14 = v32;
                            // branch -> 0x8f61d114
                        } else {
                            v14 = 0;
                        }
                    } else {
                        v14 = v29;
                    }
                }
                // 0x8f61d114
                logger_init((char *)v14, v3, v59, v8, v10, v9, timep);
                time_val = time(NULL);
                v8 = &timep;
                timep = time_val;
                time_info = gmtime(&timep);
                v71 = timep;
                v4 = v71;
                v21 = -1;
                v15 = (int32_t)time_info;
                if (v71 != -1) {
                    // 0x8f61d13c
                    if (time_info != NULL) {
                        // 0x8f61d144
                        time_str = (int32_t)asctime(time_info);
                        v3 = (int32_t)"Time is: \"%s\"\n";
                        v4 = time_str;
                        v33 = print_log(1, (int32_t)"Time is: \"%s\"\n", time_str, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v21 = v4;
                        v15 = v33;
                        // branch -> 0x8f61d158
                    } else {
                        v21 = v71;
                        v15 = 0;
                    }
                }
                // 0x8f61d158
                v34 = fboot_oem_init(v15, v3, v21, v8, v10, v9);
                v35 = hlos_iface_init(v34, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v36 = factory_kill_is_supported((char *)v35, v3, v4, v8, v10, v9, timep);
                v16 = v36;
                if (v36 == 0) {
                    // 0x8f61d16c
                    v24 = &str;
                    v3 = v24;
                    v4 = 17;
                    v37 = __utag_gets_constprop_4_4("bootmode", v24, 17, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                    if (v37 != 0) {
                        // 0x8f61d184
                        v3 = (int32_t)"factory";
                        strcmp_rc = strcmp((char *)&str, "factory");
                        if (strcmp_rc == 0) {
                            // 0x8f61d198
                            v3 = (int32_t)"Configuring device power for factory mode\n";
                            v38 = print_log(1, (int32_t)"Configuring device power for factory mode\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v16 = target_fact_cbl_setup((char *)v38, v3, v4, v8);
                            // branch -> 0x8f61d1a8
                        } else {
                            v16 = strcmp_rc;
                        }
                    } else {
                        v16 = 0;
                    }
                }
                // 0x8f61d1a8
                target_get_reset_status((char *)v16, v3, v4, v8);
                v3 = v6;
                v4 = 33;
                v39 = __utag_gets_constprop_4_4("device", v6, 33, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                v22 = v10;
                v23 = v9;
                if (v39 == 0) {
                    // 0x8f61d274
                    if (is_validation_enabled((char *)0, v3, v4, v8) == 0) {
                        // 0x8f61d294
                        v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                        if (v51 == 0) {
                            // 0x8f61d2a0
                            v3 = (int32_t)"Enabling RAM dump by default\n";
                            v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                            v19 = v53;
                            // branch -> 0x8f61d2b0
                        } else {
                            v19 = v51;
                        }
                    } else {
                        // 0x8f61d280
                        v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                        v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                        v19 = v50;
                        // branch -> 0x8f61d2b0
                    }
                    // 0x8f61d2b0
                    v54 = sod_update((char *)v19, v3, v4, v8);
                    v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                    v20 = NULL;
                    if (v55 != 0) {
                        // 0x8f61d2c0
                        v3 = (int32_t)"RAM dump is enabled\n";
                        v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v20 = (char *)v56;
                        // branch -> 0x8f61d2cc
                    }
                    // 0x8f61d2cc
                    v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                    if (v7 != g17) {
                        // 0x8f61d2e0
                        __stack_chk_fail();
                        // branch -> 0x8f61d2e4
                    }
                    // 0x8f61d2e4
                    g31 = v1;
                    g33 = v2;
                    return (char *)v57;
                }
                // 0x8f61d1c4
                v40 = target_mot_prod_id((char *)v39, v3, v4, v8);
                v63 = v40;
                v41 = target_mot_hw_id((char *)v40, v3, v4, v8, v10, v9, timep);
                g33 = v41;
                v42 = get_product_id_by_name((char *)&v5, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                v62 = v6;
                if (v42 > -1) {
                    // 0x8f61d1f8
                    v44 = hwrev_from_utag(v42, v3, v4, v8, v10, v9);
                    v3 = v6;
                    if (v44 != NULL) {
                        // 0x8f61d20c
                        v45 = get_hw_id_by_rev((char *)&v5, v6, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        g31 = v6;
                        if (v45 > (char *)-1) {
                            // 0x8f61d20c
                            v18 = (int32_t)v45;
                            v73 = v6;
                            v74 = g33;
                            // branch -> 0x8f61d22c
                        } else {
                            // 0x8f61d21c
                            v3 = (int32_t)"Mismatched product and hw revision\n";
                            // branch -> 0x8f61d224
                            // 0x8f61d224
                            v46 = print_log(-1, (int32_t)"Mismatched product and hw revision\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v69 = g33;
                            g31 = v69;
                            v18 = v46;
                            v73 = v69;
                            v74 = v69;
                            // branch -> 0x8f61d22c
                        }
                        // 0x8f61d22c
                        v67 = v63;
                        v17 = v18;
                        v22 = v10;
                        v23 = v9;
                        if (v73 != v74 || v62 != v67) {
                            // 0x8f61d238
                            v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                            v8 = v67;
                            print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                            v66 = v62;
                            v70 = v66;
                            if (v66 == 0) {
                                // if_8f61d254_0_true
                                v70 = v63;
                                // branch -> after_if_8f61d254_0
                            }
                            // after_if_8f61d254_0
                            v64 = (char *)(v70 % 256);
                            if (g31 == 0) {
                                // if_8f61d260_0_true
                                g31 = g33;
                                // branch -> after_if_8f61d260_0
                            }
                            // after_if_8f61d260_0
                            v60 = target_set_prod_id(v64, v3, v6, v8);
                            v72 = g31 % 256;
                            v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                            v4 = v61;
                            v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                            v17 = (int32_t)v47;
                            v22 = v73;
                            v23 = v74;
                            // branch -> 0x8f61d274
                        }
                        // 0x8f61d274
                        v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                        if (v48 == 0) {
                            // 0x8f61d294
                            v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                            if (v51 == 0) {
                                // 0x8f61d2a0
                                v3 = (int32_t)"Enabling RAM dump by default\n";
                                v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                                v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                                v19 = v53;
                                // branch -> 0x8f61d2b0
                            } else {
                                v19 = v51;
                            }
                        } else {
                            // 0x8f61d280
                            v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                            v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                            v19 = v50;
                            // branch -> 0x8f61d2b0
                        }
                        // 0x8f61d2b0
                        v54 = sod_update((char *)v19, v3, v4, v8);
                        v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                        v20 = NULL;
                        if (v55 != 0) {
                            // 0x8f61d2c0
                            v3 = (int32_t)"RAM dump is enabled\n";
                            v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v20 = (char *)v56;
                            // branch -> 0x8f61d2cc
                        }
                        // 0x8f61d2cc
                        v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                        if (v7 != g17) {
                            // 0x8f61d2e0
                            __stack_chk_fail();
                            // branch -> 0x8f61d2e4
                        }
                        // 0x8f61d2e4
                        g31 = v1;
                        g33 = v2;
                        return (char *)v57;
                    }
                    // if_8f61d200_0_true
                    v3 = (int32_t)"No HW REV defined in utags\n";
                    // branch -> 0x8f61d224
                    // 0x8f61d224
                    v46 = print_log(2, (int32_t)"No HW REV defined in utags\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v69 = g33;
                    g31 = v69;
                    v73 = v69;
                    v74 = v69;
                    // branch -> 0x8f61d22c
                    // 0x8f61d22c
                    v67 = v63;
                    if (v73 != v74 || v62 != v67) {
                        // 0x8f61d238
                        v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                        v8 = v67;
                        print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                        v66 = v62;
                        v70 = v66;
                        if (v66 == 0) {
                            // if_8f61d254_0_true
                            v70 = v63;
                            // branch -> after_if_8f61d254_0
                        }
                        // after_if_8f61d254_0
                        v64 = (char *)(v70 % 256);
                        if (g31 == 0) {
                            // if_8f61d260_0_true
                            g31 = g33;
                            // branch -> after_if_8f61d260_0
                        }
                        // after_if_8f61d260_0
                        v60 = target_set_prod_id(v64, v3, v6, v8);
                        v72 = g31 % 256;
                        v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                        v4 = v61;
                        v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                        v17 = (int32_t)v47;
                        v22 = v73;
                        v23 = v74;
                        // branch -> 0x8f61d274
                    } else {
                        v17 = v46;
                        v22 = v10;
                        v23 = v9;
                    }
                } else {
                    // 0x8f61d1e4
                    v3 = (int32_t)"Invalid product name %s\n";
                    v4 = v6;
                    v43 = print_log(-1, (int32_t)"Invalid product name %s\n", v6, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v17 = v43;
                    v22 = v10;
                    v23 = v9;
                    // branch -> 0x8f61d274
                }
                // 0x8f61d274
                v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                if (v48 == 0) {
                    // 0x8f61d294
                    v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                    if (v51 == 0) {
                        // 0x8f61d2a0
                        v3 = (int32_t)"Enabling RAM dump by default\n";
                        v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                        v19 = v53;
                        // branch -> 0x8f61d2b0
                    } else {
                        v19 = v51;
                    }
                } else {
                    // 0x8f61d280
                    v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                    v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                    v19 = v50;
                    // branch -> 0x8f61d2b0
                }
                // 0x8f61d2b0
                v54 = sod_update((char *)v19, v3, v4, v8);
                v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                v20 = NULL;
                if (v55 != 0) {
                    // 0x8f61d2c0
                    v3 = (int32_t)"RAM dump is enabled\n";
                    v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v20 = (char *)v56;
                    // branch -> 0x8f61d2cc
                }
                // 0x8f61d2cc
                v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                if (v7 != g17) {
                    // 0x8f61d2e0
                    __stack_chk_fail();
                    // branch -> 0x8f61d2e4
                }
                // 0x8f61d2e4
                g31 = v1;
                g33 = v2;
                return (char *)v57;
            }
            // 0x8f61d094
            v25 = get_srk_name("boot_srk", v3, v4, v8, v10, v9, timep);
            g31 = v25;
            v26 = get_srk_name("ap_srk", v3, v4, v8, v10, v9, timep);
            v3 = v26;
            v68 = g31;
            // branch -> 0x8f61d0ac
            // 0x8f61d0ac
            v59 = security_policy_init((char *)v68, v26, v4, v8);
            v65 = v68;
            if (v65 != 0) {
                // 0x8f61d0bc
                v27 = is_validation_enabled((char *)v65, v3, v59, v8);
                if (v27 != 0) {
                    // 0x8f61d0c8
                    set_blankflash_magic((char *)v27, v3, v59, v8);
                    reboot_device("\x01\x55\x66\x77\x9c\xc1\x6a\x8f\x66\x21\x68\x8f\x86\x21\x68\x8f\x95\x21\x68\x8f\x54\x27\x68\x8f\x9e\x21\x68\x8f\xb9\x4a\x68\x8f\xc9\x21\x68\x8f\xe2\x21\x68\x8f\xfe\x21\x68\x8f\x22\x22\x68\x8f\x57\x22\x68\x8f\x79\x22\x68\x8f\x97\x22\x68\x8f\x28\x30\x9f\xe5\x07\x40\x2d\xe9", v3, v59, v8, v10, v9, timep, str, 0, 0);
                    // branch -> 0x8f61d0d4
                    while (true) {
                        // 0x8f61d0d4
                        // branch -> 0x8f61d0d4
                    }
                }
            }
            // 0x8f61d0d8
            v28 = generic_mmc_init(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0);
            v14 = v28;
            if (v28 >= 0) {
                // 0x8f61d0e4
                v58 = set_gpt_opts((char *)&g10, v3, v59, v8);
                v3 = v58;
                v29 = init_gpt((int32_t)&g10, v58, v59, v8, v10, v9, timep, str, 0, 0, 0);
                if (v29 == 0) {
                    // 0x8f61d0f8
                    v30 = validate_gpt_partition(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                    if (v30 != 0) {
                        // 0x8f61d104
                        v3 = (int32_t)"Invalid GPT, please re-flash it";
                        v31 = print_log(4, (int32_t)"Invalid GPT, please re-flash it", v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v32 = uninit_gpt((char *)v31, v3, v59, v8, v10, v9, timep, str, 0, 0);
                        v14 = v32;
                        // branch -> 0x8f61d114
                    } else {
                        v14 = 0;
                    }
                } else {
                    v14 = v29;
                }
            }
            // 0x8f61d114
            logger_init((char *)v14, v3, v59, v8, v10, v9, timep);
            time_val = time(NULL);
            v8 = &timep;
            timep = time_val;
            time_info = gmtime(&timep);
            v71 = timep;
            v4 = v71;
            v21 = -1;
            v15 = (int32_t)time_info;
            if (v71 != -1) {
                // 0x8f61d13c
                if (time_info != NULL) {
                    // 0x8f61d144
                    time_str = (int32_t)asctime(time_info);
                    v3 = (int32_t)"Time is: \"%s\"\n";
                    v4 = time_str;
                    v33 = print_log(1, (int32_t)"Time is: \"%s\"\n", time_str, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v21 = v4;
                    v15 = v33;
                    // branch -> 0x8f61d158
                } else {
                    v21 = v71;
                    v15 = 0;
                }
            }
            // 0x8f61d158
            v34 = fboot_oem_init(v15, v3, v21, v8, v10, v9);
            v35 = hlos_iface_init(v34, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
            v36 = factory_kill_is_supported((char *)v35, v3, v4, v8, v10, v9, timep);
            v16 = v36;
            if (v36 == 0) {
                // 0x8f61d16c
                v24 = &str;
                v3 = v24;
                v4 = 17;
                v37 = __utag_gets_constprop_4_4("bootmode", v24, 17, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                if (v37 != 0) {
                    // 0x8f61d184
                    v3 = (int32_t)"factory";
                    strcmp_rc = strcmp((char *)&str, "factory");
                    if (strcmp_rc == 0) {
                        // 0x8f61d198
                        v3 = (int32_t)"Configuring device power for factory mode\n";
                        v38 = print_log(1, (int32_t)"Configuring device power for factory mode\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v16 = target_fact_cbl_setup((char *)v38, v3, v4, v8);
                        // branch -> 0x8f61d1a8
                    } else {
                        v16 = strcmp_rc;
                    }
                } else {
                    v16 = 0;
                }
            }
            // 0x8f61d1a8
            target_get_reset_status((char *)v16, v3, v4, v8);
            v3 = v6;
            v4 = 33;
            v39 = __utag_gets_constprop_4_4("device", v6, 33, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
            v22 = v10;
            v23 = v9;
            if (v39 == 0) {
                // 0x8f61d274
                if (is_validation_enabled((char *)0, v3, v4, v8) == 0) {
                    // 0x8f61d294
                    v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                    if (v51 == 0) {
                        // 0x8f61d2a0
                        v3 = (int32_t)"Enabling RAM dump by default\n";
                        v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                        v19 = v53;
                        // branch -> 0x8f61d2b0
                    } else {
                        v19 = v51;
                    }
                } else {
                    // 0x8f61d280
                    v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                    v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                    v19 = v50;
                    // branch -> 0x8f61d2b0
                }
                // 0x8f61d2b0
                v54 = sod_update((char *)v19, v3, v4, v8);
                v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                v20 = NULL;
                if (v55 != 0) {
                    // 0x8f61d2c0
                    v3 = (int32_t)"RAM dump is enabled\n";
                    v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v20 = (char *)v56;
                    // branch -> 0x8f61d2cc
                }
                // 0x8f61d2cc
                v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                if (v7 != g17) {
                    // 0x8f61d2e0
                    __stack_chk_fail();
                    // branch -> 0x8f61d2e4
                }
                // 0x8f61d2e4
                g31 = v1;
                g33 = v2;
                return (char *)v57;
            }
            // 0x8f61d1c4
            v40 = target_mot_prod_id((char *)v39, v3, v4, v8);
            v63 = v40;
            v41 = target_mot_hw_id((char *)v40, v3, v4, v8, v10, v9, timep);
            g33 = v41;
            v42 = get_product_id_by_name((char *)&v5, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
            v62 = v6;
            if (v42 > -1) {
                // 0x8f61d1f8
                v44 = hwrev_from_utag(v42, v3, v4, v8, v10, v9);
                v3 = v6;
                if (v44 != NULL) {
                    // 0x8f61d20c
                    v45 = get_hw_id_by_rev((char *)&v5, v6, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    g31 = v6;
                    if (v45 > (char *)-1) {
                        // 0x8f61d20c
                        v18 = (int32_t)v45;
                        v73 = v6;
                        v74 = g33;
                        // branch -> 0x8f61d22c
                    } else {
                        // 0x8f61d21c
                        v3 = (int32_t)"Mismatched product and hw revision\n";
                        // branch -> 0x8f61d224
                        // 0x8f61d224
                        v46 = print_log(-1, (int32_t)"Mismatched product and hw revision\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v69 = g33;
                        g31 = v69;
                        v18 = v46;
                        v73 = v69;
                        v74 = v69;
                        // branch -> 0x8f61d22c
                    }
                    // 0x8f61d22c
                    v67 = v63;
                    v17 = v18;
                    v22 = v10;
                    v23 = v9;
                    if (v73 != v74 || v62 != v67) {
                        // 0x8f61d238
                        v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                        v8 = v67;
                        print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                        v66 = v62;
                        v70 = v66;
                        if (v66 == 0) {
                            // if_8f61d254_0_true
                            v70 = v63;
                            // branch -> after_if_8f61d254_0
                        }
                        // after_if_8f61d254_0
                        v64 = (char *)(v70 % 256);
                        if (g31 == 0) {
                            // if_8f61d260_0_true
                            g31 = g33;
                            // branch -> after_if_8f61d260_0
                        }
                        // after_if_8f61d260_0
                        v60 = target_set_prod_id(v64, v3, v6, v8);
                        v72 = g31 % 256;
                        v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                        v4 = v61;
                        v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                        v17 = (int32_t)v47;
                        v22 = v73;
                        v23 = v74;
                        // branch -> 0x8f61d274
                    }
                    // 0x8f61d274
                    v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                    if (v48 == 0) {
                        // 0x8f61d294
                        v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                        if (v51 == 0) {
                            // 0x8f61d2a0
                            v3 = (int32_t)"Enabling RAM dump by default\n";
                            v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                            v19 = v53;
                            // branch -> 0x8f61d2b0
                        } else {
                            v19 = v51;
                        }
                    } else {
                        // 0x8f61d280
                        v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                        v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                        v19 = v50;
                        // branch -> 0x8f61d2b0
                    }
                    // 0x8f61d2b0
                    v54 = sod_update((char *)v19, v3, v4, v8);
                    v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                    v20 = NULL;
                    if (v55 != 0) {
                        // 0x8f61d2c0
                        v3 = (int32_t)"RAM dump is enabled\n";
                        v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v20 = (char *)v56;
                        // branch -> 0x8f61d2cc
                    }
                    // 0x8f61d2cc
                    v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                    if (v7 != g17) {
                        // 0x8f61d2e0
                        __stack_chk_fail();
                        // branch -> 0x8f61d2e4
                    }
                    // 0x8f61d2e4
                    g31 = v1;
                    g33 = v2;
                    return (char *)v57;
                }
                // if_8f61d200_0_true
                v3 = (int32_t)"No HW REV defined in utags\n";
                // branch -> 0x8f61d224
                // 0x8f61d224
                v46 = print_log(2, (int32_t)"No HW REV defined in utags\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v69 = g33;
                g31 = v69;
                v73 = v69;
                v74 = v69;
                // branch -> 0x8f61d22c
                // 0x8f61d22c
                v67 = v63;
                if (v73 != v74 || v62 != v67) {
                    // 0x8f61d238
                    v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                    v8 = v67;
                    print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                    v66 = v62;
                    v70 = v66;
                    if (v66 == 0) {
                        // if_8f61d254_0_true
                        v70 = v63;
                        // branch -> after_if_8f61d254_0
                    }
                    // after_if_8f61d254_0
                    v64 = (char *)(v70 % 256);
                    if (g31 == 0) {
                        // if_8f61d260_0_true
                        g31 = g33;
                        // branch -> after_if_8f61d260_0
                    }
                    // after_if_8f61d260_0
                    v60 = target_set_prod_id(v64, v3, v6, v8);
                    v72 = g31 % 256;
                    v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                    v4 = v61;
                    v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                    v17 = (int32_t)v47;
                    v22 = v73;
                    v23 = v74;
                    // branch -> 0x8f61d274
                } else {
                    v17 = v46;
                    v22 = v10;
                    v23 = v9;
                }
            } else {
                // 0x8f61d1e4
                v3 = (int32_t)"Invalid product name %s\n";
                v4 = v6;
                v43 = print_log(-1, (int32_t)"Invalid product name %s\n", v6, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v17 = v43;
                v22 = v10;
                v23 = v9;
                // branch -> 0x8f61d274
            }
            // 0x8f61d274
            v48 = is_validation_enabled((char *)v17, v3, v4, v8);
            if (v48 == 0) {
                // 0x8f61d294
                v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                if (v51 == 0) {
                    // 0x8f61d2a0
                    v3 = (int32_t)"Enabling RAM dump by default\n";
                    v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                    v19 = v53;
                    // branch -> 0x8f61d2b0
                } else {
                    v19 = v51;
                }
            } else {
                // 0x8f61d280
                v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                v19 = v50;
                // branch -> 0x8f61d2b0
            }
            // 0x8f61d2b0
            v54 = sod_update((char *)v19, v3, v4, v8);
            v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
            v20 = NULL;
            if (v55 != 0) {
                // 0x8f61d2c0
                v3 = (int32_t)"RAM dump is enabled\n";
                v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                v20 = (char *)v56;
                // branch -> 0x8f61d2cc
            }
            // 0x8f61d2cc
            v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
            if (v7 != g17) {
                // 0x8f61d2e0
                __stack_chk_fail();
                // branch -> 0x8f61d2e4
            }
            // 0x8f61d2e4
            g31 = v1;
            g33 = v2;
            return (char *)v57;
        }
        case 0x8000: {
            // 0x8f61d07c
            if (is_always_on("security_test_cert", v3, v4, v8) != 0) {
                // if_8f61d088_0_true
                v3 = (int32_t)"SRK.CA614.wtls.crt";
                g31 = (int32_t)"SRK.CA614.wtls.crt";
                v68 = (int32_t)"SRK.CA614.wtls.crt";
                // branch -> 0x8f61d0ac
                // 0x8f61d0ac
                v59 = security_policy_init((char *)v68, (int32_t)"SRK.CA614.wtls.crt", v4, v8);
                v65 = v68;
                if (v65 != 0) {
                    // 0x8f61d0bc
                    v27 = is_validation_enabled((char *)v65, v3, v59, v8);
                    if (v27 != 0) {
                        // 0x8f61d0c8
                        set_blankflash_magic((char *)v27, v3, v59, v8);
                        reboot_device("\x01\x55\x66\x77\x9c\xc1\x6a\x8f\x66\x21\x68\x8f\x86\x21\x68\x8f\x95\x21\x68\x8f\x54\x27\x68\x8f\x9e\x21\x68\x8f\xb9\x4a\x68\x8f\xc9\x21\x68\x8f\xe2\x21\x68\x8f\xfe\x21\x68\x8f\x22\x22\x68\x8f\x57\x22\x68\x8f\x79\x22\x68\x8f\x97\x22\x68\x8f\x28\x30\x9f\xe5\x07\x40\x2d\xe9", v3, v59, v8, v10, v9, timep, str, 0, 0);
                        // branch -> 0x8f61d0d4
                        while (true) {
                            // 0x8f61d0d4
                            // branch -> 0x8f61d0d4
                        }
                    }
                }
                // 0x8f61d0d8
                v28 = generic_mmc_init(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0);
                v14 = v28;
                if (v28 >= 0) {
                    // 0x8f61d0e4
                    v58 = set_gpt_opts((char *)&g10, v3, v59, v8);
                    v3 = v58;
                    v29 = init_gpt((int32_t)&g10, v58, v59, v8, v10, v9, timep, str, 0, 0, 0);
                    if (v29 == 0) {
                        // 0x8f61d0f8
                        v30 = validate_gpt_partition(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                        if (v30 != 0) {
                            // 0x8f61d104
                            v3 = (int32_t)"Invalid GPT, please re-flash it";
                            v31 = print_log(4, (int32_t)"Invalid GPT, please re-flash it", v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v32 = uninit_gpt((char *)v31, v3, v59, v8, v10, v9, timep, str, 0, 0);
                            v14 = v32;
                            // branch -> 0x8f61d114
                        } else {
                            v14 = 0;
                        }
                    } else {
                        v14 = v29;
                    }
                }
                // 0x8f61d114
                logger_init((char *)v14, v3, v59, v8, v10, v9, timep);
                time_val = time(NULL);
                v8 = &timep;
                timep = time_val;
                time_info = gmtime(&timep);
                v71 = timep;
                v4 = v71;
                v21 = -1;
                v15 = (int32_t)time_info;
                if (v71 != -1) {
                    // 0x8f61d13c
                    if (time_info != NULL) {
                        // 0x8f61d144
                        time_str = (int32_t)asctime(time_info);
                        v3 = (int32_t)"Time is: \"%s\"\n";
                        v4 = time_str;
                        v33 = print_log(1, (int32_t)"Time is: \"%s\"\n", time_str, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v21 = v4;
                        v15 = v33;
                        // branch -> 0x8f61d158
                    } else {
                        v21 = v71;
                        v15 = 0;
                    }
                }
                // 0x8f61d158
                v34 = fboot_oem_init(v15, v3, v21, v8, v10, v9);
                v35 = hlos_iface_init(v34, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v36 = factory_kill_is_supported((char *)v35, v3, v4, v8, v10, v9, timep);
                v16 = v36;
                if (v36 == 0) {
                    // 0x8f61d16c
                    v24 = &str;
                    v3 = v24;
                    v4 = 17;
                    v37 = __utag_gets_constprop_4_4("bootmode", v24, 17, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                    if (v37 != 0) {
                        // 0x8f61d184
                        v3 = (int32_t)"factory";
                        strcmp_rc = strcmp((char *)&str, "factory");
                        if (strcmp_rc == 0) {
                            // 0x8f61d198
                            v3 = (int32_t)"Configuring device power for factory mode\n";
                            v38 = print_log(1, (int32_t)"Configuring device power for factory mode\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v16 = target_fact_cbl_setup((char *)v38, v3, v4, v8);
                            // branch -> 0x8f61d1a8
                        } else {
                            v16 = strcmp_rc;
                        }
                    } else {
                        v16 = 0;
                    }
                }
                // 0x8f61d1a8
                target_get_reset_status((char *)v16, v3, v4, v8);
                v3 = v6;
                v4 = 33;
                v39 = __utag_gets_constprop_4_4("device", v6, 33, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                v22 = v10;
                v23 = v9;
                if (v39 == 0) {
                    // 0x8f61d274
                    if (is_validation_enabled((char *)0, v3, v4, v8) == 0) {
                        // 0x8f61d294
                        v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                        if (v51 == 0) {
                            // 0x8f61d2a0
                            v3 = (int32_t)"Enabling RAM dump by default\n";
                            v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                            v19 = v53;
                            // branch -> 0x8f61d2b0
                        } else {
                            v19 = v51;
                        }
                    } else {
                        // 0x8f61d280
                        v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                        v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                        v19 = v50;
                        // branch -> 0x8f61d2b0
                    }
                    // 0x8f61d2b0
                    v54 = sod_update((char *)v19, v3, v4, v8);
                    v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                    v20 = NULL;
                    if (v55 != 0) {
                        // 0x8f61d2c0
                        v3 = (int32_t)"RAM dump is enabled\n";
                        v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v20 = (char *)v56;
                        // branch -> 0x8f61d2cc
                    }
                    // 0x8f61d2cc
                    v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                    if (v7 != g17) {
                        // 0x8f61d2e0
                        __stack_chk_fail();
                        // branch -> 0x8f61d2e4
                    }
                    // 0x8f61d2e4
                    g31 = v1;
                    g33 = v2;
                    return (char *)v57;
                }
                // 0x8f61d1c4
                v40 = target_mot_prod_id((char *)v39, v3, v4, v8);
                v63 = v40;
                v41 = target_mot_hw_id((char *)v40, v3, v4, v8, v10, v9, timep);
                g33 = v41;
                v42 = get_product_id_by_name((char *)&v5, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                v62 = v6;
                if (v42 > -1) {
                    // 0x8f61d1f8
                    v44 = hwrev_from_utag(v42, v3, v4, v8, v10, v9);
                    v3 = v6;
                    if (v44 != NULL) {
                        // 0x8f61d20c
                        v45 = get_hw_id_by_rev((char *)&v5, v6, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        g31 = v6;
                        if (v45 > (char *)-1) {
                            // 0x8f61d20c
                            v18 = (int32_t)v45;
                            v73 = v6;
                            v74 = g33;
                            // branch -> 0x8f61d22c
                        } else {
                            // 0x8f61d21c
                            v3 = (int32_t)"Mismatched product and hw revision\n";
                            // branch -> 0x8f61d224
                            // 0x8f61d224
                            v46 = print_log(-1, (int32_t)"Mismatched product and hw revision\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                            v69 = g33;
                            g31 = v69;
                            v18 = v46;
                            v73 = v69;
                            v74 = v69;
                            // branch -> 0x8f61d22c
                        }
                        // 0x8f61d22c
                        v67 = v63;
                        v17 = v18;
                        v22 = v10;
                        v23 = v9;
                        if (v73 != v74 || v62 != v67) {
                            // 0x8f61d238
                            v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                            v8 = v67;
                            print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                            v66 = v62;
                            v70 = v66;
                            if (v66 == 0) {
                                // if_8f61d254_0_true
                                v70 = v63;
                                // branch -> after_if_8f61d254_0
                            }
                            // after_if_8f61d254_0
                            v64 = (char *)(v70 % 256);
                            if (g31 == 0) {
                                // if_8f61d260_0_true
                                g31 = g33;
                                // branch -> after_if_8f61d260_0
                            }
                            // after_if_8f61d260_0
                            v60 = target_set_prod_id(v64, v3, v6, v8);
                            v72 = g31 % 256;
                            v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                            v4 = v61;
                            v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                            v17 = (int32_t)v47;
                            v22 = v73;
                            v23 = v74;
                            // branch -> 0x8f61d274
                        }
                        // 0x8f61d274
                        v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                        if (v48 == 0) {
                            // 0x8f61d294
                            v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                            if (v51 == 0) {
                                // 0x8f61d2a0
                                v3 = (int32_t)"Enabling RAM dump by default\n";
                                v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                                v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                                v19 = v53;
                                // branch -> 0x8f61d2b0
                            } else {
                                v19 = v51;
                            }
                        } else {
                            // 0x8f61d280
                            v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                            v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                            v19 = v50;
                            // branch -> 0x8f61d2b0
                        }
                        // 0x8f61d2b0
                        v54 = sod_update((char *)v19, v3, v4, v8);
                        v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                        v20 = NULL;
                        if (v55 != 0) {
                            // 0x8f61d2c0
                            v3 = (int32_t)"RAM dump is enabled\n";
                            v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v20 = (char *)v56;
                            // branch -> 0x8f61d2cc
                        }
                        // 0x8f61d2cc
                        v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                        if (v7 != g17) {
                            // 0x8f61d2e0
                            __stack_chk_fail();
                            // branch -> 0x8f61d2e4
                        }
                        // 0x8f61d2e4
                        g31 = v1;
                        g33 = v2;
                        return (char *)v57;
                    }
                    // if_8f61d200_0_true
                    v3 = (int32_t)"No HW REV defined in utags\n";
                    // branch -> 0x8f61d224
                    // 0x8f61d224
                    v46 = print_log(2, (int32_t)"No HW REV defined in utags\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v69 = g33;
                    g31 = v69;
                    v73 = v69;
                    v74 = v69;
                    // branch -> 0x8f61d22c
                    // 0x8f61d22c
                    v67 = v63;
                    if (v73 != v74 || v62 != v67) {
                        // 0x8f61d238
                        v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                        v8 = v67;
                        print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                        v66 = v62;
                        v70 = v66;
                        if (v66 == 0) {
                            // if_8f61d254_0_true
                            v70 = v63;
                            // branch -> after_if_8f61d254_0
                        }
                        // after_if_8f61d254_0
                        v64 = (char *)(v70 % 256);
                        if (g31 == 0) {
                            // if_8f61d260_0_true
                            g31 = g33;
                            // branch -> after_if_8f61d260_0
                        }
                        // after_if_8f61d260_0
                        v60 = target_set_prod_id(v64, v3, v6, v8);
                        v72 = g31 % 256;
                        v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                        v4 = v61;
                        v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                        v17 = (int32_t)v47;
                        v22 = v73;
                        v23 = v74;
                        // branch -> 0x8f61d274
                    } else {
                        v17 = v46;
                        v22 = v10;
                        v23 = v9;
                    }
                } else {
                    // 0x8f61d1e4
                    v3 = (int32_t)"Invalid product name %s\n";
                    v4 = v6;
                    v43 = print_log(-1, (int32_t)"Invalid product name %s\n", v6, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v17 = v43;
                    v22 = v10;
                    v23 = v9;
                    // branch -> 0x8f61d274
                }
                // 0x8f61d274
                v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                if (v48 == 0) {
                    // 0x8f61d294
                    v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                    if (v51 == 0) {
                        // 0x8f61d2a0
                        v3 = (int32_t)"Enabling RAM dump by default\n";
                        v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                        v19 = v53;
                        // branch -> 0x8f61d2b0
                    } else {
                        v19 = v51;
                    }
                } else {
                    // 0x8f61d280
                    v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                    v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                    v19 = v50;
                    // branch -> 0x8f61d2b0
                }
                // 0x8f61d2b0
                v54 = sod_update((char *)v19, v3, v4, v8);
                v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                v20 = NULL;
                if (v55 != 0) {
                    // 0x8f61d2c0
                    v3 = (int32_t)"RAM dump is enabled\n";
                    v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v20 = (char *)v56;
                    // branch -> 0x8f61d2cc
                }
                // 0x8f61d2cc
                v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                if (v7 != g17) {
                    // 0x8f61d2e0
                    __stack_chk_fail();
                    // branch -> 0x8f61d2e4
                }
                // 0x8f61d2e4
                g31 = v1;
                g33 = v2;
                return (char *)v57;
            }
            // 0x8f61d094
            v25 = get_srk_name("boot_srk", v3, v4, v8, v10, v9, timep);
            g31 = v25;
            v26 = get_srk_name("ap_srk", v3, v4, v8, v10, v9, timep);
            v3 = v26;
            v68 = g31;
            // branch -> 0x8f61d0ac
            // 0x8f61d0ac
            v59 = security_policy_init((char *)v68, v26, v4, v8);
            v65 = v68;
            if (v65 != 0) {
                // 0x8f61d0bc
                v27 = is_validation_enabled((char *)v65, v3, v59, v8);
                if (v27 != 0) {
                    // 0x8f61d0c8
                    set_blankflash_magic((char *)v27, v3, v59, v8);
                    reboot_device("\x01\x55\x66\x77\x9c\xc1\x6a\x8f\x66\x21\x68\x8f\x86\x21\x68\x8f\x95\x21\x68\x8f\x54\x27\x68\x8f\x9e\x21\x68\x8f\xb9\x4a\x68\x8f\xc9\x21\x68\x8f\xe2\x21\x68\x8f\xfe\x21\x68\x8f\x22\x22\x68\x8f\x57\x22\x68\x8f\x79\x22\x68\x8f\x97\x22\x68\x8f\x28\x30\x9f\xe5\x07\x40\x2d\xe9", v3, v59, v8, v10, v9, timep, str, 0, 0);
                    // branch -> 0x8f61d0d4
                    while (true) {
                        // 0x8f61d0d4
                        // branch -> 0x8f61d0d4
                    }
                }
            }
            // 0x8f61d0d8
            v28 = generic_mmc_init(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0);
            v14 = v28;
            if (v28 >= 0) {
                // 0x8f61d0e4
                v58 = set_gpt_opts((char *)&g10, v3, v59, v8);
                v3 = v58;
                v29 = init_gpt((int32_t)&g10, v58, v59, v8, v10, v9, timep, str, 0, 0, 0);
                if (v29 == 0) {
                    // 0x8f61d0f8
                    v30 = validate_gpt_partition(NULL, v3, v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                    if (v30 != 0) {
                        // 0x8f61d104
                        v3 = (int32_t)"Invalid GPT, please re-flash it";
                        v31 = print_log(4, (int32_t)"Invalid GPT, please re-flash it", v59, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v32 = uninit_gpt((char *)v31, v3, v59, v8, v10, v9, timep, str, 0, 0);
                        v14 = v32;
                        // branch -> 0x8f61d114
                    } else {
                        v14 = 0;
                    }
                } else {
                    v14 = v29;
                }
            }
            // 0x8f61d114
            logger_init((char *)v14, v3, v59, v8, v10, v9, timep);
            time_val = time(NULL);
            v8 = &timep;
            timep = time_val;
            time_info = gmtime(&timep);
            v71 = timep;
            v4 = v71;
            v21 = -1;
            v15 = (int32_t)time_info;
            if (v71 != -1) {
                // 0x8f61d13c
                if (time_info != NULL) {
                    // 0x8f61d144
                    time_str = (int32_t)asctime(time_info);
                    v3 = (int32_t)"Time is: \"%s\"\n";
                    v4 = time_str;
                    v33 = print_log(1, (int32_t)"Time is: \"%s\"\n", time_str, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    v21 = v4;
                    v15 = v33;
                    // branch -> 0x8f61d158
                } else {
                    v21 = v71;
                    v15 = 0;
                }
            }
            // 0x8f61d158
            v34 = fboot_oem_init(v15, v3, v21, v8, v10, v9);
            v35 = hlos_iface_init(v34, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
            v36 = factory_kill_is_supported((char *)v35, v3, v4, v8, v10, v9, timep);
            v16 = v36;
            if (v36 == 0) {
                // 0x8f61d16c
                v24 = &str;
                v3 = v24;
                v4 = 17;
                v37 = __utag_gets_constprop_4_4("bootmode", v24, 17, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
                if (v37 != 0) {
                    // 0x8f61d184
                    v3 = (int32_t)"factory";
                    strcmp_rc = strcmp((char *)&str, "factory");
                    if (strcmp_rc == 0) {
                        // 0x8f61d198
                        v3 = (int32_t)"Configuring device power for factory mode\n";
                        v38 = print_log(1, (int32_t)"Configuring device power for factory mode\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v16 = target_fact_cbl_setup((char *)v38, v3, v4, v8);
                        // branch -> 0x8f61d1a8
                    } else {
                        v16 = strcmp_rc;
                    }
                } else {
                    v16 = 0;
                }
            }
            // 0x8f61d1a8
            target_get_reset_status((char *)v16, v3, v4, v8);
            v3 = v6;
            v4 = 33;
            v39 = __utag_gets_constprop_4_4("device", v6, 33, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
            v22 = v10;
            v23 = v9;
            if (v39 == 0) {
                // 0x8f61d274
                if (is_validation_enabled((char *)0, v3, v4, v8) == 0) {
                    // 0x8f61d294
                    v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                    if (v51 == 0) {
                        // 0x8f61d2a0
                        v3 = (int32_t)"Enabling RAM dump by default\n";
                        v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                        v19 = v53;
                        // branch -> 0x8f61d2b0
                    } else {
                        v19 = v51;
                    }
                } else {
                    // 0x8f61d280
                    v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                    v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                    v19 = v50;
                    // branch -> 0x8f61d2b0
                }
                // 0x8f61d2b0
                v54 = sod_update((char *)v19, v3, v4, v8);
                v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                v20 = NULL;
                if (v55 != 0) {
                    // 0x8f61d2c0
                    v3 = (int32_t)"RAM dump is enabled\n";
                    v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v20 = (char *)v56;
                    // branch -> 0x8f61d2cc
                }
                // 0x8f61d2cc
                v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                if (v7 != g17) {
                    // 0x8f61d2e0
                    __stack_chk_fail();
                    // branch -> 0x8f61d2e4
                }
                // 0x8f61d2e4
                g31 = v1;
                g33 = v2;
                return (char *)v57;
            }
            // 0x8f61d1c4
            v40 = target_mot_prod_id((char *)v39, v3, v4, v8);
            v63 = v40;
            v41 = target_mot_hw_id((char *)v40, v3, v4, v8, v10, v9, timep);
            g33 = v41;
            v42 = get_product_id_by_name((char *)&v5, v3, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5, 0);
            v62 = v6;
            if (v42 > -1) {
                // 0x8f61d1f8
                v44 = hwrev_from_utag(v42, v3, v4, v8, v10, v9);
                v3 = v6;
                if (v44 != NULL) {
                    // 0x8f61d20c
                    v45 = get_hw_id_by_rev((char *)&v5, v6, v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                    g31 = v6;
                    if (v45 > (char *)-1) {
                        // 0x8f61d20c
                        v18 = (int32_t)v45;
                        v73 = v6;
                        v74 = g33;
                        // branch -> 0x8f61d22c
                    } else {
                        // 0x8f61d21c
                        v3 = (int32_t)"Mismatched product and hw revision\n";
                        // branch -> 0x8f61d224
                        // 0x8f61d224
                        v46 = print_log(-1, (int32_t)"Mismatched product and hw revision\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                        v69 = g33;
                        g31 = v69;
                        v18 = v46;
                        v73 = v69;
                        v74 = v69;
                        // branch -> 0x8f61d22c
                    }
                    // 0x8f61d22c
                    v67 = v63;
                    v17 = v18;
                    v22 = v10;
                    v23 = v9;
                    if (v73 != v74 || v62 != v67) {
                        // 0x8f61d238
                        v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                        v8 = v67;
                        print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                        v66 = v62;
                        v70 = v66;
                        if (v66 == 0) {
                            // if_8f61d254_0_true
                            v70 = v63;
                            // branch -> after_if_8f61d254_0
                        }
                        // after_if_8f61d254_0
                        v64 = (char *)(v70 % 256);
                        if (g31 == 0) {
                            // if_8f61d260_0_true
                            g31 = g33;
                            // branch -> after_if_8f61d260_0
                        }
                        // after_if_8f61d260_0
                        v60 = target_set_prod_id(v64, v3, v6, v8);
                        v72 = g31 % 256;
                        v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                        v4 = v61;
                        v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                        v17 = (int32_t)v47;
                        v22 = v73;
                        v23 = v74;
                        // branch -> 0x8f61d274
                    }
                    // 0x8f61d274
                    v48 = is_validation_enabled((char *)v17, v3, v4, v8);
                    if (v48 == 0) {
                        // 0x8f61d294
                        v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                        if (v51 == 0) {
                            // 0x8f61d2a0
                            v3 = (int32_t)"Enabling RAM dump by default\n";
                            v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                            v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                            v19 = v53;
                            // branch -> 0x8f61d2b0
                        } else {
                            v19 = v51;
                        }
                    } else {
                        // 0x8f61d280
                        v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                        v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                        v19 = v50;
                        // branch -> 0x8f61d2b0
                    }
                    // 0x8f61d2b0
                    v54 = sod_update((char *)v19, v3, v4, v8);
                    v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
                    v20 = NULL;
                    if (v55 != 0) {
                        // 0x8f61d2c0
                        v3 = (int32_t)"RAM dump is enabled\n";
                        v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                        v20 = (char *)v56;
                        // branch -> 0x8f61d2cc
                    }
                    // 0x8f61d2cc
                    v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
                    if (v7 != g17) {
                        // 0x8f61d2e0
                        __stack_chk_fail();
                        // branch -> 0x8f61d2e4
                    }
                    // 0x8f61d2e4
                    g31 = v1;
                    g33 = v2;
                    return (char *)v57;
                }
                // if_8f61d200_0_true
                v3 = (int32_t)"No HW REV defined in utags\n";
                // branch -> 0x8f61d224
                // 0x8f61d224
                v46 = print_log(2, (int32_t)"No HW REV defined in utags\n", v4, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v69 = g33;
                g31 = v69;
                v73 = v69;
                v74 = v69;
                // branch -> 0x8f61d22c
                // 0x8f61d22c
                v67 = v63;
                if (v73 != v74 || v62 != v67) {
                    // 0x8f61d238
                    v3 = (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n";
                    v8 = v67;
                    print_log(-1, (int32_t)"Oops, mismatch IDs (%c:%c, %c:%c), reloading FDT...\n", v6, v67, v73, v74, timep, str, 0, 0, 0, 0, v5);
                    v66 = v62;
                    v70 = v66;
                    if (v66 == 0) {
                        // if_8f61d254_0_true
                        v70 = v63;
                        // branch -> after_if_8f61d254_0
                    }
                    // after_if_8f61d254_0
                    v64 = (char *)(v70 % 256);
                    if (g31 == 0) {
                        // if_8f61d260_0_true
                        g31 = g33;
                        // branch -> after_if_8f61d260_0
                    }
                    // after_if_8f61d260_0
                    v60 = target_set_prod_id(v64, v3, v6, v8);
                    v72 = g31 % 256;
                    v61 = target_set_hw_id((char *)v72, v3, v60, v8);
                    v4 = v61;
                    v47 = mbm_fdt_init(v72, v3, v61, v8, v73, v74, timep, str, 0, 0, 0, 0, v5, 0);
                    v17 = (int32_t)v47;
                    v22 = v73;
                    v23 = v74;
                    // branch -> 0x8f61d274
                } else {
                    v17 = v46;
                    v22 = v10;
                    v23 = v9;
                }
            } else {
                // 0x8f61d1e4
                v3 = (int32_t)"Invalid product name %s\n";
                v4 = v6;
                v43 = print_log(-1, (int32_t)"Invalid product name %s\n", v6, v8, v10, v9, timep, str, 0, 0, 0, 0, v5);
                v17 = v43;
                v22 = v10;
                v23 = v9;
                // branch -> 0x8f61d274
            }
            // 0x8f61d274
            v48 = is_validation_enabled((char *)v17, v3, v4, v8);
            if (v48 == 0) {
                // 0x8f61d294
                v51 = sod_init(0, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5, 0, 0);
                if (v51 == 0) {
                    // 0x8f61d2a0
                    v3 = (int32_t)"Enabling RAM dump by default\n";
                    v52 = print_log(1, (int32_t)"Enabling RAM dump by default\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                    v53 = sod_ramdump_enable(v52, v3, v4, v8, v22, v23, timep, str, 0, 0, 0, 0);
                    v19 = v53;
                    // branch -> 0x8f61d2b0
                } else {
                    v19 = v51;
                }
            } else {
                // 0x8f61d280
                v3 = (int32_t)"Disabling RAM dump for secure HW\n";
                v49 = print_log(1, (int32_t)"Disabling RAM dump for secure HW\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                v50 = sod_ramdump_disable(v49, v3, v4, v8, v22, v23, timep, str, 0);
                v19 = v50;
                // branch -> 0x8f61d2b0
            }
            // 0x8f61d2b0
            v54 = sod_update((char *)v19, v3, v4, v8);
            v55 = sod_ramdump_enabled((char *)v54, v3, v4, v8);
            v20 = NULL;
            if (v55 != 0) {
                // 0x8f61d2c0
                v3 = (int32_t)"RAM dump is enabled\n";
                v56 = print_log(1, (int32_t)"RAM dump is enabled\n", v4, v8, v22, v23, timep, str, 0, 0, 0, 0, v5);
                v20 = (char *)v56;
                // branch -> 0x8f61d2cc
            }
            // 0x8f61d2cc
            v57 = sod_share(v20, v3, v4, v8, v22, v23, timep);
            if (v7 != g17) {
                // 0x8f61d2e0
                __stack_chk_fail();
                // branch -> 0x8f61d2e4
            }
            // 0x8f61d2e4
            g31 = v1;
            g33 = v2;
            return (char *)v57;
        }
    }
    // branch -> 0x8f61d0ac
    // Detected a possible infinite recursion (goto support failed); quitting...
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// char * asctime(const struct tm * tp);
// struct tm * gmtime(const time_t * timer);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// char * strcat(char * restrict dest, const char * restrict src);
// char * strchr(char * s, int c);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// char * strncat(char * restrict dest, const char * restrict src, size_t n);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strncpy(char * restrict dest, const char * restrict src, size_t n);
// size_t strnlen(const char * string, size_t maxlen);
// char * strrchr(char * s, int c);
// char * strtok(char * restrict s, const char * restrict delim);
// time_t time(time_t * timer);
// int vsnprintf(char * restrict s, size_t maxlen, const char * restrict format, _G_va_list arg);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 17
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:36:36

//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <ctype.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t free_context(int32_t a1, int32_t a2, int32_t a3);
void function_8f660c54(int32_t * a1, char * a2, int32_t a3, int32_t * a4);
int32_t lbackref(int32_t * a1, char * a2, int32_t a3, int32_t a4, uint32_t a5);
int32_t ldissect(int32_t * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t lslow(int32_t * a1, char * a2, int32_t a3, int32_t a4);
int32_t mcs_ctx_init_rsa_sig(char a1, char a2, char a3, int32_t a4, uint32_t a5);
int32_t mcs_free_name(char * a1, int32_t a2);
int32_t mcs_rsa_add_cipher_pad_isra_1(int32_t a1, char * a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, uint32_t a7, int32_t a8);
int32_t mcs_rsa_do_rsa(char * a1, int32_t a2, int32_t a3, uint32_t a4);
int32_t mcs_rsa_mgf_isra_0(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t mcs_rsa_remove_cipher_pad_isra_3(char * a1, int32_t * a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6);
int32_t mcs_verify_cert_chain(int32_t a1, int16_t * a2);
int32_t mcs_X509Certificate_decodeExtension(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t mcs_X509Certificate_decodeName(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t read_parser_data(int32_t a1);
int32_t read_verify_data(int32_t a1);
int32_t sbackref(int32_t * a1, char * a2, int32_t a3, int32_t a4, uint32_t a5);
int32_t sdissect(int32_t * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t sslow(int32_t * a1, char * a2, int32_t a3, int32_t a4);

// --------------------- Global Variables ---------------------

int32_t g6 = 0; // LR
int32_t g7 = 0; // R1
int32_t g8 = 0; // R10
int32_t g9 = 0; // R11
int32_t g10 = 0; // R2
int32_t g11 = 0; // R3
int32_t g12 = 0; // R4
int32_t g13 = 0; // R5
int32_t g14 = 0; // R6
int32_t g15 = 0; // R7
int32_t g16 = 0; // R8
int32_t g17 = 0; // R9
int32_t g1 = -0x79b779d6; // 0x8f6a69c9
int32_t g2 = 0x2b0b0455; // 0x8f6a69d2
int32_t g3 = 0x20494b50; // 0x8f6a69dd
int32_t g4 = 0x67251d55; // 0x8f6a69e7
int32_t g5 = 0; // 0x8f7112f4

// ------------------------ Functions -------------------------

// Address range: 0x8f667ff4 - 0x8f668333
int32_t mcs_rsa_remove_cipher_pad_isra_3(char * a1, int32_t * a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6) {
    // 0x8f667ff4
    int32_t v1;
    char * v2 = (char *)v1;
    int32_t v3 = (int32_t)a1;
    int32_t v4 = (int32_t)a2;
    int32_t v5 = g12; // 0x8f667ff4
    g15 = &g5;
    g14 = a3;
    int32_t v6 = 0x1000000 * a6;
    int32_t v7 = v6 / 0x1000000; // 0x8f66800c
    g11 = v7;
    g12 = v3;
    int32_t v8 = g5;
    g10 = v8;
    int32_t v9 = a3 == 13 ? 20 : 0;
    g13 = v4;
    g17 = a5;
    int32_t v10;
    int32_t v11 = 0x1000000 * v10;
    int32_t v12 = v11 / 0x1000000; // 0x8f66802c
    char * v13 = (char *)v9; // bp-412
    char * v14;
    if (v7 < 2) {
        // 0x8f668044
        int32_t * v15; // 0x8f6682e8_0
        int32_t v16; // 0x8f6682c4
        int32_t v17;
        int32_t v18;
        int32_t v19;
        char * v20;
        char * v21;
        int32_t v22; // 0x8f6682f8
        int32_t v23; // 0x8f6682ec
        int32_t result; // 0x8f6682d8
        int32_t v24; // 0x8f6682e8
        switch (v12) {
            default: {
                // 0x8f668050
                g12 = v11 == 0x2000000 ? v12 - 2 : 1;
                v14 = v2;
                // branch -> 0x8f6682b0
              lab_0x8f6682b0_5:
                // 0x8f6682b0
                mcs_memclear((int32_t)&v17, 256, g10, g11);
                v16 = mcs_memclear((int32_t)&v18, 20, g10, g11);
                mcs_clear_hash_ctx((int32_t)&v19, v16, g10, g11, (int32_t)v14, 0, 0);
                result = g12;
                if (v8 == g5) {
                    // 0x8f668328
                    g12 = v5;
                    return result;
                }
              lab_0x8f6682e4_3:
                // 0x8f6682e4
                __stack_chk_fail();
                v22 = v16;
                v21 = v14;
                // branch -> 0x8f6682e8
                // 0x8f6682e8
                v15 = (int32_t *)g13;
                v24 = *v15;
                g10 = v24;
                v23 = v24 - 1;
                g11 = v23;
                if (v22 <= v23) {
                  lab_0x8f6682f8_3:;
                    int32_t v25 = v22 + 1; // 0x8f6682f8
                    int32_t v26 = v25; // R1
                    if (v25 >= 11) {
                        int32_t v27 = v24 - v25; // 0x8f668304
                        g10 = v27;
                        *v15 = v27;
                        int32_t v28 = g10; // 0x8f66830c
                        if (v28 == 0) {
                            // if_8f668310_0_true
                            g12 = 0;
                            v14 = v21;
                            // branch -> 0x8f6682b0
                            goto lab_0x8f6682b0_5;
                        } else {
                            int32_t v29 = g12; // 0x8f668318
                            g10 = mcs_memmove(v29, v26 + v29, v28, g11, (int32_t)v21);
                            // branch -> 0x8f6682ac
                            // 0x8f6682ac
                            g12 = 0;
                            v14 = v21;
                            // branch -> 0x8f6682b0
                            goto lab_0x8f6682b0_5;
                        }
                        int32_t v30 = g10; // 0x8f6682b8
                        int32_t v31 = g11; // 0x8f6682b8
                        mcs_memclear((int32_t)&v17, 256, v30, v31);
                        int32_t v32 = g10; // 0x8f6682c4
                        int32_t v33 = g11; // 0x8f6682c4
                        v16 = mcs_memclear((int32_t)&v18, 20, v32, v33);
                        v26 = v16;
                        int32_t v34 = g10; // 0x8f6682cc
                        int32_t v35 = g11; // 0x8f6682cc
                        mcs_clear_hash_ctx((int32_t)&v19, v16, v34, v35, (int32_t)v14, 0, 0);
                        int32_t v36 = g5;
                        result = g12;
                        if (v8 != v36) {
                            goto lab_0x8f6682e4_3;
                        }
                        // 0x8f668328
                        g12 = v5;
                        return result;
                    }
                    v20 = v21;
                } else {
                    v20 = v21;
                }
                break;
            }
            case 1: {
                // 0x8f6680e0
                if (a3 == 13) {
                    int32_t v37 = *a2; // 0x8f6680e8
                    g11 = v37;
                    if (v37 + -2 * v9 >= 0) {
                        int32_t v38 = &v19; // 0x8f668100_0
                        if (mcs_ctx_init_hash(13, v38, v8, v37, v1, 0, 0, v9) == 0) {
                            if (a4 != 0) {
                                // 0x8f668134
                                g10 = g17;
                                if (mcs_hash_data(v38, a4, g17, g11, v1, 0, 0, (int32_t)v13, v19, 0, 0, 0, 0, 0, 0) != 0) {
                                    // 0x8f66803c
                                    g12 = 1;
                                    v14 = v2;
                                    // branch -> 0x8f6682b0
                                    goto lab_0x8f6682b0_5;
                                }
                            }
                            int32_t v39 = &v18; // 0x8f66811c_0
                            int32_t v40 = (int32_t)&v13;
                            g10 = v40;
                            if (mcs_hash_end(v38, v39, v40, g11, v1, 0, 0, (int32_t)v13, v19, 0, 0, 0, 0, 0) == 0) {
                                char * v41 = v13;
                                int32_t v42 = (int32_t)v41;
                                int32_t v43 = &v17; // 0x8f668154_0
                                g16 = v43;
                                int32_t v44 = *(int32_t *)g13; // 0x8f668158
                                if (mcs_rsa_mgf_isra_0(g14, v42 + 1 + g12, v44 + -1 - v42, v43) == 0) {
                                    char * v45 = v13;
                                    int32_t v46 = 0; // 0x8f6681cc
                                    if (v45 != NULL) {
                                        int32_t v47;
                                        int32_t v48 = &v47; // 0x8f66819c
                                        int32_t v49 = 0; // 0x8f668198
                                        while (true) {
                                            int32_t v50 = v49 + 1; // 0x8f668198
                                            int32_t v51 = v48 + 1; // 0x8f66819c
                                            char * v52 = (char *)(g12 + v50); // 0x8f6681a0_0
                                            *v52 = *v52 ^ *(char *)v51;
                                            int32_t v53 = (int32_t)v45; // 0x8f668190
                                            if (v50 != v53) {
                                                // 0x8f668198
                                                v48 = v51;
                                                v49 = v50;
                                                // branch -> 0x8f668198
                                                continue;
                                            } else {
                                                v46 = v53;
                                            }
                                        }
                                    }
                                    int32_t v54 = *(int32_t *)g13 + -1 - v46; // 0x8f6681bc
                                    char * v55 = (char *)v54;
                                    if (mcs_rsa_mgf_isra_0(g14, g12 + 1, v46, v43) == 0) {
                                        int32_t v56 = (int32_t)v13;
                                        int32_t v57 = v56 + 1; // R0
                                        int32_t v58 = g12; // 0x8f6681e0
                                        int32_t v59 = -1 - v56; // 0x8f6681e4
                                        int32_t v60 = *(int32_t *)g13; // 0x8f6681e818
                                        int32_t v61 = v58;
                                        uint32_t v62 = v60; // 0x8f66822011
                                        int32_t v63; // 0x8f66824c
                                        int32_t v64; // 0x8f66829c
                                        int32_t * v65; // 0x8f6682a0_0
                                        int32_t v66; // 0x8f66824c
                                        int32_t v67; // R6
                                        int32_t v68; // 0x8f668238
                                        int32_t v69; // 0x8f66826c
                                        int32_t v70; // 0x8f668280
                                        int32_t v71; // 0x8f6682183
                                        int32_t v72; // 0x8f66822c
                                        int32_t v73; // 0x8f668258
                                        int32_t v74; // 0x8f668278
                                        int32_t v75; // 0x8f668280
                                        int32_t v76; // 0x8f66828c
                                        int32_t v77; // 0x8f668250
                                        int32_t v78; // 0x8f668228
                                        uint32_t v79; // 0x8f66825c
                                        int32_t v80; // 0x8f66823c
                                        unsigned char v81; // 0x8f668250
                                        uint32_t v82; // 0x8f668254
                                        int32_t v83; // 0x8f6682a0
                                        int32_t v84; // 0x8f668234
                                        if (v60 + v59 == 0) {
                                            int32_t v85 = 0; // 0x8f6681fc
                                            int32_t v86 = v58 + v56; // 0x8f668208
                                            while (true) {
                                                int32_t v87 = v86 + 1; // 0x8f6681f8
                                                char * v88 = (char *)v87; // 0x8f6681f8_0
                                                *v88 = *(char *)(g16 + v85) ^ *v88;
                                                int32_t v89 = *(int32_t *)g13; // 0x8f6681e8
                                                int32_t v90 = v85 + 1; // 0x8f6681f0
                                                if (v90 < v59 + v89) {
                                                    // 0x8f668210
                                                    v61 = g12;
                                                    v62 = v89;
                                                    // branch -> 0x8f668210
                                                    // 0x8f668210
                                                    v71 = 2 * v56 | 1;
                                                    if (v71 >= v62) {
                                                        v80 = v71;
                                                        v78 = v71;
                                                        v84 = 0;
                                                        while (true) {
                                                            // 0x8f668228
                                                            v72 = v78 + 1;
                                                            v68 = v84;
                                                            if (*(char *)(v78 + v61) != 0) {
                                                              lab_if_8f668234_0_true:
                                                                // if_8f668234_0_true
                                                                v68 = v84 | 1;
                                                                // branch -> after_if_8f668234_0
                                                            }
                                                          lab_after_if_8f668234_0:;
                                                            int32_t v91 = 1 - v68 + v80; // 0x8f66823c
                                                            v67 = v91;
                                                            if (v72 < v62) {
                                                                v63 = v72;
                                                                // break (via goto) -> 0x8f668244
                                                                goto lab_0x8f668244;
                                                            }
                                                            v80 = v91;
                                                            v78 = v72;
                                                            v84 = v68;
                                                            // continue -> 0x8f668228
                                                        }
                                                        if (v81 > 1) {
                                                            // branch -> after_if_8f668260_0
                                                        }
                                                        if (v79 < v82) {
                                                            // branch -> after_if_8f668278_0
                                                        }
                                                        char v92; // 0x8f66825c
                                                        if (v92 == 1) {
                                                            // branch -> after_if_8f668280_0
                                                        }
                                                        // after_if_8f668280_0
                                                        if (v64 == 4) {
                                                            // 0x8f66828c
                                                            v76 = v79 + 1;
                                                        }
                                                      lab_0x8f6682b0_7:
                                                        // 0x8f6682b0
                                                        mcs_memclear((int32_t)&v17, 256, g10, g11);
                                                        v16 = mcs_memclear((int32_t)&v18, 20, g10, g11);
                                                        mcs_clear_hash_ctx((int32_t)&v19, v16, g10, g11, (int32_t)v14, 0, 0);
                                                        result = g12;
                                                        if (v8 != g5) {
                                                            goto lab_0x8f6682e4_3;
                                                        }
                                                        // 0x8f668328
                                                        g12 = v5;
                                                        return result;
                                                    }
                                                    // 0x8f668244
                                                    v66 = mcs_memcmp(v57 + v61, v39, v56, v71, v54, 0, 0);
                                                    v77 = g12;
                                                    v81 = *(char *)v77;
                                                    v82 = *(int32_t *)g13;
                                                    g10 = v82;
                                                    v73 = 1 - (int32_t)v81;
                                                    g11 = v73;
                                                    v79 = v71;
                                                    v69 = v73;
                                                    if (v81 > 1) {
                                                        // if_8f668260_0_true
                                                        g11 = 0;
                                                        v69 = 0;
                                                        // branch -> after_if_8f668260_0
                                                    }
                                                    // after_if_8f668260_0
                                                    v70 = v69;
                                                    if (v79 < v82) {
                                                        // if_8f668274_0_true
                                                        v74 = v69 + (int32_t)(v66 == 0) + 1;
                                                        g11 = v74;
                                                        v70 = v74;
                                                        // branch -> after_if_8f668278_0
                                                    }
                                                    // after_if_8f668278_0
                                                    v64 = v70;
                                                    if (*(char *)(v79 + v77) == 1) {
                                                        // if_8f668280_0_true
                                                        v75 = v70 + 1;
                                                        g11 = v75;
                                                        v64 = v75;
                                                        // branch -> after_if_8f668280_0
                                                    }
                                                    // after_if_8f668280_0
                                                    if (v64 == 4) {
                                                        // 0x8f66828c
                                                        v76 = v79 + 1;
                                                        g10 = mcs_memmove(v77, v76 + v77, v82 - v76, 4, v54);
                                                        v65 = (int32_t *)g13;
                                                        v83 = *v65;
                                                        g11 = v83;
                                                        *v65 = v83 - v76;
                                                        // branch -> 0x8f6682ac
                                                        // 0x8f6682ac
                                                        g12 = 0;
                                                        v14 = v55;
                                                        // branch -> 0x8f6682b0
                                                        goto lab_0x8f6682b0_7;
                                                    } else {
                                                        v20 = v55;
                                                      lab_0x8f66803c_3:
                                                        // 0x8f66803c
                                                        g12 = 1;
                                                        v14 = v20;
                                                        // branch -> 0x8f6682b0
                                                        goto lab_0x8f6682b0_7;
                                                    }
                                                  lab_0x8f6682b0_11:
                                                    // 0x8f6682b0
                                                    mcs_memclear((int32_t)&v17, 256, g10, g11);
                                                    v16 = mcs_memclear((int32_t)&v18, 20, g10, g11);
                                                    mcs_clear_hash_ctx((int32_t)&v19, v16, g10, g11, (int32_t)v14, 0, 0);
                                                    result = g12;
                                                    if (v8 != g5) {
                                                        goto lab_0x8f6682e4_3;
                                                    }
                                                    // 0x8f668328
                                                    g12 = v5;
                                                    return result;
                                                }
                                                // 0x8f6681f8
                                                v85 = v90;
                                                v86 = v87;
                                                // branch -> 0x8f6681f8
                                            }
                                        }
                                        // 0x8f668210
                                        v71 = 2 * v56 | 1;
                                        v67 = v71;
                                        v63 = v71;
                                        if (v71 >= v62) {
                                            v80 = v71;
                                            v78 = v71;
                                            v84 = 0;
                                            while (true) {
                                                // 0x8f668228
                                                v72 = v78 + 1;
                                                if (*(char *)(v78 + v61) == 0) {
                                                    v68 = v84;
                                                    goto lab_after_if_8f668234_0;
                                                }
                                                goto lab_if_8f668234_0_true;
                                            }
                                        }
                                      lab_0x8f668244:
                                        // 0x8f668244
                                        v66 = mcs_memcmp(v57 + v61, v39, v56, v63, v54, 0, 0);
                                        v77 = g12;
                                        v81 = *(char *)v77;
                                        v82 = *(int32_t *)g13;
                                        g10 = v82;
                                        v73 = 1 - (int32_t)v81;
                                        g11 = v73;
                                        v79 = v67;
                                        v69 = v73;
                                        if (v81 > 1) {
                                            // if_8f668260_0_true
                                            g11 = 0;
                                            v69 = 0;
                                            // branch -> after_if_8f668260_0
                                        }
                                        // after_if_8f668260_0
                                        v70 = v69;
                                        if (v79 < v82) {
                                            // if_8f668274_0_true
                                            v74 = v69 + (int32_t)(v66 == 0) + 1;
                                            g11 = v74;
                                            v70 = v74;
                                            // branch -> after_if_8f668278_0
                                        }
                                        // after_if_8f668278_0
                                        v64 = v70;
                                        if (*(char *)(v79 + v77) == 1) {
                                            // if_8f668280_0_true
                                            v75 = v70 + 1;
                                            g11 = v75;
                                            v64 = v75;
                                            // branch -> after_if_8f668280_0
                                        }
                                        // after_if_8f668280_0
                                        if (v64 == 4) {
                                            // 0x8f66828c
                                            v76 = v79 + 1;
                                            g10 = mcs_memmove(v77, v76 + v77, v82 - v76, 4, v54);
                                            v65 = (int32_t *)g13;
                                            v83 = *v65;
                                            g11 = v83;
                                            *v65 = v83 - v76;
                                            // branch -> 0x8f6682ac
                                            // 0x8f6682ac
                                            g12 = 0;
                                            v14 = v55;
                                            // branch -> 0x8f6682b0
                                            goto lab_0x8f6682b0_11;
                                        } else {
                                            v20 = v55;
                                        }
                                    } else {
                                        v20 = v55;
                                    }
                                } else {
                                    v20 = v41;
                                }
                            } else {
                                v20 = v2;
                            }
                        } else {
                            v20 = v2;
                        }
                    } else {
                        v20 = v2;
                    }
                } else {
                    v20 = v2;
                }
                break;
            }
            case 0: {
                char v93 = *a1; // 0x8f66805c
                g10 = v93;
                if (v93 == 0) {
                    char v94 = *(char *)(v3 + 1); // 0x8f66806c
                    int32_t v95 = v94; // 0x8f66806c
                    if (v6 == 0x1000000) {
                        // 0x8f668074
                        if (v94 == 2) {
                            // 0x8f6680a4
                            v22 = v95;
                            v21 = v2;
                            if (*(char *)(v95 + v3) != 0) {
                                while (true) {
                                    // 0x8f668090
                                    if (v95 >= *a2 - 1) {
                                        int32_t v96 = v95 + 1; // 0x8f6680a0
                                        if (*(char *)(v96 + v3) == 0) {
                                            v22 = v96;
                                            v21 = v2;
                                            // break (via goto) -> 0x8f6682e8
                                            goto lab_0x8f6682e8;
                                        }
                                        v95 = v96;
                                        // continue -> 0x8f668090
                                        continue;
                                    } else {
                                        v22 = v95;
                                        v21 = v2;
                                    }
                                }
                                // 0x8f6682e8
                                v15 = (int32_t *)v4;
                                v24 = *v15;
                                g10 = v24;
                                v23 = v24 - 1;
                                g11 = v23;
                                if (v22 > v23) {
                                    v20 = v21;
                                    goto lab_0x8f66803c_3;
                                }
                                goto lab_0x8f6682f8_3;
                            }
                            // 0x8f6682e8
                            v15 = (int32_t *)v4;
                            v24 = *v15;
                            g10 = v24;
                            v23 = v24 - 1;
                            g11 = v23;
                            if (v22 > v23) {
                                v20 = v21;
                                goto lab_0x8f66803c_3;
                            }
                            goto lab_0x8f6682f8_3;
                        }
                    } else {
                        // 0x8f668080
                        if (v94 == 1) {
                            char v97 = *(char *)(v3 + 2); // 0x8f6680c8
                            g11 = v97;
                            if (v97 == 0) {
                                v22 = 2;
                                v21 = v2;
                              lab_0x8f6682e8:
                                // 0x8f6682e8
                                v15 = (int32_t *)v4;
                                v24 = *v15;
                                g10 = v24;
                                v23 = v24 - 1;
                                g11 = v23;
                                if (v22 > v23) {
                                    v20 = v21;
                                    goto lab_0x8f66803c_3;
                                }
                                goto lab_0x8f6682f8_3;
                            }
                        }
                    }
                    // 0x8f66803c
                    g12 = 1;
                    v14 = v2;
                    // branch -> 0x8f6682b0
                    goto lab_0x8f6682b0_11;
                } else {
                    v20 = v2;
                }
                break;
            }
        }
        // 0x8f66803c
        g12 = 1;
        v14 = v20;
        // branch -> 0x8f6682b0
        goto lab_0x8f6682b0_11;
    } else {
        // 0x8f66803c
        g12 = 1;
        v14 = v2;
        // branch -> 0x8f6682b0
        goto lab_0x8f6682b0_11;
    }
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// void free(void * ptr);
// int isalnum(int c);
// void * malloc(size_t size);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// size_t strlen(const char * s);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 19
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 18:51:38

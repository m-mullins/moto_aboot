//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t __utag_describe(int32_t a1, int32_t a2, int32_t a3);
int32_t __utag_format(char * a1, int32_t a2, char * a3, int32_t a4, int32_t a5);
int32_t cmd_multiflash_mmc_img(char * str, char * a2, int32_t a3, int32_t a4);
int32_t cmd_multiflash_mmc_sparse_img(int32_t a1, char * a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9, int32_t a10, int32_t a11, int32_t a12);
int32_t dbval_provision_store(char * a1, int32_t * a2, char * a3);
int32_t dbval_validate_datablock(int32_t a1, int32_t a2, int32_t a3, char * a4);
int32_t disable_charger_mode(int32_t a1, int32_t a2);
int32_t fastboot_init_validators(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5);
int32_t fboot_cmd_multiflash_validate(int32_t a1, int32_t a2);
int32_t get_delay_abs_time(int32_t a1, int32_t a2, int32_t a3);
int32_t get_offset_ui_setting(int32_t a1, int32_t a2);
int32_t get_schedule_abs_time(int32_t a1);
int32_t is_recovery_mode(char * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t mcs_clear_rsa_ctx(char * a1, int32_t a2, int32_t a3);
int32_t mcs_hashSHA(int32_t a1, int32_t * a2, int32_t * a3);
int32_t mcs_mp_mont_prod(int32_t * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t mcs_mp_mont_reduce(int32_t * a1, int32_t a2, int32_t a3);
int32_t mutex_acquire(int32_t a1, int32_t a2);
int32_t mutex_release(int32_t a1);
int32_t recovery_mode(int32_t a1, int32_t a2, int32_t a3);
int32_t start_usb_detection(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6);
int32_t stop_charging(int32_t a1, int32_t a2);
int32_t stop_usb_detection(int32_t a1, int32_t a2);
int32_t target_display_pre_on(int32_t a1, int32_t a2, int32_t a3);
int32_t target_reboot_device(int32_t a1);
int32_t thread_preempt(void);
int32_t thread_resume(int32_t a1, int32_t a2);
int32_t wififlash_mode(int32_t a1, int32_t a2, int32_t a3);
int32_t XXH32_intermediateDigest(void);
int32_t XXH32_update(char * a1, char * a2, int32_t a3);

// --------------------- Global Variables ---------------------

int32_t g43 = 0; // LR
int32_t g44 = 0; // R0
int32_t g45 = 0; // R1
int32_t g46 = 0; // R10
int32_t g47 = 0; // R11
int32_t g48 = 0; // R2
int32_t g49 = 0; // R4
int32_t g50 = 0; // R5
int32_t g51 = 0; // R6
int32_t g52 = 0; // R7
int32_t g53 = 0; // R8
int32_t g54 = 0; // R9
int32_t g1 = -0x1a60cfd8; // 0x8f62dd14
int32_t g2 = -0x1a60cfd8; // 0x8f62dd48
int32_t g3 = -0x16d2bfed; // 0x8f62dd7c
int32_t g4 = -0x16d2bf09; // 0x8f62dee0
int32_t g5 = -0x16d2bf8d; // 0x8f62e0bc
int32_t g6 = -0x16d2bfc9; // 0x8f62e21c
int32_t g7 = -0x16d2bf8d; // 0x8f62e284
int32_t g8 = -0x16d2bfc9; // 0x8f62e74c
int32_t g9 = -0x16d2b010; // 0x8f62e900
int32_t g10 = -0x16d2bc10; // 0x8f62eb6c
int32_t g11 = -0x1a60c1d8; // 0x8f62f18c
int32_t g12 = -0x16d2bf8d; // 0x8f630638
int32_t g13 = -0x16d2bf09; // 0x8f634ac0
char * g14 = "\x01"; // 0x8f6a3f48
int32_t g15 = 1; // 0x8f6ac0f0
char * g16 = "\n"; // 0x8f6ac1b0
int32_t g17 = -1; // 0x8f6ac1c4
char * g18 = "\xf1"; // 0x8f6affa8
int32_t g19 = 0; // 0x8f6c0378
int32_t g20 = 0; // 0x8f6c037c
int64_t g21 = 0; // 0x8f6c0380
int32_t g22 = 0; // 0x8f6c0384
int32_t g23 = 0; // 0x8f6c0388
int32_t g24 = 0; // 0x8f6c038c
char * g25; // 0x8f6c0394
char * g26; // 0x8f6c03b8
int32_t g27 = 0; // 0x8f6c03c8
int32_t g28 = 0; // 0x8f6c03cc
char * g29; // 0x8f6c03d4
int32_t g30 = 0; // 0x8f6c03dc
char * g31; // 0x8f6c03e0
int32_t g32 = 0; // 0x8f6e07ec
int32_t g33 = 0; // 0x8f6e07f4
int32_t g34 = 0; // 0x8f6e0828
int16_t * g35 = NULL; // 0x8f70da9c
int32_t g36 = 0; // 0x8f70da9e
int32_t g37 = 0; // 0x8f7112f4
int32_t g38 = 0; // 0x8f7114ac
int32_t g39 = 0; // 0x8f7114f4
int32_t g40 = 0; // 0x8f7114f8
int32_t g41 = 0; // 0x8f71150c
int32_t g42 = 0; // 0x8f711510

// ------------------------ Functions -------------------------

// Address range: 0x8f666fa8 - 0x8f667257
int32_t mcs_mp_mont_prod(int32_t * a1, int32_t a2, int32_t a3, int32_t a4) {
    int32_t v1 = (int32_t)a1;
    int32_t v2 = *(int32_t *)(v1 + 16); // 0x8f666fb4
    int32_t v3 = (int32_t)*(int16_t *)(v1 + 4); // 0x8f666fc0
    int32_t v4 = g37;
    int32_t v5 = v3 - 1; // 0x8f666fcc
    int32_t v6 = 2 * v5 + 3; // R1
    *(int32_t *)v2 = 0;
    int32_t v7 = 1; // 0x8f666ff064
    int32_t v8; // 0x8f667204629
    int32_t v9;
    int32_t v10; // LR
    int32_t result; // 0x8f667204
    int32_t v11; // R3
    int32_t v12;
    int32_t v13; // 0x8f667064
    int32_t v14; // 0x8f66706c
    int32_t v15; // 0x8f667000
    int32_t v16; // 0x8f667004
    int32_t v17; // 0x8f667004
    int32_t v18; // 0x8f6671f0
    int32_t v19; // 0x8f667094
    int32_t v20; // 0x8f6671f8
    int32_t v21; // 0x8f667030
    int32_t v22; // 0x8f667050
    int32_t v23; // 0x8f6671e0
    int32_t v24; // 0x8f667224
    int32_t v25; // 0x8f667044
    int32_t v26; // 0x8f6671f8
    int32_t v27; // 0x8f6671d0
    uint32_t v28; // 0x8f66703c
    int32_t v29; // 0x8f667048
    if (v7 >= v6) {
        // 0x8f666ffc
        v15 = v5;
        v16 = v2;
        v17 = v16 - 4;
        v6 = 0;
        if (v15 > 0) {
            // 0x8f667028
            v11 = 4 * (v15 < 1 ? 4 : v3 + 0x3fffffff) + v16;
            v21 = 0;
            v8 = v17;
            // branch -> 0x8f667028
          lab_0x8f667028_2:
            while (true) {
                // 0x8f667028
                v28 = *(int32_t *)(4 * v21 + a3);
                v10 = v8;
                v25 = v28 / 0x10000;
                v29 = v28 % 0x10000;
                v19 = 0;
                v13 = v29;
                v14 = v25;
                v22 = 0;
                // branch -> 0x8f66704c
                goto lab_0x8f66704c;
            }
        } else {
            // after_if_8f667018_0
            v9 = v17;
            // branch -> 0x8f6671c8
        }
        // 0x8f6671c8
        v27 = v16 + 4 * v3;
        if (v15 >= 0) {
            v23 = -4;
            while (true) {
                // 0x8f6671e0
                *(int32_t *)a2 = *(int32_t *)(v27 + v23);
                v18 = 1;
                v11 = v18;
                if (v18 <= v5) {
                    goto lab_0x8f6671e0_2;
                }
                // 0x8f6671f8
                v20 = v1;
                v26 = *(int32_t *)v20;
                result = mcs_mp_compare(v20, a2, v26, v18, v9, v3, a2);
                v12 = g37;
                if (result == -1) {
                    // 0x8f667240
                    if (v4 == v12) {
                        // 0x8f66724c
                        return result;
                    }
                } else {
                    // 0x8f66721c
                    if (v4 == v12) {
                        // 0x8f667224
                        v24 = v1;
                        return mcs_mp_subb(v24, a2, *(int32_t *)v24, 0, g49, g50, g51, g52, g53, g54, g46, g47);
                    }
                }
                // 0x8f667248
                __stack_chk_fail();
                // branch -> 0x8f66724c
                // 0x8f66724c
                return result;
            }
        }
        // 0x8f6671f8
        v20 = v1;
        v26 = *(int32_t *)v20;
        result = mcs_mp_compare(v20, a2, v26, 0, v9, v3, a2);
        v12 = g37;
        if (result == -1) {
            // 0x8f667240
            if (v4 == v12) {
                // 0x8f66724c
                return result;
            }
        } else {
            // 0x8f66721c
            if (v4 == v12) {
                // 0x8f667224
                v24 = v1;
                return mcs_mp_subb(v24, a2, *(int32_t *)v24, 0, g49, g50, g51, g52, g53, g54, g46, g47);
            }
        }
        // 0x8f667248
        __stack_chk_fail();
        // branch -> 0x8f66724c
        // 0x8f66724c
        return result;
    }
    *(int32_t *)(4 * v7 + v2) = 0;
    int32_t v30 = v7 + 1; // 0x8f666ff0
    while (v30 < v6) {
        // 0x8f666fec
        *(int32_t *)(4 * v30 + v2) = 0;
        v30++;
        // continue -> 0x8f666fec
    }
    // 0x8f666ffc
    v15 = v5;
    v16 = v2;
    v17 = v16 - 4;
    v6 = 0;
    if (v15 > 0) {
        // 0x8f667028
        v11 = 4 * (v15 < 1 ? 4 : v3 + 0x3fffffff) + v16;
        v21 = 0;
        v8 = v17;
        // branch -> 0x8f667028
        while (true) {
            // 0x8f667028
            v28 = *(int32_t *)(4 * v21 + a3);
            v10 = v8;
            v25 = v28 / 0x10000;
            v29 = v28 % 0x10000;
            v19 = 0;
            v13 = v29;
            v14 = v25;
            v22 = 0;
            // branch -> 0x8f66704c
          lab_0x8f66704c:
            while (true) {
                uint32_t v31 = *(int32_t *)(4 * v22 + a4); // 0x8f667050
                int32_t v32 = v22 + 1; // 0x8f667054
                int32_t v33 = v32; // R12
                uint32_t v34 = v31 % 0x10000; // 0x8f667058
                uint32_t v35 = v31 / 0x10000; // 0x8f66705c
                int32_t v36 = v35 * v14; // 0x8f667060
                uint32_t v37 = v35 * v13; // 0x8f667064
                uint32_t v38 = v34 * v14 + v37; // 0x8f66706c
                int32_t v39 = v36; // 0x8f667078
                if (v38 < v37) {
                    // if_8f667074_0_true
                    v39 = v36 + 0x10000;
                    // branch -> after_if_8f667074_0
                }
                int32_t v40 = v39 + v38 / 0x10000; // R6
                int32_t v41 = v10 + 4; // 0x8f667084
                int32_t * v42 = (int32_t *)v41; // 0x8f667084_0
                v10 = v41;
                *v42 = 0x10000 * v38 + v34 * v13 + v19 + *v42;
                if (v32 < v5) {
                    // if_8f6670a4_0_true
                    v19 = v40;
                    v13 = v29;
                    v14 = v25;
                    v22 = v33;
                    // branch -> 0x8f66704c
                    continue;
                } else {
                    int32_t v43 = 4 * v21; // 0x8f667030
                    int32_t * v44 = (int32_t *)v11; // 0x8f6670ac_0
                    int32_t v45 = v40 + *v44; // 0x8f6670b0
                    *v44 = v45;
                    int32_t v46; // 0x8f66712c
                    int32_t v47; // 0x8f667134
                    int32_t v48; // 0x8f6670ec
                    int32_t v49; // 0x8f66715c
                    uint32_t v50; // 0x8f667100
                    int32_t v51; // 0x8f667118
                    int32_t v52; // 0x8f66710c
                    int32_t v53; // 0x8f667110
                    if (v45 < v40) {
                        // if_8f6670bc_0_true
                        // branch -> 0x8f6670e8
                    } else {
                        int32_t v54 = v45 + 4; // 0x8f6670c413
                        int32_t v55 = *(int32_t *)v54; // 0x8f6670c415
                        v33 = v54;
                        int32_t v56 = v55; // 0x8f6670e0
                        if (v55 == -1) {
                            *(int32_t *)(v45 + 4) = 0;
                            int32_t v57 = v33; // 0x8f6670d8
                            int32_t v58 = v57 + 4; // 0x8f6670c4
                            int32_t v59 = *(int32_t *)v58; // 0x8f6670c4
                            while (v59 == -1) {
                                // if_8f6670d0_0_true
                                *(int32_t *)(v57 + 4) = 0;
                                v57 = v58;
                                v58 = v57 + 4;
                                v59 = *(int32_t *)v58;
                                // continue -> if_8f6670d0_0_true
                            }
                            // 0x8f6670e0
                            *(int32_t *)v58 = v59 + 1;
                            // branch -> 0x8f6670e8
                          lab_0x8f6670e8:
                            // 0x8f6670e8
                            v48 = v1;
                            v10 = v8;
                            v50 = *(int32_t *)(v2 + v43) * *(int32_t *)(v48 + 24);
                            v52 = v50 / 0x10000;
                            v53 = v50 % 0x10000;
                            v49 = 0;
                            v46 = v53;
                            v47 = v52;
                            v51 = 0;
                            // branch -> 0x8f667114
                          lab_0x8f667114:;
                            int32_t v60; // 0x8f6671bc
                            int32_t v61; // 0x8f667020
                            while (true) {
                                uint32_t v62 = *(int32_t *)(4 * v51 + *(int32_t *)v48); // 0x8f667118
                                int32_t v63 = v51 + 1; // 0x8f66711c
                                v33 = v63;
                                uint32_t v64 = v62 % 0x10000; // 0x8f667120
                                uint32_t v65 = v62 / 0x10000; // 0x8f667124
                                int32_t v66 = v65 * v47; // 0x8f667128
                                uint32_t v67 = v65 * v46; // 0x8f66712c
                                uint32_t v68 = v64 * v47 + v67; // 0x8f667134
                                int32_t v69 = v66; // 0x8f667140
                                if (v68 < v67) {
                                    // if_8f66713c_0_true
                                    v69 = v66 + 0x10000;
                                    // branch -> after_if_8f66713c_0
                                }
                                // after_if_8f66713c_0
                                v40 = v69 + v68 / 0x10000;
                                int32_t v70 = v10 + 4; // 0x8f66714c
                                int32_t * v71 = (int32_t *)v70; // 0x8f66714c_0
                                v10 = v70;
                                *v71 = 0x10000 * v68 + v64 * v46 + v49 + *v71;
                                if (v63 < v5) {
                                    // if_8f66716c_0_true
                                    v49 = v40;
                                    v46 = v53;
                                    v47 = v52;
                                    v51 = v33;
                                    // branch -> 0x8f667114
                                    continue;
                                } else {
                                    int32_t * v72 = (int32_t *)v11; // 0x8f667174_0
                                    int32_t v73 = v40 + *v72; // 0x8f667178
                                    *v72 = v73;
                                    int32_t v74; // 0x8f6671b4
                                    if (v73 < v40) {
                                        // if_8f667184_0_true
                                        // branch -> 0x8f6671b0
                                    } else {
                                        int32_t v75 = v73 + 4; // 0x8f66718c19
                                        int32_t v76 = *(int32_t *)v75; // 0x8f66718c21
                                        v33 = v75;
                                        int32_t v77 = v76; // 0x8f6671a8
                                        int32_t v78;
                                        if (v76 == -1) {
                                            *(int32_t *)(v73 + 4) = 0;
                                            int32_t v79 = v33; // 0x8f6671a0
                                            int32_t v80 = v79 + 4; // 0x8f66718c
                                            int32_t v81 = *(int32_t *)v80; // 0x8f66718c
                                            while (v81 == -1) {
                                                // if_8f667198_0_true
                                                *(int32_t *)(v79 + 4) = 0;
                                                v79 = v80;
                                                v80 = v79 + 4;
                                                v81 = *(int32_t *)v80;
                                                // continue -> if_8f667198_0_true
                                            }
                                            // 0x8f6671a8
                                            *(int32_t *)v80 = v81 + 1;
                                            // branch -> 0x8f6671b0
                                          lab_0x8f6671b0:
                                            // 0x8f6671b0
                                            v74 = v6 + 1;
                                            v6 = v74;
                                            v11 = v78 + 4;
                                            v60 = v8 + 4;
                                            v61 = v5;
                                            if (v74 >= v61) {
                                                // break (via goto) -> 0x8f667020
                                                goto lab_0x8f667020_2;
                                            }
                                            v21 = v74;
                                            v8 = v60;
                                            // continue (via goto) -> 0x8f667028
                                            goto lab_0x8f667028_2;
                                        }
                                        // 0x8f6671a8
                                        *(int32_t *)v75 = v77 + 1;
                                        v78 = v11;
                                        // branch -> 0x8f6671b0
                                        goto lab_0x8f6671b0;
                                    }
                                    // 0x8f6671b0
                                    v74 = v6 + 1;
                                    v6 = v74;
                                    v11 += 4;
                                    v60 = v8 + 4;
                                    v61 = v5;
                                    if (v74 >= v61) {
                                        // break (via goto) -> 0x8f667020
                                        goto lab_0x8f667020_2;
                                    }
                                    v21 = v74;
                                    v8 = v60;
                                    // continue (via goto) -> 0x8f667028
                                    goto lab_0x8f667028_2;
                                }
                            }
                          lab_0x8f667020_2:
                            // 0x8f667020
                            v9 = v60;
                            // branch -> 0x8f6671c8
                            // 0x8f6671c8
                            v11 = 0;
                            v27 = v2 + 4 * v3;
                            int32_t v82 = 0; // 0x8f667204
                            if (v61 >= 0) {
                                int32_t v83 = 0; // 0x8f6671ec
                                v23 = -4;
                                while (true) {
                                    // 0x8f6671e0
                                    *(int32_t *)(4 * v83 + a2) = *(int32_t *)(v27 + v23);
                                    v18 = v11 + 1;
                                    v11 = v18;
                                    if (v18 <= v5) {
                                      lab_0x8f6671e0_2:
                                        // 0x8f6671e0
                                        v83 = v18;
                                        v23 += 4;
                                        // branch -> 0x8f6671e0
                                        continue;
                                    } else {
                                        v82 = v18;
                                    }
                                }
                            }
                            // 0x8f6671f8
                            v20 = v1;
                            v26 = *(int32_t *)v20;
                            result = mcs_mp_compare(v20, a2, v26, v82, v9, v3, a2);
                            v12 = g37;
                            if (result == -1) {
                                // 0x8f667240
                                if (v4 == v12) {
                                    // 0x8f66724c
                                    return result;
                                }
                            } else {
                                // 0x8f66721c
                                if (v4 == v12) {
                                    // 0x8f667224
                                    v24 = v1;
                                    return mcs_mp_subb(v24, a2, *(int32_t *)v24, 0, g49, g50, g51, g52, g53, g54, g46, g47);
                                }
                            }
                            // 0x8f667248
                            __stack_chk_fail();
                            // branch -> 0x8f66724c
                            // 0x8f66724c
                            return result;
                        }
                        // 0x8f6670e0
                        *(int32_t *)v54 = v56 + 1;
                        // branch -> 0x8f6670e8
                        goto lab_0x8f6670e8;
                    }
                    // 0x8f6670e8
                    v48 = v1;
                    v10 = v8;
                    v50 = *(int32_t *)(v2 + v43) * *(int32_t *)(v48 + 24);
                    v52 = v50 / 0x10000;
                    v53 = v50 % 0x10000;
                    v49 = 0;
                    v46 = v53;
                    v47 = v52;
                    v51 = 0;
                    // branch -> 0x8f667114
                    goto lab_0x8f667114;
                }
            }
        }
    } else {
        // after_if_8f667018_0
        v9 = v17;
        // branch -> 0x8f6671c8
    }
    // 0x8f6671c8
    v27 = v16 + 4 * v3;
    if (v15 >= 0) {
        v23 = -4;
        while (true) {
            // 0x8f6671e0
            *(int32_t *)a2 = *(int32_t *)(v27 + v23);
            v18 = 1;
            v11 = v18;
            if (v18 <= v5) {
                goto lab_0x8f6671e0_2;
            }
            // 0x8f6671f8
            v20 = v1;
            v26 = *(int32_t *)v20;
            result = mcs_mp_compare(v20, a2, v26, v18, v9, v3, a2);
            v12 = g37;
            if (result == -1) {
                // 0x8f667240
                if (v4 == v12) {
                    // 0x8f66724c
                    return result;
                }
            } else {
                // 0x8f66721c
                if (v4 == v12) {
                    // 0x8f667224
                    v24 = v1;
                    return mcs_mp_subb(v24, a2, *(int32_t *)v24, 0, g49, g50, g51, g52, g53, g54, g46, g47);
                }
            }
            // 0x8f667248
            __stack_chk_fail();
            // branch -> 0x8f66724c
            // 0x8f66724c
            return result;
        }
    }
    // 0x8f6671f8
    v20 = v1;
    v26 = *(int32_t *)v20;
    result = mcs_mp_compare(v20, a2, v26, 0, v9, v3, a2);
    v12 = g37;
    if (result == -1) {
        // 0x8f667240
        if (v4 == v12) {
            // 0x8f66724c
            return result;
        }
    } else {
        // 0x8f66721c
        if (v4 == v12) {
            // 0x8f667224
            v24 = v1;
            return mcs_mp_subb(v24, a2, *(int32_t *)v24, 0, g49, g50, g51, g52, g53, g54, g46, g47);
        }
    }
    // 0x8f667248
    __stack_chk_fail();
    // branch -> 0x8f66724c
    // 0x8f66724c
    return result;
}

// --------------- Statically Linked Functions ----------------

// ulldiv_t __aeabi_uldivmod(unsigned long long a, unsigned long long b);
// void __stack_chk_fail(void);
// void free(void * ptr);
// void * malloc(size_t size);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// int snprintf(char * restrict s, size_t maxlen, const char * restrict format, ...);
// int strcmp(const char * s1, const char * s2);

// --------------- Instruction-Idiom Functions ----------------

// int32_t llvm_bswap_i32(int32_t a1);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 30
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:49:15

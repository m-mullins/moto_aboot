//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int32_t add_sp_block(int32_t a1, int32_t a2, int32_t a3);
int32_t board_foundry_id(int32_t a1, int32_t a2, int32_t a3);
int32_t board_pmic_target(uint32_t a1, int32_t a2, int32_t a3);
int32_t cmd_multiflash_mmc_img(char * str, char * a2, int32_t a3, int32_t a4);
int32_t disable_charger_gone_irq(int32_t a1, int32_t a2, int32_t a3);
int32_t fan54046_chg_enable(int32_t result, int32_t a2, int32_t a3);
int32_t fan54046_ibuslim_unlimited(void);
int32_t fboot_cmd_flash_post_backup_validate(int32_t * a1);
int32_t get_gpio_setting(int32_t a1, int32_t * a2, int32_t a3);
int32_t get_ldo_setting(int32_t a1, int32_t * a2);
int32_t get_utags_id(char * str, int32_t a2);
int32_t mcs_hash_data(char * a1, int32_t a2, int32_t a3);
int32_t mcs_hash_end(char * a1, int32_t result, int32_t * a3);
int32_t mcs_rsa_sig(char * a1, int32_t a2, int16_t a3, int32_t a4, int32_t a5, int32_t a6, int32_t * a7);
int32_t mcs_set_rsa_keys(char * a1, int32_t a2, int32_t a3, uint32_t a4, int32_t a5, int32_t a6, int32_t a7, int32_t a8, int32_t a9);
int32_t mcs_X509Certificate_getSubject(void);
int32_t mcs_X509Certificate_getSubjectPublicKey(int32_t a1);
int32_t md5_append(int32_t * a1, char * a2, uint32_t a3);
int32_t md5_finish(int32_t * a1, int32_t a2, int32_t a3, int32_t a4);
int32_t multiflash_partition(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t pmic_charger_cleanup(int32_t a1, int32_t a2);
int32_t pmic_set_extra_reset_info(uint32_t result, uint32_t a2);
int32_t register_cmd_validator(int32_t * a1, char a2, int32_t a3);
int32_t rtc_alarm_disable(int32_t a1, int32_t a2, int32_t a3);
int32_t set_current_path(int32_t a1, char * a2, int32_t a3, int32_t a4);
int32_t sp_init(void);
int32_t target_mot_hw_id(char * a1, int32_t a2);
int32_t target_set_hw_id(char * a1, int32_t a2, int32_t a3);
int32_t udc_register_gadget(int32_t a1, int32_t a2);
int32_t udc_start(int32_t a1, int32_t a2);

// --------------------- Global Variables ---------------------

int32_t g29 = 0; // LR
int32_t g30 = 0; // R0
int32_t g31 = 0; // R1
int32_t g32 = 0; // R10
int32_t g33 = 0; // R11
int32_t g34 = 0; // R2
int32_t g35 = 0; // R3
int32_t g36 = 0; // R4
int32_t g37 = 0; // R5
int32_t g38 = 0; // R6
int32_t g39 = 0; // R7
int32_t g40 = 0; // R8
int32_t g41 = 0; // R9
int32_t g1 = -0x16d2bf10; // 0x8f60569c
int32_t g2 = 0; // 0x8f6ac068
int32_t g3 = 0; // 0x8f6ac06c
char * g4 = "\xff\xff\xff\xff\xe8\xc0\x6a\x8f\xe8\xc0\x6a\x8f\x01"; // 0x8f6ac0e4
char * g5[3] = {
    "config",
    "utags",
    "utagsBackup"
}; // 0x8f6b009c
char * g6[2] = {
    "hw",
    "hw"
}; // 0x8f6b00fc
int32_t g7 = 0; // 0x8f6b792c
char * g8; // 0x8f6b794c
int32_t g9 = 0; // 0x8f6c03c0
int32_t g10 = 0; // 0x8f6c03c4
int32_t g11 = 0; // 0x8f6c03cc
int32_t g12 = 0; // 0x8f6e0aac
int32_t g13 = 0; // 0x8f710c38
int32_t g14 = 0; // 0x8f710c3c
int32_t g15 = 0; // 0x8f710c40
int32_t g16 = 0; // 0x8f710c44
char * g17; // 0x8f710c48
char * g18; // 0x8f710c50
int32_t g19 = 0; // 0x8f710c60
int32_t g20 = 0; // 0x8f710c64
char g21 = 0; // 0x8f710c68
char * g22; // 0x8f710c70
int32_t g23 = 0; // 0x8f710e70
char * g24; // 0x8f710e74
int32_t g25 = 0; // 0x8f710e78
int32_t g26 = 0; // 0x8f710e7c
int32_t g27 = 0; // 0x8f7112f4
int32_t g28 = 0; // 0x8f7125ec

// ------------------------ Functions -------------------------

// Address range: 0x8f65a8c8 - 0x8f65a98f
// Used cryptographic patterns:
//  - padding_used_in_hashing_algorithms__0x80_0_____0_ (8-bit, little endian)
int32_t md5_finish(int32_t * a1, int32_t a2, int32_t a3, int32_t a4) {
    int32_t v1 = (int32_t)a1;
    int32_t v2 = a2; // bp-36
    int32_t v3 = g37; // 0x8f65a8c8
    int32_t v4 = g38; // 0x8f65a8c8
    g37 = v1;
    g40 = a2;
    g36 = 0;
    g39 = &g27;
    int32_t v5 = &v2; // 0x8f65a8f0_0
    int32_t v6 = 0; // 0x8f65a900
    g38 = v5;
    uint32_t v7 = *(int32_t *)(4 * v6 / 4 + v1); // 0x8f65a8f4
    *(char *)(v6 + v5) = (char)(v7 >> 8 * (v6 % 4));
    int32_t v8 = g36 + 1; // 0x8f65a904
    g36 = v8;
    int32_t v9 = g37; // 0x8f65a910
    // branch -> 0x8f65a8e8
    while (v8 != 8) {
        // 0x8f65a8e8
        v6 = v8;
        g38 = v5;
        v7 = *(int32_t *)(4 * v6 / 4 + v9);
        *(char *)(v6 + v5) = (char)(v7 >> 8 * (v6 % 4));
        v8 = g36 + 1;
        g36 = v8;
        v9 = g37;
        // continue -> 0x8f65a8e8
    }
    int32_t * v10 = (int32_t *)v9; // 0x8f65a910_0
    uint32_t v11 = *v10; // 0x8f65a910
    md5_append(v10, "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", (55 - v11 / 8) % 64 + 1);
    int32_t result = md5_append((int32_t *)g37, (char *)&v2, g36); // 0x8f65a93c
    int32_t v12 = 0; // 0x8f65a95c
    uint32_t v13 = *(int32_t *)(4 * (v12 / 4 + 2) + g37); // 0x8f65a954
    *(char *)(g40 + v12) = (char)(v13 >> (8 * v12 & 24));
    int32_t v14 = 1; // 0x8f65a960
    // branch -> 0x8f65a944
    while (v14 != 16) {
        // 0x8f65a944
        v12 = v14;
        v13 = *(int32_t *)(4 * (v12 / 4 + 2) + g37);
        *(char *)(g40 + v12) = (char)(v13 >> (8 * v12 & 24));
        v14++;
        // continue -> 0x8f65a944
    }
    // 0x8f65a980
    g37 = v3;
    g38 = v4;
    return result;
}

// --------------- Statically Linked Functions ----------------

// void __stack_chk_fail(void);
// uLong crc32(uLong crc, const Bytef * buf, uInt len);
// void * malloc(size_t size);
// int memcmp(const void * s1, const void * s2, size_t n);
// void * memcpy(void * restrict dest, const void * restrict src, size_t n);
// void * memset(void * s, int c, size_t n);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);
// int strncmp(const char * s1, const char * s2, size_t n);
// char * strstr(char * haystack, const char * needle);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: android-ndk-r8 (4.4.3 armv5te, armv7a(arm-linux-androideabi-gcc))
// Detected functions: 30
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-08-06 19:38:13
